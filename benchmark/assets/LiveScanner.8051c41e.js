import{Q as L}from"./QSelect.72451ebc.js";import{Q as N}from"./QBtn.6b7b2e93.js";import{x as f,b as h,m as V}from"./utils.9c952faa.js";import{ah as z,q as D,r,u as P,o as Q,t as k,N as T,y as S,M as c,P as E,ad as j}from"./index.854bdf1e.js";import"./position-engine.8986b49b.js";import"./scroll.4974edba.js";const q={class:"q-pa-md",style:{width:"100%"}},F={style:{"padding-left":"10px"}},M={id:"results"},O=D({__name:"LiveScanner",setup($){const s=r(""),g=r([]),I=P(),l=r(""),u=r(!1),p=r(),_=r("");let d=!1,o,n,m;Q(async()=>{_.value=I.currentRoute.value.params.name;const e=h.getEngines();g.value=e,s.value=e[0],C()});const x=async()=>{let e=await V(_.value,s.value,o.getSupportedSettings());if(s.value==="Dynamsoft"){let t=!1;for(let a=0;a<e.length;a++){const i=e[a];i.name==="template"&&i.value&&(t=!0)}t===!1&&e.push({name:"template",value:"speed"})}await o.setSupportedSettings(e)},w=async()=>{if(v(),n){n.isOpen()===!1?(l.value="Starting...",await n.open(!0),u.value=!0,l.value=""):(n.close(!0),u.value=!1);return}u.value=!1},B=()=>{y()},C=async()=>{var e;l.value="Initializing Camera...",f.defaultUIElementURL="https://cdn.jsdelivr.net/npm/dynamsoft-camera-enhancer@3.3.4/dist/dce.ui.html",n=await f.createInstance(),n.on("played",B),await n.setUIElement(f.defaultUIElementURL),(e=document.getElementById("enhancerUIContainer"))==null||e.appendChild(n.getUIElement()),document.getElementsByClassName("dce-btn-close")[0].remove(),l.value=""},y=()=>{v(),m=setInterval(R,200)},v=()=>{clearInterval(m),d=!1},R=async()=>{if(n&&d===!1){d=!0;let e=!1;o?o.getEngine()!=s.value&&(e=!0):e=!0,e&&(l.value="Initializing Barcode Reader...",o=await h.createInstance(s.value),await x(),l.value="");const t=n.getFrame(),a=await o.detect(t);l.value=a.elapsedTime+"ms",o.getEngine()===s.value&&U(a),d=!1}},U=e=>{if(e.results.length>0){let t="";for(let a=0;a<e.results.length;a++){const i=e.results[a];t=t+(a+1)+". "+i.barcodeFormat+": "+i.barcodeText,i.confidence&&(t=t+", confidence: "+i.confidence),t=t+`
`}p.value=t}},b=e=>{m&&n.isOpen()&&(v(),y()),p.value=""};return(e,t)=>(k(),T("div",q,[S(L,{"onUpdate:modelValue":[t[0]||(t[0]=a=>b()),t[1]||(t[1]=a=>s.value=a)],style:{"max-width":"300px"},modelValue:s.value,options:g.value,label:"Engine"},null,8,["modelValue","options"]),c("div",null,[S(N,{outline:"",color:"primary",label:u.value?"Stop Scanning":"Start Scanning",onClick:w},null,8,["label"]),c("span",F,E(l.value),1)]),c("div",M,[c("pre",null,""+E(p.value)+`
      `,1)]),c("div",null,[c("div",{id:"enhancerUIContainer",style:{width:"100%",height:"500px"},class:j(u.value?"":"hidden")},null,2)])]))}});var X=z(O,[["__scopeId","data-v-2130b34a"]]);export{X as default};
