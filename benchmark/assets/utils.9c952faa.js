var Ta=Object.defineProperty;var Oa=(r,e,t)=>e in r?Ta(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var sr=(r,e,t)=>(Oa(r,typeof e!="symbol"?e+"":e,t),t);import{c as p0,h as Ia}from"./index.854bdf1e.js";const Bu={dark:{type:Boolean,default:null}};function vu(r,e){return p0(()=>r.dark===null?e.dark.isActive:r.dark)}const _u={name:String};function Cu(r={}){return(e,t,i)=>{e[t](Ia("input",{class:"hidden"+(i||""),...r.value}))}}function mu(r){return p0(()=>r.name||r.for)}var gi=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Ai(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var B0={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(r,e){(function(t){r.exports=t()})(function(){return function t(i,o,s){function u(_,m){if(!o[_]){if(!i[_]){var D=typeof Ai=="function"&&Ai;if(!m&&D)return D(_,!0);if(g)return g(_,!0);var F=new Error("Cannot find module '"+_+"'");throw F.code="MODULE_NOT_FOUND",F}var T=o[_]={exports:{}};i[_][0].call(T.exports,function(I){var k=i[_][1][I];return u(k||I)},T,T.exports,t,i,o,s)}return o[_].exports}for(var g=typeof Ai=="function"&&Ai,B=0;B<s.length;B++)u(s[B]);return u}({1:[function(t,i,o){(function(s){var u=s.MutationObserver||s.WebKitMutationObserver,g;if(u){var B=0,_=new u(I),m=s.document.createTextNode("");_.observe(m,{characterData:!0}),g=function(){m.data=B=++B%2}}else if(!s.setImmediate&&typeof s.MessageChannel!="undefined"){var D=new s.MessageChannel;D.port1.onmessage=I,g=function(){D.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?g=function(){var U=s.document.createElement("script");U.onreadystatechange=function(){I(),U.onreadystatechange=null,U.parentNode.removeChild(U),U=null},s.document.documentElement.appendChild(U)}:g=function(){setTimeout(I,0)};var F,T=[];function I(){F=!0;for(var U,K,X=T.length;X;){for(K=T,T=[],U=-1;++U<X;)K[U]();X=T.length}F=!1}i.exports=k;function k(U){T.push(U)===1&&!F&&g()}}).call(this,typeof gi!="undefined"?gi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(t,i,o){var s=t(1);function u(){}var g={},B=["REJECTED"],_=["FULFILLED"],m=["PENDING"];i.exports=D;function D(re){if(typeof re!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,re!==u&&k(this,re)}D.prototype.catch=function(re){return this.then(null,re)},D.prototype.then=function(re,ue){if(typeof re!="function"&&this.state===_||typeof ue!="function"&&this.state===B)return this;var Ae=new this.constructor(u);if(this.state!==m){var v=this.state===_?re:ue;T(Ae,v,this.outcome)}else this.queue.push(new F(Ae,re,ue));return Ae};function F(re,ue,Ae){this.promise=re,typeof ue=="function"&&(this.onFulfilled=ue,this.callFulfilled=this.otherCallFulfilled),typeof Ae=="function"&&(this.onRejected=Ae,this.callRejected=this.otherCallRejected)}F.prototype.callFulfilled=function(re){g.resolve(this.promise,re)},F.prototype.otherCallFulfilled=function(re){T(this.promise,this.onFulfilled,re)},F.prototype.callRejected=function(re){g.reject(this.promise,re)},F.prototype.otherCallRejected=function(re){T(this.promise,this.onRejected,re)};function T(re,ue,Ae){s(function(){var v;try{v=ue(Ae)}catch(ye){return g.reject(re,ye)}v===re?g.reject(re,new TypeError("Cannot resolve promise with itself")):g.resolve(re,v)})}g.resolve=function(re,ue){var Ae=U(I,ue);if(Ae.status==="error")return g.reject(re,Ae.value);var v=Ae.value;if(v)k(re,v);else{re.state=_,re.outcome=ue;for(var ye=-1,be=re.queue.length;++ye<be;)re.queue[ye].callFulfilled(ue)}return re},g.reject=function(re,ue){re.state=B,re.outcome=ue;for(var Ae=-1,v=re.queue.length;++Ae<v;)re.queue[Ae].callRejected(ue);return re};function I(re){var ue=re&&re.then;if(re&&(typeof re=="object"||typeof re=="function")&&typeof ue=="function")return function(){ue.apply(re,arguments)}}function k(re,ue){var Ae=!1;function v(h){Ae||(Ae=!0,g.reject(re,h))}function ye(h){Ae||(Ae=!0,g.resolve(re,h))}function be(){ue(ye,v)}var je=U(be);je.status==="error"&&v(je.value)}function U(re,ue){var Ae={};try{Ae.value=re(ue),Ae.status="success"}catch(v){Ae.status="error",Ae.value=v}return Ae}D.resolve=K;function K(re){return re instanceof this?re:g.resolve(new this(u),re)}D.reject=X;function X(re){var ue=new this(u);return g.reject(ue,re)}D.all=te;function te(re){var ue=this;if(Object.prototype.toString.call(re)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Ae=re.length,v=!1;if(!Ae)return this.resolve([]);for(var ye=new Array(Ae),be=0,je=-1,h=new this(u);++je<Ae;)x(re[je],je);return h;function x(l,f){ue.resolve(l).then(n,function(a){v||(v=!0,g.reject(h,a))});function n(a){ye[f]=a,++be===Ae&&!v&&(v=!0,g.resolve(h,ye))}}}D.race=ne;function ne(re){var ue=this;if(Object.prototype.toString.call(re)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Ae=re.length,v=!1;if(!Ae)return this.resolve([]);for(var ye=-1,be=new this(u);++ye<Ae;)je(re[ye]);return be;function je(h){ue.resolve(h).then(function(x){v||(v=!0,g.resolve(be,x))},function(x){v||(v=!0,g.reject(be,x))})}}},{1:1}],3:[function(t,i,o){(function(s){typeof s.Promise!="function"&&(s.Promise=t(2))}).call(this,typeof gi!="undefined"?gi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(t,i,o){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H};function u(H,oe){if(!(H instanceof oe))throw new TypeError("Cannot call a class as a function")}function g(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}var B=g();function _(){try{if(!B||!B.open)return!1;var H=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),oe=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!H||oe)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}function m(H,oe){H=H||[],oe=oe||{};try{return new Blob(H,oe)}catch(xe){if(xe.name!=="TypeError")throw xe;for(var $=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,le=new $,fe=0;fe<H.length;fe+=1)le.append(H[fe]);return le.getBlob(oe.type)}}typeof Promise=="undefined"&&t(3);var D=Promise;function F(H,oe){oe&&H.then(function($){oe(null,$)},function($){oe($)})}function T(H,oe,$){typeof oe=="function"&&H.then(oe),typeof $=="function"&&H.catch($)}function I(H){return typeof H!="string"&&(console.warn(H+" used as a key, but it is not a string."),H=String(H)),H}function k(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var U="local-forage-detect-blob-support",K=void 0,X={},te=Object.prototype.toString,ne="readonly",re="readwrite";function ue(H){for(var oe=H.length,$=new ArrayBuffer(oe),le=new Uint8Array($),fe=0;fe<oe;fe++)le[fe]=H.charCodeAt(fe);return $}function Ae(H){return new D(function(oe){var $=H.transaction(U,re),le=m([""]);$.objectStore(U).put(le,"key"),$.onabort=function(fe){fe.preventDefault(),fe.stopPropagation(),oe(!1)},$.oncomplete=function(){var fe=navigator.userAgent.match(/Chrome\/(\d+)/),xe=navigator.userAgent.match(/Edge\//);oe(xe||!fe||parseInt(fe[1],10)>=43)}}).catch(function(){return!1})}function v(H){return typeof K=="boolean"?D.resolve(K):Ae(H).then(function(oe){return K=oe,K})}function ye(H){var oe=X[H.name],$={};$.promise=new D(function(le,fe){$.resolve=le,$.reject=fe}),oe.deferredOperations.push($),oe.dbReady?oe.dbReady=oe.dbReady.then(function(){return $.promise}):oe.dbReady=$.promise}function be(H){var oe=X[H.name],$=oe.deferredOperations.pop();if($)return $.resolve(),$.promise}function je(H,oe){var $=X[H.name],le=$.deferredOperations.pop();if(le)return le.reject(oe),le.promise}function h(H,oe){return new D(function($,le){if(X[H.name]=X[H.name]||p(),H.db)if(oe)ye(H),H.db.close();else return $(H.db);var fe=[H.name];oe&&fe.push(H.version);var xe=B.open.apply(B,fe);oe&&(xe.onupgradeneeded=function(Ce){var we=xe.result;try{we.createObjectStore(H.storeName),Ce.oldVersion<=1&&we.createObjectStore(U)}catch(Fe){if(Fe.name==="ConstraintError")console.warn('The database "'+H.name+'" has been upgraded from version '+Ce.oldVersion+" to version "+Ce.newVersion+', but the storage "'+H.storeName+'" already exists.');else throw Fe}}),xe.onerror=function(Ce){Ce.preventDefault(),le(xe.error)},xe.onsuccess=function(){var Ce=xe.result;Ce.onversionchange=function(we){we.target.close()},$(Ce),be(H)}})}function x(H){return h(H,!1)}function l(H){return h(H,!0)}function f(H,oe){if(!H.db)return!0;var $=!H.db.objectStoreNames.contains(H.storeName),le=H.version<H.db.version,fe=H.version>H.db.version;if(le&&(H.version!==oe&&console.warn('The database "'+H.name+`" can't be downgraded from version `+H.db.version+" to version "+H.version+"."),H.version=H.db.version),fe||$){if($){var xe=H.db.version+1;xe>H.version&&(H.version=xe)}return!0}return!1}function n(H){return new D(function(oe,$){var le=new FileReader;le.onerror=$,le.onloadend=function(fe){var xe=btoa(fe.target.result||"");oe({__local_forage_encoded_blob:!0,data:xe,type:H.type})},le.readAsBinaryString(H)})}function a(H){var oe=ue(atob(H.data));return m([oe],{type:H.type})}function c(H){return H&&H.__local_forage_encoded_blob}function A(H){var oe=this,$=oe._initReady().then(function(){var le=X[oe._dbInfo.name];if(le&&le.dbReady)return le.dbReady});return T($,H,H),$}function E(H){ye(H);for(var oe=X[H.name],$=oe.forages,le=0;le<$.length;le++){var fe=$[le];fe._dbInfo.db&&(fe._dbInfo.db.close(),fe._dbInfo.db=null)}return H.db=null,x(H).then(function(xe){return H.db=xe,f(H)?l(H):xe}).then(function(xe){H.db=oe.db=xe;for(var Ce=0;Ce<$.length;Ce++)$[Ce]._dbInfo.db=xe}).catch(function(xe){throw je(H,xe),xe})}function d(H,oe,$,le){le===void 0&&(le=1);try{var fe=H.db.transaction(H.storeName,oe);$(null,fe)}catch(xe){if(le>0&&(!H.db||xe.name==="InvalidStateError"||xe.name==="NotFoundError"))return D.resolve().then(function(){if(!H.db||xe.name==="NotFoundError"&&!H.db.objectStoreNames.contains(H.storeName)&&H.version<=H.db.version)return H.db&&(H.version=H.db.version+1),l(H)}).then(function(){return E(H).then(function(){d(H,oe,$,le-1)})}).catch($);$(xe)}}function p(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function C(H){var oe=this,$={db:null};if(H)for(var le in H)$[le]=H[le];var fe=X[$.name];fe||(fe=p(),X[$.name]=fe),fe.forages.push(oe),oe._initReady||(oe._initReady=oe.ready,oe.ready=A);var xe=[];function Ce(){return D.resolve()}for(var we=0;we<fe.forages.length;we++){var Fe=fe.forages[we];Fe!==oe&&xe.push(Fe._initReady().catch(Ce))}var Se=fe.forages.slice(0);return D.all(xe).then(function(){return $.db=fe.db,x($)}).then(function(Oe){return $.db=Oe,f($,oe._defaultConfig.version)?l($):Oe}).then(function(Oe){$.db=fe.db=Oe,oe._dbInfo=$;for(var Me=0;Me<Se.length;Me++){var We=Se[Me];We!==oe&&(We._dbInfo.db=$.db,We._dbInfo.version=$.version)}})}function y(H,oe){var $=this;H=I(H);var le=new D(function(fe,xe){$.ready().then(function(){d($._dbInfo,ne,function(Ce,we){if(Ce)return xe(Ce);try{var Fe=we.objectStore($._dbInfo.storeName),Se=Fe.get(H);Se.onsuccess=function(){var Oe=Se.result;Oe===void 0&&(Oe=null),c(Oe)&&(Oe=a(Oe)),fe(Oe)},Se.onerror=function(){xe(Se.error)}}catch(Oe){xe(Oe)}})}).catch(xe)});return F(le,oe),le}function S(H,oe){var $=this,le=new D(function(fe,xe){$.ready().then(function(){d($._dbInfo,ne,function(Ce,we){if(Ce)return xe(Ce);try{var Fe=we.objectStore($._dbInfo.storeName),Se=Fe.openCursor(),Oe=1;Se.onsuccess=function(){var Me=Se.result;if(Me){var We=Me.value;c(We)&&(We=a(We));var Je=H(We,Me.key,Oe++);Je!==void 0?fe(Je):Me.continue()}else fe()},Se.onerror=function(){xe(Se.error)}}catch(Me){xe(Me)}})}).catch(xe)});return F(le,oe),le}function w(H,oe,$){var le=this;H=I(H);var fe=new D(function(xe,Ce){var we;le.ready().then(function(){return we=le._dbInfo,te.call(oe)==="[object Blob]"?v(we.db).then(function(Fe){return Fe?oe:n(oe)}):oe}).then(function(Fe){d(le._dbInfo,re,function(Se,Oe){if(Se)return Ce(Se);try{var Me=Oe.objectStore(le._dbInfo.storeName);Fe===null&&(Fe=void 0);var We=Me.put(Fe,H);Oe.oncomplete=function(){Fe===void 0&&(Fe=null),xe(Fe)},Oe.onabort=Oe.onerror=function(){var Je=We.error?We.error:We.transaction.error;Ce(Je)}}catch(Je){Ce(Je)}})}).catch(Ce)});return F(fe,$),fe}function b(H,oe){var $=this;H=I(H);var le=new D(function(fe,xe){$.ready().then(function(){d($._dbInfo,re,function(Ce,we){if(Ce)return xe(Ce);try{var Fe=we.objectStore($._dbInfo.storeName),Se=Fe.delete(H);we.oncomplete=function(){fe()},we.onerror=function(){xe(Se.error)},we.onabort=function(){var Oe=Se.error?Se.error:Se.transaction.error;xe(Oe)}}catch(Oe){xe(Oe)}})}).catch(xe)});return F(le,oe),le}function O(H){var oe=this,$=new D(function(le,fe){oe.ready().then(function(){d(oe._dbInfo,re,function(xe,Ce){if(xe)return fe(xe);try{var we=Ce.objectStore(oe._dbInfo.storeName),Fe=we.clear();Ce.oncomplete=function(){le()},Ce.onabort=Ce.onerror=function(){var Se=Fe.error?Fe.error:Fe.transaction.error;fe(Se)}}catch(Se){fe(Se)}})}).catch(fe)});return F($,H),$}function N(H){var oe=this,$=new D(function(le,fe){oe.ready().then(function(){d(oe._dbInfo,ne,function(xe,Ce){if(xe)return fe(xe);try{var we=Ce.objectStore(oe._dbInfo.storeName),Fe=we.count();Fe.onsuccess=function(){le(Fe.result)},Fe.onerror=function(){fe(Fe.error)}}catch(Se){fe(Se)}})}).catch(fe)});return F($,H),$}function j(H,oe){var $=this,le=new D(function(fe,xe){if(H<0){fe(null);return}$.ready().then(function(){d($._dbInfo,ne,function(Ce,we){if(Ce)return xe(Ce);try{var Fe=we.objectStore($._dbInfo.storeName),Se=!1,Oe=Fe.openKeyCursor();Oe.onsuccess=function(){var Me=Oe.result;if(!Me){fe(null);return}H===0||Se?fe(Me.key):(Se=!0,Me.advance(H))},Oe.onerror=function(){xe(Oe.error)}}catch(Me){xe(Me)}})}).catch(xe)});return F(le,oe),le}function Z(H){var oe=this,$=new D(function(le,fe){oe.ready().then(function(){d(oe._dbInfo,ne,function(xe,Ce){if(xe)return fe(xe);try{var we=Ce.objectStore(oe._dbInfo.storeName),Fe=we.openKeyCursor(),Se=[];Fe.onsuccess=function(){var Oe=Fe.result;if(!Oe){le(Se);return}Se.push(Oe.key),Oe.continue()},Fe.onerror=function(){fe(Fe.error)}}catch(Oe){fe(Oe)}})}).catch(fe)});return F($,H),$}function Y(H,oe){oe=k.apply(this,arguments);var $=this.config();H=typeof H!="function"&&H||{},H.name||(H.name=H.name||$.name,H.storeName=H.storeName||$.storeName);var le=this,fe;if(!H.name)fe=D.reject("Invalid arguments");else{var xe=H.name===$.name&&le._dbInfo.db,Ce=xe?D.resolve(le._dbInfo.db):x(H).then(function(we){var Fe=X[H.name],Se=Fe.forages;Fe.db=we;for(var Oe=0;Oe<Se.length;Oe++)Se[Oe]._dbInfo.db=we;return we});H.storeName?fe=Ce.then(function(we){if(!!we.objectStoreNames.contains(H.storeName)){var Fe=we.version+1;ye(H);var Se=X[H.name],Oe=Se.forages;we.close();for(var Me=0;Me<Oe.length;Me++){var We=Oe[Me];We._dbInfo.db=null,We._dbInfo.version=Fe}var Je=new D(function(Ze,Et){var ht=B.open(H.name,Fe);ht.onerror=function($t){var Jr=ht.result;Jr.close(),Et($t)},ht.onupgradeneeded=function(){var $t=ht.result;$t.deleteObjectStore(H.storeName)},ht.onsuccess=function(){var $t=ht.result;$t.close(),Ze($t)}});return Je.then(function(Ze){Se.db=Ze;for(var Et=0;Et<Oe.length;Et++){var ht=Oe[Et];ht._dbInfo.db=Ze,be(ht._dbInfo)}}).catch(function(Ze){throw(je(H,Ze)||D.resolve()).catch(function(){}),Ze})}}):fe=Ce.then(function(we){ye(H);var Fe=X[H.name],Se=Fe.forages;we.close();for(var Oe=0;Oe<Se.length;Oe++){var Me=Se[Oe];Me._dbInfo.db=null}var We=new D(function(Je,Ze){var Et=B.deleteDatabase(H.name);Et.onerror=function(){var ht=Et.result;ht&&ht.close(),Ze(Et.error)},Et.onblocked=function(){console.warn('dropInstance blocked for database "'+H.name+'" until all open connections are closed')},Et.onsuccess=function(){var ht=Et.result;ht&&ht.close(),Je(ht)}});return We.then(function(Je){Fe.db=Je;for(var Ze=0;Ze<Se.length;Ze++){var Et=Se[Ze];be(Et._dbInfo)}}).catch(function(Je){throw(je(H,Je)||D.resolve()).catch(function(){}),Je})})}return F(fe,oe),fe}var W={_driver:"asyncStorage",_initStorage:C,_support:_(),iterate:S,getItem:y,setItem:w,removeItem:b,clear:O,length:N,key:j,keys:Z,dropInstance:Y};function P(){return typeof openDatabase=="function"}var R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",V="~~local_forage_type~",J=/^~~local_forage_type~([^~]+)~/,q="__lfsc__:",L=q.length,M="arbf",G="blob",ee="si08",z="ui08",ie="uic8",de="si16",he="si32",se="ur16",Ee="ui32",ce="fl32",pe="fl64",_e=L+M.length,Be=Object.prototype.toString;function Te(H){var oe=H.length*.75,$=H.length,le,fe=0,xe,Ce,we,Fe;H[H.length-1]==="="&&(oe--,H[H.length-2]==="="&&oe--);var Se=new ArrayBuffer(oe),Oe=new Uint8Array(Se);for(le=0;le<$;le+=4)xe=R.indexOf(H[le]),Ce=R.indexOf(H[le+1]),we=R.indexOf(H[le+2]),Fe=R.indexOf(H[le+3]),Oe[fe++]=xe<<2|Ce>>4,Oe[fe++]=(Ce&15)<<4|we>>2,Oe[fe++]=(we&3)<<6|Fe&63;return Se}function Re(H){var oe=new Uint8Array(H),$="",le;for(le=0;le<oe.length;le+=3)$+=R[oe[le]>>2],$+=R[(oe[le]&3)<<4|oe[le+1]>>4],$+=R[(oe[le+1]&15)<<2|oe[le+2]>>6],$+=R[oe[le+2]&63];return oe.length%3===2?$=$.substring(0,$.length-1)+"=":oe.length%3===1&&($=$.substring(0,$.length-2)+"=="),$}function tt(H,oe){var $="";if(H&&($=Be.call(H)),H&&($==="[object ArrayBuffer]"||H.buffer&&Be.call(H.buffer)==="[object ArrayBuffer]")){var le,fe=q;H instanceof ArrayBuffer?(le=H,fe+=M):(le=H.buffer,$==="[object Int8Array]"?fe+=ee:$==="[object Uint8Array]"?fe+=z:$==="[object Uint8ClampedArray]"?fe+=ie:$==="[object Int16Array]"?fe+=de:$==="[object Uint16Array]"?fe+=se:$==="[object Int32Array]"?fe+=he:$==="[object Uint32Array]"?fe+=Ee:$==="[object Float32Array]"?fe+=ce:$==="[object Float64Array]"?fe+=pe:oe(new Error("Failed to get type for BinaryArray"))),oe(fe+Re(le))}else if($==="[object Blob]"){var xe=new FileReader;xe.onload=function(){var Ce=V+H.type+"~"+Re(this.result);oe(q+G+Ce)},xe.readAsArrayBuffer(H)}else try{oe(JSON.stringify(H))}catch(Ce){console.error("Couldn't convert value into a JSON string: ",H),oe(null,Ce)}}function lt(H){if(H.substring(0,L)!==q)return JSON.parse(H);var oe=H.substring(_e),$=H.substring(L,_e),le;if($===G&&J.test(oe)){var fe=oe.match(J);le=fe[1],oe=oe.substring(fe[0].length)}var xe=Te(oe);switch($){case M:return xe;case G:return m([xe],{type:le});case ee:return new Int8Array(xe);case z:return new Uint8Array(xe);case ie:return new Uint8ClampedArray(xe);case de:return new Int16Array(xe);case se:return new Uint16Array(xe);case he:return new Int32Array(xe);case Ee:return new Uint32Array(xe);case ce:return new Float32Array(xe);case pe:return new Float64Array(xe);default:throw new Error("Unkown type: "+$)}}var Ft={serialize:tt,deserialize:lt,stringToBuffer:Te,bufferToString:Re};function Ne(H,oe,$,le){H.executeSql("CREATE TABLE IF NOT EXISTS "+oe.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],$,le)}function rt(H){var oe=this,$={db:null};if(H)for(var le in H)$[le]=typeof H[le]!="string"?H[le].toString():H[le];var fe=new D(function(xe,Ce){try{$.db=openDatabase($.name,String($.version),$.description,$.size)}catch(we){return Ce(we)}$.db.transaction(function(we){Ne(we,$,function(){oe._dbInfo=$,xe()},function(Fe,Se){Ce(Se)})},Ce)});return $.serializer=Ft,fe}function ft(H,oe,$,le,fe,xe){H.executeSql($,le,fe,function(Ce,we){we.code===we.SYNTAX_ERR?Ce.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[oe.storeName],function(Fe,Se){Se.rows.length?xe(Fe,we):Ne(Fe,oe,function(){Fe.executeSql($,le,fe,xe)},xe)},xe):xe(Ce,we)},xe)}function Lt(H,oe){var $=this;H=I(H);var le=new D(function(fe,xe){$.ready().then(function(){var Ce=$._dbInfo;Ce.db.transaction(function(we){ft(we,Ce,"SELECT * FROM "+Ce.storeName+" WHERE key = ? LIMIT 1",[H],function(Fe,Se){var Oe=Se.rows.length?Se.rows.item(0).value:null;Oe&&(Oe=Ce.serializer.deserialize(Oe)),fe(Oe)},function(Fe,Se){xe(Se)})})}).catch(xe)});return F(le,oe),le}function St(H,oe){var $=this,le=new D(function(fe,xe){$.ready().then(function(){var Ce=$._dbInfo;Ce.db.transaction(function(we){ft(we,Ce,"SELECT * FROM "+Ce.storeName,[],function(Fe,Se){for(var Oe=Se.rows,Me=Oe.length,We=0;We<Me;We++){var Je=Oe.item(We),Ze=Je.value;if(Ze&&(Ze=Ce.serializer.deserialize(Ze)),Ze=H(Ze,Je.key,We+1),Ze!==void 0){fe(Ze);return}}fe()},function(Fe,Se){xe(Se)})})}).catch(xe)});return F(le,oe),le}function It(H,oe,$,le){var fe=this;H=I(H);var xe=new D(function(Ce,we){fe.ready().then(function(){oe===void 0&&(oe=null);var Fe=oe,Se=fe._dbInfo;Se.serializer.serialize(oe,function(Oe,Me){Me?we(Me):Se.db.transaction(function(We){ft(We,Se,"INSERT OR REPLACE INTO "+Se.storeName+" (key, value) VALUES (?, ?)",[H,Oe],function(){Ce(Fe)},function(Je,Ze){we(Ze)})},function(We){if(We.code===We.QUOTA_ERR){if(le>0){Ce(It.apply(fe,[H,Fe,$,le-1]));return}we(We)}})})}).catch(we)});return F(xe,$),xe}function yr(H,oe,$){return It.apply(this,[H,oe,$,1])}function rr(H,oe){var $=this;H=I(H);var le=new D(function(fe,xe){$.ready().then(function(){var Ce=$._dbInfo;Ce.db.transaction(function(we){ft(we,Ce,"DELETE FROM "+Ce.storeName+" WHERE key = ?",[H],function(){fe()},function(Fe,Se){xe(Se)})})}).catch(xe)});return F(le,oe),le}function Yt(H){var oe=this,$=new D(function(le,fe){oe.ready().then(function(){var xe=oe._dbInfo;xe.db.transaction(function(Ce){ft(Ce,xe,"DELETE FROM "+xe.storeName,[],function(){le()},function(we,Fe){fe(Fe)})})}).catch(fe)});return F($,H),$}function zr(H){var oe=this,$=new D(function(le,fe){oe.ready().then(function(){var xe=oe._dbInfo;xe.db.transaction(function(Ce){ft(Ce,xe,"SELECT COUNT(key) as c FROM "+xe.storeName,[],function(we,Fe){var Se=Fe.rows.item(0).c;le(Se)},function(we,Fe){fe(Fe)})})}).catch(fe)});return F($,H),$}function hr(H,oe){var $=this,le=new D(function(fe,xe){$.ready().then(function(){var Ce=$._dbInfo;Ce.db.transaction(function(we){ft(we,Ce,"SELECT key FROM "+Ce.storeName+" WHERE id = ? LIMIT 1",[H+1],function(Fe,Se){var Oe=Se.rows.length?Se.rows.item(0).key:null;fe(Oe)},function(Fe,Se){xe(Se)})})}).catch(xe)});return F(le,oe),le}function zt(H){var oe=this,$=new D(function(le,fe){oe.ready().then(function(){var xe=oe._dbInfo;xe.db.transaction(function(Ce){ft(Ce,xe,"SELECT key FROM "+xe.storeName,[],function(we,Fe){for(var Se=[],Oe=0;Oe<Fe.rows.length;Oe++)Se.push(Fe.rows.item(Oe).key);le(Se)},function(we,Fe){fe(Fe)})})}).catch(fe)});return F($,H),$}function ia(H){return new D(function(oe,$){H.transaction(function(le){le.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(fe,xe){for(var Ce=[],we=0;we<xe.rows.length;we++)Ce.push(xe.rows.item(we).name);oe({db:H,storeNames:Ce})},function(fe,xe){$(xe)})},function(le){$(le)})})}function na(H,oe){oe=k.apply(this,arguments);var $=this.config();H=typeof H!="function"&&H||{},H.name||(H.name=H.name||$.name,H.storeName=H.storeName||$.storeName);var le=this,fe;return H.name?fe=new D(function(xe){var Ce;H.name===$.name?Ce=le._dbInfo.db:Ce=openDatabase(H.name,"","",0),H.storeName?xe({db:Ce,storeNames:[H.storeName]}):xe(ia(Ce))}).then(function(xe){return new D(function(Ce,we){xe.db.transaction(function(Fe){function Se(Je){return new D(function(Ze,Et){Fe.executeSql("DROP TABLE IF EXISTS "+Je,[],function(){Ze()},function(ht,$t){Et($t)})})}for(var Oe=[],Me=0,We=xe.storeNames.length;Me<We;Me++)Oe.push(Se(xe.storeNames[Me]));D.all(Oe).then(function(){Ce()}).catch(function(Je){we(Je)})},function(Fe){we(Fe)})})}):fe=D.reject("Invalid arguments"),F(fe,oe),fe}var oa={_driver:"webSQLStorage",_initStorage:rt,_support:P(),iterate:St,getItem:Lt,setItem:yr,removeItem:rr,clear:Yt,length:zr,key:hr,keys:zt,dropInstance:na};function aa(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Xn(H,oe){var $=H.name+"/";return H.storeName!==oe.storeName&&($+=H.storeName+"/"),$}function sa(){var H="_localforage_support_test";try{return localStorage.setItem(H,!0),localStorage.removeItem(H),!1}catch{return!0}}function xa(){return!sa()||localStorage.length>0}function la(H){var oe=this,$={};if(H)for(var le in H)$[le]=H[le];return $.keyPrefix=Xn(H,oe._defaultConfig),xa()?(oe._dbInfo=$,$.serializer=Ft,D.resolve()):D.reject()}function ha(H){var oe=this,$=oe.ready().then(function(){for(var le=oe._dbInfo.keyPrefix,fe=localStorage.length-1;fe>=0;fe--){var xe=localStorage.key(fe);xe.indexOf(le)===0&&localStorage.removeItem(xe)}});return F($,H),$}function ca(H,oe){var $=this;H=I(H);var le=$.ready().then(function(){var fe=$._dbInfo,xe=localStorage.getItem(fe.keyPrefix+H);return xe&&(xe=fe.serializer.deserialize(xe)),xe});return F(le,oe),le}function ua(H,oe){var $=this,le=$.ready().then(function(){for(var fe=$._dbInfo,xe=fe.keyPrefix,Ce=xe.length,we=localStorage.length,Fe=1,Se=0;Se<we;Se++){var Oe=localStorage.key(Se);if(Oe.indexOf(xe)===0){var Me=localStorage.getItem(Oe);if(Me&&(Me=fe.serializer.deserialize(Me)),Me=H(Me,Oe.substring(Ce),Fe++),Me!==void 0)return Me}}});return F(le,oe),le}function fa(H,oe){var $=this,le=$.ready().then(function(){var fe=$._dbInfo,xe;try{xe=localStorage.key(H)}catch{xe=null}return xe&&(xe=xe.substring(fe.keyPrefix.length)),xe});return F(le,oe),le}function Ea(H){var oe=this,$=oe.ready().then(function(){for(var le=oe._dbInfo,fe=localStorage.length,xe=[],Ce=0;Ce<fe;Ce++){var we=localStorage.key(Ce);we.indexOf(le.keyPrefix)===0&&xe.push(we.substring(le.keyPrefix.length))}return xe});return F($,H),$}function da(H){var oe=this,$=oe.keys().then(function(le){return le.length});return F($,H),$}function ga(H,oe){var $=this;H=I(H);var le=$.ready().then(function(){var fe=$._dbInfo;localStorage.removeItem(fe.keyPrefix+H)});return F(le,oe),le}function Aa(H,oe,$){var le=this;H=I(H);var fe=le.ready().then(function(){oe===void 0&&(oe=null);var xe=oe;return new D(function(Ce,we){var Fe=le._dbInfo;Fe.serializer.serialize(oe,function(Se,Oe){if(Oe)we(Oe);else try{localStorage.setItem(Fe.keyPrefix+H,Se),Ce(xe)}catch(Me){(Me.name==="QuotaExceededError"||Me.name==="NS_ERROR_DOM_QUOTA_REACHED")&&we(Me),we(Me)}})})});return F(fe,$),fe}function pa(H,oe){if(oe=k.apply(this,arguments),H=typeof H!="function"&&H||{},!H.name){var $=this.config();H.name=H.name||$.name,H.storeName=H.storeName||$.storeName}var le=this,fe;return H.name?fe=new D(function(xe){H.storeName?xe(Xn(H,le._defaultConfig)):xe(H.name+"/")}).then(function(xe){for(var Ce=localStorage.length-1;Ce>=0;Ce--){var we=localStorage.key(Ce);we.indexOf(xe)===0&&localStorage.removeItem(we)}}):fe=D.reject("Invalid arguments"),F(fe,oe),fe}var Ba={_driver:"localStorageWrapper",_initStorage:la,_support:aa(),iterate:ua,getItem:ca,setItem:Aa,removeItem:ga,clear:ha,length:da,key:fa,keys:Ea,dropInstance:pa},va=function(oe,$){return oe===$||typeof oe=="number"&&typeof $=="number"&&isNaN(oe)&&isNaN($)},_a=function(oe,$){for(var le=oe.length,fe=0;fe<le;){if(va(oe[fe],$))return!0;fe++}return!1},Yn=Array.isArray||function(H){return Object.prototype.toString.call(H)==="[object Array]"},Kr={},zn={},Lr={INDEXEDDB:W,WEBSQL:oa,LOCALSTORAGE:Ba},Ca=[Lr.INDEXEDDB._driver,Lr.WEBSQL._driver,Lr.LOCALSTORAGE._driver],di=["dropInstance"],Zi=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(di),ma={description:"",driver:Ca.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ya(H,oe){H[oe]=function(){var $=arguments;return H.ready().then(function(){return H[oe].apply(H,$)})}}function Qi(){for(var H=1;H<arguments.length;H++){var oe=arguments[H];if(oe)for(var $ in oe)oe.hasOwnProperty($)&&(Yn(oe[$])?arguments[0][$]=oe[$].slice():arguments[0][$]=oe[$])}return arguments[0]}var Da=function(){function H(oe){u(this,H);for(var $ in Lr)if(Lr.hasOwnProperty($)){var le=Lr[$],fe=le._driver;this[$]=fe,Kr[fe]||this.defineDriver(le)}this._defaultConfig=Qi({},ma),this._config=Qi({},this._defaultConfig,oe),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return H.prototype.config=function($){if((typeof $=="undefined"?"undefined":s($))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var le in $){if(le==="storeName"&&($[le]=$[le].replace(/\W/g,"_")),le==="version"&&typeof $[le]!="number")return new Error("Database version must be a number.");this._config[le]=$[le]}return"driver"in $&&$.driver?this.setDriver(this._config.driver):!0}else return typeof $=="string"?this._config[$]:this._config},H.prototype.defineDriver=function($,le,fe){var xe=new D(function(Ce,we){try{var Fe=$._driver,Se=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!$._driver){we(Se);return}for(var Oe=Zi.concat("_initStorage"),Me=0,We=Oe.length;Me<We;Me++){var Je=Oe[Me],Ze=!_a(di,Je);if((Ze||$[Je])&&typeof $[Je]!="function"){we(Se);return}}var Et=function(){for(var Jr=function(Sa){return function(){var ba=new Error("Method "+Sa+" is not implemented by the current driver"),Kn=D.reject(ba);return F(Kn,arguments[arguments.length-1]),Kn}},$i=0,Fa=di.length;$i<Fa;$i++){var en=di[$i];$[en]||($[en]=Jr(en))}};Et();var ht=function(Jr){Kr[Fe]&&console.info("Redefining LocalForage driver: "+Fe),Kr[Fe]=$,zn[Fe]=Jr,Ce()};"_support"in $?$._support&&typeof $._support=="function"?$._support().then(ht,we):ht(!!$._support):ht(!0)}catch($t){we($t)}});return T(xe,le,fe),xe},H.prototype.driver=function(){return this._driver||null},H.prototype.getDriver=function($,le,fe){var xe=Kr[$]?D.resolve(Kr[$]):D.reject(new Error("Driver not found."));return T(xe,le,fe),xe},H.prototype.getSerializer=function($){var le=D.resolve(Ft);return T(le,$),le},H.prototype.ready=function($){var le=this,fe=le._driverSet.then(function(){return le._ready===null&&(le._ready=le._initDriver()),le._ready});return T(fe,$,$),fe},H.prototype.setDriver=function($,le,fe){var xe=this;Yn($)||($=[$]);var Ce=this._getSupportedDrivers($);function we(){xe._config.driver=xe.driver()}function Fe(Me){return xe._extend(Me),we(),xe._ready=xe._initStorage(xe._config),xe._ready}function Se(Me){return function(){var We=0;function Je(){for(;We<Me.length;){var Ze=Me[We];return We++,xe._dbInfo=null,xe._ready=null,xe.getDriver(Ze).then(Fe).catch(Je)}we();var Et=new Error("No available storage method found.");return xe._driverSet=D.reject(Et),xe._driverSet}return Je()}}var Oe=this._driverSet!==null?this._driverSet.catch(function(){return D.resolve()}):D.resolve();return this._driverSet=Oe.then(function(){var Me=Ce[0];return xe._dbInfo=null,xe._ready=null,xe.getDriver(Me).then(function(We){xe._driver=We._driver,we(),xe._wrapLibraryMethodsWithReady(),xe._initDriver=Se(Ce)})}).catch(function(){we();var Me=new Error("No available storage method found.");return xe._driverSet=D.reject(Me),xe._driverSet}),T(this._driverSet,le,fe),this._driverSet},H.prototype.supports=function($){return!!zn[$]},H.prototype._extend=function($){Qi(this,$)},H.prototype._getSupportedDrivers=function($){for(var le=[],fe=0,xe=$.length;fe<xe;fe++){var Ce=$[fe];this.supports(Ce)&&le.push(Ce)}return le},H.prototype._wrapLibraryMethodsWithReady=function(){for(var $=0,le=Zi.length;$<le;$++)ya(this,Zi[$])},H.prototype.createInstance=function($){return new H($)},H}(),wa=new Da;i.exports=wa},{3:3}]},{},[4])(4)})})(B0);var vr=B0.exports;/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */function Ra(r,e,t,i){r.prototype._pos=[0,0,0],r.prototype._orientation=[0,0,-1,0,1,0],r.prototype.stereo=function(s){var u=this;if(!u.ctx||!u.ctx.listener)return u;for(var g=u._howls.length-1;g>=0;g--)u._howls[g].stereo(s);return u},r.prototype.pos=function(s,u,g){var B=this;if(!B.ctx||!B.ctx.listener)return B;if(u=typeof u!="number"?B._pos[1]:u,g=typeof g!="number"?B._pos[2]:g,typeof s=="number")B._pos=[s,u,g],typeof B.ctx.listener.positionX!="undefined"?(B.ctx.listener.positionX.setTargetAtTime(B._pos[0],e.ctx.currentTime,.1),B.ctx.listener.positionY.setTargetAtTime(B._pos[1],e.ctx.currentTime,.1),B.ctx.listener.positionZ.setTargetAtTime(B._pos[2],e.ctx.currentTime,.1)):B.ctx.listener.setPosition(B._pos[0],B._pos[1],B._pos[2]);else return B._pos;return B},r.prototype.orientation=function(s,u,g,B,_,m){var D=this;if(!D.ctx||!D.ctx.listener)return D;var F=D._orientation;if(u=typeof u!="number"?F[1]:u,g=typeof g!="number"?F[2]:g,B=typeof B!="number"?F[3]:B,_=typeof _!="number"?F[4]:_,m=typeof m!="number"?F[5]:m,typeof s=="number")D._orientation=[s,u,g,B,_,m],typeof D.ctx.listener.forwardX!="undefined"?(D.ctx.listener.forwardX.setTargetAtTime(s,e.ctx.currentTime,.1),D.ctx.listener.forwardY.setTargetAtTime(u,e.ctx.currentTime,.1),D.ctx.listener.forwardZ.setTargetAtTime(g,e.ctx.currentTime,.1),D.ctx.listener.upX.setTargetAtTime(B,e.ctx.currentTime,.1),D.ctx.listener.upY.setTargetAtTime(_,e.ctx.currentTime,.1),D.ctx.listener.upZ.setTargetAtTime(m,e.ctx.currentTime,.1)):D.ctx.listener.setOrientation(s,u,g,B,_,m);else return F;return D},t.prototype.init=function(s){return function(u){var g=this;return g._orientation=u.orientation||[1,0,0],g._stereo=u.stereo||null,g._pos=u.pos||null,g._pannerAttr={coneInnerAngle:typeof u.coneInnerAngle!="undefined"?u.coneInnerAngle:360,coneOuterAngle:typeof u.coneOuterAngle!="undefined"?u.coneOuterAngle:360,coneOuterGain:typeof u.coneOuterGain!="undefined"?u.coneOuterGain:0,distanceModel:typeof u.distanceModel!="undefined"?u.distanceModel:"inverse",maxDistance:typeof u.maxDistance!="undefined"?u.maxDistance:1e4,panningModel:typeof u.panningModel!="undefined"?u.panningModel:"HRTF",refDistance:typeof u.refDistance!="undefined"?u.refDistance:1,rolloffFactor:typeof u.rolloffFactor!="undefined"?u.rolloffFactor:1},g._onstereo=u.onstereo?[{fn:u.onstereo}]:[],g._onpos=u.onpos?[{fn:u.onpos}]:[],g._onorientation=u.onorientation?[{fn:u.onorientation}]:[],s.call(this,u)}}(t.prototype.init),t.prototype.stereo=function(s,u){var g=this;if(!g._webAudio)return g;if(g._state!=="loaded")return g._queue.push({event:"stereo",action:function(){g.stereo(s,u)}}),g;var B=typeof e.ctx.createStereoPanner=="undefined"?"spatial":"stereo";if(typeof u=="undefined")if(typeof s=="number")g._stereo=s,g._pos=[s,0,0];else return g._stereo;for(var _=g._getSoundIds(u),m=0;m<_.length;m++){var D=g._soundById(_[m]);if(D)if(typeof s=="number")D._stereo=s,D._pos=[s,0,0],D._node&&(D._pannerAttr.panningModel="equalpower",(!D._panner||!D._panner.pan)&&o(D,B),B==="spatial"?typeof D._panner.positionX!="undefined"?(D._panner.positionX.setValueAtTime(s,e.ctx.currentTime),D._panner.positionY.setValueAtTime(0,e.ctx.currentTime),D._panner.positionZ.setValueAtTime(0,e.ctx.currentTime)):D._panner.setPosition(s,0,0):D._panner.pan.setValueAtTime(s,e.ctx.currentTime)),g._emit("stereo",D._id);else return D._stereo}return g},t.prototype.pos=function(s,u,g,B){var _=this;if(!_._webAudio)return _;if(_._state!=="loaded")return _._queue.push({event:"pos",action:function(){_.pos(s,u,g,B)}}),_;if(u=typeof u!="number"?0:u,g=typeof g!="number"?-.5:g,typeof B=="undefined")if(typeof s=="number")_._pos=[s,u,g];else return _._pos;for(var m=_._getSoundIds(B),D=0;D<m.length;D++){var F=_._soundById(m[D]);if(F)if(typeof s=="number")F._pos=[s,u,g],F._node&&((!F._panner||F._panner.pan)&&o(F,"spatial"),typeof F._panner.positionX!="undefined"?(F._panner.positionX.setValueAtTime(s,e.ctx.currentTime),F._panner.positionY.setValueAtTime(u,e.ctx.currentTime),F._panner.positionZ.setValueAtTime(g,e.ctx.currentTime)):F._panner.setPosition(s,u,g)),_._emit("pos",F._id);else return F._pos}return _},t.prototype.orientation=function(s,u,g,B){var _=this;if(!_._webAudio)return _;if(_._state!=="loaded")return _._queue.push({event:"orientation",action:function(){_.orientation(s,u,g,B)}}),_;if(u=typeof u!="number"?_._orientation[1]:u,g=typeof g!="number"?_._orientation[2]:g,typeof B=="undefined")if(typeof s=="number")_._orientation=[s,u,g];else return _._orientation;for(var m=_._getSoundIds(B),D=0;D<m.length;D++){var F=_._soundById(m[D]);if(F)if(typeof s=="number")F._orientation=[s,u,g],F._node&&(F._panner||(F._pos||(F._pos=_._pos||[0,0,-.5]),o(F,"spatial")),typeof F._panner.orientationX!="undefined"?(F._panner.orientationX.setValueAtTime(s,e.ctx.currentTime),F._panner.orientationY.setValueAtTime(u,e.ctx.currentTime),F._panner.orientationZ.setValueAtTime(g,e.ctx.currentTime)):F._panner.setOrientation(s,u,g)),_._emit("orientation",F._id);else return F._orientation}return _},t.prototype.pannerAttr=function(){var s=this,u=arguments,g,B,_;if(!s._webAudio)return s;if(u.length===0)return s._pannerAttr;if(u.length===1)if(typeof u[0]=="object")g=u[0],typeof B=="undefined"&&(g.pannerAttr||(g.pannerAttr={coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor,panningModel:g.panningModel}),s._pannerAttr={coneInnerAngle:typeof g.pannerAttr.coneInnerAngle!="undefined"?g.pannerAttr.coneInnerAngle:s._coneInnerAngle,coneOuterAngle:typeof g.pannerAttr.coneOuterAngle!="undefined"?g.pannerAttr.coneOuterAngle:s._coneOuterAngle,coneOuterGain:typeof g.pannerAttr.coneOuterGain!="undefined"?g.pannerAttr.coneOuterGain:s._coneOuterGain,distanceModel:typeof g.pannerAttr.distanceModel!="undefined"?g.pannerAttr.distanceModel:s._distanceModel,maxDistance:typeof g.pannerAttr.maxDistance!="undefined"?g.pannerAttr.maxDistance:s._maxDistance,refDistance:typeof g.pannerAttr.refDistance!="undefined"?g.pannerAttr.refDistance:s._refDistance,rolloffFactor:typeof g.pannerAttr.rolloffFactor!="undefined"?g.pannerAttr.rolloffFactor:s._rolloffFactor,panningModel:typeof g.pannerAttr.panningModel!="undefined"?g.pannerAttr.panningModel:s._panningModel});else return _=s._soundById(parseInt(u[0],10)),_?_._pannerAttr:s._pannerAttr;else u.length===2&&(g=u[0],B=parseInt(u[1],10));for(var m=s._getSoundIds(B),D=0;D<m.length;D++)if(_=s._soundById(m[D]),_){var F=_._pannerAttr;F={coneInnerAngle:typeof g.coneInnerAngle!="undefined"?g.coneInnerAngle:F.coneInnerAngle,coneOuterAngle:typeof g.coneOuterAngle!="undefined"?g.coneOuterAngle:F.coneOuterAngle,coneOuterGain:typeof g.coneOuterGain!="undefined"?g.coneOuterGain:F.coneOuterGain,distanceModel:typeof g.distanceModel!="undefined"?g.distanceModel:F.distanceModel,maxDistance:typeof g.maxDistance!="undefined"?g.maxDistance:F.maxDistance,refDistance:typeof g.refDistance!="undefined"?g.refDistance:F.refDistance,rolloffFactor:typeof g.rolloffFactor!="undefined"?g.rolloffFactor:F.rolloffFactor,panningModel:typeof g.panningModel!="undefined"?g.panningModel:F.panningModel};var T=_._panner;T||(_._pos||(_._pos=s._pos||[0,0,-.5]),o(_,"spatial"),T=_._panner),T.coneInnerAngle=F.coneInnerAngle,T.coneOuterAngle=F.coneOuterAngle,T.coneOuterGain=F.coneOuterGain,T.distanceModel=F.distanceModel,T.maxDistance=F.maxDistance,T.refDistance=F.refDistance,T.rolloffFactor=F.rolloffFactor,T.panningModel=F.panningModel}return s},i.prototype.init=function(s){return function(){var u=this,g=u._parent;u._orientation=g._orientation,u._stereo=g._stereo,u._pos=g._pos,u._pannerAttr=g._pannerAttr,s.call(this),u._stereo?g.stereo(u._stereo):u._pos&&g.pos(u._pos[0],u._pos[1],u._pos[2],u._id)}}(i.prototype.init),i.prototype.reset=function(s){return function(){var u=this,g=u._parent;return u._orientation=g._orientation,u._stereo=g._stereo,u._pos=g._pos,u._pannerAttr=g._pannerAttr,u._stereo?g.stereo(u._stereo):u._pos?g.pos(u._pos[0],u._pos[1],u._pos[2],u._id):u._panner&&(u._panner.disconnect(0),u._panner=void 0,g._refreshBuffer(u)),s.call(this)}}(i.prototype.reset);var o=function(s,u){u=u||"spatial",u==="spatial"?(s._panner=e.ctx.createPanner(),s._panner.coneInnerAngle=s._pannerAttr.coneInnerAngle,s._panner.coneOuterAngle=s._pannerAttr.coneOuterAngle,s._panner.coneOuterGain=s._pannerAttr.coneOuterGain,s._panner.distanceModel=s._pannerAttr.distanceModel,s._panner.maxDistance=s._pannerAttr.maxDistance,s._panner.refDistance=s._pannerAttr.refDistance,s._panner.rolloffFactor=s._pannerAttr.rolloffFactor,s._panner.panningModel=s._pannerAttr.panningModel,typeof s._panner.positionX!="undefined"?(s._panner.positionX.setValueAtTime(s._pos[0],e.ctx.currentTime),s._panner.positionY.setValueAtTime(s._pos[1],e.ctx.currentTime),s._panner.positionZ.setValueAtTime(s._pos[2],e.ctx.currentTime)):s._panner.setPosition(s._pos[0],s._pos[1],s._pos[2]),typeof s._panner.orientationX!="undefined"?(s._panner.orientationX.setValueAtTime(s._orientation[0],e.ctx.currentTime),s._panner.orientationY.setValueAtTime(s._orientation[1],e.ctx.currentTime),s._panner.orientationZ.setValueAtTime(s._orientation[2],e.ctx.currentTime)):s._panner.setOrientation(s._orientation[0],s._orientation[1],s._orientation[2])):(s._panner=e.ctx.createStereoPanner(),s._panner.pan.setValueAtTime(s._stereo,e.ctx.currentTime)),s._panner.connect(s._node),s._paused||s._parent.pause(s._id,!0).play(s._id,!0)}}/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var bn=function(){this.init()};bn.prototype={init:function(){var r=this||De;return r._counter=1e3,r._html5AudioPool=[],r.html5PoolSize=10,r._codecs={},r._howls=[],r._muted=!1,r._volume=1,r._canPlayEvent="canplaythrough",r._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,r.masterGain=null,r.noAudio=!1,r.usingWebAudio=!0,r.autoSuspend=!0,r.ctx=null,r.autoUnlock=!0,r._setup(),r},volume:function(r){var e=this||De;if(r=parseFloat(r),e.ctx||Fi(),typeof r!="undefined"&&r>=0&&r<=1){if(e._volume=r,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(r,De.ctx.currentTime);for(var t=0;t<e._howls.length;t++)if(!e._howls[t]._webAudio)for(var i=e._howls[t]._getSoundIds(),o=0;o<i.length;o++){var s=e._howls[t]._soundById(i[o]);s&&s._node&&(s._node.volume=s._volume*r)}return e}return e._volume},mute:function(r){var e=this||De;e.ctx||Fi(),e._muted=r,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(r?0:e._volume,De.ctx.currentTime);for(var t=0;t<e._howls.length;t++)if(!e._howls[t]._webAudio)for(var i=e._howls[t]._getSoundIds(),o=0;o<i.length;o++){var s=e._howls[t]._soundById(i[o]);s&&s._node&&(s._node.muted=r?!0:s._muted)}return e},stop:function(){for(var r=this||De,e=0;e<r._howls.length;e++)r._howls[e].stop();return r},unload:function(){for(var r=this||De,e=r._howls.length-1;e>=0;e--)r._howls[e].unload();return r.usingWebAudio&&r.ctx&&typeof r.ctx.close!="undefined"&&(r.ctx.close(),r.ctx=null,Fi()),r},codecs:function(r){return(this||De)._codecs[r.replace(/^x-/,"")]},_setup:function(){var r=this||De;if(r.state=r.ctx&&r.ctx.state||"suspended",r._autoSuspend(),!r.usingWebAudio)if(typeof Audio!="undefined")try{var e=new Audio;typeof e.oncanplaythrough=="undefined"&&(r._canPlayEvent="canplay")}catch{r.noAudio=!0}else r.noAudio=!0;try{var e=new Audio;e.muted&&(r.noAudio=!0)}catch{}return r.noAudio||r._setupCodecs(),r},_setupCodecs:function(){var r=this||De,e=null;try{e=typeof Audio!="undefined"?new Audio:null}catch{return r}if(!e||typeof e.canPlayType!="function")return r;var t=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i=r._navigator?r._navigator.userAgent:"",o=i.match(/OPR\/([0-6].)/g),s=o&&parseInt(o[0].split("/")[1],10)<33,u=i.indexOf("Safari")!==-1&&i.indexOf("Chrome")===-1,g=i.match(/Version\/(.*?) /),B=u&&g&&parseInt(g[1],10)<15;return r._codecs={mp3:!!(!s&&(t||e.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!t,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(e.canPlayType('audio/wav; codecs="1"')||e.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(e.canPlayType("audio/x-m4b;")||e.canPlayType("audio/m4b;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!B&&e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!B&&e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},r},_unlockAudio:function(){var r=this||De;if(!(r._audioUnlocked||!r.ctx)){r._audioUnlocked=!1,r.autoUnlock=!1,!r._mobileUnloaded&&r.ctx.sampleRate!==44100&&(r._mobileUnloaded=!0,r.unload()),r._scratchBuffer=r.ctx.createBuffer(1,1,22050);var e=function(t){for(;r._html5AudioPool.length<r.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,r._releaseHtml5Audio(i)}catch{r.noAudio=!0;break}for(var o=0;o<r._howls.length;o++)if(!r._howls[o]._webAudio)for(var s=r._howls[o]._getSoundIds(),u=0;u<s.length;u++){var g=r._howls[o]._soundById(s[u]);g&&g._node&&!g._node._unlocked&&(g._node._unlocked=!0,g._node.load())}r._autoResume();var B=r.ctx.createBufferSource();B.buffer=r._scratchBuffer,B.connect(r.ctx.destination),typeof B.start=="undefined"?B.noteOn(0):B.start(0),typeof r.ctx.resume=="function"&&r.ctx.resume(),B.onended=function(){B.disconnect(0),r._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0),document.removeEventListener("keydown",e,!0);for(var _=0;_<r._howls.length;_++)r._howls[_]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),document.addEventListener("keydown",e,!0),r}},_obtainHtml5Audio:function(){var r=this||De;if(r._html5AudioPool.length)return r._html5AudioPool.pop();var e=new Audio().play();return e&&typeof Promise!="undefined"&&(e instanceof Promise||typeof e.then=="function")&&e.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(r){var e=this||De;return r._unlocked&&e._html5AudioPool.push(r),e},_autoSuspend:function(){var r=this;if(!(!r.autoSuspend||!r.ctx||typeof r.ctx.suspend=="undefined"||!De.usingWebAudio)){for(var e=0;e<r._howls.length;e++)if(r._howls[e]._webAudio){for(var t=0;t<r._howls[e]._sounds.length;t++)if(!r._howls[e]._sounds[t]._paused)return r}return r._suspendTimer&&clearTimeout(r._suspendTimer),r._suspendTimer=setTimeout(function(){if(!!r.autoSuspend){r._suspendTimer=null,r.state="suspending";var i=function(){r.state="suspended",r._resumeAfterSuspend&&(delete r._resumeAfterSuspend,r._autoResume())};r.ctx.suspend().then(i,i)}},3e4),r}},_autoResume:function(){var r=this;if(!(!r.ctx||typeof r.ctx.resume=="undefined"||!De.usingWebAudio))return r.state==="running"&&r.ctx.state!=="interrupted"&&r._suspendTimer?(clearTimeout(r._suspendTimer),r._suspendTimer=null):r.state==="suspended"||r.state==="running"&&r.ctx.state==="interrupted"?(r.ctx.resume().then(function(){r.state="running";for(var e=0;e<r._howls.length;e++)r._howls[e]._emit("resume")}),r._suspendTimer&&(clearTimeout(r._suspendTimer),r._suspendTimer=null)):r.state==="suspending"&&(r._resumeAfterSuspend=!0),r}};var De=new bn,Ii=function(r){var e=this;if(!r.src||r.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}e.init(r)};Ii.prototype={init:function(r){var e=this;return De.ctx||Fi(),e._autoplay=r.autoplay||!1,e._format=typeof r.format!="string"?r.format:[r.format],e._html5=r.html5||!1,e._muted=r.mute||!1,e._loop=r.loop||!1,e._pool=r.pool||5,e._preload=typeof r.preload=="boolean"||r.preload==="metadata"?r.preload:!0,e._rate=r.rate||1,e._sprite=r.sprite||{},e._src=typeof r.src!="string"?r.src:[r.src],e._volume=r.volume!==void 0?r.volume:1,e._xhr={method:r.xhr&&r.xhr.method?r.xhr.method:"GET",headers:r.xhr&&r.xhr.headers?r.xhr.headers:null,withCredentials:r.xhr&&r.xhr.withCredentials?r.xhr.withCredentials:!1},e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=r.onend?[{fn:r.onend}]:[],e._onfade=r.onfade?[{fn:r.onfade}]:[],e._onload=r.onload?[{fn:r.onload}]:[],e._onloaderror=r.onloaderror?[{fn:r.onloaderror}]:[],e._onplayerror=r.onplayerror?[{fn:r.onplayerror}]:[],e._onpause=r.onpause?[{fn:r.onpause}]:[],e._onplay=r.onplay?[{fn:r.onplay}]:[],e._onstop=r.onstop?[{fn:r.onstop}]:[],e._onmute=r.onmute?[{fn:r.onmute}]:[],e._onvolume=r.onvolume?[{fn:r.onvolume}]:[],e._onrate=r.onrate?[{fn:r.onrate}]:[],e._onseek=r.onseek?[{fn:r.onseek}]:[],e._onunlock=r.onunlock?[{fn:r.onunlock}]:[],e._onresume=[],e._webAudio=De.usingWebAudio&&!e._html5,typeof De.ctx!="undefined"&&De.ctx&&De.autoUnlock&&De._unlockAudio(),De._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&e._preload!=="none"&&e.load(),e},load:function(){var r=this,e=null;if(De.noAudio){r._emit("loaderror",null,"No audio support.");return}typeof r._src=="string"&&(r._src=[r._src]);for(var t=0;t<r._src.length;t++){var i,o;if(r._format&&r._format[t])i=r._format[t];else{if(o=r._src[t],typeof o!="string"){r._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}i=/^data:audio\/([^;,]+);/i.exec(o),i||(i=/\.([^.]+)$/.exec(o.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&De.codecs(i)){e=r._src[t];break}}if(!e){r._emit("loaderror",null,"No codec support for selected audio sources.");return}return r._src=e,r._state="loading",window.location.protocol==="https:"&&e.slice(0,5)==="http:"&&(r._html5=!0,r._webAudio=!1),new Ri(r),r._webAudio&&Pa(r),r},play:function(r,e){var t=this,i=null;if(typeof r=="number")i=r,r=null;else{if(typeof r=="string"&&t._state==="loaded"&&!t._sprite[r])return null;if(typeof r=="undefined"&&(r="__default",!t._playLock)){for(var o=0,s=0;s<t._sounds.length;s++)t._sounds[s]._paused&&!t._sounds[s]._ended&&(o++,i=t._sounds[s]._id);o===1?r=null:i=null}}var u=i?t._soundById(i):t._inactiveSound();if(!u)return null;if(i&&!r&&(r=u._sprite||"__default"),t._state!=="loaded"){u._sprite=r,u._ended=!1;var g=u._id;return t._queue.push({event:"play",action:function(){t.play(g)}}),g}if(i&&!u._paused)return e||t._loadQueue("play"),u._id;t._webAudio&&De._autoResume();var B=Math.max(0,u._seek>0?u._seek:t._sprite[r][0]/1e3),_=Math.max(0,(t._sprite[r][0]+t._sprite[r][1])/1e3-B),m=_*1e3/Math.abs(u._rate),D=t._sprite[r][0]/1e3,F=(t._sprite[r][0]+t._sprite[r][1])/1e3;u._sprite=r,u._ended=!1;var T=function(){u._paused=!1,u._seek=B,u._start=D,u._stop=F,u._loop=!!(u._loop||t._sprite[r][2])};if(B>=F){t._ended(u);return}var I=u._node;if(t._webAudio){var k=function(){t._playLock=!1,T(),t._refreshBuffer(u);var te=u._muted||t._muted?0:u._volume;I.gain.setValueAtTime(te,De.ctx.currentTime),u._playStart=De.ctx.currentTime,typeof I.bufferSource.start=="undefined"?u._loop?I.bufferSource.noteGrainOn(0,B,86400):I.bufferSource.noteGrainOn(0,B,_):u._loop?I.bufferSource.start(0,B,86400):I.bufferSource.start(0,B,_),m!==1/0&&(t._endTimers[u._id]=setTimeout(t._ended.bind(t,u),m)),e||setTimeout(function(){t._emit("play",u._id),t._loadQueue()},0)};De.state==="running"&&De.ctx.state!=="interrupted"?k():(t._playLock=!0,t.once("resume",k),t._clearTimer(u._id))}else{var U=function(){I.currentTime=B,I.muted=u._muted||t._muted||De._muted||I.muted,I.volume=u._volume*De.volume(),I.playbackRate=u._rate;try{var te=I.play();if(te&&typeof Promise!="undefined"&&(te instanceof Promise||typeof te.then=="function")?(t._playLock=!0,T(),te.then(function(){t._playLock=!1,I._unlocked=!0,e?t._loadQueue():t._emit("play",u._id)}).catch(function(){t._playLock=!1,t._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),u._ended=!0,u._paused=!0})):e||(t._playLock=!1,T(),t._emit("play",u._id)),I.playbackRate=u._rate,I.paused){t._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}r!=="__default"||u._loop?t._endTimers[u._id]=setTimeout(t._ended.bind(t,u),m):(t._endTimers[u._id]=function(){t._ended(u),I.removeEventListener("ended",t._endTimers[u._id],!1)},I.addEventListener("ended",t._endTimers[u._id],!1))}catch(ne){t._emit("playerror",u._id,ne)}};I.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(I.src=t._src,I.load());var K=window&&window.ejecta||!I.readyState&&De._navigator.isCocoonJS;if(I.readyState>=3||K)U();else{t._playLock=!0,t._state="loading";var X=function(){t._state="loaded",U(),I.removeEventListener(De._canPlayEvent,X,!1)};I.addEventListener(De._canPlayEvent,X,!1),t._clearTimer(u._id)}}return u._id},pause:function(r){var e=this;if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(r)}}),e;for(var t=e._getSoundIds(r),i=0;i<t.length;i++){e._clearTimer(t[i]);var o=e._soundById(t[i]);if(o&&!o._paused&&(o._seek=e.seek(t[i]),o._rateSeek=0,o._paused=!0,e._stopFade(t[i]),o._node))if(e._webAudio){if(!o._node.bufferSource)continue;typeof o._node.bufferSource.stop=="undefined"?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),e._cleanBuffer(o._node)}else(!isNaN(o._node.duration)||o._node.duration===1/0)&&o._node.pause();arguments[1]||e._emit("pause",o?o._id:null)}return e},stop:function(r,e){var t=this;if(t._state!=="loaded"||t._playLock)return t._queue.push({event:"stop",action:function(){t.stop(r)}}),t;for(var i=t._getSoundIds(r),o=0;o<i.length;o++){t._clearTimer(i[o]);var s=t._soundById(i[o]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,t._stopFade(i[o]),s._node&&(t._webAudio?s._node.bufferSource&&(typeof s._node.bufferSource.stop=="undefined"?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),t._cleanBuffer(s._node)):(!isNaN(s._node.duration)||s._node.duration===1/0)&&(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&t._clearSound(s._node))),e||t._emit("stop",s._id))}return t},mute:function(r,e){var t=this;if(t._state!=="loaded"||t._playLock)return t._queue.push({event:"mute",action:function(){t.mute(r,e)}}),t;if(typeof e=="undefined")if(typeof r=="boolean")t._muted=r;else return t._muted;for(var i=t._getSoundIds(e),o=0;o<i.length;o++){var s=t._soundById(i[o]);s&&(s._muted=r,s._interval&&t._stopFade(s._id),t._webAudio&&s._node?s._node.gain.setValueAtTime(r?0:s._volume,De.ctx.currentTime):s._node&&(s._node.muted=De._muted?!0:r),t._emit("mute",s._id))}return t},volume:function(){var r=this,e=arguments,t,i;if(e.length===0)return r._volume;if(e.length===1||e.length===2&&typeof e[1]=="undefined"){var o=r._getSoundIds(),s=o.indexOf(e[0]);s>=0?i=parseInt(e[0],10):t=parseFloat(e[0])}else e.length>=2&&(t=parseFloat(e[0]),i=parseInt(e[1],10));var u;if(typeof t!="undefined"&&t>=0&&t<=1){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,e)}}),r;typeof i=="undefined"&&(r._volume=t),i=r._getSoundIds(i);for(var g=0;g<i.length;g++)u=r._soundById(i[g]),u&&(u._volume=t,e[2]||r._stopFade(i[g]),r._webAudio&&u._node&&!u._muted?u._node.gain.setValueAtTime(t,De.ctx.currentTime):u._node&&!u._muted&&(u._node.volume=t*De.volume()),r._emit("volume",u._id))}else return u=i?r._soundById(i):r._sounds[0],u?u._volume:0;return r},fade:function(r,e,t,i){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(r,e,t,i)}}),o;r=Math.min(Math.max(0,parseFloat(r)),1),e=Math.min(Math.max(0,parseFloat(e)),1),t=parseFloat(t),o.volume(r,i);for(var s=o._getSoundIds(i),u=0;u<s.length;u++){var g=o._soundById(s[u]);if(g){if(i||o._stopFade(s[u]),o._webAudio&&!g._muted){var B=De.ctx.currentTime,_=B+t/1e3;g._volume=r,g._node.gain.setValueAtTime(r,B),g._node.gain.linearRampToValueAtTime(e,_)}o._startFadeInterval(g,r,e,t,s[u],typeof i=="undefined")}}return o},_startFadeInterval:function(r,e,t,i,o,s){var u=this,g=e,B=t-e,_=Math.abs(B/.01),m=Math.max(4,_>0?i/_:i),D=Date.now();r._fadeTo=t,r._interval=setInterval(function(){var F=(Date.now()-D)/i;D=Date.now(),g+=B*F,g=Math.round(g*100)/100,B<0?g=Math.max(t,g):g=Math.min(t,g),u._webAudio?r._volume=g:u.volume(g,r._id,!0),s&&(u._volume=g),(t<e&&g<=t||t>e&&g>=t)&&(clearInterval(r._interval),r._interval=null,r._fadeTo=null,u.volume(t,r._id),u._emit("fade",r._id))},m)},_stopFade:function(r){var e=this,t=e._soundById(r);return t&&t._interval&&(e._webAudio&&t._node.gain.cancelScheduledValues(De.ctx.currentTime),clearInterval(t._interval),t._interval=null,e.volume(t._fadeTo,r),t._fadeTo=null,e._emit("fade",r)),e},loop:function(){var r=this,e=arguments,t,i,o;if(e.length===0)return r._loop;if(e.length===1)if(typeof e[0]=="boolean")t=e[0],r._loop=t;else return o=r._soundById(parseInt(e[0],10)),o?o._loop:!1;else e.length===2&&(t=e[0],i=parseInt(e[1],10));for(var s=r._getSoundIds(i),u=0;u<s.length;u++)o=r._soundById(s[u]),o&&(o._loop=t,r._webAudio&&o._node&&o._node.bufferSource&&(o._node.bufferSource.loop=t,t&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop,r.playing(s[u])&&(r.pause(s[u],!0),r.play(s[u],!0)))));return r},rate:function(){var r=this,e=arguments,t,i;if(e.length===0)i=r._sounds[0]._id;else if(e.length===1){var o=r._getSoundIds(),s=o.indexOf(e[0]);s>=0?i=parseInt(e[0],10):t=parseFloat(e[0])}else e.length===2&&(t=parseFloat(e[0]),i=parseInt(e[1],10));var u;if(typeof t=="number"){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,e)}}),r;typeof i=="undefined"&&(r._rate=t),i=r._getSoundIds(i);for(var g=0;g<i.length;g++)if(u=r._soundById(i[g]),u){r.playing(i[g])&&(u._rateSeek=r.seek(i[g]),u._playStart=r._webAudio?De.ctx.currentTime:u._playStart),u._rate=t,r._webAudio&&u._node&&u._node.bufferSource?u._node.bufferSource.playbackRate.setValueAtTime(t,De.ctx.currentTime):u._node&&(u._node.playbackRate=t);var B=r.seek(i[g]),_=(r._sprite[u._sprite][0]+r._sprite[u._sprite][1])/1e3-B,m=_*1e3/Math.abs(u._rate);(r._endTimers[i[g]]||!u._paused)&&(r._clearTimer(i[g]),r._endTimers[i[g]]=setTimeout(r._ended.bind(r,u),m)),r._emit("rate",u._id)}}else return u=r._soundById(i),u?u._rate:r._rate;return r},seek:function(){var r=this,e=arguments,t,i;if(e.length===0)r._sounds.length&&(i=r._sounds[0]._id);else if(e.length===1){var o=r._getSoundIds(),s=o.indexOf(e[0]);s>=0?i=parseInt(e[0],10):r._sounds.length&&(i=r._sounds[0]._id,t=parseFloat(e[0]))}else e.length===2&&(t=parseFloat(e[0]),i=parseInt(e[1],10));if(typeof i=="undefined")return 0;if(typeof t=="number"&&(r._state!=="loaded"||r._playLock))return r._queue.push({event:"seek",action:function(){r.seek.apply(r,e)}}),r;var u=r._soundById(i);if(u)if(typeof t=="number"&&t>=0){var g=r.playing(i);g&&r.pause(i,!0),u._seek=t,u._ended=!1,r._clearTimer(i),!r._webAudio&&u._node&&!isNaN(u._node.duration)&&(u._node.currentTime=t);var B=function(){g&&r.play(i,!0),r._emit("seek",i)};if(g&&!r._webAudio){var _=function(){r._playLock?setTimeout(_,0):B()};setTimeout(_,0)}else B()}else if(r._webAudio){var m=r.playing(i)?De.ctx.currentTime-u._playStart:0,D=u._rateSeek?u._rateSeek-u._seek:0;return u._seek+(D+m*Math.abs(u._rate))}else return u._node.currentTime;return r},playing:function(r){var e=this;if(typeof r=="number"){var t=e._soundById(r);return t?!t._paused:!1}for(var i=0;i<e._sounds.length;i++)if(!e._sounds[i]._paused)return!0;return!1},duration:function(r){var e=this,t=e._duration,i=e._soundById(r);return i&&(t=e._sprite[i._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var r=this,e=r._sounds,t=0;t<e.length;t++)e[t]._paused||r.stop(e[t]._id),r._webAudio||(r._clearSound(e[t]._node),e[t]._node.removeEventListener("error",e[t]._errorFn,!1),e[t]._node.removeEventListener(De._canPlayEvent,e[t]._loadFn,!1),e[t]._node.removeEventListener("ended",e[t]._endFn,!1),De._releaseHtml5Audio(e[t]._node)),delete e[t]._node,r._clearTimer(e[t]._id);var i=De._howls.indexOf(r);i>=0&&De._howls.splice(i,1);var o=!0;for(t=0;t<De._howls.length;t++)if(De._howls[t]._src===r._src||r._src.indexOf(De._howls[t]._src)>=0){o=!1;break}return Ir&&o&&delete Ir[r._src],De.noAudio=!1,r._state="unloaded",r._sounds=[],r=null,null},on:function(r,e,t,i){var o=this,s=o["_on"+r];return typeof e=="function"&&s.push(i?{id:t,fn:e,once:i}:{id:t,fn:e}),o},off:function(r,e,t){var i=this,o=i["_on"+r],s=0;if(typeof e=="number"&&(t=e,e=null),e||t)for(s=0;s<o.length;s++){var u=t===o[s].id;if(e===o[s].fn&&u||!e&&u){o.splice(s,1);break}}else if(r)i["_on"+r]=[];else{var g=Object.keys(i);for(s=0;s<g.length;s++)g[s].indexOf("_on")===0&&Array.isArray(i[g[s]])&&(i[g[s]]=[])}return i},once:function(r,e,t){var i=this;return i.on(r,e,t,1),i},_emit:function(r,e,t){for(var i=this,o=i["_on"+r],s=o.length-1;s>=0;s--)(!o[s].id||o[s].id===e||r==="load")&&(setTimeout(function(u){u.call(this,e,t)}.bind(i,o[s].fn),0),o[s].once&&i.off(r,o[s].fn,o[s].id));return i._loadQueue(r),i},_loadQueue:function(r){var e=this;if(e._queue.length>0){var t=e._queue[0];t.event===r&&(e._queue.shift(),e._loadQueue()),r||t.action()}return e},_ended:function(r){var e=this,t=r._sprite;if(!e._webAudio&&r._node&&!r._node.paused&&!r._node.ended&&r._node.currentTime<r._stop)return setTimeout(e._ended.bind(e,r),100),e;var i=!!(r._loop||e._sprite[t][2]);if(e._emit("end",r._id),!e._webAudio&&i&&e.stop(r._id,!0).play(r._id),e._webAudio&&i){e._emit("play",r._id),r._seek=r._start||0,r._rateSeek=0,r._playStart=De.ctx.currentTime;var o=(r._stop-r._start)*1e3/Math.abs(r._rate);e._endTimers[r._id]=setTimeout(e._ended.bind(e,r),o)}return e._webAudio&&!i&&(r._paused=!0,r._ended=!0,r._seek=r._start||0,r._rateSeek=0,e._clearTimer(r._id),e._cleanBuffer(r._node),De._autoSuspend()),!e._webAudio&&!i&&e.stop(r._id,!0),e},_clearTimer:function(r){var e=this;if(e._endTimers[r]){if(typeof e._endTimers[r]!="function")clearTimeout(e._endTimers[r]);else{var t=e._soundById(r);t&&t._node&&t._node.removeEventListener("ended",e._endTimers[r],!1)}delete e._endTimers[r]}return e},_soundById:function(r){for(var e=this,t=0;t<e._sounds.length;t++)if(r===e._sounds[t]._id)return e._sounds[t];return null},_inactiveSound:function(){var r=this;r._drain();for(var e=0;e<r._sounds.length;e++)if(r._sounds[e]._ended)return r._sounds[e].reset();return new Ri(r)},_drain:function(){var r=this,e=r._pool,t=0,i=0;if(!(r._sounds.length<e)){for(i=0;i<r._sounds.length;i++)r._sounds[i]._ended&&t++;for(i=r._sounds.length-1;i>=0;i--){if(t<=e)return;r._sounds[i]._ended&&(r._webAudio&&r._sounds[i]._node&&r._sounds[i]._node.disconnect(0),r._sounds.splice(i,1),t--)}}},_getSoundIds:function(r){var e=this;if(typeof r=="undefined"){for(var t=[],i=0;i<e._sounds.length;i++)t.push(e._sounds[i]._id);return t}else return[r]},_refreshBuffer:function(r){var e=this;return r._node.bufferSource=De.ctx.createBufferSource(),r._node.bufferSource.buffer=Ir[e._src],r._panner?r._node.bufferSource.connect(r._panner):r._node.bufferSource.connect(r._node),r._node.bufferSource.loop=r._loop,r._loop&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop||0),r._node.bufferSource.playbackRate.setValueAtTime(r._rate,De.ctx.currentTime),e},_cleanBuffer:function(r){var e=this,t=De._navigator&&De._navigator.vendor.indexOf("Apple")>=0;if(!r.bufferSource)return e;if(De._scratchBuffer&&r.bufferSource&&(r.bufferSource.onended=null,r.bufferSource.disconnect(0),t))try{r.bufferSource.buffer=De._scratchBuffer}catch{}return r.bufferSource=null,e},_clearSound:function(r){var e=/MSIE |Trident\//.test(De._navigator&&De._navigator.userAgent);e||(r.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var Ri=function(r){this._parent=r,this.init()};Ri.prototype={init:function(){var r=this,e=r._parent;return r._muted=e._muted,r._loop=e._loop,r._volume=e._volume,r._rate=e._rate,r._seek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++De._counter,e._sounds.push(r),r.create(),r},create:function(){var r=this,e=r._parent,t=De._muted||r._muted||r._parent._muted?0:r._volume;return e._webAudio?(r._node=typeof De.ctx.createGain=="undefined"?De.ctx.createGainNode():De.ctx.createGain(),r._node.gain.setValueAtTime(t,De.ctx.currentTime),r._node.paused=!0,r._node.connect(De.masterGain)):De.noAudio||(r._node=De._obtainHtml5Audio(),r._errorFn=r._errorListener.bind(r),r._node.addEventListener("error",r._errorFn,!1),r._loadFn=r._loadListener.bind(r),r._node.addEventListener(De._canPlayEvent,r._loadFn,!1),r._endFn=r._endListener.bind(r),r._node.addEventListener("ended",r._endFn,!1),r._node.src=e._src,r._node.preload=e._preload===!0?"auto":e._preload,r._node.volume=t*De.volume(),r._node.load()),r},reset:function(){var r=this,e=r._parent;return r._muted=e._muted,r._loop=e._loop,r._volume=e._volume,r._rate=e._rate,r._seek=0,r._rateSeek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++De._counter,r},_errorListener:function(){var r=this;r._parent._emit("loaderror",r._id,r._node.error?r._node.error.code:0),r._node.removeEventListener("error",r._errorFn,!1)},_loadListener:function(){var r=this,e=r._parent;e._duration=Math.ceil(r._node.duration*10)/10,Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue()),r._node.removeEventListener(De._canPlayEvent,r._loadFn,!1)},_endListener:function(){var r=this,e=r._parent;e._duration===1/0&&(e._duration=Math.ceil(r._node.duration*10)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=e._duration*1e3),e._ended(r)),r._node.removeEventListener("ended",r._endFn,!1)}};var Ir={},Pa=function(r){var e=r._src;if(Ir[e]){r._duration=Ir[e].duration,v0(r);return}if(/^data:[^;]+;base64,/.test(e)){for(var t=atob(e.split(",")[1]),i=new Uint8Array(t.length),o=0;o<t.length;++o)i[o]=t.charCodeAt(o);Jn(i.buffer,r)}else{var s=new XMLHttpRequest;s.open(r._xhr.method,e,!0),s.withCredentials=r._xhr.withCredentials,s.responseType="arraybuffer",r._xhr.headers&&Object.keys(r._xhr.headers).forEach(function(u){s.setRequestHeader(u,r._xhr.headers[u])}),s.onload=function(){var u=(s.status+"")[0];if(u!=="0"&&u!=="2"&&u!=="3"){r._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".");return}Jn(s.response,r)},s.onerror=function(){r._webAudio&&(r._html5=!0,r._webAudio=!1,r._sounds=[],delete Ir[e],r.load())},Ma(s)}},Ma=function(r){try{r.send()}catch{r.onerror()}},Jn=function(r,e){var t=function(){e._emit("loaderror",null,"Decoding audio data failed.")},i=function(o){o&&e._sounds.length>0?(Ir[e._src]=o,v0(e,o)):t()};typeof Promise!="undefined"&&De.ctx.decodeAudioData.length===1?De.ctx.decodeAudioData(r).then(i).catch(t):De.ctx.decodeAudioData(r,i,t)},v0=function(r,e){e&&!r._duration&&(r._duration=e.duration),Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue())},Fi=function(){if(!!De.usingWebAudio){try{typeof AudioContext!="undefined"?De.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?De.ctx=new webkitAudioContext:De.usingWebAudio=!1}catch{De.usingWebAudio=!1}De.ctx||(De.usingWebAudio=!1);var r=/iP(hone|od|ad)/.test(De._navigator&&De._navigator.platform),e=De._navigator&&De._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),t=e?parseInt(e[1],10):null;if(r&&t&&t<9){var i=/safari/.test(De._navigator&&De._navigator.userAgent.toLowerCase());De._navigator&&!i&&(De.usingWebAudio=!1)}De.usingWebAudio&&(De.masterGain=typeof De.ctx.createGain=="undefined"?De.ctx.createGainNode():De.ctx.createGain(),De.masterGain.gain.setValueAtTime(De._muted?0:De._volume,De.ctx.currentTime),De.masterGain.connect(De.ctx.destination)),De._setup()}};Ra(bn,De,Ii,Ri);/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Barcode Reader JS Edition
 * @website http://www.dynamsoft.com
 * @copyright Copyright 2022, Dynamsoft Corporation
 * @author Dynamsoft
 * @version 9.2.13 (js 20220810)
 * @fileoverview Dynamsoft JavaScript Library for Barcode Reader
 * More info on DBR JS: https://www.dynamsoft.com/barcode-reader/sdk-javascript/
 */const Pr=typeof self=="undefined";let kr,Ut,pi,Pi,yt;if(typeof navigator!="undefined"&&(kr=navigator,Ut=kr.userAgent,pi=kr.platform,Pi=kr.mediaDevices),!Pr){const r={init:function(){this.browser=this.searchString(this.dataBrowser)||"unknownBrowser",this.version=this.searchVersion(Ut)||this.searchVersion(kr.appVersion)||0,this.OS=this.searchString(this.dataOS)||"unknownOS",this.OS=="Linux"&&Ut.indexOf("Windows NT")!=-1&&(this.OS="HarmonyOS")},searchString:function(e){for(let t=0;t<e.length;t++){let i=e[t].string,o=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,i){if(i.indexOf(e[t].subString)!=-1)return e[t].identity}else if(o)return e[t].identity}},searchVersion:function(e){let t=e.indexOf(this.versionSearchString);if(t!=-1)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:Ut,subString:"Edge",identity:"Edge"},{string:Ut,subString:"OPR",identity:"OPR"},{string:Ut,subString:"Chrome",identity:"Chrome"},{string:kr.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:Ut,subString:"Firefox",identity:"Firefox"},{string:Ut,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:Ut,subString:"HarmonyOS",identity:"HarmonyOS"},{string:Ut,subString:"Android",identity:"Android"},{string:Ut,subString:"iPhone",identity:"iPhone"},{string:pi,subString:"Win",identity:"Windows"},{string:pi,subString:"Mac",identity:"Mac"},{string:pi,subString:"Linux",identity:"Linux"}]};r.init(),yt={browser:r.browser,version:r.version,OS:r.OS}}Pr&&(yt={browser:"ssr",version:0,OS:"ssr"});const La=typeof WebAssembly!="undefined"&&Ut&&!(/Safari/.test(Ut)&&!/Chrome/.test(Ut)&&/\(.+\s11_2_([2-6]).*\)/.test(Ut)),ka=typeof Worker!="undefined",_0=!(!Pi||!Pi.getUserMedia),Na=async()=>{let r=!1;if(_0)try{(await Pi.getUserMedia({video:!0})).getTracks().forEach(e=>{e.stop()}),r=!0}catch{}return r};yt.browser==="Chrome"&&yt.version>66||yt.browser==="Safari"&&yt.version>13||yt.browser==="OPR"&&yt.version>43||yt.browser==="Edge"&&yt.version;const ja=(()=>{if(!Pr&&document.currentScript){let r=document.currentScript.src,e=r.indexOf("?");if(e!=-1)r=r.substring(0,e);else{let t=r.indexOf("#");t!=-1&&(r=r.substring(0,t))}return r.substring(0,r.lastIndexOf("/")+1)}return"./"})(),qr=" is not allowed to change after `createInstance` or `loadWasm` is called.",Ua=!Pr&&document.currentScript&&(document.currentScript.getAttribute("data-license")||document.currentScript.getAttribute("data-productKeys")||document.currentScript.getAttribute("data-licenseKey")||document.currentScript.getAttribute("data-handshakeCode")||document.currentScript.getAttribute("data-organizationID"))||"",Va=!Pr&&document.currentScript&&document.currentScript.getAttribute("data-sessionPassword")||"",qn=r=>{if(r==null)r=[];else{r=r instanceof Array?[...r]:[r];for(let e=0;e<r.length;++e){if(!Pr){let t=document.createElement("a");t.href=r[e],r[e]=t.href}r[e].endsWith("/")||(r[e]+="/")}}return r};var Rt,Mi,cn,Sr;(function(r){r[r.IPF_Binary=0]="IPF_Binary",r[r.IPF_BinaryInverted=1]="IPF_BinaryInverted",r[r.IPF_GrayScaled=2]="IPF_GrayScaled",r[r.IPF_NV21=3]="IPF_NV21",r[r.IPF_RGB_565=4]="IPF_RGB_565",r[r.IPF_RGB_555=5]="IPF_RGB_555",r[r.IPF_RGB_888=6]="IPF_RGB_888",r[r.IPF_ARGB_8888=7]="IPF_ARGB_8888",r[r.IPF_RGB_161616=8]="IPF_RGB_161616",r[r.IPF_ARGB_16161616=9]="IPF_ARGB_16161616",r[r.IPF_ABGR_8888=10]="IPF_ABGR_8888",r[r.IPF_ABGR_16161616=11]="IPF_ABGR_16161616",r[r.IPF_BGR_888=12]="IPF_BGR_888"})(Rt||(Rt={})),function(r){r[r.DBR_SYSTEM_EXCEPTION=1]="DBR_SYSTEM_EXCEPTION",r[r.DBR_SUCCESS=0]="DBR_SUCCESS",r[r.DBR_UNKNOWN=-1e4]="DBR_UNKNOWN",r[r.DBR_NO_MEMORY=-10001]="DBR_NO_MEMORY",r[r.DBR_NULL_REFERENCE=-10002]="DBR_NULL_REFERENCE",r[r.DBR_LICENSE_INVALID=-10003]="DBR_LICENSE_INVALID",r[r.DBR_LICENSE_EXPIRED=-10004]="DBR_LICENSE_EXPIRED",r[r.DBR_FILE_NOT_FOUND=-10005]="DBR_FILE_NOT_FOUND",r[r.DBR_FILETYPE_NOT_SUPPORTED=-10006]="DBR_FILETYPE_NOT_SUPPORTED",r[r.DBR_BPP_NOT_SUPPORTED=-10007]="DBR_BPP_NOT_SUPPORTED",r[r.DBR_INDEX_INVALID=-10008]="DBR_INDEX_INVALID",r[r.DBR_BARCODE_FORMAT_INVALID=-10009]="DBR_BARCODE_FORMAT_INVALID",r[r.DBR_CUSTOM_REGION_INVALID=-10010]="DBR_CUSTOM_REGION_INVALID",r[r.DBR_MAX_BARCODE_NUMBER_INVALID=-10011]="DBR_MAX_BARCODE_NUMBER_INVALID",r[r.DBR_IMAGE_READ_FAILED=-10012]="DBR_IMAGE_READ_FAILED",r[r.DBR_TIFF_READ_FAILED=-10013]="DBR_TIFF_READ_FAILED",r[r.DBR_QR_LICENSE_INVALID=-10016]="DBR_QR_LICENSE_INVALID",r[r.DBR_1D_LICENSE_INVALID=-10017]="DBR_1D_LICENSE_INVALID",r[r.DBR_DIB_BUFFER_INVALID=-10018]="DBR_DIB_BUFFER_INVALID",r[r.DBR_PDF417_LICENSE_INVALID=-10019]="DBR_PDF417_LICENSE_INVALID",r[r.DBR_DATAMATRIX_LICENSE_INVALID=-10020]="DBR_DATAMATRIX_LICENSE_INVALID",r[r.DBR_PDF_READ_FAILED=-10021]="DBR_PDF_READ_FAILED",r[r.DBR_PDF_DLL_MISSING=-10022]="DBR_PDF_DLL_MISSING",r[r.DBR_PAGE_NUMBER_INVALID=-10023]="DBR_PAGE_NUMBER_INVALID",r[r.DBR_CUSTOM_SIZE_INVALID=-10024]="DBR_CUSTOM_SIZE_INVALID",r[r.DBR_CUSTOM_MODULESIZE_INVALID=-10025]="DBR_CUSTOM_MODULESIZE_INVALID",r[r.DBR_RECOGNITION_TIMEOUT=-10026]="DBR_RECOGNITION_TIMEOUT",r[r.DBR_JSON_PARSE_FAILED=-10030]="DBR_JSON_PARSE_FAILED",r[r.DBR_JSON_TYPE_INVALID=-10031]="DBR_JSON_TYPE_INVALID",r[r.DBR_JSON_KEY_INVALID=-10032]="DBR_JSON_KEY_INVALID",r[r.DBR_JSON_VALUE_INVALID=-10033]="DBR_JSON_VALUE_INVALID",r[r.DBR_JSON_NAME_KEY_MISSING=-10034]="DBR_JSON_NAME_KEY_MISSING",r[r.DBR_JSON_NAME_VALUE_DUPLICATED=-10035]="DBR_JSON_NAME_VALUE_DUPLICATED",r[r.DBR_TEMPLATE_NAME_INVALID=-10036]="DBR_TEMPLATE_NAME_INVALID",r[r.DBR_JSON_NAME_REFERENCE_INVALID=-10037]="DBR_JSON_NAME_REFERENCE_INVALID",r[r.DBR_PARAMETER_VALUE_INVALID=-10038]="DBR_PARAMETER_VALUE_INVALID",r[r.DBR_DOMAIN_NOT_MATCHED=-10039]="DBR_DOMAIN_NOT_MATCHED",r[r.DBR_RESERVEDINFO_NOT_MATCHED=-10040]="DBR_RESERVEDINFO_NOT_MATCHED",r[r.DBR_AZTEC_LICENSE_INVALID=-10041]="DBR_AZTEC_LICENSE_INVALID",r[r.DBR_LICENSE_DLL_MISSING=-10042]="DBR_LICENSE_DLL_MISSING",r[r.DBR_LICENSEKEY_NOT_MATCHED=-10043]="DBR_LICENSEKEY_NOT_MATCHED",r[r.DBR_REQUESTED_FAILED=-10044]="DBR_REQUESTED_FAILED",r[r.DBR_LICENSE_INIT_FAILED=-10045]="DBR_LICENSE_INIT_FAILED",r[r.DBR_PATCHCODE_LICENSE_INVALID=-10046]="DBR_PATCHCODE_LICENSE_INVALID",r[r.DBR_POSTALCODE_LICENSE_INVALID=-10047]="DBR_POSTALCODE_LICENSE_INVALID",r[r.DBR_DPM_LICENSE_INVALID=-10048]="DBR_DPM_LICENSE_INVALID",r[r.DBR_FRAME_DECODING_THREAD_EXISTS=-10049]="DBR_FRAME_DECODING_THREAD_EXISTS",r[r.DBR_STOP_DECODING_THREAD_FAILED=-10050]="DBR_STOP_DECODING_THREAD_FAILED",r[r.DBR_SET_MODE_ARGUMENT_ERROR=-10051]="DBR_SET_MODE_ARGUMENT_ERROR",r[r.DBR_LICENSE_CONTENT_INVALID=-10052]="DBR_LICENSE_CONTENT_INVALID",r[r.DBR_LICENSE_KEY_INVALID=-10053]="DBR_LICENSE_KEY_INVALID",r[r.DBR_LICENSE_DEVICE_RUNS_OUT=-10054]="DBR_LICENSE_DEVICE_RUNS_OUT",r[r.DBR_GET_MODE_ARGUMENT_ERROR=-10055]="DBR_GET_MODE_ARGUMENT_ERROR",r[r.DBR_IRT_LICENSE_INVALID=-10056]="DBR_IRT_LICENSE_INVALID",r[r.DBR_MAXICODE_LICENSE_INVALID=-10057]="DBR_MAXICODE_LICENSE_INVALID",r[r.DBR_GS1_DATABAR_LICENSE_INVALID=-10058]="DBR_GS1_DATABAR_LICENSE_INVALID",r[r.DBR_GS1_COMPOSITE_LICENSE_INVALID=-10059]="DBR_GS1_COMPOSITE_LICENSE_INVALID",r[r.DBR_DOTCODE_LICENSE_INVALID=-10061]="DBR_DOTCODE_LICENSE_INVALID",r[r.DMERR_NO_LICENSE=-2e4]="DMERR_NO_LICENSE",r[r.DMERR_LICENSE_SYNC_FAILED=-20003]="DMERR_LICENSE_SYNC_FAILED",r[r.DMERR_TRIAL_LICENSE=-20010]="DMERR_TRIAL_LICENSE",r[r.DMERR_FAILED_TO_REACH_LTS=-20200]="DMERR_FAILED_TO_REACH_LTS"}(Mi||(Mi={})),function(r){r[r.IMRDT_IMAGE=1]="IMRDT_IMAGE",r[r.IMRDT_CONTOUR=2]="IMRDT_CONTOUR",r[r.IMRDT_LINESEGMENT=4]="IMRDT_LINESEGMENT",r[r.IMRDT_LOCALIZATIONRESULT=8]="IMRDT_LOCALIZATIONRESULT",r[r.IMRDT_REGIONOFINTEREST=16]="IMRDT_REGIONOFINTEREST",r[r.IMRDT_QUADRILATERAL=32]="IMRDT_QUADRILATERAL"}(cn||(cn={})),function(r){r[r.BF_ALL=4265607167]="BF_ALL",r[r.BF_ONED=3147775]="BF_ONED",r[r.BF_GS1_DATABAR=260096]="BF_GS1_DATABAR",r[r.BF_CODE_39=1]="BF_CODE_39",r[r.BF_CODE_128=2]="BF_CODE_128",r[r.BF_CODE_93=4]="BF_CODE_93",r[r.BF_CODABAR=8]="BF_CODABAR",r[r.BF_ITF=16]="BF_ITF",r[r.BF_EAN_13=32]="BF_EAN_13",r[r.BF_EAN_8=64]="BF_EAN_8",r[r.BF_UPC_A=128]="BF_UPC_A",r[r.BF_UPC_E=256]="BF_UPC_E",r[r.BF_INDUSTRIAL_25=512]="BF_INDUSTRIAL_25",r[r.BF_CODE_39_EXTENDED=1024]="BF_CODE_39_EXTENDED",r[r.BF_GS1_DATABAR_OMNIDIRECTIONAL=2048]="BF_GS1_DATABAR_OMNIDIRECTIONAL",r[r.BF_GS1_DATABAR_TRUNCATED=4096]="BF_GS1_DATABAR_TRUNCATED",r[r.BF_GS1_DATABAR_STACKED=8192]="BF_GS1_DATABAR_STACKED",r[r.BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL=16384]="BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL",r[r.BF_GS1_DATABAR_EXPANDED=32768]="BF_GS1_DATABAR_EXPANDED",r[r.BF_GS1_DATABAR_EXPANDED_STACKED=65536]="BF_GS1_DATABAR_EXPANDED_STACKED",r[r.BF_GS1_DATABAR_LIMITED=131072]="BF_GS1_DATABAR_LIMITED",r[r.BF_PATCHCODE=262144]="BF_PATCHCODE",r[r.BF_PDF417=33554432]="BF_PDF417",r[r.BF_QR_CODE=67108864]="BF_QR_CODE",r[r.BF_DATAMATRIX=134217728]="BF_DATAMATRIX",r[r.BF_AZTEC=268435456]="BF_AZTEC",r[r.BF_MAXICODE=536870912]="BF_MAXICODE",r[r.BF_MICRO_QR=1073741824]="BF_MICRO_QR",r[r.BF_MICRO_PDF417=524288]="BF_MICRO_PDF417",r[r.BF_GS1_COMPOSITE=2147483648]="BF_GS1_COMPOSITE",r[r.BF_MSI_CODE=1048576]="BF_MSI_CODE",r[r.BF_CODE_11=2097152]="BF_CODE_11",r[r.BF_NULL=0]="BF_NULL"}(Sr||(Sr={}));const Zn=r=>r&&typeof r=="object"&&typeof r.then=="function",Qn=yt.OS=="iPhone"||yt.OS=="Android"||yt.OS=="HarmonyOS"?2048:4096;class ae{constructor(){this._instanceID=void 0,this._ifSaveOriginalImageInACanvas=!1,this.oriCanvas=null,this.oriCanvasData=null,this.canvas=null,this.bFilterRegionInJs=!1,this._region=null,this._timeStartDecode=null,this._timeEnterInnerDBR=null,this._timeGetMessage=null,this.decodeRecords={},this.bDestroyed=!1,this._lastErrorCode=0,this._lastErrorString="",this._lastInnerDecodeDuration=0,this.intervalTime=0,this._intervalGetVideoFrame=0,this.array_getFrameTimeCost=[],this.array_decodeFrameTimeCost=[],this._indexCurrentDecodingFrame=0,this._arrPolygons=[],this._bPauseScan=!1,this._intervalDetectVideoPause=1e3,this._soundSource="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",this.beepSound=new Ii({src:["data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"],onplayerror:(e,t)=>{console.warn(`Sound '${e}' playback failure: ${t}`)}}),this.bPlaySoundOnSuccessfulRead=!1,this.bVibrateOnSuccessfulRead=!1,this.vibrateDuration=300,this.captureAndDecodeInParallel=!0,this._dce=null,this._imgSource=null,this._maxCvsSideLength=Qn,this._tempSolutionStatus="closed"}static get version(){return this._version}static get license(){return this._license}static set license(e){((t,i)=>{const o=t;if(!o._pLoad.isEmpty)throw new Error("`license`"+qr);o._license=i})(ae,e)}static get productKeys(){return this._license}static set productKeys(e){ae.license=e}static get handshakeCode(){return this._license}static set handshakeCode(e){ae.license=e}static get organizationID(){return this._license}static set organizationID(e){ae.license=e}static set sessionPassword(e){((t,i)=>{const o=t;if(!o._pLoad.isEmpty)throw new Error("`sessionPassword`"+qr);o._sessionPassword=i})(ae,e)}static get sessionPassword(){return this._sessionPassword}static async detectEnvironment(){return await(async()=>({wasm:La,worker:ka,getUserMedia:_0,camera:await Na(),browser:yt.browser,version:yt.version,OS:yt.OS}))()}static get engineResourcePath(){return this._engineResourcePath}static set engineResourcePath(e){if(!this._pLoad.isEmpty)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` or `loadWasm` is called.");ae._engineResourcePath=(t=>{if(t==null&&(t="./"),!Pr){let i=document.createElement("a");i.href=t,t=i.href}return t.endsWith("/")||(t+="/"),t})(e)}static get licenseServer(){return this._licenseServer}static set licenseServer(e){((t,i)=>{const o=t;if(!o._pLoad.isEmpty)throw new Error("`licenseServer`"+qr);o._licenseServer=qn(i)})(ae,e)}static get deviceFriendlyName(){return this._deviceFriendlyName}static set deviceFriendlyName(e){((t,i)=>{const o=t;if(!o._pLoad.isEmpty)throw new Error("`deviceFriendlyName`"+qr);o._deviceFriendlyName=i||""})(ae,e)}static get _bUseFullFeature(){return this.__bUseFullFeature}static set _bUseFullFeature(e){if(!this._pLoad.isEmpty)throw new Error("`_bUseFullFeature` is not allowed to change after `createInstance` or `loadWasm` is called.");ae.__bUseFullFeature=e}static isImageSource(e){return!(!e||typeof e!="object"||Array.isArray(e))&&"getImage"in e}static isDSImage(e){return!(!e||typeof e!="object"||Array.isArray(e))&&"data"in e&&"width"in e&&"height"in e&&"pixelFormat"in e}static isDCEFrame(e){return!(!e||typeof e!="object"||Array.isArray(e))&&"data"in e&&"region"in e&&"sx"in e&&"sy"in e&&"width"in e&&"height"in e&&"colorMode"in e&&"timeSpent"in e&&"timeStamp"in e&&"isCropped"in e&&"toCanvas"in e&&"_sWidth"in e&&"_sHeight"in e&&"_bUseWebGL"in e}get ifSaveOriginalImageInACanvas(){return this._ifSaveOriginalImageInACanvas}set ifSaveOriginalImageInACanvas(e){this._ifSaveOriginalImageInACanvas=e}getOriginalImageInACanvas(){return!this.oriCanvas&&this.oriCanvasData?this.oriCanvasData.toCanvas():this.oriCanvas}set region(e){this._region=e,this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}get region(){return this._region}static isWasmLoaded(){return this._pLoad.isFulfilled}isContextDestroyed(){return this.bDestroyed}static get lastErrorCode(){return this._lastErrorCode}static get lastErrorString(){return this._lastErrorString}get lastErrorCode(){return this._lastErrorCode}get lastErrorString(){return this._lastErrorString}static get defaultUIElementURL(){var e;return(e=ae._defaultUIElementURL)===null||e===void 0?void 0:e.replace("@engineResourcePath/",ae.engineResourcePath)}static set defaultUIElementURL(e){ae._defaultUIElementURL=e}static _fireHTTPSWarnning(){ae.onWarning&&location&&location.protocol!=="https:"&&setTimeout(()=>{ae.onWarning&&ae.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)}get soundSource(){return this._soundSource}set soundSource(e){this._soundSource=e,this.beepSound=new Ii({src:[this._soundSource],onplayerror:(t,i)=>{console.warn(`Sound '${t}' playback failure: ${i}`)}})}get whenToPlaySoundforSuccessfulRead(){return this.bPlaySoundOnSuccessfulRead===!0?"frame":this.bPlaySoundOnSuccessfulRead?this.bPlaySoundOnSuccessfulRead:"never"}set whenToPlaySoundforSuccessfulRead(e){this.bPlaySoundOnSuccessfulRead=e!=="never"&&e}get whenToVibrateforSuccessfulRead(){return this.bVibrateOnSuccessfulRead===!0?"frame":this.bVibrateOnSuccessfulRead?this.bVibrateOnSuccessfulRead:"never"}set whenToVibrateforSuccessfulRead(e){this.bVibrateOnSuccessfulRead=e!=="never"&&e}set dce(e){this._dce=e}get dce(){return!this._dce||this._dce.isDisposed?null:this._dce}set maxCvsSideLength(e){this._maxCvsSideLength=e,this._dceControler&&this._dceControler.setDisiredValue(this,"maxCvsSideLength",e)}get maxCvsSideLength(){return this._maxCvsSideLength}async _registerDCEControler(){if(!this.dce)return;ae._onLog&&ae._onLog("_registerDCEControler()");const e=this.dce;this._dceControler=e._createControler();const t=this._dceControler;t.register(this),t.setDisiredValue(this,"refreshInterval",200),t.setDisiredValue(this,"maxCvsSideLength",this._maxCvsSideLength);try{}catch(s){s.name==="ReferenceError"&&window&&(window.ResizeObserver=void 0)}const i=e.getUIElement(),o=this.dce.constructor;if(o._defaultUIElementURL==="@engineResourcePath/dce.ui.html")try{i?i===t._innerSetUI&&(await e.setUIElement(`${o.engineResourcePath}dce.ui.html`),t._innerSetUI=e.getUIElement()):(await e.setUIElement(`${o.engineResourcePath}dbr.ui.html`),t._innerSetUI=e.getUIElement())}catch{await e.setUIElement(o.defaultUIElementURL)}else i||await e.setUIElement(o.defaultUIElementURL);this.callbackCameraChange=()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackResolutionChange=()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackCameraClose=()=>{this.stopScanning(!0),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._bPauseScan=!1},this.callbackSingleFrameAcquired=async s=>{let u=await this._decode_DCEFrame(s,{bCopyData:!1}),g=null;if(u&&u.length){const{sx:B,sy:_,width:m,height:D,_sWidth:F,_sHeight:T}=s;g=u.map(I=>({localizationResult:JSON.parse(JSON.stringify(I.localizationResult))})),ae.recalculateResultLocation(g,B,_,F,T,m,D)}if(this._drawResults(g),await this.clearMapDecodeRecord(),this.onImageRead&&this.dce.isOpen()&&!this._bPauseScan){let B=this._cloneDecodeResults(u);this.onImageRead(B)}if(this.onUniqueRead&&this.dce.isOpen()&&!this._bPauseScan)for(let B of u)this.onUniqueRead(B.barcodeText,this._cloneDecodeResults(B))},e.on("cameraChange",this.callbackCameraChange),e.on("resolutionChange",this.callbackResolutionChange),e.on("cameraClose",this.callbackCameraClose),e.on("singleFrameAcquired",this.callbackSingleFrameAcquired)}_logoutDCEControler(){this.dce&&this._dceControler&&(ae._onLog&&ae._onLog("_logoutDCEControler()"),this._dceControler.logout(this),this.dce.off("cameraChange",this.callbackCameraChange),this.dce.off("resolutionChange",this.callbackResolutionChange),this.dce.off("cameraClose",this.callbackCameraClose),this.dce.off("singleFrameAcquired",this.callbackSingleFrameAcquired),this._dceControler=null,this.dce=null)}async setImageSource(e,t){if(e==null)return this._imgSource=null,this._logoutDCEControler(),void(this._drawingItemNamespace=null);if(e&&e.isCameraEnhancer)this.dce=e,await this._registerDCEControler(),this._imgSource=null;else{if(!ae.isImageSource(e))throw new Error("Invalid value.");this._logoutDCEControler(),this._imgSource=e}t&&t.resultsHighlightBaseShapes&&(this._drawingItemNamespace=t.resultsHighlightBaseShapes)}static async loadWasm(){if(this._pLoad.isEmpty){let{lt:e,l:t,ls:i,sp:o,rmk:s}=(u=>{const g=u;if(g._pLoad.isEmpty){let B,_,m=g._license||"",D=JSON.parse(JSON.stringify(g._licenseServer)),F=g._sessionPassword,T=0;if(m.startsWith("t")||m.startsWith("f"))T=0;else if(m.length===0||m.startsWith("P")||m.startsWith("L")||m.startsWith("Y")||m.startsWith("A"))T=1;else{T=2;const I=m.indexOf(":");if(I!=-1&&(m=m.substring(I+1)),m.startsWith("DLS2")){let k=m.substring(4);try{k=atob(k)}catch{throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}const U=JSON.parse(k);if(m=U.handshakeCode?U.handshakeCode:U.organizationID?U.organizationID:"",typeof m=="number"&&(m=JSON.stringify(m)),D.length===0){let K=[];U.mainServerURL&&(K[0]=U.mainServerURL),U.standbyServerURL&&(K[1]=U.standbyServerURL),D=qn(K)}!F&&U.sessionPassword&&(F=U.sessionPassword),B=U.remark}(m==="200001"||m.startsWith("200001-"))&&(D&&D.length||(m="")),m||(T=1)}if(T&&(globalThis.crypto||(_="Please upgrade your browser to support online key."),globalThis.crypto.subtle||(_="Require https to use online key in this browser.")),_){if(T!==1)throw new Error(_);T=0,console.warn(_),g._lastErrorCode=-1,g._lastErrorString=_}return T===1&&(m="",console.warn("Applying for a public trial license ...")),{lt:T,l:m,ls:D,sp:F,rmk:B}}throw new Error("Can't preprocess license again"+qr)})(ae);this._pLoad.task=async(u,g)=>{let B=ae.engineResourcePath+ae._workerName;ae.engineResourcePath.startsWith(location.origin)||(B=await fetch(B).then(_=>_.blob()).then(_=>URL.createObjectURL(_))),ae._dbrWorker=new Worker(B),ae._dbrWorker.onerror=_=>{let m=new Error(_.message);g(m)},ae._dbrWorker.onmessage=async _=>{let m=_.data?_.data:_;switch(m.type){case"log":ae._onLog&&ae._onLog(m.message);break;case"load":{m.message&&(m.message=m.message.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamsoft-barcode-reader/#javascript)"));let D,F=!1;e===1&&(F=!0),m.success?(ae._dbrWorker.onerror=null,ae._version=m.version+"(JS "+ae._jsVersion+"."+ae._jsEditVersion+")",ae._onLog&&ae._onLog("load dbr worker success"),m.message&&console.warn(m.message)):(D=new Error(m.message),D.stack=m.stack+`
`+D.stack,F||m.ltsErrorCode==111&&m.message.toLowerCase().indexOf("trial license")!=-1&&(F=!0)),F&&ae.showDialog(m.success?"warn":"error",m.message),m.success?u():g(D);break}case"task":{let D=m.id,F=m.body;try{ae._taskCallbackMap.get(D)(F),ae._taskCallbackMap.delete(D)}catch(T){throw ae._taskCallbackMap.delete(D),T}break}default:ae._onLog&&ae._onLog(_)}},ae._dbrWorker.postMessage({type:"loadWasm",engineResourcePath:ae.engineResourcePath,bUseFullFeature:ae._bUseFullFeature,bd:ae._bWasmDebug,v:ae._jsVersion,brtk:!!e,bptk:e===1,l:t,dm:location.origin.startsWith("http")?location.origin:"https://localhost",os:yt,fn:ae.deviceFriendlyName,ls:i,sp:o,rmk:s})}}await this._pLoad}static async showDialog(e,t){await(async(i,o,s)=>{if(!i._bNeverShowDialog)try{let u=await fetch(i.engineResourcePath+"dls.license.dialog.html");if(!u.ok)throw Error("Get license dialog fail. Network Error: "+u.statusText);let g=await u.text();if(!g.trim().startsWith("<"))throw Error("Get license dialog fail. Can't get valid HTMLElement.");let B=document.createElement("div");B.innerHTML=g;let _=[];for(let X=0;X<B.childElementCount;++X){let te=B.children[X];te instanceof HTMLStyleElement&&(_.push(te),document.head.append(te))}let m=B.childElementCount==1?B.children[0]:B;m.remove();let D,F,T,I,k,U=[m],K=m.children;for(let X of K)U.push(X);for(let X=0;X<U.length;++X)for(let te of U[X].children)U.push(te);for(let X of U)if(!D&&X.classList.contains("dls-license-mask"))D=X,X.addEventListener("click",te=>{if(X==te.target){m.remove();for(let ne of _)ne.remove()}});else if(!F&&X.classList.contains("dls-license-icon-close"))F=X,X.addEventListener("click",()=>{m.remove();for(let te of _)te.remove()});else if(!T&&X.classList.contains("dls-license-icon-error"))T=X,o!="error"&&X.remove();else if(!I&&X.classList.contains("dls-license-icon-warn"))I=X,o!="warn"&&X.remove();else if(!k&&X.classList.contains("dls-license-msg-content")){k=X;let te=s;for(;te;){let ne=te.indexOf("["),re=te.indexOf("]",ne),ue=te.indexOf("(",re),Ae=te.indexOf(")",ue);if(ne==-1||re==-1||ue==-1||Ae==-1){X.appendChild(new Text(te));break}ne>0&&X.appendChild(new Text(te.substring(0,ne)));let v=document.createElement("a"),ye=te.substring(ne+1,re);v.innerText=ye;let be=te.substring(ue+1,Ae);v.setAttribute("href",be),v.setAttribute("target","_blank"),X.appendChild(v),te=te.substring(Ae+1)}}document.body.appendChild(m)}catch(u){i._onLog&&i._onLog(u.message||u)}})(this,e,t)}static async createInstanceInWorker(e=!1){return await ae.loadWasm(),await new Promise((t,i)=>{let o=ae._nextTaskID++;ae._taskCallbackMap.set(o,s=>{if(s.success)return t(s.instanceID);{let u=new Error(s.message);return u.stack=s.stack+`
`+u.stack,i(u)}}),ae._dbrWorker.postMessage({type:"createInstance",id:o,bScanner:e})})}static async createInstance(){let e=new ae;return e._instanceID=await ae.createInstanceInWorker(),ae._fireHTTPSWarnning(),e}async clearMapDecodeRecord(){return await new Promise((e,t)=>{let i=ae._nextTaskID++;ae._taskCallbackMap.set(i,o=>{if(o.success)return e();{let s=new Error(o.message);return s.stack=o.stack+`
`+s.stack,t(s)}}),ae._dbrWorker.postMessage({type:"clearMapDecodeRecord",id:i,instanceID:this._instanceID})})}async decode(e){ae._onLog&&ae._onLog("decode(source: any)"),ae._onLog&&(this._timeStartDecode=Date.now());{let t={};return!this.region||this.region instanceof Array||(t.region=JSON.parse(JSON.stringify(this.region))),e instanceof Blob?await this._decode_Blob(e,t):e instanceof ArrayBuffer?await this._decode_ArrayBuffer(e,t):e instanceof Uint8Array||e instanceof Uint8ClampedArray?await this._decode_Uint8Array(e,t):e instanceof HTMLImageElement||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap?await this._decode_Image(e,t):e instanceof HTMLCanvasElement?await this._decode_Canvas(e,t):e instanceof HTMLVideoElement?await this._decode_Video(e,t):typeof e=="string"?e.substring(0,11)=="data:image/"?await this._decode_Base64(e,t):await this._decode_Url(e,t):ae.isDCEFrame(e)?(t.bCopyData=!0,await this._decode_DCEFrame(e,t)):ae.isDSImage(e)?(t.bCopyData=!0,await this._decode_DSImage(e,t)):await Promise.reject(TypeError("'_decode(source, config)': Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'."))}}async decodeBase64String(e){let t={};return!this.region||this.region instanceof Array||(t.region=JSON.parse(JSON.stringify(this.region))),this._decode_Base64(e,t)}async decodeUrl(e){let t={};return!this.region||this.region instanceof Array||(t.region=JSON.parse(JSON.stringify(this.region))),this._decode_Url(e,t)}async _decodeBuffer_Uint8Array(e,t,i,o,s,u){return await new Promise((g,B)=>{let _=ae._nextTaskID++;ae._taskCallbackMap.set(_,m=>{if(m.success){let D,F=ae._onLog?Date.now():0;ae._onLog&&ae._onLog("worker return result: "+F),this._lastInnerDecodeDuration=m.duration;try{D=this._handleRetJsonString(m.decodeReturn)}catch(T){return B(T)}if(ae._onLog){let T=Date.now();ae._onLog("DBR getting message from worker timestamp: "+F),ae._onLog("From DBR staring decoding to entering worker costs: "+(this._timeEnterInnerDBR-this._timeStartDecode)),ae._onLog("From DBR entering worker to returning message from worker costs: "+(F-this._timeEnterInnerDBR)),ae._onLog("Handling results from DBR worker costs: "+(T-F)),ae._onLog("Total decoding image costs: "+(T-this._timeStartDecode))}return g(D)}{let D=new Error(m.message);return D.stack=m.stack+`
`+D.stack,B(D)}}),this._timeEnterInnerDBR=Date.now(),ae._onLog&&ae._onLog("Sending buffer to worker timestamp:"+this._timeEnterInnerDBR),ae._dbrWorker.postMessage({type:"decodeBuffer",id:_,instanceID:this._instanceID,body:{buffer:e,width:t,height:i,stride:o,format:s,config:u}},[e.buffer]),ae._onLog&&u&&u.timeStamp&&ae._onLog("Delay of decoding image: "+(this._timeEnterInnerDBR-u.timeStamp))})}async _decodeBuffer_Blob(e,t,i,o,s,u){ae._onLog&&ae._onLog("_decodeBuffer_Blob(buffer,width,height,stride,format)");const g=e.arrayBuffer?await e.arrayBuffer():await new Promise((B,_)=>{let m=new FileReader;m.readAsArrayBuffer(e),m.onload=()=>{B(m.result)},m.onerror=()=>{_(m.error)}});return await this._decodeBuffer_Uint8Array(new Uint8Array(g),t,i,o,s,u)}async decodeBuffer(e,t,i,o,s,u){let g;return ae._onLog&&ae._onLog("decodeBuffer(buffer,width,height,stride,format)"),ae._onLog&&(this._timeStartDecode=Date.now()),e instanceof Uint8Array||e instanceof Uint8ClampedArray?g=await this._decodeBuffer_Uint8Array(e,t,i,o,s,u):e instanceof ArrayBuffer?g=await this._decodeBuffer_Uint8Array(new Uint8Array(e),t,i,o,s,u):e instanceof Blob&&(g=await this._decodeBuffer_Blob(e,t,i,o,s,u)),g}async _decodeFileInMemory_Uint8Array(e){return await new Promise((t,i)=>{let o=ae._nextTaskID++;ae._taskCallbackMap.set(o,s=>{if(s.success){let u;this._lastInnerDecodeDuration=s.duration;try{u=this._handleRetJsonString(s.decodeReturn)}catch(g){return i(g)}return t(u)}{let u=new Error(s.message);return u.stack=s.stack+`
`+u.stack,i(u)}}),ae._dbrWorker.postMessage({type:"decodeFileInMemory",id:o,instanceID:this._instanceID,body:{bytes:e}})})}async getRuntimeSettings(){return await new Promise((e,t)=>{let i=ae._nextTaskID++;ae._taskCallbackMap.set(i,o=>{if(o.success){let s=JSON.parse(o.results);return this.userDefinedRegion!=null&&(s.region=JSON.parse(JSON.stringify(this.userDefinedRegion))),e(s)}{let s=new Error(o.message);return s.stack=o.stack+`
`+s.stack,t(s)}}),ae._dbrWorker.postMessage({type:"getRuntimeSettings",id:i,instanceID:this._instanceID})})}async updateRuntimeSettings(e){let t;if(typeof e=="string")if(e=="speed"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),t=await this.getRuntimeSettings(),t.barcodeFormatIds=i.barcodeFormatIds,t.barcodeFormatIds_2=i.barcodeFormatIds_2,t.region=i.region,t.deblurLevel=3,t.expectedBarcodesCount=0,t.localizationModes=[2,0,0,0,0,0,0,0]}else if(e=="balance"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),t=await this.getRuntimeSettings(),t.barcodeFormatIds=i.barcodeFormatIds,t.barcodeFormatIds_2=i.barcodeFormatIds_2,t.region=i.region,t.deblurLevel=5,t.expectedBarcodesCount=512,t.localizationModes=[2,16,0,0,0,0,0,0]}else if(e=="coverage"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),t=await this.getRuntimeSettings(),t.barcodeFormatIds=i.barcodeFormatIds,t.barcodeFormatIds_2=i.barcodeFormatIds_2,t.region=i.region}else if(e=="dense"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,t=await this.getRuntimeSettings(),t.barcodeFormatIds=i.barcodeFormatIds,t.barcodeFormatIds_2=i.barcodeFormatIds_2,t.region=i.region,t.deblurLevel=9,t.expectedBarcodesCount=0,t.localizationModes=[2,8,0,0,0,0,0,0]}else if(e=="distance"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,t=await this.getRuntimeSettings(),t.barcodeFormatIds=i.barcodeFormatIds,t.barcodeFormatIds_2=i.barcodeFormatIds_2,t.region=i.region,t.deblurLevel=3,t.expectedBarcodesCount=0,t.localizationModes=[2,8,0,0,0,0,0,0]}else t=JSON.parse(e);else{if(typeof e!="object")throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");if(t=JSON.parse(JSON.stringify(e)),t.region instanceof Array){let i=t.region;[i.regionLeft,i.regionTop,i.regionLeft,i.regionBottom,i.regionMeasuredByPercentage].some(o=>o!==void 0)&&(t.region={regionLeft:i.regionLeft||0,regionTop:i.regionTop||0,regionRight:i.regionRight||0,regionBottom:i.regionBottom||0,regionMeasuredByPercentage:i.regionMeasuredByPercentage||0})}}if(!ae._bUseFullFeature){if((t.barcodeFormatIds&~(Sr.BF_ONED|Sr.BF_QR_CODE|Sr.BF_PDF417|Sr.BF_DATAMATRIX))!=0||t.barcodeFormatIds_2!=0)throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");if(t.intermediateResultTypes!=0)throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.")}if(this.bFilterRegionInJs){let i=t.region;if(i instanceof Array)throw Error("The `region` of type `Array` is only allowed in `BarcodeScanner`.");this.userDefinedRegion=JSON.parse(JSON.stringify(i)),(i.regionLeft||i.regionTop||i.regionRight||i.regionBottom||i.regionMeasuredByPercentage)&&(i.regionLeft||i.regionTop||i.regionRight!=100||i.regionBottom!=100||!i.regionMeasuredByPercentage)?this.region=i:this.region=null,t.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0}}else this.userDefinedRegion=null,this.region=null;return await new Promise((i,o)=>{let s=ae._nextTaskID++;ae._taskCallbackMap.set(s,u=>{if(u.success){try{this._handleRetJsonString(u.updateReturn)}catch(g){o(g)}return i()}{let g=new Error(u.message);return g.stack=u.stack+`
`+g.stack,o(g)}}),ae._dbrWorker.postMessage({type:"updateRuntimeSettings",id:s,instanceID:this._instanceID,body:{settings:JSON.stringify(t)}})})}async resetRuntimeSettings(){return this.userDefinedRegion=null,this.region=null,this.maxCvsSideLength=Qn,await new Promise((e,t)=>{let i=ae._nextTaskID++;ae._taskCallbackMap.set(i,o=>{if(o.success)return e();{let s=new Error(o.message);return s.stack=o.stack+`
`+s.stack,t(s)}}),ae._dbrWorker.postMessage({type:"resetRuntimeSettings",id:i,instanceID:this._instanceID})})}async outputRuntimeSettingsToString(){if(!ae._bUseFullFeature)throw Error("outputRuntimeSettingsToString() is not supported in the compact version. Please try the full-featured version.");return await new Promise((e,t)=>{let i=ae._nextTaskID++;ae._taskCallbackMap.set(i,o=>{if(o.success)return e(o.results);{let s=new Error(o.message);return s.stack=o.stack+`
`+s.stack,t(s)}}),ae._dbrWorker.postMessage({type:"outputRuntimeSettingsToString",id:i,instanceID:this._instanceID})})}async initRuntimeSettingsWithString(e){if(!ae._bUseFullFeature)throw Error("initRuntimeSettingsWithString() is not supported in the compact version. Please try the full-featured version.");if(typeof e=="string")e=e;else{if(typeof e!="object")throw TypeError("'initRuntimeSettingstWithString(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");e=JSON.stringify(e)}return await new Promise((t,i)=>{let o=ae._nextTaskID++;ae._taskCallbackMap.set(o,s=>{if(s.success){try{this._handleRetJsonString(s.initReturn)}catch(u){i(u)}return t()}{let u=new Error(s.message);return u.stack=s.stack+`
`+u.stack,i(u)}}),ae._dbrWorker.postMessage({type:"initRuntimeSettingsWithString",id:o,instanceID:this._instanceID,body:{settings:e}})})}async _decode_Blob(e,t){ae._onLog&&ae._onLog("_decode_Blob(blob: Blob)");let i=null,o=null;if(typeof createImageBitmap!="undefined")try{i=await createImageBitmap(e)}catch{}i||(o=await function(u){return new Promise((g,B)=>{let _=URL.createObjectURL(u),m=new Image;m.dbrObjUrl=_,m.src=_,m.onload=()=>{g(m)},m.onerror=D=>{B(new Error("Can't convert blob to image : "+(D instanceof Event?D.type:D)))}})}(e));let s=await this._decode_Image(i||o,t);return i&&i.close(),s}async _decode_ArrayBuffer(e,t){return await this._decode_Blob(new Blob([e]),t)}async _decode_Uint8Array(e,t){return await this._decode_Blob(new Blob([e]),t)}async _decode_Image(e,t){ae._onLog&&ae._onLog("_decode_Image(image: HTMLImageElement|ImageBitmap)"),t=t||{};let i,o,s=e instanceof HTMLImageElement?e.naturalWidth:e.width,u=e instanceof HTMLImageElement?e.naturalHeight:e.height,g=Math.max(s,u);if(g>this._maxCvsSideLength){let _=this._maxCvsSideLength/g;i=Math.round(s*_),o=Math.round(u*_)}else i=s,o=u;this.canvas||(this.canvas=document.createElement("canvas"));const B=this.canvas;return B.width===i&&B.height===o||(B.width=i,B.height=o),B.ctx2d||(B.ctx2d=B.getContext("2d")),B.ctx2d.drawImage(e,0,0,s,u,0,0,i,o),e.dbrObjUrl&&URL.revokeObjectURL(e.dbrObjUrl),await this._decode_Canvas(B,t)}async _decode_Canvas(e,t){if(ae._onLog&&ae._onLog("_decode_Canvas(canvas:HTMLCanvasElement)"),e.crossOrigin&&e.crossOrigin!="anonymous")throw"cors";if(e.width===0||e.height===0)throw Error("The width or height of the 'canvas' is 0.");this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=e,this.oriCanvasData=null);let i=(e.ctx2d||e.getContext("2d")).getImageData(0,0,e.width,e.height).data;return await this._decodeBuffer_Uint8Array(i,e.width,e.height,4*e.width,Rt.IPF_ABGR_8888,t)}async _decode_Video(e,t){if(ae._onLog&&ae._onLog("_decode_Video(video)"),!(e instanceof HTMLVideoElement))throw TypeError("'_decode_Video(video [, config] )': Type of 'video' should be 'HTMLVideoElement'.");if(e.crossOrigin&&e.crossOrigin!="anonymous")throw"cors";t=t||{};let i,o,s=e.videoWidth,u=e.videoHeight,g=Math.max(s,u);if(g>this._maxCvsSideLength){let _=this._maxCvsSideLength/g;i=Math.round(s*_),o=Math.round(u*_)}else i=s,o=u;this.canvas||(this.canvas=document.createElement("canvas"));const B=this.canvas;return B.width===i&&B.height===o||(B.width=i,B.height=o),B.ctx2d||(B.ctx2d=B.getContext("2d")),B.ctx2d.drawImage(e,0,0,s,u,0,0,i,o),await this._decode_Canvas(B,t)}async _decode_DCEFrame(e,t){if(ae._onLog&&ae._onLog("_decode_DCEFrame(dceFrame)"),!ae.isDCEFrame(e))return[];let i=[];this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:e.width,height:e.height,colorMode:e.colorMode,data:new Uint8Array(e.data),toCanvas:e.toCanvas});const{width:o,height:s,colorMode:u,timeStamp:g}=e;let B;B=t&&t.bCopyData?new Uint8Array(e.data):e.data;let _=null;if(t?(_=JSON.parse(JSON.stringify(t)),_.timeStamp=g):_={timeStamp:g},u==="grey")i=await this._decodeBuffer_Uint8Array(B,o,s,o,Rt.IPF_GrayScaled,_);else if(u==="rgba")i=await this._decodeBuffer_Uint8Array(B,o,s,4*o,Rt.IPF_ABGR_8888,_);else{if(u!=="bgra")throw new Error(`Color mode '${u}' is not supported to decode.`);i=await this._decodeBuffer_Uint8Array(B,o,s,4*o,Rt.IPF_ARGB_8888,_)}return i}async _decode_DSImage(e,t){if(ae._onLog&&ae._onLog("_decode_DSImage(dsImage)"),!ae.isDSImage(e))return null;this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:e.width,height:e.height,pixelFormat:e.pixelFormat.toLowerCase(),data:new Uint8Array(e.data),toCanvas:function(){const _=document.createElement("canvas");let m;switch(_.width=this.width,_.height=this.height,this.pixelFormat){case"grey":m=new Uint8ClampedArray(this.width*this.height*4);for(let F=0;F<m.length;F+=4)m[F]=this.data[F/4],m[F+1]=this.data[F/4],m[F+2]=this.data[F/4],m[F+3]=255;break;case"rgb":m=new Uint8ClampedArray(this.width*this.height*4);for(let F=0;F<m.length;F+=4)m[F]=this.data[F],m[F+1]=this.data[F+1],m[F+2]=this.data[F+2],m[F+3]=255;break;case"bgr":m=new Uint8ClampedArray(this.width*this.height*4);for(let F=0;F<m.length;F+=4)m[F]=this.data[F],m[F+1]=this.data[F+1],m[F+2]=this.data[F+2],m[F+3]=255;break;case"rgba":case"bgra":m=new Uint8ClampedArray(this.data);break;default:throw new Error("The content of 2D Canvas is currently limited to the sRGB color space.")}const D=new ImageData(m,this.width,this.height);return _.getContext("2d").putImageData(D,0,0),_}});const{width:i,height:o}=e;let s,u,g,B=e.pixelFormat.toLowerCase();switch(s=t&&t.bCopyData?new Uint8Array(e.data):e.data,B){case"grey":g=Rt.IPF_GrayScaled,u=i;break;case"rgb":g=Rt.IPF_BGR_888,u=3*i;break;case"bgr":g=Rt.IPF_RGB_888,u=3*i;break;case"rgba":g=Rt.IPF_ABGR_8888,u=4*i;break;case"bgra":g=Rt.IPF_ARGB_8888,u=4*i;break;default:throw new Error("The pixel format is not supported to decode.")}return await this._decodeBuffer_Uint8Array(s,i,o,u,g,t)}async _decode_Base64(e,t){if(ae._onLog&&ae._onLog("_decode_Base64(base64Str)"),typeof e!="string")return Promise.reject("'_decode_Base64(base64Str, config)': Type of 'base64Str' should be 'string'.");e.substring(0,11)=="data:image/"&&(e=e.substring(e.indexOf(",")+1));{let i=atob(e),o=i.length,s=new Uint8Array(o);for(;o--;)s[o]=i.charCodeAt(o);return await this._decode_Blob(new Blob([s]),t)}}async _decode_Url(e,t){if(ae._onLog&&ae._onLog("_decode_Url(url)"),typeof e!="string")throw TypeError("'_decode_Url(url, config)': Type of 'url' should be 'string'.");e=e;{let i=await new Promise((o,s)=>{let u=new XMLHttpRequest;u.open("GET",e,!0),u.responseType="blob",u.send(),u.onloadend=async()=>{o(u.response)},u.onerror=()=>{s(new Error("Network Error: "+u.statusText))}});return await this._decode_Blob(i,t)}}async _decode_FilePath(e,t){throw ae._onLog&&ae._onLog("_decode_FilePath(path)"),Error("'_decode_FilePath(path, config)': The method is only supported in node environment.")}static recalculateResultLocation(e,t,i,o,s,u,g){if(e.length>0)for(let B of e){let _=B.localizationResult;_.resultCoordinateType==2&&(_.x1*=.01*u,_.x2*=.01*u,_.x3*=.01*u,_.x4*=.01*u,_.y1*=.01*g,_.y2*=.01*g,_.y3*=.01*g,_.y4*=.01*g);let m=u/o,D=g/s;_.x1=_.x1/m+t,_.x2=_.x2/m+t,_.x3=_.x3/m+t,_.x4=_.x4/m+t,_.y1=_.y1/D+i,_.y2=_.y2/D+i,_.y3=_.y3/D+i,_.y4=_.y4/D+i,_.resultCoordinateType==2&&(_.x1*=100/o,_.x2*=100/o,_.x3*=100/o,_.x4*=100/o,_.y1*=100/s,_.y2*=100/s,_.y3*=100/s,_.y4*=100/s)}}static BarcodeReaderException(e,t){let i,o=Mi.DBR_UNKNOWN;return typeof e=="number"?(o=e,i=new Error(t)):i=new Error(e),i.code=o,i}_handleRetJsonString(e){let t=Mi;if(e.textResults){for(let i=0;i<e.textResults.length;i++){let o=e.textResults[i];try{let s=o.barcodeText,u="";for(let g=0;g<s.length;g++)u+=String.fromCharCode(s[g]);try{o.barcodeText=decodeURIComponent(escape(u))}catch{o.barcodeText=u}}catch{o.barcodeText=""}if(o.exception!=null){ae._setWarnnedEx.has(o.exception)||(ae._setWarnnedEx.add(o.exception),console.warn(o.exception));let s={};o.exception.split(";").forEach(u=>{let g=u.indexOf(":");s[u.substring(0,g)]=u.substring(g+1)}),o.exception=s}}return e.decodeRecords?this.decodeRecords=e.decodeRecords:this.decodeRecords={},this._lastErrorCode=e.exception,this._lastErrorString=e.description,e.exception&&!ae._setWarnnedEx.has(e.description)&&(ae._setWarnnedEx.add(e.description),console.warn(e.description)),e.textResults}if(e.exception==t.DBR_SUCCESS)return e.data;throw ae.BarcodeReaderException(e.exception,e.description)}async setModeArgument(e,t,i,o){return await new Promise((s,u)=>{let g=ae._nextTaskID++;ae._taskCallbackMap.set(g,B=>{if(B.success){try{this._handleRetJsonString(B.setReturn)}catch(_){return u(_)}return s()}{let _=new Error(B.message);return _.stack=B.stack+`
`+_.stack,u(_)}}),ae._dbrWorker.postMessage({type:"setModeArgument",id:g,instanceID:this._instanceID,body:{modeName:e,index:t,argumentName:i,argumentValue:o}})})}async getModeArgument(e,t,i){return await new Promise((o,s)=>{let u=ae._nextTaskID++;ae._taskCallbackMap.set(u,g=>{if(g.success){let B;try{B=this._handleRetJsonString(g.getReturn)}catch(_){return s(_)}return o(B)}{let B=new Error(g.message);return B.stack=g.stack+`
`+B.stack,s(B)}}),ae._dbrWorker.postMessage({type:"getModeArgument",id:u,instanceID:this._instanceID,body:{modeName:e,index:t,argumentName:i}})})}async getIntermediateResults(){return await new Promise((e,t)=>{let i=ae._nextTaskID++;ae._taskCallbackMap.set(i,o=>{if(o.success)return e(o.results);{let s=new Error(o.message);return s.stack=o.stack+`
`+s.stack,t(s)}}),ae._dbrWorker.postMessage({type:"getIntermediateResults",id:i,instanceID:this._instanceID})})}async getIntermediateCanvas(){let e=await this.getIntermediateResults(),t=[];for(let i of e)if(i.dataType==cn.IMRDT_IMAGE)for(let o of i.results){const s=o.bytes;let u;switch(ae._onLog&&ae._onLog(" "+s.length+" "+s.byteLength+" "+o.width+" "+o.height+" "+o.stride+" "+o.format),o.format){case Rt.IPF_ABGR_8888:u=new Uint8ClampedArray(s);break;case Rt.IPF_RGB_888:{const _=s.length/3;u=new Uint8ClampedArray(4*_);for(let m=0;m<_;++m)u[4*m]=s[3*m+2],u[4*m+1]=s[3*m+1],u[4*m+2]=s[3*m],u[4*m+3]=255;break}case Rt.IPF_GrayScaled:{const _=s.length;u=new Uint8ClampedArray(4*_);for(let m=0;m<_;m++)u[4*m]=u[4*m+1]=u[4*m+2]=s[m],u[4*m+3]=255;break}case Rt.IPF_Binary:case Rt.IPF_BinaryInverted:{o.width=8*o.stride,o.height=s.length/o.stride;const _=s.length;u=new Uint8ClampedArray(8*_*4);for(let m=0;m<_;m++){let D=s[m];for(let F=0;F<8;++F)u[4*(8*m+F)]=u[4*(8*m+F)+1]=u[4*(8*m+F)+2]=(128&D)/128*255,u[4*(8*m+F)+3]=255,D<<=1}break}default:console.warn("unknow intermediate image",o)}if(!u)continue;let g=new ImageData(u,o.width,o.height),B=document.createElement("canvas");B.width=o.width,B.height=o.height,B.getContext("2d").putImageData(g,0,0),t.push(B)}return t}async keepAlive(){ae._dbrWorker.postMessage({type:"keepAlive"})}async getScanSettings(){return await new Promise((e,t)=>{let i=ae._nextTaskID++;ae._taskCallbackMap.set(i,o=>{if(o.success){let s=o.results;return s.intervalTime=this.intervalTime,s.whenToPlaySoundforSuccessfulRead=this.whenToPlaySoundforSuccessfulRead,s.soundOnSuccessfullRead=this.soundSource,s.whenToVibrateforSuccessfulRead=this.whenToVibrateforSuccessfulRead,s.vibrateDuration=this.vibrateDuration,s.captureAndDecodeInParallel=this.captureAndDecodeInParallel,e(s)}{let s=new Error(o.message);return s.stack+=`
`+o.stack,t(s)}}),ae._dbrWorker.postMessage({type:"getScanSettings",id:i,instanceID:this._instanceID})})}async updateScanSettings(e){if(!e)return;const t=JSON.parse(JSON.stringify(e));return t.hasOwnProperty("intervalTime")&&(this.intervalTime=Math.max(t.intervalTime,0),delete t.intervalTime),t.hasOwnProperty("whenToPlaySoundforSuccessfulRead")&&(this.whenToPlaySoundforSuccessfulRead=t.whenToPlaySoundforSuccessfulRead,delete t.whenToPlaySoundforSuccessfulRead),t.hasOwnProperty("soundOnSuccessfullRead")&&(this.soundSource=t.soundOnSuccessfullRead,delete t.soundOnSuccessfullRead),t.hasOwnProperty("whenToVibrateforSuccessfulRead")&&(this.whenToVibrateforSuccessfulRead=t.whenToVibrateforSuccessfulRead,delete t.whenToVibrateforSuccessfulRead),t.hasOwnProperty("vibrateDuration")&&(this.vibrateDuration=t.vibrateDuration,delete t.vibrateDuration),t.hasOwnProperty("captureAndDecodeInParallel")&&(this.captureAndDecodeInParallel=t.captureAndDecodeInParallel,delete t.captureAndDecodeInParallel),await new Promise((i,o)=>{let s=ae._nextTaskID++;ae._taskCallbackMap.set(s,u=>{if(u.success)return i();{let g=new Error(u.message);return g.stack+=`
`+u.stack,o(g)}}),ae._dbrWorker.postMessage({type:"updateScanSettings",id:s,instanceID:this._instanceID,body:{settings:t}})})}_cloneDecodeResults(e){if(e instanceof Array){let t=[];for(let i of e)t.push(this._cloneDecodeResults(i));return t}{let t=e;return JSON.parse(JSON.stringify(t,(o,s)=>o=="oriVideoCanvas"||o=="searchRegionCanvas"?void 0:s))}}async _loopReadVideo(){if(this.bDestroyed)return this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),void this._drawResults(null);if(this.dce&&!this.dce.isOpen())return this._drawResults(null),void await this.clearMapDecodeRecord();if(!this.dce&&!this._imgSource||this._bPauseScan)return ae._onLog&&ae._onLog("Scan is paused, or imageSource is not set. Ask in 1s."),await this.clearMapDecodeRecord(),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this._intervalDetectVideoPause));ae._onLog&&ae._onLog("======= once read ======="),ae._onLog&&(this._timeStartDecode=Date.now());let e=null,t=null;if(this.dce)e=this._getVideoFrame();else if(this._imgSource&&(t=await this._imgSource.getImage(),!ae.isDSImage(t)))throw new Error("Invalid DSImage.");if(!e&&!t)return ae._onLog&&ae._onLog("Get invalid frame."),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0));(async()=>{let i=[];if(e){i=await this._decode_DCEFrame(e,{bScanner:!0,bCopyData:!1});let o=null;if(i&&i.length){const{sx:s,sy:u,width:g,height:B,_sWidth:_,_sHeight:m}=e;o=i.map(D=>({localizationResult:JSON.parse(JSON.stringify(D.localizationResult))})),ae.recalculateResultLocation(o,s,u,_,m,g,B)}this._drawResults(o)}else t&&(i=await this._decode_DSImage(t,{bScanner:!0,bCopyData:!1}));return i})().then(i=>{if(ae._onLog&&ae._onLog(i),this.dce&&this.captureAndDecodeInParallel){let o=this.array_decodeFrameTimeCost,s=this.array_getFrameTimeCost;const u=()=>{let g=0;if(s&&s.length){let B=Math.min(...o),_=Math.max(...s);B&&_&&(g=B-_)}else g=0;return g>0?g:0};(()=>{for(;o.length>=5;)o.shift();o.push(this._lastInnerDecodeDuration)})(),this._intervalGetVideoFrame=u()+this.intervalTime}if((this.dce&&this.dce.isOpen()||this._imgSource)&&!this._bPauseScan){if(this.bPlaySoundOnSuccessfulRead&&i.length){let o=!1;if(this.bPlaySoundOnSuccessfulRead===!0||this.bPlaySoundOnSuccessfulRead==="frame")o=!0;else if(this.bPlaySoundOnSuccessfulRead==="unique"){for(let s of i)if(s.resultState==0){o=!0;break}}o&&(this.beepSound.stop(),this.beepSound.play())}if(navigator.vibrate&&this.bVibrateOnSuccessfulRead&&i.length){let o=!1;if(this.bVibrateOnSuccessfulRead===!0||this.bVibrateOnSuccessfulRead==="frame")o=!0;else if(this.bVibrateOnSuccessfulRead==="unique"){for(let s of i)if(s.resultState==0){o=!0;break}}if(o)try{navigator.vibrate(this.vibrateDuration)}catch(s){console.warn("Vibration not allowed. User interaction required: "+(s.message||s))}}if(this.onImageRead){let o=this._cloneDecodeResults(i);o.length===0&&this.onImageRead([]);for(let s of o)s.resultState!=0&&s.resultState!=1||this.onImageRead(o)}if(this.onUniqueRead)for(let o of i)o.resultState==0&&this.onUniqueRead(o.barcodeText,this._cloneDecodeResults(o))}this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.intervalTime?this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this.intervalTime):this._loopReadVideo()}).catch(i=>{this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),ae._onLog&&ae._onLog(i.message||i),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},Math.max(this.intervalTime,1e3)),i.message=="platform error"||console.warn(i.message)})}_getVideoFrame(){if(!this.dce)return null;let e;if(this.captureAndDecodeInParallel){if(ae._onLog&&ae._onLog("Get frame in parallel."),this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",this._intervalGetVideoFrame),!this.dce.numberOfFramesInBuffer)return this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",0),null;e=this.dce.getFrameFromBuffer(),(i=>{if(!i)return;let o=i.timeSpent,s=this.array_getFrameTimeCost;for(;s.length>=5;)s.shift();s.push(o)})(e)}else ae._onLog&&ae._onLog("Get frame in serial."),this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),e=this.dce.getFrame();return e}_drawResults(e){if(!this.dce||this._bPauseScan||!this._drawingItemNamespace||!this._drawingItemNamespace.DT_Polygon)return;if(!this._dbrDrawingLayer){if(!this.dce.isOpen())return;this._dbrDrawingLayer=this.dce.getDrawingLayer(3)}const t=this._dbrDrawingLayer;e||(e=[]);let i=this._arrPolygons;for(let o=0;o<e.length;o++){let s,u=e[o].localizationResult;i[o]?(s=i[o],t.hasDrawingItem(s)||t.addDrawingItem(s),s.set("vertices",[{x:u.x1,y:u.y1},{x:u.x2,y:u.y2},{x:u.x3,y:u.y3},{x:u.x4,y:u.y4}])):(s=new this._drawingItemNamespace.DT_Polygon([{x:u.x1,y:u.y1},{x:u.x2,y:u.y2},{x:u.x3,y:u.y3},{x:u.x4,y:u.y4}]),t.addDrawingItem(s),i[o]=s)}for(let o=e.length;o<i.length;o++)t.removeDrawingItem(i[o]);t.renderAll()}async startScanning(e){if(!this.dce&&!this._imgSource)throw new Error("'imageSource' is not set. call 'setImageSource()' before 'startScanning()'.");if(this._tempSolutionStatus!="closed"||(this._tempSolutionStatus="opening",this._tempSolutionStatus!="opening"))return;let t=null;return this.dce&&(this.dce.isOpen()?(e&&this.dce.appendAndShowUI(),t=JSON.parse(JSON.stringify(this.dce.playCallbackInfo))):t=await this.dce.open(e),this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"close"}),this._dceControler.clearUserDisiredValue({property:"ifShowScanRegionLaser"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())),this._tempSolutionStatus=="opening"?(this._bPauseScan=!1,this.dce&&this.dce.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},0)),this._tempSolutionStatus="opened",this.keepAlive(),t):void 0}stopScanning(e){this.dce&&(this._drawResults(null),this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"close",[e]))),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._tempSolutionStatus="closed"}pauseScanning(e){if(e&&e.keepResultsHighlighted||this._drawResults(null),this._bPauseScan=!0,this.dce){if(this.dce.singleFrameMode)throw new Error("'pauseScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"stopFetchingLoop"))}}resumeScanning(){if(this._bPauseScan=!1,this.dce){if(this.dce.singleFrameMode)throw new Error("'resumeScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this.dce.startFetchingLoop(),this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"}),this._dceControler.clearUserDisiredValue({property:"ifShowScanRegionLaser"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())}}destroyContext(){if(ae._onLog&&ae._onLog("destroyContext()"),this.bDestroyed)return;this.bDestroyed=!0,(this.dce||this._tempSolutionStatus==="opening")&&this.stopScanning(),this.setImageSource(null);let e=ae._nextTaskID++;ae._taskCallbackMap.set(e,t=>{if(!t.success){let i=new Error(t.message);throw i.stack=t.stack+`
`+i.stack,i}}),ae._dbrWorker.postMessage({type:"destroyContext",id:e,instanceID:this._instanceID})}}ae._jsVersion="9.2.13",ae._jsEditVersion="20220810",ae._version=`loading...(JS ${ae._jsVersion}.${ae._jsEditVersion})`,ae._license=Ua,ae._sessionPassword=Va,ae.browserInfo=yt,ae._workerName=`dbr-${ae._jsVersion}.browser.worker.js`,ae._engineResourcePath=ja,ae._licenseServer=[],ae._deviceFriendlyName="",ae._isShowRelDecodeTimeInResults=!1,ae._bWasmDebug=!1,ae._bNeverShowDialog=!1,ae.__bUseFullFeature=!0,ae._nextTaskID=0,ae._taskCallbackMap=new Map,ae._pLoad=new class extends Promise{constructor(r){let e,t;super((i,o)=>{e=i,t=o}),this._s="pending",this.resolve=i=>{this.isPending&&(Zn(i)?this.task=i:(this._s="fulfilled",e(i)))},this.reject=i=>{this.isPending&&(this._s="rejected",t(i))},this.task=r}get status(){return this._s}get isPending(){return this._s==="pending"}get isFulfilled(){return this._s==="fulfilled"}get isRejected(){return this._s==="rejected"}get task(){return this._task}set task(r){let e;this._task=r,Zn(r)?e=r:typeof r=="function"&&(e=new Promise(r)),e&&(async()=>{try{const t=await e;r===this._task&&this.resolve(t)}catch(t){r===this._task&&this.reject(t)}})()}get isEmpty(){return this._task==null}},ae._lastErrorCode=0,ae._lastErrorString="",ae._setWarnnedEx=new Set,ae._defaultUIElementURL="@engineResourcePath/dbr.ui.html";var Ga={653:(r,e,t)=>{var i,o,s,u,g,B,_,m,D,F,T,I,k,U,K,X,te,ne,re,ue,Ae,v=v||{version:"5.2.1"};if(e.fabric=v,typeof document!="undefined"&&typeof window!="undefined")document instanceof(typeof HTMLDocument!="undefined"?HTMLDocument:Document)?v.document=document:v.document=document.implementation.createHTMLDocument(""),v.window=window;else{var ye=new(t(192)).JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;v.document=ye.document,v.jsdomImplForWrapper=t(898).implForWrapper,v.nodeCanvas=t(245).Canvas,v.window=ye,DOMParser=v.window.DOMParser}function be(h,x){var l=h.canvas,f=x.targetCanvas,n=f.getContext("2d");n.translate(0,f.height),n.scale(1,-1);var a=l.height-f.height;n.drawImage(l,0,a,f.width,f.height,0,0,f.width,f.height)}function je(h,x){var l=x.targetCanvas.getContext("2d"),f=x.destinationWidth,n=x.destinationHeight,a=f*n*4,c=new Uint8Array(this.imageBuffer,0,a),A=new Uint8ClampedArray(this.imageBuffer,0,a);h.readPixels(0,0,f,n,h.RGBA,h.UNSIGNED_BYTE,c);var E=new ImageData(A,f,n);l.putImageData(E,0,0)}v.isTouchSupported="ontouchstart"in v.window||"ontouchstart"in v.document||v.window&&v.window.navigator&&v.window.navigator.maxTouchPoints>0,v.isLikelyNode=typeof Buffer!="undefined"&&typeof window=="undefined",v.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],v.DPI=96,v.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",v.commaWsp="(?:\\s+,?\\s*|,\\s*)",v.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,v.reNonWord=/[ \n\.,;!\?\-]/,v.fontPaths={},v.iMatrix=[1,0,0,1,0,0],v.svgNS="http://www.w3.org/2000/svg",v.perfLimitSizeTotal=2097152,v.maxCacheSideLimit=4096,v.minCacheSideLimit=256,v.charWidthsCache={},v.textureSize=2048,v.disableStyleCopyPaste=!1,v.enableGLFiltering=!0,v.devicePixelRatio=v.window.devicePixelRatio||v.window.webkitDevicePixelRatio||v.window.mozDevicePixelRatio||1,v.browserShadowBlurConstant=1,v.arcToSegmentsCache={},v.boundsOfCurveCache={},v.cachesBoundsOfCurve=!0,v.forceGLPutImageData=!1,v.initFilterBackend=function(){return v.enableGLFiltering&&v.isWebglSupported&&v.isWebglSupported(v.textureSize)?(console.log("max texture size: "+v.maxTextureSize),new v.WebglFilterBackend({tileSize:v.textureSize})):v.Canvas2dFilterBackend?new v.Canvas2dFilterBackend:void 0},typeof document!="undefined"&&typeof window!="undefined"&&(window.fabric=v),function(){function h(l,f){if(this.__eventListeners[l]){var n=this.__eventListeners[l];f?n[n.indexOf(f)]=!1:v.util.array.fill(n,!1)}}function x(l,f){var n=function(){f.apply(this,arguments),this.off(l,n)}.bind(this);this.on(l,n)}v.Observable={fire:function(l,f){if(!this.__eventListeners)return this;var n=this.__eventListeners[l];if(!n)return this;for(var a=0,c=n.length;a<c;a++)n[a]&&n[a].call(this,f||{});return this.__eventListeners[l]=n.filter(function(A){return A!==!1}),this},on:function(l,f){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var n in l)this.on(n,l[n]);else this.__eventListeners[l]||(this.__eventListeners[l]=[]),this.__eventListeners[l].push(f);return this},once:function(l,f){if(arguments.length===1)for(var n in l)x.call(this,n,l[n]);else x.call(this,l,f);return this},off:function(l,f){if(!this.__eventListeners)return this;if(arguments.length===0)for(l in this.__eventListeners)h.call(this,l);else if(arguments.length===1&&typeof arguments[0]=="object")for(var n in l)h.call(this,n,l[n]);else h.call(this,l,f);return this}}}(),v.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var h=0,x=arguments.length;h<x;h++)this._onObjectAdded(arguments[h]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(h,x,l){var f=this._objects;return l?f[x]=h:f.splice(x,0,h),this._onObjectAdded&&this._onObjectAdded(h),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var h,x=this._objects,l=!1,f=0,n=arguments.length;f<n;f++)(h=x.indexOf(arguments[f]))!==-1&&(l=!0,x.splice(h,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[f]));return this.renderOnAddRemove&&l&&this.requestRenderAll(),this},forEachObject:function(h,x){for(var l=this.getObjects(),f=0,n=l.length;f<n;f++)h.call(x,l[f],f,l);return this},getObjects:function(h){return h===void 0?this._objects.concat():this._objects.filter(function(x){return x.type===h})},item:function(h){return this._objects[h]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(h,x){return this._objects.indexOf(h)>-1||!!x&&this._objects.some(function(l){return typeof l.contains=="function"&&l.contains(h,!0)})},complexity:function(){return this._objects.reduce(function(h,x){return h+(x.complexity?x.complexity():0)},0)}},v.CommonMethods={_setOptions:function(h){for(var x in h)this.set(x,h[x])},_initGradient:function(h,x){!h||!h.colorStops||h instanceof v.Gradient||this.set(x,new v.Gradient(h))},_initPattern:function(h,x,l){!h||!h.source||h instanceof v.Pattern?l&&l():this.set(x,new v.Pattern(h,l))},_setObject:function(h){for(var x in h)this._set(x,h[x])},set:function(h,x){return typeof h=="object"?this._setObject(h):this._set(h,x),this},_set:function(h,x){this[h]=x},toggle:function(h){var x=this.get(h);return typeof x=="boolean"&&this.set(h,!x),this},get:function(h){return this[h]}},i=e,o=Math.sqrt,s=Math.atan2,u=Math.pow,g=Math.PI/180,B=Math.PI/2,v.util={cos:function(h){if(h===0)return 1;switch(h<0&&(h=-h),h/B){case 1:case 3:return 0;case 2:return-1}return Math.cos(h)},sin:function(h){if(h===0)return 0;var x=1;switch(h<0&&(x=-1),h/B){case 1:return x;case 2:return 0;case 3:return-x}return Math.sin(h)},removeFromArray:function(h,x){var l=h.indexOf(x);return l!==-1&&h.splice(l,1),h},getRandomInt:function(h,x){return Math.floor(Math.random()*(x-h+1))+h},degreesToRadians:function(h){return h*g},radiansToDegrees:function(h){return h/g},rotatePoint:function(h,x,l){var f=new v.Point(h.x-x.x,h.y-x.y),n=v.util.rotateVector(f,l);return new v.Point(n.x,n.y).addEquals(x)},rotateVector:function(h,x){var l=v.util.sin(x),f=v.util.cos(x);return{x:h.x*f-h.y*l,y:h.x*l+h.y*f}},createVector:function(h,x){return new v.Point(x.x-h.x,x.y-h.y)},calcAngleBetweenVectors:function(h,x){return Math.acos((h.x*x.x+h.y*x.y)/(Math.hypot(h.x,h.y)*Math.hypot(x.x,x.y)))},getHatVector:function(h){return new v.Point(h.x,h.y).multiply(1/Math.hypot(h.x,h.y))},getBisector:function(h,x,l){var f=v.util.createVector(h,x),n=v.util.createVector(h,l),a=v.util.calcAngleBetweenVectors(f,n),c=a*(v.util.calcAngleBetweenVectors(v.util.rotateVector(f,a),n)===0?1:-1)/2;return{vector:v.util.getHatVector(v.util.rotateVector(f,c)),angle:a}},projectStrokeOnPoints:function(h,x,l){var f=[],n=x.strokeWidth/2,a=x.strokeUniform?new v.Point(1/x.scaleX,1/x.scaleY):new v.Point(1,1),c=function(A){var E=n/Math.hypot(A.x,A.y);return new v.Point(A.x*E*a.x,A.y*E*a.y)};return h.length<=1||h.forEach(function(A,E){var d,p,C=new v.Point(A.x,A.y);E===0?(p=h[E+1],d=l?c(v.util.createVector(p,C)).addEquals(C):h[h.length-1]):E===h.length-1?(d=h[E-1],p=l?c(v.util.createVector(d,C)).addEquals(C):h[0]):(d=h[E-1],p=h[E+1]);var y,S,w=v.util.getBisector(C,d,p),b=w.vector,O=w.angle;if(x.strokeLineJoin==="miter"&&(y=-n/Math.sin(O/2),S=new v.Point(b.x*y*a.x,b.y*y*a.y),Math.hypot(S.x,S.y)/n<=x.strokeMiterLimit))return f.push(C.add(S)),void f.push(C.subtract(S));y=-n*Math.SQRT2,S=new v.Point(b.x*y*a.x,b.y*y*a.y),f.push(C.add(S)),f.push(C.subtract(S))}),f},transformPoint:function(h,x,l){return l?new v.Point(x[0]*h.x+x[2]*h.y,x[1]*h.x+x[3]*h.y):new v.Point(x[0]*h.x+x[2]*h.y+x[4],x[1]*h.x+x[3]*h.y+x[5])},makeBoundingBoxFromPoints:function(h,x){if(x)for(var l=0;l<h.length;l++)h[l]=v.util.transformPoint(h[l],x);var f=[h[0].x,h[1].x,h[2].x,h[3].x],n=v.util.array.min(f),a=v.util.array.max(f)-n,c=[h[0].y,h[1].y,h[2].y,h[3].y],A=v.util.array.min(c);return{left:n,top:A,width:a,height:v.util.array.max(c)-A}},invertTransform:function(h){var x=1/(h[0]*h[3]-h[1]*h[2]),l=[x*h[3],-x*h[1],-x*h[2],x*h[0]],f=v.util.transformPoint({x:h[4],y:h[5]},l,!0);return l[4]=-f.x,l[5]=-f.y,l},toFixed:function(h,x){return parseFloat(Number(h).toFixed(x))},parseUnit:function(h,x){var l=/\D{0,2}$/.exec(h),f=parseFloat(h);switch(x||(x=v.Text.DEFAULT_SVG_FONT_SIZE),l[0]){case"mm":return f*v.DPI/25.4;case"cm":return f*v.DPI/2.54;case"in":return f*v.DPI;case"pt":return f*v.DPI/72;case"pc":return f*v.DPI/72*12;case"em":return f*x;default:return f}},falseFunction:function(){return!1},getKlass:function(h,x){return h=v.util.string.camelize(h.charAt(0).toUpperCase()+h.slice(1)),v.util.resolveNamespace(x)[h]},getSvgAttributes:function(h){var x=["instantiated_by_use","style","id","class"];switch(h){case"linearGradient":x=x.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":x=x.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":x=x.concat(["offset","stop-color","stop-opacity"])}return x},resolveNamespace:function(h){if(!h)return v;var x,l=h.split("."),f=l.length,n=i||v.window;for(x=0;x<f;++x)n=n[l[x]];return n},loadImage:function(h,x,l,f){if(h){var n=v.util.createImage(),a=function(){x&&x.call(l,n,!1),n=n.onload=n.onerror=null};n.onload=a,n.onerror=function(){v.log("Error loading "+n.src),x&&x.call(l,null,!0),n=n.onload=n.onerror=null},h.indexOf("data")!==0&&f!=null&&(n.crossOrigin=f),h.substring(0,14)==="data:image/svg"&&(n.onload=null,v.util.loadImageInDom(n,a)),n.src=h}else x&&x.call(l,h)},loadImageInDom:function(h,x){var l=v.document.createElement("div");l.style.width=l.style.height="1px",l.style.left=l.style.top="-100%",l.style.position="absolute",l.appendChild(h),v.document.querySelector("body").appendChild(l),h.onload=function(){x(),l.parentNode.removeChild(l),l=null}},enlivenObjects:function(h,x,l,f){var n=[],a=0,c=(h=h||[]).length;function A(){++a===c&&x&&x(n.filter(function(E){return E}))}c?h.forEach(function(E,d){E&&E.type?v.util.getKlass(E.type,l).fromObject(E,function(p,C){C||(n[d]=p),f&&f(E,p,C),A()}):A()}):x&&x(n)},enlivenObjectEnlivables:function(h,x,l){var f=v.Object.ENLIVEN_PROPS.filter(function(n){return!!h[n]});v.util.enlivenObjects(f.map(function(n){return h[n]}),function(n){var a={};f.forEach(function(c,A){a[c]=n[A],x&&(x[c]=n[A])}),l&&l(a)})},enlivenPatterns:function(h,x){function l(){++n===a&&x&&x(f)}var f=[],n=0,a=(h=h||[]).length;a?h.forEach(function(c,A){c&&c.source?new v.Pattern(c,function(E){f[A]=E,l()}):(f[A]=c,l())}):x&&x(f)},groupSVGElements:function(h,x,l){var f;return h&&h.length===1?h[0]:(x&&(x.width&&x.height?x.centerPoint={x:x.width/2,y:x.height/2}:(delete x.width,delete x.height)),f=new v.Group(h,x),l!==void 0&&(f.sourcePath=l),f)},populateWithProperties:function(h,x,l){if(l&&Array.isArray(l))for(var f=0,n=l.length;f<n;f++)l[f]in h&&(x[l[f]]=h[l[f]])},createCanvasElement:function(){return v.document.createElement("canvas")},copyCanvasElement:function(h){var x=v.util.createCanvasElement();return x.width=h.width,x.height=h.height,x.getContext("2d").drawImage(h,0,0),x},toDataURL:function(h,x,l){return h.toDataURL("image/"+x,l)},createImage:function(){return v.document.createElement("img")},multiplyTransformMatrices:function(h,x,l){return[h[0]*x[0]+h[2]*x[1],h[1]*x[0]+h[3]*x[1],h[0]*x[2]+h[2]*x[3],h[1]*x[2]+h[3]*x[3],l?0:h[0]*x[4]+h[2]*x[5]+h[4],l?0:h[1]*x[4]+h[3]*x[5]+h[5]]},qrDecompose:function(h){var x=s(h[1],h[0]),l=u(h[0],2)+u(h[1],2),f=o(l),n=(h[0]*h[3]-h[2]*h[1])/f,a=s(h[0]*h[2]+h[1]*h[3],l);return{angle:x/g,scaleX:f,scaleY:n,skewX:a/g,skewY:0,translateX:h[4],translateY:h[5]}},calcRotateMatrix:function(h){if(!h.angle)return v.iMatrix.concat();var x=v.util.degreesToRadians(h.angle),l=v.util.cos(x),f=v.util.sin(x);return[l,f,-f,l,0,0]},calcDimensionsMatrix:function(h){var x=h.scaleX===void 0?1:h.scaleX,l=h.scaleY===void 0?1:h.scaleY,f=[h.flipX?-x:x,0,0,h.flipY?-l:l,0,0],n=v.util.multiplyTransformMatrices,a=v.util.degreesToRadians;return h.skewX&&(f=n(f,[1,0,Math.tan(a(h.skewX)),1],!0)),h.skewY&&(f=n(f,[1,Math.tan(a(h.skewY)),0,1],!0)),f},composeMatrix:function(h){var x=[1,0,0,1,h.translateX||0,h.translateY||0],l=v.util.multiplyTransformMatrices;return h.angle&&(x=l(x,v.util.calcRotateMatrix(h))),(h.scaleX!==1||h.scaleY!==1||h.skewX||h.skewY||h.flipX||h.flipY)&&(x=l(x,v.util.calcDimensionsMatrix(h))),x},resetObjectTransform:function(h){h.scaleX=1,h.scaleY=1,h.skewX=0,h.skewY=0,h.flipX=!1,h.flipY=!1,h.rotate(0)},saveObjectTransform:function(h){return{scaleX:h.scaleX,scaleY:h.scaleY,skewX:h.skewX,skewY:h.skewY,angle:h.angle,left:h.left,flipX:h.flipX,flipY:h.flipY,top:h.top}},isTransparent:function(h,x,l,f){f>0&&(x>f?x-=f:x=0,l>f?l-=f:l=0);var n,a=!0,c=h.getImageData(x,l,2*f||1,2*f||1),A=c.data.length;for(n=3;n<A&&(a=c.data[n]<=0)!=0;n+=4);return c=null,a},parsePreserveAspectRatioAttribute:function(h){var x,l="meet",f=h.split(" ");return f&&f.length&&((l=f.pop())!=="meet"&&l!=="slice"?(x=l,l="meet"):f.length&&(x=f.pop())),{meetOrSlice:l,alignX:x!=="none"?x.slice(1,4):"none",alignY:x!=="none"?x.slice(5,8):"none"}},clearFabricFontCache:function(h){(h=(h||"").toLowerCase())?v.charWidthsCache[h]&&delete v.charWidthsCache[h]:v.charWidthsCache={}},limitDimsByArea:function(h,x){var l=Math.sqrt(x*h),f=Math.floor(x/l);return{x:Math.floor(l),y:f}},capValue:function(h,x,l){return Math.max(h,Math.min(x,l))},findScaleToFit:function(h,x){return Math.min(x.width/h.width,x.height/h.height)},findScaleToCover:function(h,x){return Math.max(x.width/h.width,x.height/h.height)},matrixToSVG:function(h){return"matrix("+h.map(function(x){return v.util.toFixed(x,v.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(h,x){var l=v.util.invertTransform(x),f=v.util.multiplyTransformMatrices(l,h.calcOwnMatrix());v.util.applyTransformToObject(h,f)},addTransformToObject:function(h,x){v.util.applyTransformToObject(h,v.util.multiplyTransformMatrices(x,h.calcOwnMatrix()))},applyTransformToObject:function(h,x){var l=v.util.qrDecompose(x),f=new v.Point(l.translateX,l.translateY);h.flipX=!1,h.flipY=!1,h.set("scaleX",l.scaleX),h.set("scaleY",l.scaleY),h.skewX=l.skewX,h.skewY=l.skewY,h.angle=l.angle,h.setPositionByOrigin(f,"center","center")},sizeAfterTransform:function(h,x,l){var f=h/2,n=x/2,a=[{x:-f,y:-n},{x:f,y:-n},{x:-f,y:n},{x:f,y:n}],c=v.util.calcDimensionsMatrix(l),A=v.util.makeBoundingBoxFromPoints(a,c);return{x:A.width,y:A.height}},mergeClipPaths:function(h,x){var l=h,f=x;l.inverted&&!f.inverted&&(l=x,f=h),v.util.applyTransformToObject(f,v.util.multiplyTransformMatrices(v.util.invertTransform(l.calcTransformMatrix()),f.calcTransformMatrix()));var n=l.inverted&&f.inverted;return n&&(l.inverted=f.inverted=!1),new v.Group([l],{clipPath:f,inverted:n})}},function(){var h=Array.prototype.join,x={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},l={m:"l",M:"L"};function f(S,w,b,O,N,j,Z,Y,W,P,R){var V=v.util.cos(S),J=v.util.sin(S),q=v.util.cos(w),L=v.util.sin(w),M=b*N*q-O*j*L+Z,G=O*N*q+b*j*L+Y;return["C",P+W*(-b*N*J-O*j*V),R+W*(-O*N*J+b*j*V),M+W*(b*N*L+O*j*q),G+W*(O*N*L-b*j*q),M,G]}function n(S,w,b,O){var N=Math.atan2(w,S),j=Math.atan2(O,b);return j>=N?j-N:2*Math.PI-(N-j)}function a(S,w,b){for(var O=b[1],N=b[2],j=b[3],Z=b[4],Y=b[5],W=function(V,J,q,L,M,G,ee){var z=Math.PI,ie=ee*z/180,de=v.util.sin(ie),he=v.util.cos(ie),se=0,Ee=0,ce=-he*V*.5-de*J*.5,pe=-he*J*.5+de*V*.5,_e=(q=Math.abs(q))*q,Be=(L=Math.abs(L))*L,Te=pe*pe,Re=ce*ce,tt=_e*Be-_e*Te-Be*Re,lt=0;if(tt<0){var Ft=Math.sqrt(1-tt/(_e*Be));q*=Ft,L*=Ft}else lt=(M===G?-1:1)*Math.sqrt(tt/(_e*Te+Be*Re));var Ne=lt*q*pe/L,rt=-lt*L*ce/q,ft=he*Ne-de*rt+.5*V,Lt=de*Ne+he*rt+.5*J,St=n(1,0,(ce-Ne)/q,(pe-rt)/L),It=n((ce-Ne)/q,(pe-rt)/L,(-ce-Ne)/q,(-pe-rt)/L);G===0&&It>0?It-=2*z:G===1&&It<0&&(It+=2*z);for(var yr=Math.ceil(Math.abs(It/z*2)),rr=[],Yt=It/yr,zr=8/3*Math.sin(Yt/4)*Math.sin(Yt/4)/Math.sin(Yt/2),hr=St+Yt,zt=0;zt<yr;zt++)rr[zt]=f(St,hr,he,de,q,L,ft,Lt,zr,se,Ee),se=rr[zt][5],Ee=rr[zt][6],St=hr,hr+=Yt;return rr}(b[6]-S,b[7]-w,O,N,Z,Y,j),P=0,R=W.length;P<R;P++)W[P][1]+=S,W[P][2]+=w,W[P][3]+=S,W[P][4]+=w,W[P][5]+=S,W[P][6]+=w;return W}function c(S,w,b,O){return Math.sqrt((b-S)*(b-S)+(O-w)*(O-w))}function A(S,w,b,O,N,j,Z,Y){return function(W){var P,R=(P=W)*P*P,V=function(L){return 3*L*L*(1-L)}(W),J=function(L){return 3*L*(1-L)*(1-L)}(W),q=function(L){return(1-L)*(1-L)*(1-L)}(W);return{x:Z*R+N*V+b*J+S*q,y:Y*R+j*V+O*J+w*q}}}function E(S,w,b,O,N,j,Z,Y){return function(W){var P=1-W,R=3*P*P*(b-S)+6*P*W*(N-b)+3*W*W*(Z-N),V=3*P*P*(O-w)+6*P*W*(j-O)+3*W*W*(Y-j);return Math.atan2(V,R)}}function d(S,w,b,O,N,j){return function(Z){var Y,W=(Y=Z)*Y,P=function(V){return 2*V*(1-V)}(Z),R=function(V){return(1-V)*(1-V)}(Z);return{x:N*W+b*P+S*R,y:j*W+O*P+w*R}}}function p(S,w,b,O,N,j){return function(Z){var Y=1-Z,W=2*Y*(b-S)+2*Z*(N-b),P=2*Y*(O-w)+2*Z*(j-O);return Math.atan2(P,W)}}function C(S,w,b){var O,N,j={x:w,y:b},Z=0;for(N=1;N<=100;N+=1)O=S(N/100),Z+=c(j.x,j.y,O.x,O.y),j=O;return Z}function y(S){for(var w,b,O,N,j=0,Z=S.length,Y=0,W=0,P=0,R=0,V=[],J=0;J<Z;J++){switch(O={x:Y,y:W,command:(w=S[J])[0]},w[0]){case"M":O.length=0,P=Y=w[1],R=W=w[2];break;case"L":O.length=c(Y,W,w[1],w[2]),Y=w[1],W=w[2];break;case"C":b=A(Y,W,w[1],w[2],w[3],w[4],w[5],w[6]),N=E(Y,W,w[1],w[2],w[3],w[4],w[5],w[6]),O.iterator=b,O.angleFinder=N,O.length=C(b,Y,W),Y=w[5],W=w[6];break;case"Q":b=d(Y,W,w[1],w[2],w[3],w[4]),N=p(Y,W,w[1],w[2],w[3],w[4]),O.iterator=b,O.angleFinder=N,O.length=C(b,Y,W),Y=w[3],W=w[4];break;case"Z":case"z":O.destX=P,O.destY=R,O.length=c(Y,W,P,R),Y=P,W=R}j+=O.length,V.push(O)}return V.push({length:j,x:Y,y:W}),V}v.util.joinPath=function(S){return S.map(function(w){return w.join(" ")}).join(" ")},v.util.parsePath=function(S){var w,b,O,N,j,Z=[],Y=[],W=v.rePathCommand,P="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",R="("+P+")"+v.commaWsp,V="([01])"+v.commaWsp+"?",J=new RegExp(R+"?"+R+"?"+R+V+V+R+"?("+P+")","g");if(!S||!S.match)return Z;for(var q,L=0,M=(j=S.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;L<M;L++){N=(w=j[L]).slice(1).trim(),Y.length=0;var G=w.charAt(0);if(q=[G],G.toLowerCase()==="a")for(var ee;ee=J.exec(N);)for(var z=1;z<ee.length;z++)Y.push(ee[z]);else for(;O=W.exec(N);)Y.push(O[0]);z=0;for(var ie=Y.length;z<ie;z++)b=parseFloat(Y[z]),isNaN(b)||q.push(b);var de=x[G.toLowerCase()],he=l[G]||G;if(q.length-1>de)for(var se=1,Ee=q.length;se<Ee;se+=de)Z.push([G].concat(q.slice(se,se+de))),G=he;else Z.push(q)}return Z},v.util.makePathSimpler=function(S){var w,b,O,N,j,Z,Y=0,W=0,P=S.length,R=0,V=0,J=[];for(b=0;b<P;++b){switch(O=!1,(w=S[b].slice(0))[0]){case"l":w[0]="L",w[1]+=Y,w[2]+=W;case"L":Y=w[1],W=w[2];break;case"h":w[1]+=Y;case"H":w[0]="L",w[2]=W,Y=w[1];break;case"v":w[1]+=W;case"V":w[0]="L",W=w[1],w[1]=Y,w[2]=W;break;case"m":w[0]="M",w[1]+=Y,w[2]+=W;case"M":Y=w[1],W=w[2],R=w[1],V=w[2];break;case"c":w[0]="C",w[1]+=Y,w[2]+=W,w[3]+=Y,w[4]+=W,w[5]+=Y,w[6]+=W;case"C":j=w[3],Z=w[4],Y=w[5],W=w[6];break;case"s":w[0]="S",w[1]+=Y,w[2]+=W,w[3]+=Y,w[4]+=W;case"S":N==="C"?(j=2*Y-j,Z=2*W-Z):(j=Y,Z=W),Y=w[3],W=w[4],w[0]="C",w[5]=w[3],w[6]=w[4],w[3]=w[1],w[4]=w[2],w[1]=j,w[2]=Z,j=w[3],Z=w[4];break;case"q":w[0]="Q",w[1]+=Y,w[2]+=W,w[3]+=Y,w[4]+=W;case"Q":j=w[1],Z=w[2],Y=w[3],W=w[4];break;case"t":w[0]="T",w[1]+=Y,w[2]+=W;case"T":N==="Q"?(j=2*Y-j,Z=2*W-Z):(j=Y,Z=W),w[0]="Q",Y=w[1],W=w[2],w[1]=j,w[2]=Z,w[3]=Y,w[4]=W;break;case"a":w[0]="A",w[6]+=Y,w[7]+=W;case"A":O=!0,J=J.concat(a(Y,W,w)),Y=w[6],W=w[7];break;case"z":case"Z":Y=R,W=V}O||J.push(w),N=w[0]}return J},v.util.getSmoothPathFromPoints=function(S,w){var b,O=[],N=new v.Point(S[0].x,S[0].y),j=new v.Point(S[1].x,S[1].y),Z=S.length,Y=1,W=0,P=Z>2;for(w=w||0,P&&(Y=S[2].x<j.x?-1:S[2].x===j.x?0:1,W=S[2].y<j.y?-1:S[2].y===j.y?0:1),O.push(["M",N.x-Y*w,N.y-W*w]),b=1;b<Z;b++){if(!N.eq(j)){var R=N.midPointFrom(j);O.push(["Q",N.x,N.y,R.x,R.y])}N=S[b],b+1<S.length&&(j=S[b+1])}return P&&(Y=N.x>S[b-2].x?1:N.x===S[b-2].x?0:-1,W=N.y>S[b-2].y?1:N.y===S[b-2].y?0:-1),O.push(["L",N.x+Y*w,N.y+W*w]),O},v.util.getPathSegmentsInfo=y,v.util.getBoundsOfCurve=function(S,w,b,O,N,j,Z,Y){var W;if(v.cachesBoundsOfCurve&&(W=h.call(arguments),v.boundsOfCurveCache[W]))return v.boundsOfCurveCache[W];var P,R,V,J,q,L,M,G,ee=Math.sqrt,z=Math.min,ie=Math.max,de=Math.abs,he=[],se=[[],[]];R=6*S-12*b+6*N,P=-3*S+9*b-9*N+3*Z,V=3*b-3*S;for(var Ee=0;Ee<2;++Ee)if(Ee>0&&(R=6*w-12*O+6*j,P=-3*w+9*O-9*j+3*Y,V=3*O-3*w),de(P)<1e-12){if(de(R)<1e-12)continue;0<(J=-V/R)&&J<1&&he.push(J)}else(M=R*R-4*V*P)<0||(0<(q=(-R+(G=ee(M)))/(2*P))&&q<1&&he.push(q),0<(L=(-R-G)/(2*P))&&L<1&&he.push(L));for(var ce,pe,_e,Be=he.length,Te=Be;Be--;)ce=(_e=1-(J=he[Be]))*_e*_e*S+3*_e*_e*J*b+3*_e*J*J*N+J*J*J*Z,se[0][Be]=ce,pe=_e*_e*_e*w+3*_e*_e*J*O+3*_e*J*J*j+J*J*J*Y,se[1][Be]=pe;se[0][Te]=S,se[1][Te]=w,se[0][Te+1]=Z,se[1][Te+1]=Y;var Re=[{x:z.apply(null,se[0]),y:z.apply(null,se[1])},{x:ie.apply(null,se[0]),y:ie.apply(null,se[1])}];return v.cachesBoundsOfCurve&&(v.boundsOfCurveCache[W]=Re),Re},v.util.getPointOnPath=function(S,w,b){b||(b=y(S));for(var O=0;w-b[O].length>0&&O<b.length-2;)w-=b[O].length,O++;var N,j=b[O],Z=w/j.length,Y=j.command,W=S[O];switch(Y){case"M":return{x:j.x,y:j.y,angle:0};case"Z":case"z":return(N=new v.Point(j.x,j.y).lerp(new v.Point(j.destX,j.destY),Z)).angle=Math.atan2(j.destY-j.y,j.destX-j.x),N;case"L":return(N=new v.Point(j.x,j.y).lerp(new v.Point(W[1],W[2]),Z)).angle=Math.atan2(W[2]-j.y,W[1]-j.x),N;case"C":case"Q":return function(P,R){for(var V,J,q,L=0,M=0,G=P.iterator,ee={x:P.x,y:P.y},z=.01,ie=P.angleFinder;M<R&&z>1e-4;)V=G(L),q=L,(J=c(ee.x,ee.y,V.x,V.y))+M>R?(L-=z,z/=2):(ee=V,L+=z,M+=J);return V.angle=ie(q),V}(j,w)}},v.util.transformPath=function(S,w,b){return b&&(w=v.util.multiplyTransformMatrices(w,[1,0,0,1,-b.x,-b.y])),S.map(function(O){for(var N=O.slice(0),j={},Z=1;Z<O.length-1;Z+=2)j.x=O[Z],j.y=O[Z+1],j=v.util.transformPoint(j,w),N[Z]=j.x,N[Z+1]=j.y;return N})}}(),function(){var h=Array.prototype.slice;function x(l,f,n){if(l&&l.length!==0){var a=l.length-1,c=f?l[a][f]:l[a];if(f)for(;a--;)n(l[a][f],c)&&(c=l[a][f]);else for(;a--;)n(l[a],c)&&(c=l[a]);return c}}v.util.array={fill:function(l,f){for(var n=l.length;n--;)l[n]=f;return l},invoke:function(l,f){for(var n=h.call(arguments,2),a=[],c=0,A=l.length;c<A;c++)a[c]=n.length?l[c][f].apply(l[c],n):l[c][f].call(l[c]);return a},min:function(l,f){return x(l,f,function(n,a){return n<a})},max:function(l,f){return x(l,f,function(n,a){return n>=a})}}}(),function(){function h(x,l,f){if(f)if(!v.isLikelyNode&&l instanceof Element)x=l;else if(l instanceof Array){x=[];for(var n=0,a=l.length;n<a;n++)x[n]=h({},l[n],f)}else if(l&&typeof l=="object")for(var c in l)c==="canvas"||c==="group"?x[c]=null:l.hasOwnProperty(c)&&(x[c]=h({},l[c],f));else x=l;else for(var c in l)x[c]=l[c];return x}v.util.object={extend:h,clone:function(x,l){return h({},x,l)}},v.util.object.extend(v.util,v.Observable)}(),function(){function h(x,l){var f=x.charCodeAt(l);if(isNaN(f))return"";if(f<55296||f>57343)return x.charAt(l);if(55296<=f&&f<=56319){if(x.length<=l+1)throw"High surrogate without following low surrogate";var n=x.charCodeAt(l+1);if(56320>n||n>57343)throw"High surrogate without following low surrogate";return x.charAt(l)+x.charAt(l+1)}if(l===0)throw"Low surrogate without preceding high surrogate";var a=x.charCodeAt(l-1);if(55296>a||a>56319)throw"Low surrogate without preceding high surrogate";return!1}v.util.string={camelize:function(x){return x.replace(/-+(.)?/g,function(l,f){return f?f.toUpperCase():""})},capitalize:function(x,l){return x.charAt(0).toUpperCase()+(l?x.slice(1):x.slice(1).toLowerCase())},escapeXml:function(x){return x.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(x){var l,f=0,n=[];for(f=0;f<x.length;f++)(l=h(x,f))!==!1&&n.push(l);return n}}}(),function(){var h=Array.prototype.slice,x=function(){},l=function(){for(var c in{toString:1})if(c==="toString")return!1;return!0}(),f=function(c,A,E){for(var d in A)d in c.prototype&&typeof c.prototype[d]=="function"&&(A[d]+"").indexOf("callSuper")>-1?c.prototype[d]=function(p){return function(){var C=this.constructor.superclass;this.constructor.superclass=E;var y=A[p].apply(this,arguments);if(this.constructor.superclass=C,p!=="initialize")return y}}(d):c.prototype[d]=A[d],l&&(A.toString!==Object.prototype.toString&&(c.prototype.toString=A.toString),A.valueOf!==Object.prototype.valueOf&&(c.prototype.valueOf=A.valueOf))};function n(){}function a(c){for(var A=null,E=this;E.constructor.superclass;){var d=E.constructor.superclass.prototype[c];if(E[c]!==d){A=d;break}E=E.constructor.superclass.prototype}return A?arguments.length>1?A.apply(this,h.call(arguments,1)):A.call(this):console.log("tried to callSuper "+c+", method not found in prototype chain",this)}v.util.createClass=function(){var c=null,A=h.call(arguments,0);function E(){this.initialize.apply(this,arguments)}typeof A[0]=="function"&&(c=A.shift()),E.superclass=c,E.subclasses=[],c&&(n.prototype=c.prototype,E.prototype=new n,c.subclasses.push(E));for(var d=0,p=A.length;d<p;d++)f(E,A[d],c);return E.prototype.initialize||(E.prototype.initialize=x),E.prototype.constructor=E,E.prototype.callSuper=a,E}}(),_=!!v.document.createElement("div").attachEvent,m=["touchstart","touchmove","touchend"],v.util.addListener=function(h,x,l,f){h&&h.addEventListener(x,l,!_&&f)},v.util.removeListener=function(h,x,l,f){h&&h.removeEventListener(x,l,!_&&f)},v.util.getPointer=function(h){var x=h.target,l=v.util.getScrollLeftTop(x),f=function(n){var a=n.changedTouches;return a&&a[0]?a[0]:n}(h);return{x:f.clientX+l.left,y:f.clientY+l.top}},v.util.isTouchEvent=function(h){return m.indexOf(h.type)>-1||h.pointerType==="touch"},F=typeof(D=v.document.createElement("div")).style.opacity=="string",T=typeof D.style.filter=="string",I=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,k=function(h){return h},F?k=function(h,x){return h.style.opacity=x,h}:T&&(k=function(h,x){var l=h.style;return h.currentStyle&&!h.currentStyle.hasLayout&&(l.zoom=1),I.test(l.filter)?(x=x>=.9999?"":"alpha(opacity="+100*x+")",l.filter=l.filter.replace(I,x)):l.filter+=" alpha(opacity="+100*x+")",h}),v.util.setStyle=function(h,x){var l=h.style;if(!l)return h;if(typeof x=="string")return h.style.cssText+=";"+x,x.indexOf("opacity")>-1?k(h,x.match(/opacity:\s*(\d?\.?\d*)/)[1]):h;for(var f in x)f==="opacity"?k(h,x[f]):l[f==="float"||f==="cssFloat"?l.styleFloat===void 0?"cssFloat":"styleFloat":f]=x[f];return h},function(){var h,x,l,f,n=Array.prototype.slice,a=function(E){return n.call(E,0)};try{h=a(v.document.childNodes)instanceof Array}catch{}function c(E,d){var p=v.document.createElement(E);for(var C in d)C==="class"?p.className=d[C]:C==="for"?p.htmlFor=d[C]:p.setAttribute(C,d[C]);return p}function A(E){for(var d=0,p=0,C=v.document.documentElement,y=v.document.body||{scrollLeft:0,scrollTop:0};E&&(E.parentNode||E.host)&&((E=E.parentNode||E.host)===v.document?(d=y.scrollLeft||C.scrollLeft||0,p=y.scrollTop||C.scrollTop||0):(d+=E.scrollLeft||0,p+=E.scrollTop||0),E.nodeType!==1||E.style.position!=="fixed"););return{left:d,top:p}}h||(a=function(E){for(var d=new Array(E.length),p=E.length;p--;)d[p]=E[p];return d}),x=v.document.defaultView&&v.document.defaultView.getComputedStyle?function(E,d){var p=v.document.defaultView.getComputedStyle(E,null);return p?p[d]:void 0}:function(E,d){var p=E.style[d];return!p&&E.currentStyle&&(p=E.currentStyle[d]),p},l=v.document.documentElement.style,f="userSelect"in l?"userSelect":"MozUserSelect"in l?"MozUserSelect":"WebkitUserSelect"in l?"WebkitUserSelect":"KhtmlUserSelect"in l?"KhtmlUserSelect":"",v.util.makeElementUnselectable=function(E){return E.onselectstart!==void 0&&(E.onselectstart=v.util.falseFunction),f?E.style[f]="none":typeof E.unselectable=="string"&&(E.unselectable="on"),E},v.util.makeElementSelectable=function(E){return E.onselectstart!==void 0&&(E.onselectstart=null),f?E.style[f]="":typeof E.unselectable=="string"&&(E.unselectable=""),E},v.util.setImageSmoothing=function(E,d){E.imageSmoothingEnabled=E.imageSmoothingEnabled||E.webkitImageSmoothingEnabled||E.mozImageSmoothingEnabled||E.msImageSmoothingEnabled||E.oImageSmoothingEnabled,E.imageSmoothingEnabled=d},v.util.getById=function(E){return typeof E=="string"?v.document.getElementById(E):E},v.util.toArray=a,v.util.addClass=function(E,d){E&&(" "+E.className+" ").indexOf(" "+d+" ")===-1&&(E.className+=(E.className?" ":"")+d)},v.util.makeElement=c,v.util.wrapElement=function(E,d,p){return typeof d=="string"&&(d=c(d,p)),E.parentNode&&E.parentNode.replaceChild(d,E),d.appendChild(E),d},v.util.getScrollLeftTop=A,v.util.getElementOffset=function(E){var d,p,C=E&&E.ownerDocument,y={left:0,top:0},S={left:0,top:0},w={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!C)return S;for(var b in w)S[w[b]]+=parseInt(x(E,b),10)||0;return d=C.documentElement,E.getBoundingClientRect!==void 0&&(y=E.getBoundingClientRect()),p=A(E),{left:y.left+p.left-(d.clientLeft||0)+S.left,top:y.top+p.top-(d.clientTop||0)+S.top}},v.util.getNodeCanvas=function(E){var d=v.jsdomImplForWrapper(E);return d._canvas||d._image},v.util.cleanUpJsdomNode=function(E){if(v.isLikelyNode){var d=v.jsdomImplForWrapper(E);d&&(d._image=null,d._canvas=null,d._currentSrc=null,d._attributes=null,d._classList=null)}}}(),function(){function h(){}v.util.request=function(x,l){l||(l={});var f=l.method?l.method.toUpperCase():"GET",n=l.onComplete||function(){},a=new v.window.XMLHttpRequest,c=l.body||l.parameters;return a.onreadystatechange=function(){a.readyState===4&&(n(a),a.onreadystatechange=h)},f==="GET"&&(c=null,typeof l.parameters=="string"&&(x=function(A,E){return A+(/\?/.test(A)?"&":"?")+E}(x,l.parameters))),a.open(f,x,!0),f!=="POST"&&f!=="PUT"||a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(c),a}}(),v.log=console.log,v.warn=console.warn,function(){var h=v.util.object.extend,x=v.util.object.clone,l=[];function f(){return!1}function n(E,d,p,C){return-p*Math.cos(E/C*(Math.PI/2))+p+d}v.util.object.extend(l,{cancelAll:function(){var E=this.splice(0);return E.forEach(function(d){d.cancel()}),E},cancelByCanvas:function(E){if(!E)return[];var d=this.filter(function(p){return typeof p.target=="object"&&p.target.canvas===E});return d.forEach(function(p){p.cancel()}),d},cancelByTarget:function(E){var d=this.findAnimationsByTarget(E);return d.forEach(function(p){p.cancel()}),d},findAnimationIndex:function(E){return this.indexOf(this.findAnimation(E))},findAnimation:function(E){return this.find(function(d){return d.cancel===E})},findAnimationsByTarget:function(E){return E?this.filter(function(d){return d.target===E}):[]}});var a=v.window.requestAnimationFrame||v.window.webkitRequestAnimationFrame||v.window.mozRequestAnimationFrame||v.window.oRequestAnimationFrame||v.window.msRequestAnimationFrame||function(E){return v.window.setTimeout(E,1e3/60)},c=v.window.cancelAnimationFrame||v.window.clearTimeout;function A(){return a.apply(v.window,arguments)}v.util.animate=function(E){E||(E={});var d,p=!1,C=function(){var y=v.runningAnimations.indexOf(d);return y>-1&&v.runningAnimations.splice(y,1)[0]};return d=h(x(E),{cancel:function(){return p=!0,C()},currentValue:"startValue"in E?E.startValue:0,completionRate:0,durationRate:0}),v.runningAnimations.push(d),A(function(y){var S,w=y||+new Date,b=E.duration||500,O=w+b,N=E.onChange||f,j=E.abort||f,Z=E.onComplete||f,Y=E.easing||n,W="startValue"in E&&E.startValue.length>0,P="startValue"in E?E.startValue:0,R="endValue"in E?E.endValue:100,V=E.byValue||(W?P.map(function(J,q){return R[q]-P[q]}):R-P);E.onStart&&E.onStart(),function J(q){var L=(S=q||+new Date)>O?b:S-w,M=L/b,G=W?P.map(function(z,ie){return Y(L,P[ie],V[ie],b)}):Y(L,P,V,b),ee=Math.abs(W?(G[0]-P[0])/V[0]:(G-P)/V);if(d.currentValue=W?G.slice():G,d.completionRate=ee,d.durationRate=M,!p){if(!j(G,ee,M))return S>O?(d.currentValue=W?R.slice():R,d.completionRate=1,d.durationRate=1,N(W?R.slice():R,1,1),Z(R,1,1),void C()):(N(G,ee,M),void A(J));C()}}(w)}),d.cancel},v.util.requestAnimFrame=A,v.util.cancelAnimFrame=function(){return c.apply(v.window,arguments)},v.runningAnimations=l}(),function(){function h(x,l,f){var n="rgba("+parseInt(x[0]+f*(l[0]-x[0]),10)+","+parseInt(x[1]+f*(l[1]-x[1]),10)+","+parseInt(x[2]+f*(l[2]-x[2]),10);return(n+=","+(x&&l?parseFloat(x[3]+f*(l[3]-x[3])):1))+")"}v.util.animateColor=function(x,l,f,n){var a=new v.Color(x).getSource(),c=new v.Color(l).getSource(),A=n.onComplete,E=n.onChange;return n=n||{},v.util.animate(v.util.object.extend(n,{duration:f||500,startValue:a,endValue:c,byValue:c,easing:function(d,p,C,y){return h(p,C,n.colorEasing?n.colorEasing(d,y):1-Math.cos(d/y*(Math.PI/2)))},onComplete:function(d,p,C){if(A)return A(h(c,c,0),p,C)},onChange:function(d,p,C){if(E){if(Array.isArray(d))return E(h(d,d,0),p,C);E(d,p,C)}}}))}}(),function(){function h(n,a,c,A){return n<Math.abs(a)?(n=a,A=c/4):A=a===0&&n===0?c/(2*Math.PI)*Math.asin(1):c/(2*Math.PI)*Math.asin(a/n),{a:n,c:a,p:c,s:A}}function x(n,a,c){return n.a*Math.pow(2,10*(a-=1))*Math.sin((a*c-n.s)*(2*Math.PI)/n.p)}function l(n,a,c,A){return c-f(A-n,0,c,A)+a}function f(n,a,c,A){return(n/=A)<1/2.75?c*(7.5625*n*n)+a:n<2/2.75?c*(7.5625*(n-=1.5/2.75)*n+.75)+a:n<2.5/2.75?c*(7.5625*(n-=2.25/2.75)*n+.9375)+a:c*(7.5625*(n-=2.625/2.75)*n+.984375)+a}v.util.ease={easeInQuad:function(n,a,c,A){return c*(n/=A)*n+a},easeOutQuad:function(n,a,c,A){return-c*(n/=A)*(n-2)+a},easeInOutQuad:function(n,a,c,A){return(n/=A/2)<1?c/2*n*n+a:-c/2*(--n*(n-2)-1)+a},easeInCubic:function(n,a,c,A){return c*(n/=A)*n*n+a},easeOutCubic:function(n,a,c,A){return c*((n=n/A-1)*n*n+1)+a},easeInOutCubic:function(n,a,c,A){return(n/=A/2)<1?c/2*n*n*n+a:c/2*((n-=2)*n*n+2)+a},easeInQuart:function(n,a,c,A){return c*(n/=A)*n*n*n+a},easeOutQuart:function(n,a,c,A){return-c*((n=n/A-1)*n*n*n-1)+a},easeInOutQuart:function(n,a,c,A){return(n/=A/2)<1?c/2*n*n*n*n+a:-c/2*((n-=2)*n*n*n-2)+a},easeInQuint:function(n,a,c,A){return c*(n/=A)*n*n*n*n+a},easeOutQuint:function(n,a,c,A){return c*((n=n/A-1)*n*n*n*n+1)+a},easeInOutQuint:function(n,a,c,A){return(n/=A/2)<1?c/2*n*n*n*n*n+a:c/2*((n-=2)*n*n*n*n+2)+a},easeInSine:function(n,a,c,A){return-c*Math.cos(n/A*(Math.PI/2))+c+a},easeOutSine:function(n,a,c,A){return c*Math.sin(n/A*(Math.PI/2))+a},easeInOutSine:function(n,a,c,A){return-c/2*(Math.cos(Math.PI*n/A)-1)+a},easeInExpo:function(n,a,c,A){return n===0?a:c*Math.pow(2,10*(n/A-1))+a},easeOutExpo:function(n,a,c,A){return n===A?a+c:c*(1-Math.pow(2,-10*n/A))+a},easeInOutExpo:function(n,a,c,A){return n===0?a:n===A?a+c:(n/=A/2)<1?c/2*Math.pow(2,10*(n-1))+a:c/2*(2-Math.pow(2,-10*--n))+a},easeInCirc:function(n,a,c,A){return-c*(Math.sqrt(1-(n/=A)*n)-1)+a},easeOutCirc:function(n,a,c,A){return c*Math.sqrt(1-(n=n/A-1)*n)+a},easeInOutCirc:function(n,a,c,A){return(n/=A/2)<1?-c/2*(Math.sqrt(1-n*n)-1)+a:c/2*(Math.sqrt(1-(n-=2)*n)+1)+a},easeInElastic:function(n,a,c,A){var E=0;return n===0?a:(n/=A)==1?a+c:(E||(E=.3*A),-x(h(c,c,E,1.70158),n,A)+a)},easeOutElastic:function(n,a,c,A){var E=0;if(n===0)return a;if((n/=A)==1)return a+c;E||(E=.3*A);var d=h(c,c,E,1.70158);return d.a*Math.pow(2,-10*n)*Math.sin((n*A-d.s)*(2*Math.PI)/d.p)+d.c+a},easeInOutElastic:function(n,a,c,A){var E=0;if(n===0)return a;if((n/=A/2)==2)return a+c;E||(E=A*(.3*1.5));var d=h(c,c,E,1.70158);return n<1?-.5*x(d,n,A)+a:d.a*Math.pow(2,-10*(n-=1))*Math.sin((n*A-d.s)*(2*Math.PI)/d.p)*.5+d.c+a},easeInBack:function(n,a,c,A,E){return E===void 0&&(E=1.70158),c*(n/=A)*n*((E+1)*n-E)+a},easeOutBack:function(n,a,c,A,E){return E===void 0&&(E=1.70158),c*((n=n/A-1)*n*((E+1)*n+E)+1)+a},easeInOutBack:function(n,a,c,A,E){return E===void 0&&(E=1.70158),(n/=A/2)<1?c/2*(n*n*((1+(E*=1.525))*n-E))+a:c/2*((n-=2)*n*((1+(E*=1.525))*n+E)+2)+a},easeInBounce:l,easeOutBounce:f,easeInOutBounce:function(n,a,c,A){return n<A/2?.5*l(2*n,0,c,A)+a:.5*f(2*n-A,0,c,A)+.5*c+a}}}(),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.util.object.clone,n=x.util.toFixed,a=x.util.parseUnit,c=x.util.multiplyTransformMatrices,A={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},E={stroke:"strokeOpacity",fill:"fillOpacity"},d="font-size",p="clip-path";function C(P){return P in A?A[P]:P}function y(P,R,V,J){var q,L=Array.isArray(R);if(P!=="fill"&&P!=="stroke"||R!=="none"){if(P==="strokeUniform")return R==="non-scaling-stroke";if(P==="strokeDashArray")R=R==="none"?null:R.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(P==="transformMatrix")R=V&&V.transformMatrix?c(V.transformMatrix,x.parseTransformAttribute(R)):x.parseTransformAttribute(R);else if(P==="visible")R=R!=="none"&&R!=="hidden",V&&V.visible===!1&&(R=!1);else if(P==="opacity")R=parseFloat(R),V&&V.opacity!==void 0&&(R*=V.opacity);else if(P==="textAnchor")R=R==="start"?"left":R==="end"?"right":"center";else if(P==="charSpacing")q=a(R,J)/J*1e3;else if(P==="paintFirst"){var M=R.indexOf("fill"),G=R.indexOf("stroke");R="fill",(M>-1&&G>-1&&G<M||M===-1&&G>-1)&&(R="stroke")}else{if(P==="href"||P==="xlink:href"||P==="font")return R;if(P==="imageSmoothing")return R==="optimizeQuality";q=L?R.map(a):a(R,J)}}else R="";return!L&&isNaN(q)?R:q}function S(P){return new RegExp("^("+P.join("|")+")\\b","i")}function w(P,R){var V,J,q,L,M=[];for(q=0,L=R.length;q<L;q++)V=R[q],J=P.getElementsByTagName(V),M=M.concat(Array.prototype.slice.call(J));return M}function b(P,R){var V,J=!0;return(V=O(P,R.pop()))&&R.length&&(J=function(q,L){for(var M,G=!0;q.parentNode&&q.parentNode.nodeType===1&&L.length;)G&&(M=L.pop()),G=O(q=q.parentNode,M);return L.length===0}(P,R)),V&&J&&R.length===0}function O(P,R){var V,J,q=P.nodeName,L=P.getAttribute("class"),M=P.getAttribute("id");if(V=new RegExp("^"+q,"i"),R=R.replace(V,""),M&&R.length&&(V=new RegExp("#"+M+"(?![a-zA-Z\\-]+)","i"),R=R.replace(V,"")),L&&R.length)for(J=(L=L.split(" ")).length;J--;)V=new RegExp("\\."+L[J]+"(?![a-zA-Z\\-]+)","i"),R=R.replace(V,"");return R.length===0}function N(P,R){var V;if(P.getElementById&&(V=P.getElementById(R)),V)return V;var J,q,L,M=P.getElementsByTagName("*");for(q=0,L=M.length;q<L;q++)if(R===(J=M[q]).getAttribute("id"))return J}x.svgValidTagNamesRegEx=S(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),x.svgViewBoxElementsRegEx=S(["symbol","image","marker","pattern","view","svg"]),x.svgInvalidAncestorsRegEx=S(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),x.svgValidParentsRegEx=S(["symbol","g","a","svg","clipPath","defs"]),x.cssRules={},x.gradientDefs={},x.clipPaths={},x.parseTransformAttribute=function(){function P(G,ee,z){G[z]=Math.tan(x.util.degreesToRadians(ee[0]))}var R=x.iMatrix,V=x.reNum,J=x.commaWsp,q="(?:(?:(matrix)\\s*\\(\\s*("+V+")"+J+"("+V+")"+J+"("+V+")"+J+"("+V+")"+J+"("+V+")"+J+"("+V+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+V+")(?:"+J+"("+V+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+V+")(?:"+J+"("+V+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+V+")(?:"+J+"("+V+")"+J+"("+V+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+V+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+V+")\\s*\\)))",L=new RegExp("^\\s*(?:(?:"+q+"(?:"+J+"*"+q+")*)?)\\s*$"),M=new RegExp(q,"g");return function(G){var ee=R.concat(),z=[];if(!G||G&&!L.test(G))return ee;G.replace(M,function(de){var he=new RegExp(q).exec(de).filter(function(ce){return!!ce}),se=he[1],Ee=he.slice(2).map(parseFloat);switch(se){case"translate":(function(ce,pe){ce[4]=pe[0],pe.length===2&&(ce[5]=pe[1])})(ee,Ee);break;case"rotate":Ee[0]=x.util.degreesToRadians(Ee[0]),function(ce,pe){var _e=x.util.cos(pe[0]),Be=x.util.sin(pe[0]),Te=0,Re=0;pe.length===3&&(Te=pe[1],Re=pe[2]),ce[0]=_e,ce[1]=Be,ce[2]=-Be,ce[3]=_e,ce[4]=Te-(_e*Te-Be*Re),ce[5]=Re-(Be*Te+_e*Re)}(ee,Ee);break;case"scale":(function(ce,pe){var _e=pe[0],Be=pe.length===2?pe[1]:pe[0];ce[0]=_e,ce[3]=Be})(ee,Ee);break;case"skewX":P(ee,Ee,2);break;case"skewY":P(ee,Ee,1);break;case"matrix":ee=Ee}z.push(ee.concat()),ee=R.concat()});for(var ie=z[0];z.length>1;)z.shift(),ie=x.util.multiplyTransformMatrices(ie,z[0]);return ie}}();var j=new RegExp("^\\s*("+x.reNum+"+)\\s*,?\\s*("+x.reNum+"+)\\s*,?\\s*("+x.reNum+"+)\\s*,?\\s*("+x.reNum+"+)\\s*$");function Z(P){if(!x.svgViewBoxElementsRegEx.test(P.nodeName))return{};var R,V,J,q,L,M,G=P.getAttribute("viewBox"),ee=1,z=1,ie=P.getAttribute("width"),de=P.getAttribute("height"),he=P.getAttribute("x")||0,se=P.getAttribute("y")||0,Ee=P.getAttribute("preserveAspectRatio")||"",ce=!G||!(G=G.match(j)),pe=!ie||!de||ie==="100%"||de==="100%",_e=ce&&pe,Be={},Te="",Re=0,tt=0;if(Be.width=0,Be.height=0,Be.toBeParsed=_e,ce&&(he||se)&&P.parentNode&&P.parentNode.nodeName!=="#document"&&(Te=" translate("+a(he)+" "+a(se)+") ",L=(P.getAttribute("transform")||"")+Te,P.setAttribute("transform",L),P.removeAttribute("x"),P.removeAttribute("y")),_e)return Be;if(ce)return Be.width=a(ie),Be.height=a(de),Be;if(R=-parseFloat(G[1]),V=-parseFloat(G[2]),J=parseFloat(G[3]),q=parseFloat(G[4]),Be.minX=R,Be.minY=V,Be.viewBoxWidth=J,Be.viewBoxHeight=q,pe?(Be.width=J,Be.height=q):(Be.width=a(ie),Be.height=a(de),ee=Be.width/J,z=Be.height/q),(Ee=x.util.parsePreserveAspectRatioAttribute(Ee)).alignX!=="none"&&(Ee.meetOrSlice==="meet"&&(z=ee=ee>z?z:ee),Ee.meetOrSlice==="slice"&&(z=ee=ee>z?ee:z),Re=Be.width-J*ee,tt=Be.height-q*ee,Ee.alignX==="Mid"&&(Re/=2),Ee.alignY==="Mid"&&(tt/=2),Ee.alignX==="Min"&&(Re=0),Ee.alignY==="Min"&&(tt=0)),ee===1&&z===1&&R===0&&V===0&&he===0&&se===0)return Be;if((he||se)&&P.parentNode.nodeName!=="#document"&&(Te=" translate("+a(he)+" "+a(se)+") "),L=Te+" matrix("+ee+" 0 0 "+z+" "+(R*ee+Re)+" "+(V*z+tt)+") ",P.nodeName==="svg"){for(M=P.ownerDocument.createElementNS(x.svgNS,"g");P.firstChild;)M.appendChild(P.firstChild);P.appendChild(M)}else(M=P).removeAttribute("x"),M.removeAttribute("y"),L=M.getAttribute("transform")+L;return M.setAttribute("transform",L),Be}function Y(P,R){var V="xlink:href",J=N(P,R.getAttribute(V).slice(1));if(J&&J.getAttribute(V)&&Y(P,J),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(L){J&&!R.hasAttribute(L)&&J.hasAttribute(L)&&R.setAttribute(L,J.getAttribute(L))}),!R.children.length)for(var q=J.cloneNode(!0);q.firstChild;)R.appendChild(q.firstChild);R.removeAttribute(V)}x.parseSVGDocument=function(P,R,V,J){if(P){(function(he){for(var se=w(he,["use","svg:use"]),Ee=0;se.length&&Ee<se.length;){var ce=se[Ee],pe=ce.getAttribute("xlink:href")||ce.getAttribute("href");if(pe===null)return;var _e,Be,Te,Re,tt=pe.slice(1),lt=ce.getAttribute("x")||0,Ft=ce.getAttribute("y")||0,Ne=N(he,tt).cloneNode(!0),rt=(Ne.getAttribute("transform")||"")+" translate("+lt+", "+Ft+")",ft=se.length,Lt=x.svgNS;if(Z(Ne),/^svg$/i.test(Ne.nodeName)){var St=Ne.ownerDocument.createElementNS(Lt,"g");for(Be=0,Re=(Te=Ne.attributes).length;Be<Re;Be++)_e=Te.item(Be),St.setAttributeNS(Lt,_e.nodeName,_e.nodeValue);for(;Ne.firstChild;)St.appendChild(Ne.firstChild);Ne=St}for(Be=0,Re=(Te=ce.attributes).length;Be<Re;Be++)(_e=Te.item(Be)).nodeName!=="x"&&_e.nodeName!=="y"&&_e.nodeName!=="xlink:href"&&_e.nodeName!=="href"&&(_e.nodeName==="transform"?rt=_e.nodeValue+" "+rt:Ne.setAttribute(_e.nodeName,_e.nodeValue));Ne.setAttribute("transform",rt),Ne.setAttribute("instantiated_by_use","1"),Ne.removeAttribute("id"),ce.parentNode.replaceChild(Ne,ce),se.length===ft&&Ee++}})(P);var q,L,M=x.Object.__uid++,G=Z(P),ee=x.util.toArray(P.getElementsByTagName("*"));if(G.crossOrigin=J&&J.crossOrigin,G.svgUid=M,ee.length===0&&x.isLikelyNode){var z=[];for(q=0,L=(ee=P.selectNodes('//*[name(.)!="svg"]')).length;q<L;q++)z[q]=ee[q];ee=z}var ie=ee.filter(function(he){return Z(he),x.svgValidTagNamesRegEx.test(he.nodeName.replace("svg:",""))&&!function(se,Ee){for(;se&&(se=se.parentNode);)if(se.nodeName&&Ee.test(se.nodeName.replace("svg:",""))&&!se.getAttribute("instantiated_by_use"))return!0;return!1}(he,x.svgInvalidAncestorsRegEx)});if(!ie||ie&&!ie.length)R&&R([],{});else{var de={};ee.filter(function(he){return he.nodeName.replace("svg:","")==="clipPath"}).forEach(function(he){var se=he.getAttribute("id");de[se]=x.util.toArray(he.getElementsByTagName("*")).filter(function(Ee){return x.svgValidTagNamesRegEx.test(Ee.nodeName.replace("svg:",""))})}),x.gradientDefs[M]=x.getGradientDefs(P),x.cssRules[M]=x.getCSSRules(P),x.clipPaths[M]=de,x.parseElements(ie,function(he,se){R&&(R(he,G,se,ee),delete x.gradientDefs[M],delete x.cssRules[M],delete x.clipPaths[M])},f(G),V,J)}}};var W=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+x.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+x.reNum+"))?\\s+(.*)");l(x,{parseFontDeclaration:function(P,R){var V=P.match(W);if(V){var J=V[1],q=V[3],L=V[4],M=V[5],G=V[6];J&&(R.fontStyle=J),q&&(R.fontWeight=isNaN(parseFloat(q))?q:parseFloat(q)),L&&(R.fontSize=a(L)),G&&(R.fontFamily=G),M&&(R.lineHeight=M==="normal"?1:M)}},getGradientDefs:function(P){var R,V=w(P,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),J=0,q={};for(J=V.length;J--;)(R=V[J]).getAttribute("xlink:href")&&Y(P,R),q[R.getAttribute("id")]=R;return q},parseAttributes:function(P,R,V){if(P){var J,q,L,M={};V===void 0&&(V=P.getAttribute("svgUid")),P.parentNode&&x.svgValidParentsRegEx.test(P.parentNode.nodeName)&&(M=x.parseAttributes(P.parentNode,R,V));var G=R.reduce(function(Ee,ce){return(J=P.getAttribute(ce))&&(Ee[ce]=J),Ee},{}),ee=l(function(Ee,ce){var pe={};for(var _e in x.cssRules[ce])if(b(Ee,_e.split(" ")))for(var Be in x.cssRules[ce][_e])pe[Be]=x.cssRules[ce][_e][Be];return pe}(P,V),x.parseStyleAttribute(P));G=l(G,ee),ee[p]&&P.setAttribute(p,ee[p]),q=L=M.fontSize||x.Text.DEFAULT_SVG_FONT_SIZE,G[d]&&(G[d]=q=a(G[d],L));var z,ie,de={};for(var he in G)ie=y(z=C(he),G[he],M,q),de[z]=ie;de&&de.font&&x.parseFontDeclaration(de.font,de);var se=l(M,de);return x.svgValidParentsRegEx.test(P.nodeName)?se:function(Ee){for(var ce in E)if(Ee[E[ce]]!==void 0&&Ee[ce]!==""){if(Ee[ce]===void 0){if(!x.Object.prototype[ce])continue;Ee[ce]=x.Object.prototype[ce]}if(Ee[ce].indexOf("url(")!==0){var pe=new x.Color(Ee[ce]);Ee[ce]=pe.setAlpha(n(pe.getAlpha()*Ee[E[ce]],2)).toRgba()}}return Ee}(se)}},parseElements:function(P,R,V,J,q){new x.ElementsParser(P,R,V,J,q).parse()},parseStyleAttribute:function(P){var R={},V=P.getAttribute("style");return V&&(typeof V=="string"?function(J,q){var L,M;J.replace(/;\s*$/,"").split(";").forEach(function(G){var ee=G.split(":");L=ee[0].trim().toLowerCase(),M=ee[1].trim(),q[L]=M})}(V,R):function(J,q){var L,M;for(var G in J)J[G]!==void 0&&(L=G.toLowerCase(),M=J[G],q[L]=M)}(V,R)),R},parsePointsAttribute:function(P){if(!P)return null;var R,V,J=[];for(R=0,V=(P=(P=P.replace(/,/g," ").trim()).split(/\s+/)).length;R<V;R+=2)J.push({x:parseFloat(P[R]),y:parseFloat(P[R+1])});return J},getCSSRules:function(P){var R,V,J=P.getElementsByTagName("style"),q={};for(R=0,V=J.length;R<V;R++){var L=J[R].textContent;(L=L.replace(/\/\*[\s\S]*?\*\//g,"")).trim()!==""&&L.split("}").filter(function(M){return M.trim()}).forEach(function(M){var G=M.split("{"),ee={},z=G[1].trim().split(";").filter(function(se){return se.trim()});for(R=0,V=z.length;R<V;R++){var ie=z[R].split(":"),de=ie[0].trim(),he=ie[1].trim();ee[de]=he}(M=G[0].trim()).split(",").forEach(function(se){(se=se.replace(/^svg/i,"").trim())!==""&&(q[se]?x.util.object.extend(q[se],ee):q[se]=x.util.object.clone(ee))})})}return q},loadSVGFromURL:function(P,R,V,J){P=P.replace(/^\n\s*/,"").trim(),new x.util.request(P,{method:"get",onComplete:function(q){var L=q.responseXML;if(!L||!L.documentElement)return R&&R(null),!1;x.parseSVGDocument(L.documentElement,function(M,G,ee,z){R&&R(M,G,ee,z)},V,J)}})},loadSVGFromString:function(P,R,V,J){var q=new x.window.DOMParser().parseFromString(P.trim(),"text/xml");x.parseSVGDocument(q.documentElement,function(L,M,G,ee){R(L,M,G,ee)},V,J)}})}(e),v.ElementsParser=function(h,x,l,f,n,a){this.elements=h,this.callback=x,this.options=l,this.reviver=f,this.svgUid=l&&l.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=a},(U=v.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},U.createObjects=function(){var h=this;this.elements.forEach(function(x,l){x.setAttribute("svgUid",h.svgUid),h.createObject(x,l)})},U.findTag=function(h){return v[v.util.string.capitalize(h.tagName.replace("svg:",""))]},U.createObject=function(h,x){var l=this.findTag(h);if(l&&l.fromElement)try{l.fromElement(h,this.createCallback(x,h),this.options)}catch(f){v.log(f)}else this.checkIfDone()},U.createCallback=function(h,x){var l=this;return function(f){var n;l.resolveGradient(f,x,"fill"),l.resolveGradient(f,x,"stroke"),f instanceof v.Image&&f._originalElement&&(n=f.parsePreserveAspectRatioAttribute(x)),f._removeTransformMatrix(n),l.resolveClipPath(f,x),l.reviver&&l.reviver(x,f),l.instances[h]=f,l.checkIfDone()}},U.extractPropertyDefinition=function(h,x,l){var f=h[x],n=this.regexUrl;if(n.test(f)){n.lastIndex=0;var a=n.exec(f)[1];return n.lastIndex=0,v[l][this.svgUid][a]}},U.resolveGradient=function(h,x,l){var f=this.extractPropertyDefinition(h,l,"gradientDefs");if(f){var n=x.getAttribute(l+"-opacity"),a=v.Gradient.fromElement(f,h,n,this.options);h.set(l,a)}},U.createClipPathCallback=function(h,x){return function(l){l._removeTransformMatrix(),l.fillRule=l.clipRule,x.push(l)}},U.resolveClipPath=function(h,x){var l,f,n,a,c=this.extractPropertyDefinition(h,"clipPath","clipPaths");if(c){n=[],f=v.util.invertTransform(h.calcTransformMatrix());for(var A=c[0].parentNode,E=x;E.parentNode&&E.getAttribute("clip-path")!==h.clipPath;)E=E.parentNode;E.parentNode.appendChild(A);for(var d=0;d<c.length;d++)l=c[d],this.findTag(l).fromElement(l,this.createClipPathCallback(h,n),this.options);c=n.length===1?n[0]:new v.Group(n),a=v.util.multiplyTransformMatrices(f,c.calcTransformMatrix()),c.clipPath&&this.resolveClipPath(c,E);var p=v.util.qrDecompose(a);c.flipX=!1,c.flipY=!1,c.set("scaleX",p.scaleX),c.set("scaleY",p.scaleY),c.angle=p.angle,c.skewX=p.skewX,c.skewY=0,c.setPositionByOrigin({x:p.translateX,y:p.translateY},"center","center"),h.clipPath=c}else delete h.clipPath},U.checkIfDone=function(){--this.numElements==0&&(this.instances=this.instances.filter(function(h){return h!=null}),this.callback(this.instances,this.elements))},function(h){var x=h.fabric||(h.fabric={});function l(f,n){this.x=f,this.y=n}x.Point?x.warn("fabric.Point is already defined"):(x.Point=l,l.prototype={type:"point",constructor:l,add:function(f){return new l(this.x+f.x,this.y+f.y)},addEquals:function(f){return this.x+=f.x,this.y+=f.y,this},scalarAdd:function(f){return new l(this.x+f,this.y+f)},scalarAddEquals:function(f){return this.x+=f,this.y+=f,this},subtract:function(f){return new l(this.x-f.x,this.y-f.y)},subtractEquals:function(f){return this.x-=f.x,this.y-=f.y,this},scalarSubtract:function(f){return new l(this.x-f,this.y-f)},scalarSubtractEquals:function(f){return this.x-=f,this.y-=f,this},multiply:function(f){return new l(this.x*f,this.y*f)},multiplyEquals:function(f){return this.x*=f,this.y*=f,this},divide:function(f){return new l(this.x/f,this.y/f)},divideEquals:function(f){return this.x/=f,this.y/=f,this},eq:function(f){return this.x===f.x&&this.y===f.y},lt:function(f){return this.x<f.x&&this.y<f.y},lte:function(f){return this.x<=f.x&&this.y<=f.y},gt:function(f){return this.x>f.x&&this.y>f.y},gte:function(f){return this.x>=f.x&&this.y>=f.y},lerp:function(f,n){return n===void 0&&(n=.5),n=Math.max(Math.min(1,n),0),new l(this.x+(f.x-this.x)*n,this.y+(f.y-this.y)*n)},distanceFrom:function(f){var n=this.x-f.x,a=this.y-f.y;return Math.sqrt(n*n+a*a)},midPointFrom:function(f){return this.lerp(f)},min:function(f){return new l(Math.min(this.x,f.x),Math.min(this.y,f.y))},max:function(f){return new l(Math.max(this.x,f.x),Math.max(this.y,f.y))},toString:function(){return this.x+","+this.y},setXY:function(f,n){return this.x=f,this.y=n,this},setX:function(f){return this.x=f,this},setY:function(f){return this.y=f,this},setFromPoint:function(f){return this.x=f.x,this.y=f.y,this},swap:function(f){var n=this.x,a=this.y;this.x=f.x,this.y=f.y,f.x=n,f.y=a},clone:function(){return new l(this.x,this.y)}})}(e),function(h){var x=h.fabric||(h.fabric={});function l(f){this.status=f,this.points=[]}x.Intersection?x.warn("fabric.Intersection is already defined"):(x.Intersection=l,x.Intersection.prototype={constructor:l,appendPoint:function(f){return this.points.push(f),this},appendPoints:function(f){return this.points=this.points.concat(f),this}},x.Intersection.intersectLineLine=function(f,n,a,c){var A,E=(c.x-a.x)*(f.y-a.y)-(c.y-a.y)*(f.x-a.x),d=(n.x-f.x)*(f.y-a.y)-(n.y-f.y)*(f.x-a.x),p=(c.y-a.y)*(n.x-f.x)-(c.x-a.x)*(n.y-f.y);if(p!==0){var C=E/p,y=d/p;0<=C&&C<=1&&0<=y&&y<=1?(A=new l("Intersection")).appendPoint(new x.Point(f.x+C*(n.x-f.x),f.y+C*(n.y-f.y))):A=new l}else A=new l(E===0||d===0?"Coincident":"Parallel");return A},x.Intersection.intersectLinePolygon=function(f,n,a){var c,A,E,d,p=new l,C=a.length;for(d=0;d<C;d++)c=a[d],A=a[(d+1)%C],E=l.intersectLineLine(f,n,c,A),p.appendPoints(E.points);return p.points.length>0&&(p.status="Intersection"),p},x.Intersection.intersectPolygonPolygon=function(f,n){var a,c=new l,A=f.length;for(a=0;a<A;a++){var E=f[a],d=f[(a+1)%A],p=l.intersectLinePolygon(E,d,n);c.appendPoints(p.points)}return c.points.length>0&&(c.status="Intersection"),c},x.Intersection.intersectPolygonRectangle=function(f,n,a){var c=n.min(a),A=n.max(a),E=new x.Point(A.x,c.y),d=new x.Point(c.x,A.y),p=l.intersectLinePolygon(c,E,f),C=l.intersectLinePolygon(E,A,f),y=l.intersectLinePolygon(A,d,f),S=l.intersectLinePolygon(d,c,f),w=new l;return w.appendPoints(p.points),w.appendPoints(C.points),w.appendPoints(y.points),w.appendPoints(S.points),w.points.length>0&&(w.status="Intersection"),w})}(e),function(h){var x=h.fabric||(h.fabric={});function l(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}function f(n,a,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?n+6*(a-n)*c:c<.5?a:c<2/3?n+(a-n)*(2/3-c)*6:n}x.Color?x.warn("fabric.Color is already defined."):(x.Color=l,x.Color.prototype={_tryParsingColor:function(n){var a;n in l.colorNameMap&&(n=l.colorNameMap[n]),n==="transparent"&&(a=[255,255,255,0]),a||(a=l.sourceFromHex(n)),a||(a=l.sourceFromRgb(n)),a||(a=l.sourceFromHsl(n)),a||(a=[0,0,0,1]),a&&this.setSource(a)},_rgbToHsl:function(n,a,c){n/=255,a/=255,c/=255;var A,E,d,p=x.util.array.max([n,a,c]),C=x.util.array.min([n,a,c]);if(d=(p+C)/2,p===C)A=E=0;else{var y=p-C;switch(E=d>.5?y/(2-p-C):y/(p+C),p){case n:A=(a-c)/y+(a<c?6:0);break;case a:A=(c-n)/y+2;break;case c:A=(n-a)/y+4}A/=6}return[Math.round(360*A),Math.round(100*E),Math.round(100*d)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),a=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+a[0]+","+a[1]+"%,"+a[2]+"%)"},toHsla:function(){var n=this.getSource(),a=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+a[0]+","+a[1]+"%,"+a[2]+"%,"+n[3]+")"},toHex:function(){var n,a,c,A=this.getSource();return n=(n=A[0].toString(16)).length===1?"0"+n:n,a=(a=A[1].toString(16)).length===1?"0"+a:a,c=(c=A[2].toString(16)).length===1?"0"+c:c,n.toUpperCase()+a.toUpperCase()+c.toUpperCase()},toHexa:function(){var n,a=this.getSource();return n=(n=(n=Math.round(255*a[3])).toString(16)).length===1?"0"+n:n,this.toHex()+n.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var a=this.getSource();return a[3]=n,this.setSource(a),this},toGrayscale:function(){var n=this.getSource(),a=parseInt((.3*n[0]+.59*n[1]+.11*n[2]).toFixed(0),10),c=n[3];return this.setSource([a,a,a,c]),this},toBlackWhite:function(n){var a=this.getSource(),c=(.3*a[0]+.59*a[1]+.11*a[2]).toFixed(0),A=a[3];return n=n||127,c=Number(c)<Number(n)?0:255,this.setSource([c,c,c,A]),this},overlayWith:function(n){n instanceof l||(n=new l(n));var a,c=[],A=this.getAlpha(),E=this.getSource(),d=n.getSource();for(a=0;a<3;a++)c.push(Math.round(.5*E[a]+.5*d[a]));return c[3]=A,this.setSource(c),this}},x.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,x.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,x.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,x.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},x.Color.fromRgb=function(n){return l.fromSource(l.sourceFromRgb(n))},x.Color.sourceFromRgb=function(n){var a=n.match(l.reRGBa);if(a){var c=parseInt(a[1],10)/(/%$/.test(a[1])?100:1)*(/%$/.test(a[1])?255:1),A=parseInt(a[2],10)/(/%$/.test(a[2])?100:1)*(/%$/.test(a[2])?255:1),E=parseInt(a[3],10)/(/%$/.test(a[3])?100:1)*(/%$/.test(a[3])?255:1);return[parseInt(c,10),parseInt(A,10),parseInt(E,10),a[4]?parseFloat(a[4]):1]}},x.Color.fromRgba=l.fromRgb,x.Color.fromHsl=function(n){return l.fromSource(l.sourceFromHsl(n))},x.Color.sourceFromHsl=function(n){var a=n.match(l.reHSLa);if(a){var c,A,E,d=(parseFloat(a[1])%360+360)%360/360,p=parseFloat(a[2])/(/%$/.test(a[2])?100:1),C=parseFloat(a[3])/(/%$/.test(a[3])?100:1);if(p===0)c=A=E=C;else{var y=C<=.5?C*(p+1):C+p-C*p,S=2*C-y;c=f(S,y,d+1/3),A=f(S,y,d),E=f(S,y,d-1/3)}return[Math.round(255*c),Math.round(255*A),Math.round(255*E),a[4]?parseFloat(a[4]):1]}},x.Color.fromHsla=l.fromHsl,x.Color.fromHex=function(n){return l.fromSource(l.sourceFromHex(n))},x.Color.sourceFromHex=function(n){if(n.match(l.reHex)){var a=n.slice(n.indexOf("#")+1),c=a.length===3||a.length===4,A=a.length===8||a.length===4,E=c?a.charAt(0)+a.charAt(0):a.substring(0,2),d=c?a.charAt(1)+a.charAt(1):a.substring(2,4),p=c?a.charAt(2)+a.charAt(2):a.substring(4,6),C=A?c?a.charAt(3)+a.charAt(3):a.substring(6,8):"FF";return[parseInt(E,16),parseInt(d,16),parseInt(p,16),parseFloat((parseInt(C,16)/255).toFixed(2))]}},x.Color.fromSource=function(n){var a=new l;return a.setSource(n),a})}(e),function(h){var x=h.fabric||(h.fabric={}),l=["e","se","s","sw","w","nw","n","ne","e"],f=["ns","nesw","ew","nwse"],n={},a="left",c="top",A="right",E="bottom",d="center",p={top:E,bottom:c,left:A,right:a,center:d},C=x.util.radiansToDegrees,y=Math.sign||function(L){return(L>0)-(L<0)||+L};function S(L,M){var G=L.angle+C(Math.atan2(M.y,M.x))+360;return Math.round(G%360/45)}function w(L,M){var G=M.transform.target,ee=G.canvas,z=x.util.object.clone(M);z.target=G,ee&&ee.fire("object:"+L,z),G.fire(L,M)}function b(L,M){var G=M.canvas,ee=L[G.uniScaleKey];return G.uniformScaling&&!ee||!G.uniformScaling&&ee}function O(L){return L.originX===d&&L.originY===d}function N(L,M,G){var ee=L.lockScalingX,z=L.lockScalingY;return!((!ee||!z)&&(M||!ee&&!z||!G)&&(!ee||M!=="x")&&(!z||M!=="y"))}function j(L,M,G,ee){return{e:L,transform:M,pointer:{x:G,y:ee}}}function Z(L){return function(M,G,ee,z){var ie=G.target,de=ie.getCenterPoint(),he=ie.translateToOriginPoint(de,G.originX,G.originY),se=L(M,G,ee,z);return ie.setPositionByOrigin(he,G.originX,G.originY),se}}function Y(L,M){return function(G,ee,z,ie){var de=M(G,ee,z,ie);return de&&w(L,j(G,ee,z,ie)),de}}function W(L,M,G,ee,z){var ie=L.target,de=ie.controls[L.corner],he=ie.canvas.getZoom(),se=ie.padding/he,Ee=ie.toLocalPoint(new x.Point(ee,z),M,G);return Ee.x>=se&&(Ee.x-=se),Ee.x<=-se&&(Ee.x+=se),Ee.y>=se&&(Ee.y-=se),Ee.y<=se&&(Ee.y+=se),Ee.x-=de.offsetX,Ee.y-=de.offsetY,Ee}function P(L){return L.flipX!==L.flipY}function R(L,M,G,ee,z){if(L[M]!==0){var ie=z/L._getTransformedDimensions()[ee]*L[G];L.set(G,ie)}}function V(L,M,G,ee){var z,ie=M.target,de=ie._getTransformedDimensions(0,ie.skewY),he=W(M,M.originX,M.originY,G,ee),se=Math.abs(2*he.x)-de.x,Ee=ie.skewX;se<2?z=0:(z=C(Math.atan2(se/ie.scaleX,de.y/ie.scaleY)),M.originX===a&&M.originY===E&&(z=-z),M.originX===A&&M.originY===c&&(z=-z),P(ie)&&(z=-z));var ce=Ee!==z;if(ce){var pe=ie._getTransformedDimensions().y;ie.set("skewX",z),R(ie,"skewY","scaleY","y",pe)}return ce}function J(L,M,G,ee){var z,ie=M.target,de=ie._getTransformedDimensions(ie.skewX,0),he=W(M,M.originX,M.originY,G,ee),se=Math.abs(2*he.y)-de.y,Ee=ie.skewY;se<2?z=0:(z=C(Math.atan2(se/ie.scaleY,de.x/ie.scaleX)),M.originX===a&&M.originY===E&&(z=-z),M.originX===A&&M.originY===c&&(z=-z),P(ie)&&(z=-z));var ce=Ee!==z;if(ce){var pe=ie._getTransformedDimensions().x;ie.set("skewY",z),R(ie,"skewX","scaleX","x",pe)}return ce}function q(L,M,G,ee,z){z=z||{};var ie,de,he,se,Ee,ce,pe=M.target,_e=pe.lockScalingX,Be=pe.lockScalingY,Te=z.by,Re=b(L,pe),tt=N(pe,Te,Re),lt=M.gestureScale;if(tt)return!1;if(lt)de=M.scaleX*lt,he=M.scaleY*lt;else{if(ie=W(M,M.originX,M.originY,G,ee),Ee=Te!=="y"?y(ie.x):1,ce=Te!=="x"?y(ie.y):1,M.signX||(M.signX=Ee),M.signY||(M.signY=ce),pe.lockScalingFlip&&(M.signX!==Ee||M.signY!==ce))return!1;if(se=pe._getTransformedDimensions(),Re&&!Te){var Ft=Math.abs(ie.x)+Math.abs(ie.y),Ne=M.original,rt=Ft/(Math.abs(se.x*Ne.scaleX/pe.scaleX)+Math.abs(se.y*Ne.scaleY/pe.scaleY));de=Ne.scaleX*rt,he=Ne.scaleY*rt}else de=Math.abs(ie.x*pe.scaleX/se.x),he=Math.abs(ie.y*pe.scaleY/se.y);O(M)&&(de*=2,he*=2),M.signX!==Ee&&Te!=="y"&&(M.originX=p[M.originX],de*=-1,M.signX=Ee),M.signY!==ce&&Te!=="x"&&(M.originY=p[M.originY],he*=-1,M.signY=ce)}var ft=pe.scaleX,Lt=pe.scaleY;return Te?(Te==="x"&&pe.set("scaleX",de),Te==="y"&&pe.set("scaleY",he)):(!_e&&pe.set("scaleX",de),!Be&&pe.set("scaleY",he)),ft!==pe.scaleX||Lt!==pe.scaleY}n.scaleCursorStyleHandler=function(L,M,G){var ee=b(L,G),z="";if(M.x!==0&&M.y===0?z="x":M.x===0&&M.y!==0&&(z="y"),N(G,z,ee))return"not-allowed";var ie=S(G,M);return l[ie]+"-resize"},n.skewCursorStyleHandler=function(L,M,G){var ee="not-allowed";if(M.x!==0&&G.lockSkewingY||M.y!==0&&G.lockSkewingX)return ee;var z=S(G,M)%4;return f[z]+"-resize"},n.scaleSkewCursorStyleHandler=function(L,M,G){return L[G.canvas.altActionKey]?n.skewCursorStyleHandler(L,M,G):n.scaleCursorStyleHandler(L,M,G)},n.rotationWithSnapping=Y("rotating",Z(function(L,M,G,ee){var z=M,ie=z.target,de=ie.translateToOriginPoint(ie.getCenterPoint(),z.originX,z.originY);if(ie.lockRotation)return!1;var he,se=Math.atan2(z.ey-de.y,z.ex-de.x),Ee=Math.atan2(ee-de.y,G-de.x),ce=C(Ee-se+z.theta);if(ie.snapAngle>0){var pe=ie.snapAngle,_e=ie.snapThreshold||pe,Be=Math.ceil(ce/pe)*pe,Te=Math.floor(ce/pe)*pe;Math.abs(ce-Te)<_e?ce=Te:Math.abs(ce-Be)<_e&&(ce=Be)}return ce<0&&(ce=360+ce),ce%=360,he=ie.angle!==ce,ie.angle=ce,he})),n.scalingEqually=Y("scaling",Z(function(L,M,G,ee){return q(L,M,G,ee)})),n.scalingX=Y("scaling",Z(function(L,M,G,ee){return q(L,M,G,ee,{by:"x"})})),n.scalingY=Y("scaling",Z(function(L,M,G,ee){return q(L,M,G,ee,{by:"y"})})),n.scalingYOrSkewingX=function(L,M,G,ee){return L[M.target.canvas.altActionKey]?n.skewHandlerX(L,M,G,ee):n.scalingY(L,M,G,ee)},n.scalingXOrSkewingY=function(L,M,G,ee){return L[M.target.canvas.altActionKey]?n.skewHandlerY(L,M,G,ee):n.scalingX(L,M,G,ee)},n.changeWidth=Y("resizing",Z(function(L,M,G,ee){var z=M.target,ie=W(M,M.originX,M.originY,G,ee),de=z.strokeWidth/(z.strokeUniform?z.scaleX:1),he=O(M)?2:1,se=z.width,Ee=Math.abs(ie.x*he/z.scaleX)-de;return z.set("width",Math.max(Ee,0)),se!==Ee})),n.skewHandlerX=function(L,M,G,ee){var z,ie=M.target,de=ie.skewX,he=M.originY;return!ie.lockSkewingX&&(de===0?z=W(M,d,d,G,ee).x>0?a:A:(de>0&&(z=he===c?a:A),de<0&&(z=he===c?A:a),P(ie)&&(z=z===a?A:a)),M.originX=z,Y("skewing",Z(V))(L,M,G,ee))},n.skewHandlerY=function(L,M,G,ee){var z,ie=M.target,de=ie.skewY,he=M.originX;return!ie.lockSkewingY&&(de===0?z=W(M,d,d,G,ee).y>0?c:E:(de>0&&(z=he===a?c:E),de<0&&(z=he===a?E:c),P(ie)&&(z=z===c?E:c)),M.originY=z,Y("skewing",Z(J))(L,M,G,ee))},n.dragHandler=function(L,M,G,ee){var z=M.target,ie=G-M.offsetX,de=ee-M.offsetY,he=!z.get("lockMovementX")&&z.left!==ie,se=!z.get("lockMovementY")&&z.top!==de;return he&&z.set("left",ie),se&&z.set("top",de),(he||se)&&w("moving",j(L,M,G,ee)),he||se},n.scaleOrSkewActionName=function(L,M,G){var ee=L[G.canvas.altActionKey];return M.x===0?ee?"skewX":"scaleY":M.y===0?ee?"skewY":"scaleX":void 0},n.rotationStyleHandler=function(L,M,G){return G.lockRotation?"not-allowed":M.cursorStyle},n.fireEvent=w,n.wrapWithFixedAnchor=Z,n.wrapWithFireEvent=Y,n.getLocalPoint=W,x.controlsUtils=n}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.degreesToRadians,f=x.controlsUtils;f.renderCircleControl=function(n,a,c,A,E){A=A||{};var d,p=this.sizeX||A.cornerSize||E.cornerSize,C=this.sizeY||A.cornerSize||E.cornerSize,y=A.transparentCorners!==void 0?A.transparentCorners:E.transparentCorners,S=y?"stroke":"fill",w=!y&&(A.cornerStrokeColor||E.cornerStrokeColor),b=a,O=c;n.save(),n.fillStyle=A.cornerColor||E.cornerColor,n.strokeStyle=A.cornerStrokeColor||E.cornerStrokeColor,p>C?(d=p,n.scale(1,C/p),O=c*p/C):C>p?(d=C,n.scale(p/C,1),b=a*C/p):d=p,n.lineWidth=1,n.beginPath(),n.arc(b,O,d/2,0,2*Math.PI,!1),n[S](),w&&n.stroke(),n.restore()},f.renderSquareControl=function(n,a,c,A,E){A=A||{};var d=this.sizeX||A.cornerSize||E.cornerSize,p=this.sizeY||A.cornerSize||E.cornerSize,C=A.transparentCorners!==void 0?A.transparentCorners:E.transparentCorners,y=C?"stroke":"fill",S=!C&&(A.cornerStrokeColor||E.cornerStrokeColor),w=d/2,b=p/2;n.save(),n.fillStyle=A.cornerColor||E.cornerColor,n.strokeStyle=A.cornerStrokeColor||E.cornerStrokeColor,n.lineWidth=1,n.translate(a,c),n.rotate(l(E.angle)),n[y+"Rect"](-w,-b,d,p),S&&n.strokeRect(-w,-b,d,p),n.restore()}}(e),function(h){var x=h.fabric||(h.fabric={});x.Control=function(l){for(var f in l)this[f]=l[f]},x.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(l,f){return f.cursorStyle},getActionName:function(l,f){return f.actionName},getVisibility:function(l,f){var n=l._controlsVisibility;return n&&n[f]!==void 0?n[f]:this.visible},setVisibility:function(l){this.visible=l},positionHandler:function(l,f){return x.util.transformPoint({x:this.x*l.x+this.offsetX,y:this.y*l.y+this.offsetY},f)},calcCornerCoords:function(l,f,n,a,c){var A,E,d,p,C=c?this.touchSizeX:this.sizeX,y=c?this.touchSizeY:this.sizeY;if(C&&y&&C!==y){var S=Math.atan2(y,C),w=Math.sqrt(C*C+y*y)/2,b=S-x.util.degreesToRadians(l),O=Math.PI/2-S-x.util.degreesToRadians(l);A=w*x.util.cos(b),E=w*x.util.sin(b),d=w*x.util.cos(O),p=w*x.util.sin(O)}else w=.7071067812*(C&&y?C:f),b=x.util.degreesToRadians(45-l),A=d=w*x.util.cos(b),E=p=w*x.util.sin(b);return{tl:{x:n-p,y:a-d},tr:{x:n+A,y:a-E},bl:{x:n-A,y:a+E},br:{x:n+p,y:a+d}}},render:function(l,f,n,a,c){((a=a||{}).cornerStyle||c.cornerStyle)==="circle"?x.controlsUtils.renderCircleControl.call(this,l,f,n,a,c):x.controlsUtils.renderSquareControl.call(this,l,f,n,a,c)}}}(e),function(){function h(l,f){var n,a,c,A,E=l.getAttribute("style"),d=l.getAttribute("offset")||0;if(d=(d=parseFloat(d)/(/%$/.test(d)?100:1))<0?0:d>1?1:d,E){var p=E.split(/\s*;\s*/);for(p[p.length-1]===""&&p.pop(),A=p.length;A--;){var C=p[A].split(/\s*:\s*/),y=C[0].trim(),S=C[1].trim();y==="stop-color"?n=S:y==="stop-opacity"&&(c=S)}}return n||(n=l.getAttribute("stop-color")||"rgb(0,0,0)"),c||(c=l.getAttribute("stop-opacity")),a=(n=new v.Color(n)).getAlpha(),c=isNaN(parseFloat(c))?1:parseFloat(c),c*=a*f,{offset:d,color:n.toRgb(),opacity:c}}var x=v.util.object.clone;v.Gradient=v.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(l){l||(l={}),l.coords||(l.coords={});var f,n=this;Object.keys(l).forEach(function(a){n[a]=l[a]}),this.id?this.id+="_"+v.Object.__uid++:this.id=v.Object.__uid++,f={x1:l.coords.x1||0,y1:l.coords.y1||0,x2:l.coords.x2||0,y2:l.coords.y2||0},this.type==="radial"&&(f.r1=l.coords.r1||0,f.r2=l.coords.r2||0),this.coords=f,this.colorStops=l.colorStops.slice()},addColorStop:function(l){for(var f in l){var n=new v.Color(l[f]);this.colorStops.push({offset:parseFloat(f),color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(l){var f={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return v.util.populateWithProperties(this,f,l),f},toSVG:function(l,f){var n,a,c,A,E=x(this.coords,!0),d=(f=f||{},x(this.colorStops,!0)),p=E.r1>E.r2,C=this.gradientTransform?this.gradientTransform.concat():v.iMatrix.concat(),y=-this.offsetX,S=-this.offsetY,w=!!f.additionalTransform,b=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(d.sort(function(Z,Y){return Z.offset-Y.offset}),b==="objectBoundingBox"?(y/=l.width,S/=l.height):(y+=l.width/2,S+=l.height/2),l.type==="path"&&this.gradientUnits!=="percentage"&&(y-=l.pathOffset.x,S-=l.pathOffset.y),C[4]-=y,C[5]-=S,A='id="SVGID_'+this.id+'" gradientUnits="'+b+'"',A+=' gradientTransform="'+(w?f.additionalTransform+" ":"")+v.util.matrixToSVG(C)+'" ',this.type==="linear"?c=["<linearGradient ",A,' x1="',E.x1,'" y1="',E.y1,'" x2="',E.x2,'" y2="',E.y2,`">
`]:this.type==="radial"&&(c=["<radialGradient ",A,' cx="',p?E.x1:E.x2,'" cy="',p?E.y1:E.y2,'" r="',p?E.r1:E.r2,'" fx="',p?E.x2:E.x1,'" fy="',p?E.y2:E.y1,`">
`]),this.type==="radial"){if(p)for((d=d.concat()).reverse(),n=0,a=d.length;n<a;n++)d[n].offset=1-d[n].offset;var O=Math.min(E.r1,E.r2);if(O>0){var N=O/Math.max(E.r1,E.r2);for(n=0,a=d.length;n<a;n++)d[n].offset+=N*(1-d[n].offset)}}for(n=0,a=d.length;n<a;n++){var j=d[n];c.push("<stop ",'offset="',100*j.offset+"%",'" style="stop-color:',j.color,j.opacity!==void 0?";stop-opacity: "+j.opacity:";",`"/>
`)}return c.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),c.join("")},toLive:function(l){var f,n,a,c=v.util.object.clone(this.coords);if(this.type){for(this.type==="linear"?f=l.createLinearGradient(c.x1,c.y1,c.x2,c.y2):this.type==="radial"&&(f=l.createRadialGradient(c.x1,c.y1,c.r1,c.x2,c.y2,c.r2)),n=0,a=this.colorStops.length;n<a;n++){var A=this.colorStops[n].color,E=this.colorStops[n].opacity,d=this.colorStops[n].offset;E!==void 0&&(A=new v.Color(A).setAlpha(E).toRgba()),f.addColorStop(d,A)}return f}}}),v.util.object.extend(v.Gradient,{fromElement:function(l,f,n,a){var c=parseFloat(n)/(/%$/.test(n)?100:1);c=c<0?0:c>1?1:c,isNaN(c)&&(c=1);var A,E,d,p,C=l.getElementsByTagName("stop"),y=l.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",S=l.getAttribute("gradientTransform")||"",w=[],b=0,O=0;for(l.nodeName==="linearGradient"||l.nodeName==="LINEARGRADIENT"?(A="linear",E=function(N){return{x1:N.getAttribute("x1")||0,y1:N.getAttribute("y1")||0,x2:N.getAttribute("x2")||"100%",y2:N.getAttribute("y2")||0}}(l)):(A="radial",E=function(N){return{x1:N.getAttribute("fx")||N.getAttribute("cx")||"50%",y1:N.getAttribute("fy")||N.getAttribute("cy")||"50%",r1:0,x2:N.getAttribute("cx")||"50%",y2:N.getAttribute("cy")||"50%",r2:N.getAttribute("r")||"50%"}}(l)),d=C.length;d--;)w.push(h(C[d],c));return p=v.parseTransformAttribute(S),function(N,j,Z,Y){var W,P;Object.keys(j).forEach(function(R){(W=j[R])==="Infinity"?P=1:W==="-Infinity"?P=0:(P=parseFloat(j[R],10),typeof W=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(W)&&(P*=.01,Y==="pixels"&&(R!=="x1"&&R!=="x2"&&R!=="r2"||(P*=Z.viewBoxWidth||Z.width),R!=="y1"&&R!=="y2"||(P*=Z.viewBoxHeight||Z.height)))),j[R]=P})}(0,E,a,y),y==="pixels"&&(b=-f.left,O=-f.top),new v.Gradient({id:l.getAttribute("id"),type:A,coords:E,colorStops:w,gradientUnits:y,gradientTransform:p,offsetX:b,offsetY:O})}})}(),K=v.util.toFixed,v.Pattern=v.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(h,x){if(h||(h={}),this.id=v.Object.__uid++,this.setOptions(h),!h.source||h.source&&typeof h.source!="string")x&&x(this);else{var l=this;this.source=v.util.createImage(),v.util.loadImage(h.source,function(f,n){l.source=f,x&&x(l,n)},null,this.crossOrigin)}},toObject:function(h){var x,l,f=v.Object.NUM_FRACTION_DIGITS;return typeof this.source.src=="string"?x=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(x=this.source.toDataURL()),l={type:"pattern",source:x,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:K(this.offsetX,f),offsetY:K(this.offsetY,f),patternTransform:this.patternTransform?this.patternTransform.concat():null},v.util.populateWithProperties(this,l,h),l},toSVG:function(h){var x=typeof this.source=="function"?this.source():this.source,l=x.width/h.width,f=x.height/h.height,n=this.offsetX/h.width,a=this.offsetY/h.height,c="";return this.repeat!=="repeat-x"&&this.repeat!=="no-repeat"||(f=1,a&&(f+=Math.abs(a))),this.repeat!=="repeat-y"&&this.repeat!=="no-repeat"||(l=1,n&&(l+=Math.abs(n))),x.src?c=x.src:x.toDataURL&&(c=x.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+a+'" width="'+l+'" height="'+f+`">
<image x="0" y="0" width="`+x.width+'" height="'+x.height+'" xlink:href="'+c+`"></image>
</pattern>
`},setOptions:function(h){for(var x in h)this[x]=h[x]},toLive:function(h){var x=this.source;return!x||x.src!==void 0&&(!x.complete||x.naturalWidth===0||x.naturalHeight===0)?"":h.createPattern(x,this.repeat)}}),function(h){var x=h.fabric||(h.fabric={}),l=x.util.toFixed;x.Shadow?x.warn("fabric.Shadow is already defined."):(x.Shadow=x.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(f){for(var n in typeof f=="string"&&(f=this._parseShadow(f)),f)this[n]=f[n];this.id=x.Object.__uid++},_parseShadow:function(f){var n=f.trim(),a=x.Shadow.reOffsetsAndBlur.exec(n)||[];return{color:(n.replace(x.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(a[1],10)||0,offsetY:parseFloat(a[2],10)||0,blur:parseFloat(a[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(f){var n=40,a=40,c=x.Object.NUM_FRACTION_DIGITS,A=x.util.rotateVector({x:this.offsetX,y:this.offsetY},x.util.degreesToRadians(-f.angle)),E=new x.Color(this.color);return f.width&&f.height&&(n=100*l((Math.abs(A.x)+this.blur)/f.width,c)+20,a=100*l((Math.abs(A.y)+this.blur)/f.height,c)+20),f.flipX&&(A.x*=-1),f.flipY&&(A.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+a+'%" height="'+(100+2*a)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+l(this.blur?this.blur/2:0,c)+`"></feGaussianBlur>
	<feOffset dx="`+l(A.x,c)+'" dy="'+l(A.y,c)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+E.toRgb()+'" flood-opacity="'+E.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var f={},n=x.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(a){this[a]!==n[a]&&(f[a]=this[a])},this),f}}),x.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(e),function(){if(v.StaticCanvas)v.warn("fabric.StaticCanvas is already defined.");else{var h=v.util.object.extend,x=v.util.getElementOffset,l=v.util.removeFromArray,f=v.util.toFixed,n=v.util.transformPoint,a=v.util.invertTransform,c=v.util.getNodeCanvas,A=v.util.createCanvasElement,E=new Error("Could not initialize `canvas` element");v.StaticCanvas=v.util.createClass(v.CommonMethods,{initialize:function(d,p){p||(p={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(d,p)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:v.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(d,p){var C=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(d),this._initOptions(p),this.interactive||this._initRetinaScaling(),p.overlayImage&&this.setOverlayImage(p.overlayImage,C),p.backgroundImage&&this.setBackgroundImage(p.backgroundImage,C),p.backgroundColor&&this.setBackgroundColor(p.backgroundColor,C),p.overlayColor&&this.setOverlayColor(p.overlayColor,C),this.calcOffset()},_isRetinaScaling:function(){return v.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,v.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var d=v.devicePixelRatio;this.__initRetinaScaling(d,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(d,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(d,p,C){p.setAttribute("width",this.width*d),p.setAttribute("height",this.height*d),C.scale(d,d)},calcOffset:function(){return this._offset=x(this.lowerCanvasEl),this},setOverlayImage:function(d,p,C){return this.__setBgOverlayImage("overlayImage",d,p,C)},setBackgroundImage:function(d,p,C){return this.__setBgOverlayImage("backgroundImage",d,p,C)},setOverlayColor:function(d,p){return this.__setBgOverlayColor("overlayColor",d,p)},setBackgroundColor:function(d,p){return this.__setBgOverlayColor("backgroundColor",d,p)},__setBgOverlayImage:function(d,p,C,y){return typeof p=="string"?v.util.loadImage(p,function(S,w){if(S){var b=new v.Image(S,y);this[d]=b,b.canvas=this}C&&C(S,w)},this,y&&y.crossOrigin):(y&&p.setOptions(y),this[d]=p,p&&(p.canvas=this),C&&C(p,!1)),this},__setBgOverlayColor:function(d,p,C){return this[d]=p,this._initGradient(p,d),this._initPattern(p,d,C),this},_createCanvasElement:function(){var d=A();if(!d||(d.style||(d.style={}),d.getContext===void 0))throw E;return d},_initOptions:function(d){var p=this.lowerCanvasEl;this._setOptions(d),this.width=this.width||parseInt(p.width,10)||0,this.height=this.height||parseInt(p.height,10)||0,this.lowerCanvasEl.style&&(p.width=this.width,p.height=this.height,p.style.width=this.width+"px",p.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(d){d&&d.getContext?this.lowerCanvasEl=d:this.lowerCanvasEl=v.util.getById(d)||this._createCanvasElement(),v.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(d,p){return this.setDimensions({width:d},p)},setHeight:function(d,p){return this.setDimensions({height:d},p)},setDimensions:function(d,p){var C;for(var y in p=p||{},d)C=d[y],p.cssOnly||(this._setBackstoreDimension(y,d[y]),C+="px",this.hasLostContext=!0),p.backstoreOnly||this._setCssDimension(y,C);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),p.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(d,p){return this.lowerCanvasEl[d]=p,this.upperCanvasEl&&(this.upperCanvasEl[d]=p),this.cacheCanvasEl&&(this.cacheCanvasEl[d]=p),this[d]=p,this},_setCssDimension:function(d,p){return this.lowerCanvasEl.style[d]=p,this.upperCanvasEl&&(this.upperCanvasEl.style[d]=p),this.wrapperEl&&(this.wrapperEl.style[d]=p),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(d){var p,C,y,S=this._activeObject,w=this.backgroundImage,b=this.overlayImage;for(this.viewportTransform=d,C=0,y=this._objects.length;C<y;C++)(p=this._objects[C]).group||p.setCoords(!0);return S&&S.setCoords(),w&&w.setCoords(!0),b&&b.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(d,p){var C=d,y=this.viewportTransform.slice(0);d=n(d,a(this.viewportTransform)),y[0]=p,y[3]=p;var S=n(d,y);return y[4]+=C.x-S.x,y[5]+=C.y-S.y,this.setViewportTransform(y)},setZoom:function(d){return this.zoomToPoint(new v.Point(0,0),d),this},absolutePan:function(d){var p=this.viewportTransform.slice(0);return p[4]=-d.x,p[5]=-d.y,this.setViewportTransform(p)},relativePan:function(d){return this.absolutePan(new v.Point(-d.x-this.viewportTransform[4],-d.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(d){this.stateful&&d.setupState(),d._set("canvas",this),d.setCoords(),this.fire("object:added",{target:d}),d.fire("added")},_onObjectRemoved:function(d){this.fire("object:removed",{target:d}),d.fire("removed"),delete d.canvas},clearContext:function(d){return d.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var d=this.contextContainer;return this.renderCanvas(d,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=v.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var d={},p=this.width,C=this.height,y=a(this.viewportTransform);return d.tl=n({x:0,y:0},y),d.br=n({x:p,y:C},y),d.tr=new v.Point(d.br.x,d.tl.y),d.bl=new v.Point(d.tl.x,d.br.y),this.vptCoords=d,d},cancelRequestedRender:function(){this.isRendering&&(v.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(d,p){var C=this.viewportTransform,y=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(d),v.util.setImageSmoothing(d,this.imageSmoothingEnabled),this.fire("before:render",{ctx:d}),this._renderBackground(d),d.save(),d.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._renderObjects(d,p),d.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(d),y&&(y.canvas=this,y.shouldCache(),y._transformDone=!0,y.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(d)),this._renderOverlay(d),this.controlsAboveOverlay&&this.interactive&&this.drawControls(d),this.fire("after:render",{ctx:d})},drawClipPathOnCanvas:function(d){var p=this.viewportTransform,C=this.clipPath;d.save(),d.transform(p[0],p[1],p[2],p[3],p[4],p[5]),d.globalCompositeOperation="destination-in",C.transform(d),d.scale(1/C.zoomX,1/C.zoomY),d.drawImage(C._cacheCanvas,-C.cacheTranslationX,-C.cacheTranslationY),d.restore()},_renderObjects:function(d,p){var C,y;for(C=0,y=p.length;C<y;++C)p[C]&&p[C].render(d)},_renderBackgroundOrOverlay:function(d,p){var C=this[p+"Color"],y=this[p+"Image"],S=this.viewportTransform,w=this[p+"Vpt"];if(C||y){if(C){d.save(),d.beginPath(),d.moveTo(0,0),d.lineTo(this.width,0),d.lineTo(this.width,this.height),d.lineTo(0,this.height),d.closePath(),d.fillStyle=C.toLive?C.toLive(d,this):C,w&&d.transform(S[0],S[1],S[2],S[3],S[4],S[5]),d.transform(1,0,0,1,C.offsetX||0,C.offsetY||0);var b=C.gradientTransform||C.patternTransform;b&&d.transform(b[0],b[1],b[2],b[3],b[4],b[5]),d.fill(),d.restore()}y&&(d.save(),w&&d.transform(S[0],S[1],S[2],S[3],S[4],S[5]),y.render(d),d.restore())}},_renderBackground:function(d){this._renderBackgroundOrOverlay(d,"background")},_renderOverlay:function(d){this._renderBackgroundOrOverlay(d,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new v.Point(this.width/2,this.height/2)},centerObjectH:function(d){return this._centerObject(d,new v.Point(this.getCenterPoint().x,d.getCenterPoint().y))},centerObjectV:function(d){return this._centerObject(d,new v.Point(d.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(d){var p=this.getCenterPoint();return this._centerObject(d,p)},viewportCenterObject:function(d){var p=this.getVpCenter();return this._centerObject(d,p)},viewportCenterObjectH:function(d){var p=this.getVpCenter();return this._centerObject(d,new v.Point(p.x,d.getCenterPoint().y)),this},viewportCenterObjectV:function(d){var p=this.getVpCenter();return this._centerObject(d,new v.Point(d.getCenterPoint().x,p.y))},getVpCenter:function(){var d=this.getCenterPoint(),p=a(this.viewportTransform);return n(d,p)},_centerObject:function(d,p){return d.setPositionByOrigin(p,"center","center"),d.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(d){return this.toDatalessObject(d)},toObject:function(d){return this._toObjectMethod("toObject",d)},toDatalessObject:function(d){return this._toObjectMethod("toDatalessObject",d)},_toObjectMethod:function(d,p){var C=this.clipPath,y={version:v.version,objects:this._toObjects(d,p)};return C&&!C.excludeFromExport&&(y.clipPath=this._toObject(this.clipPath,d,p)),h(y,this.__serializeBgOverlay(d,p)),v.util.populateWithProperties(this,y,p),y},_toObjects:function(d,p){return this._objects.filter(function(C){return!C.excludeFromExport}).map(function(C){return this._toObject(C,d,p)},this)},_toObject:function(d,p,C){var y;this.includeDefaultValues||(y=d.includeDefaultValues,d.includeDefaultValues=!1);var S=d[p](C);return this.includeDefaultValues||(d.includeDefaultValues=y),S},__serializeBgOverlay:function(d,p){var C={},y=this.backgroundImage,S=this.overlayImage,w=this.backgroundColor,b=this.overlayColor;return w&&w.toObject?w.excludeFromExport||(C.background=w.toObject(p)):w&&(C.background=w),b&&b.toObject?b.excludeFromExport||(C.overlay=b.toObject(p)):b&&(C.overlay=b),y&&!y.excludeFromExport&&(C.backgroundImage=this._toObject(y,d,p)),S&&!S.excludeFromExport&&(C.overlayImage=this._toObject(S,d,p)),C},svgViewportTransformation:!0,toSVG:function(d,p){d||(d={}),d.reviver=p;var C=[];return this._setSVGPreamble(C,d),this._setSVGHeader(C,d),this.clipPath&&C.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(C,"background"),this._setSVGBgOverlayImage(C,"backgroundImage",p),this._setSVGObjects(C,p),this.clipPath&&C.push(`</g>
`),this._setSVGBgOverlayColor(C,"overlay"),this._setSVGBgOverlayImage(C,"overlayImage",p),C.push("</svg>"),C.join("")},_setSVGPreamble:function(d,p){p.suppressPreamble||d.push('<?xml version="1.0" encoding="',p.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(d,p){var C,y=p.width||this.width,S=p.height||this.height,w='viewBox="0 0 '+this.width+" "+this.height+'" ',b=v.Object.NUM_FRACTION_DIGITS;p.viewBox?w='viewBox="'+p.viewBox.x+" "+p.viewBox.y+" "+p.viewBox.width+" "+p.viewBox.height+'" ':this.svgViewportTransformation&&(C=this.viewportTransform,w='viewBox="'+f(-C[4]/C[0],b)+" "+f(-C[5]/C[3],b)+" "+f(this.width/C[0],b)+" "+f(this.height/C[3],b)+'" '),d.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',y,'" ','height="',S,'" ',w,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",v.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(p),`</defs>
`)},createSVGClipPathMarkup:function(d){var p=this.clipPath;return p?(p.clipPathId="CLIPPATH_"+v.Object.__uid++,'<clipPath id="'+p.clipPathId+`" >
`+this.clipPath.toClipPathSVG(d.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var d=this;return["background","overlay"].map(function(p){var C=d[p+"Color"];if(C&&C.toLive){var y=d[p+"Vpt"],S=d.viewportTransform,w={width:d.width/(y?S[0]:1),height:d.height/(y?S[3]:1)};return C.toSVG(w,{additionalTransform:y?v.util.matrixToSVG(S):""})}}).join("")},createSVGFontFacesMarkup:function(){var d,p,C,y,S,w,b,O,N="",j={},Z=v.fontPaths,Y=[];for(this._objects.forEach(function P(R){Y.push(R),R._objects&&R._objects.forEach(P)}),b=0,O=Y.length;b<O;b++)if(p=(d=Y[b]).fontFamily,d.type.indexOf("text")!==-1&&!j[p]&&Z[p]&&(j[p]=!0,d.styles))for(S in C=d.styles)for(w in y=C[S])!j[p=y[w].fontFamily]&&Z[p]&&(j[p]=!0);for(var W in j)N+=[`		@font-face {
`,"			font-family: '",W,`';
`,"			src: url('",Z[W],`');
`,`		}
`].join("");return N&&(N=['	<style type="text/css">',`<![CDATA[
`,N,"]]>",`</style>
`].join("")),N},_setSVGObjects:function(d,p){var C,y,S,w=this._objects;for(y=0,S=w.length;y<S;y++)(C=w[y]).excludeFromExport||this._setSVGObject(d,C,p)},_setSVGObject:function(d,p,C){d.push(p.toSVG(C))},_setSVGBgOverlayImage:function(d,p,C){this[p]&&!this[p].excludeFromExport&&this[p].toSVG&&d.push(this[p].toSVG(C))},_setSVGBgOverlayColor:function(d,p){var C=this[p+"Color"],y=this.viewportTransform,S=this.width,w=this.height;if(C)if(C.toLive){var b=C.repeat,O=v.util.invertTransform(y),N=this[p+"Vpt"]?v.util.matrixToSVG(O):"";d.push('<rect transform="'+N+" translate(",S/2,",",w/2,')"',' x="',C.offsetX-S/2,'" y="',C.offsetY-w/2,'" ','width="',b==="repeat-y"||b==="no-repeat"?C.source.width:S,'" height="',b==="repeat-x"||b==="no-repeat"?C.source.height:w,'" fill="url(#SVGID_'+C.id+')"',`></rect>
`)}else d.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',C,'"',`></rect>
`)},sendToBack:function(d){if(!d)return this;var p,C,y,S=this._activeObject;if(d===S&&d.type==="activeSelection")for(p=(y=S._objects).length;p--;)C=y[p],l(this._objects,C),this._objects.unshift(C);else l(this._objects,d),this._objects.unshift(d);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(d){if(!d)return this;var p,C,y,S=this._activeObject;if(d===S&&d.type==="activeSelection")for(y=S._objects,p=0;p<y.length;p++)C=y[p],l(this._objects,C),this._objects.push(C);else l(this._objects,d),this._objects.push(d);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(d,p){if(!d)return this;var C,y,S,w,b,O=this._activeObject,N=0;if(d===O&&d.type==="activeSelection")for(b=O._objects,C=0;C<b.length;C++)y=b[C],(S=this._objects.indexOf(y))>0+N&&(w=S-1,l(this._objects,y),this._objects.splice(w,0,y)),N++;else(S=this._objects.indexOf(d))!==0&&(w=this._findNewLowerIndex(d,S,p),l(this._objects,d),this._objects.splice(w,0,d));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(d,p,C){var y,S;if(C){for(y=p,S=p-1;S>=0;--S)if(d.intersectsWithObject(this._objects[S])||d.isContainedWithinObject(this._objects[S])||this._objects[S].isContainedWithinObject(d)){y=S;break}}else y=p-1;return y},bringForward:function(d,p){if(!d)return this;var C,y,S,w,b,O=this._activeObject,N=0;if(d===O&&d.type==="activeSelection")for(C=(b=O._objects).length;C--;)y=b[C],(S=this._objects.indexOf(y))<this._objects.length-1-N&&(w=S+1,l(this._objects,y),this._objects.splice(w,0,y)),N++;else(S=this._objects.indexOf(d))!==this._objects.length-1&&(w=this._findNewUpperIndex(d,S,p),l(this._objects,d),this._objects.splice(w,0,d));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(d,p,C){var y,S,w;if(C){for(y=p,S=p+1,w=this._objects.length;S<w;++S)if(d.intersectsWithObject(this._objects[S])||d.isContainedWithinObject(this._objects[S])||this._objects[S].isContainedWithinObject(d)){y=S;break}}else y=p+1;return y},moveTo:function(d,p){return l(this._objects,d),this._objects.splice(p,0,d),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(v.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(d){d.dispose&&d.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),v.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),v.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),h(v.StaticCanvas.prototype,v.Observable),h(v.StaticCanvas.prototype,v.Collection),h(v.StaticCanvas.prototype,v.DataURLExporter),h(v.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(d){var p=A();if(!p||!p.getContext)return null;var C=p.getContext("2d");return C&&d==="setLineDash"?C.setLineDash!==void 0:null}}),v.StaticCanvas.prototype.toJSON=v.StaticCanvas.prototype.toObject,v.isLikelyNode&&(v.StaticCanvas.prototype.createPNGStream=function(){var d=c(this.lowerCanvasEl);return d&&d.createPNGStream()},v.StaticCanvas.prototype.createJPEGStream=function(d){var p=c(this.lowerCanvasEl);return p&&p.createJPEGStream(d)})}}(),v.BaseBrush=v.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(h){h.strokeStyle=this.color,h.lineWidth=this.width,h.lineCap=this.strokeLineCap,h.miterLimit=this.strokeMiterLimit,h.lineJoin=this.strokeLineJoin,h.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(h){var x=this.canvas.viewportTransform;h.save(),h.transform(x[0],x[1],x[2],x[3],x[4],x[5])},_setShadow:function(){if(this.shadow){var h=this.canvas,x=this.shadow,l=h.contextTop,f=h.getZoom();h&&h._isRetinaScaling()&&(f*=v.devicePixelRatio),l.shadowColor=x.color,l.shadowBlur=x.blur*f,l.shadowOffsetX=x.offsetX*f,l.shadowOffsetY=x.offsetY*f}},needsFullRender:function(){return new v.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var h=this.canvas.contextTop;h.shadowColor="",h.shadowBlur=h.shadowOffsetX=h.shadowOffsetY=0},_isOutSideCanvas:function(h){return h.x<0||h.x>this.canvas.getWidth()||h.y<0||h.y>this.canvas.getHeight()}}),v.PencilBrush=v.util.createClass(v.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(h){this.canvas=h,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(h,x,l){var f=x.midPointFrom(l);return h.quadraticCurveTo(x.x,x.y,f.x,f.y),f},onMouseDown:function(h,x){this.canvas._isMainEvent(x.e)&&(this.drawStraightLine=x.e[this.straightLineKey],this._prepareForDrawing(h),this._captureDrawingPath(h),this._render())},onMouseMove:function(h,x){if(this.canvas._isMainEvent(x.e)&&(this.drawStraightLine=x.e[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(h))&&this._captureDrawingPath(h)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var l=this._points,f=l.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,l[f-2],l[f-1],!0),n.stroke(),n.restore()}},onMouseUp:function(h){return!this.canvas._isMainEvent(h.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(h){var x=new v.Point(h.x,h.y);this._reset(),this._addPoint(x),this.canvas.contextTop.moveTo(x.x,x.y)},_addPoint:function(h){return!(this._points.length>1&&h.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(h),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(h){var x=new v.Point(h.x,h.y);return this._addPoint(x)},_render:function(h){var x,l,f=this._points[0],n=this._points[1];if(h=h||this.canvas.contextTop,this._saveAndTransform(h),h.beginPath(),this._points.length===2&&f.x===n.x&&f.y===n.y){var a=this.width/1e3;f=new v.Point(f.x,f.y),n=new v.Point(n.x,n.y),f.x-=a,n.x+=a}for(h.moveTo(f.x,f.y),x=1,l=this._points.length;x<l;x++)this._drawSegment(h,f,n),f=this._points[x],n=this._points[x+1];h.lineTo(f.x,f.y),h.stroke(),h.restore()},convertPointsToSVGPath:function(h){var x=this.width/1e3;return v.util.getSmoothPathFromPoints(h,x)},_isEmptySVGPath:function(h){return v.util.joinPath(h)==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(h){var x=new v.Path(h,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,x.shadow=new v.Shadow(this.shadow)),x},decimatePoints:function(h,x){if(h.length<=2)return h;var l,f=this.canvas.getZoom(),n=Math.pow(x/f,2),a=h.length-1,c=h[0],A=[c];for(l=1;l<a-1;l++)Math.pow(c.x-h[l].x,2)+Math.pow(c.y-h[l].y,2)>=n&&(c=h[l],A.push(c));return A.push(h[a]),A},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var h=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(h))this.canvas.requestRenderAll();else{var x=this.createPath(h);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:x}),this.canvas.add(x),this.canvas.requestRenderAll(),x.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:x})}}}),v.CircleBrush=v.util.createClass(v.BaseBrush,{width:10,initialize:function(h){this.canvas=h,this.points=[]},drawDot:function(h){var x=this.addPoint(h),l=this.canvas.contextTop;this._saveAndTransform(l),this.dot(l,x),l.restore()},dot:function(h,x){h.fillStyle=x.fill,h.beginPath(),h.arc(x.x,x.y,x.radius,0,2*Math.PI,!1),h.closePath(),h.fill()},onMouseDown:function(h){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(h)},_render:function(){var h,x,l=this.canvas.contextTop,f=this.points;for(this._saveAndTransform(l),h=0,x=f.length;h<x;h++)this.dot(l,f[h]);l.restore()},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(h),this._render()):this.drawDot(h))},onMouseUp:function(){var h,x,l=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var f=[];for(h=0,x=this.points.length;h<x;h++){var n=this.points[h],a=new v.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(a.shadow=new v.Shadow(this.shadow)),f.push(a)}var c=new v.Group(f);c.canvas=this.canvas,this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=l,this.canvas.requestRenderAll()},addPoint:function(h){var x=new v.Point(h.x,h.y),l=v.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,f=new v.Color(this.color).setAlpha(v.util.getRandomInt(0,100)/100).toRgba();return x.radius=l,x.fill=f,this.points.push(x),x}}),v.SprayBrush=v.util.createClass(v.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(h){this.canvas=h,this.sprayChunks=[]},onMouseDown:function(h){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(h),this.render(this.sprayChunkPoints)},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.addSprayChunk(h),this.render(this.sprayChunkPoints))},onMouseUp:function(){var h=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var x=[],l=0,f=this.sprayChunks.length;l<f;l++)for(var n=this.sprayChunks[l],a=0,c=n.length;a<c;a++){var A=new v.Rect({width:n[a].width,height:n[a].width,left:n[a].x+1,top:n[a].y+1,originX:"center",originY:"center",fill:this.color});x.push(A)}this.optimizeOverlapping&&(x=this._getOptimizedRects(x));var E=new v.Group(x);this.shadow&&E.set("shadow",new v.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:E}),this.canvas.add(E),this.canvas.fire("path:created",{path:E}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=h,this.canvas.requestRenderAll()},_getOptimizedRects:function(h){var x,l,f,n={};for(l=0,f=h.length;l<f;l++)n[x=h[l].left+""+h[l].top]||(n[x]=h[l]);var a=[];for(x in n)a.push(n[x]);return a},render:function(h){var x,l,f=this.canvas.contextTop;for(f.fillStyle=this.color,this._saveAndTransform(f),x=0,l=h.length;x<l;x++){var n=h[x];n.opacity!==void 0&&(f.globalAlpha=n.opacity),f.fillRect(n.x,n.y,n.width,n.width)}f.restore()},_render:function(){var h,x,l=this.canvas.contextTop;for(l.fillStyle=this.color,this._saveAndTransform(l),h=0,x=this.sprayChunks.length;h<x;h++)this.render(this.sprayChunks[h]);l.restore()},addSprayChunk:function(h){this.sprayChunkPoints=[];var x,l,f,n,a=this.width/2;for(n=0;n<this.density;n++){x=v.util.getRandomInt(h.x-a,h.x+a),l=v.util.getRandomInt(h.y-a,h.y+a),f=this.dotWidthVariance?v.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var c=new v.Point(x,l);c.width=f,this.randomOpacity&&(c.opacity=v.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(c)}this.sprayChunks.push(this.sprayChunkPoints)}}),v.PatternBrush=v.util.createClass(v.PencilBrush,{getPatternSrc:function(){var h=v.util.createCanvasElement(),x=h.getContext("2d");return h.width=h.height=25,x.fillStyle=this.color,x.beginPath(),x.arc(10,10,10,0,2*Math.PI,!1),x.closePath(),x.fill(),h},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(h){return h.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(h){this.callSuper("_setBrushStyles",h),h.strokeStyle=this.getPattern(h)},createPath:function(h){var x=this.callSuper("createPath",h),l=x._getLeftTopCoords().scalarAdd(x.strokeWidth/2);return x.stroke=new v.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-l.x,offsetY:-l.y}),x}}),function(){var h=v.util.getPointer,x=v.util.degreesToRadians,l=v.util.isTouchEvent;for(var f in v.Canvas=v.util.createClass(v.StaticCanvas,{initialize:function(n,a){a||(a={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,a),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=v.PencilBrush&&new v.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n,a,c,A=this.getActiveObjects();if(A.length>0&&!this.preserveObjectStacking){a=[],c=[];for(var E=0,d=this._objects.length;E<d;E++)n=this._objects[E],A.indexOf(n)===-1?a.push(n):c.push(n);A.length>1&&(this._activeObject._objects=c),a.push.apply(a,c)}else a=this._objects;return a},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,a){var c=n.calcTransformMatrix(),A=v.util.invertTransform(c),E=this.restorePointerVpt(a);return v.util.transformPoint(E,A)},isTargetTransparent:function(n,a,c){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var A=this._normalizePointer(n,{x:a,y:c}),E=Math.max(n.cacheTranslationX+A.x*n.zoomX,0),d=Math.max(n.cacheTranslationY+A.y*n.zoomY,0);return v.util.isTransparent(n._cacheContext,Math.round(E),Math.round(d),this.targetFindTolerance)}var p=this.contextCache,C=n.selectionBackgroundColor,y=this.viewportTransform;return n.selectionBackgroundColor="",this.clearContext(p),p.save(),p.transform(y[0],y[1],y[2],y[3],y[4],y[5]),n.render(p),p.restore(),n.selectionBackgroundColor=C,v.util.isTransparent(p,a,c,this.targetFindTolerance)},_isSelectionKeyPressed:function(n){return Array.isArray(this.selectionKey)?!!this.selectionKey.find(function(a){return n[a]===!0}):n[this.selectionKey]},_shouldClearSelection:function(n,a){var c=this.getActiveObjects(),A=this._activeObject;return!a||a&&A&&c.length>1&&c.indexOf(a)===-1&&A!==a&&!this._isSelectionKeyPressed(n)||a&&!a.evented||a&&!a.selectable&&A&&A!==a},_shouldCenterTransform:function(n,a,c){var A;if(n)return a==="scale"||a==="scaleX"||a==="scaleY"||a==="resizing"?A=this.centeredScaling||n.centeredScaling:a==="rotate"&&(A=this.centeredRotation||n.centeredRotation),A?!c:c},_getOriginFromCorner:function(n,a){var c={x:n.originX,y:n.originY};return a==="ml"||a==="tl"||a==="bl"?c.x="right":a!=="mr"&&a!=="tr"&&a!=="br"||(c.x="left"),a==="tl"||a==="mt"||a==="tr"?c.y="bottom":a!=="bl"&&a!=="mb"&&a!=="br"||(c.y="top"),c},_getActionFromCorner:function(n,a,c,A){if(!a||!n)return"drag";var E=A.controls[a];return E.getActionName(c,E,A)},_setupCurrentTransform:function(n,a,c){if(a){var A=this.getPointer(n),E=a.__corner,d=a.controls[E],p=c&&E?d.getActionHandler(n,a,d):v.controlsUtils.dragHandler,C=this._getActionFromCorner(c,E,n,a),y=this._getOriginFromCorner(a,E),S=n[this.centeredKey],w={target:a,action:C,actionHandler:p,corner:E,scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,offsetX:A.x-a.left,offsetY:A.y-a.top,originX:y.x,originY:y.y,ex:A.x,ey:A.y,lastX:A.x,lastY:A.y,theta:x(a.angle),width:a.width*a.scaleX,shiftKey:n.shiftKey,altKey:S,original:v.util.saveObjectTransform(a)};this._shouldCenterTransform(a,C,S)&&(w.originX="center",w.originY="center"),w.original.originX=y.x,w.original.originY=y.y,this._currentTransform=w,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var a=this._groupSelector,c=new v.Point(a.ex,a.ey),A=v.util.transformPoint(c,this.viewportTransform),E=new v.Point(a.ex+a.left,a.ey+a.top),d=v.util.transformPoint(E,this.viewportTransform),p=Math.min(A.x,d.x),C=Math.min(A.y,d.y),y=Math.max(A.x,d.x),S=Math.max(A.y,d.y),w=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(p,C,y-p,S-C)),this.selectionLineWidth&&this.selectionBorderColor&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,p+=w,C+=w,y-=w,S-=w,v.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(p,C,y-p,S-C))},findTarget:function(n,a){if(!this.skipTargetFind){var c,A,E=this.getPointer(n,!0),d=this._activeObject,p=this.getActiveObjects(),C=l(n),y=p.length>1&&!a||p.length===1;if(this.targets=[],y&&d._findTargetCorner(E,C)||p.length>1&&!a&&d===this._searchPossibleTargets([d],E))return d;if(p.length===1&&d===this._searchPossibleTargets([d],E)){if(!this.preserveObjectStacking)return d;c=d,A=this.targets,this.targets=[]}var S=this._searchPossibleTargets(this._objects,E);return n[this.altSelectionKey]&&S&&c&&S!==c&&(S=c,this.targets=A),S}},_checkTarget:function(n,a,c){if(a&&a.visible&&a.evented&&a.containsPoint(n)&&(!this.perPixelTargetFind&&!a.perPixelTargetFind||a.isEditing||!this.isTargetTransparent(a,c.x,c.y)))return!0},_searchPossibleTargets:function(n,a){for(var c,A,E=n.length;E--;){var d=n[E],p=d.group?this._normalizePointer(d.group,a):a;if(this._checkTarget(p,d,a)){(c=n[E]).subTargetCheck&&c instanceof v.Group&&(A=this._searchPossibleTargets(c._objects,a))&&this.targets.push(A);break}}return c},restorePointerVpt:function(n){return v.util.transformPoint(n,v.util.invertTransform(this.viewportTransform))},getPointer:function(n,a){if(this._absolutePointer&&!a)return this._absolutePointer;if(this._pointer&&a)return this._pointer;var c,A=h(n),E=this.upperCanvasEl,d=E.getBoundingClientRect(),p=d.width||0,C=d.height||0;p&&C||("top"in d&&"bottom"in d&&(C=Math.abs(d.top-d.bottom)),"right"in d&&"left"in d&&(p=Math.abs(d.right-d.left))),this.calcOffset(),A.x=A.x-this._offset.left,A.y=A.y-this._offset.top,a||(A=this.restorePointerVpt(A));var y=this.getRetinaScaling();return y!==1&&(A.x/=y,A.y/=y),c=p===0||C===0?{width:1,height:1}:{width:E.width/p,height:E.height/C},{x:A.x*c.width,y:A.y*c.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),a=this.lowerCanvasEl,c=this.upperCanvasEl;c?c.className="":(c=this._createCanvasElement(),this.upperCanvasEl=c),v.util.addClass(c,"upper-canvas "+n),this.wrapperEl.appendChild(c),this._copyCanvasStyle(a,c),this._applyCanvasStyle(c),this.contextTop=c.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=v.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),v.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),v.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var a=this.width||n.width,c=this.height||n.height;v.util.setStyle(n,{position:"absolute",width:a+"px",height:c+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=a,n.height=c,v.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,a){a.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,a){var c=!1,A=this.getActiveObjects(),E=[],d=[];n.forEach(function(p){A.indexOf(p)===-1&&(c=!0,p.fire("deselected",{e:a,target:p}),d.push(p))}),A.forEach(function(p){n.indexOf(p)===-1&&(c=!0,p.fire("selected",{e:a,target:p}),E.push(p))}),n.length>0&&A.length>0?c&&this.fire("selection:updated",{e:a,selected:E,deselected:d}):A.length>0?this.fire("selection:created",{e:a,selected:E}):n.length>0&&this.fire("selection:cleared",{e:a,deselected:d})},setActiveObject:function(n,a){var c=this.getActiveObjects();return this._setActiveObject(n,a),this._fireSelectionEvents(c,a),this},_setActiveObject:function(n,a){return this._activeObject!==n&&!!this._discardActiveObject(a,n)&&!n.onSelect({e:a})&&(this._activeObject=n,!0)},_discardActiveObject:function(n,a){var c=this._activeObject;if(c){if(c.onDeselect({e:n,object:a}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var a=this.getActiveObjects(),c=this.getActiveObject();return a.length&&this.fire("before:selection:cleared",{target:c,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(a,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(a){v.util.cleanUpJsdomNode(this[a]),this[a]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,v.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var a=this._activeObject;a&&a._renderControls(n)},_toObject:function(n,a,c){var A=this._realizeGroupTransformOnObject(n),E=this.callSuper("_toObject",n,a,c);return this._unwindGroupTransformOnObject(n,A),E},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var a={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(c){a[c]=n[c]}),v.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),a}return null},_unwindGroupTransformOnObject:function(n,a){a&&n.set(a)},_setSVGObject:function(n,a,c){var A=this._realizeGroupTransformOnObject(a);this.callSuper("_setSVGObject",n,a,c),this._unwindGroupTransformOnObject(a,A)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),v.StaticCanvas.prototype.setViewportTransform.call(this,n)}}),v.StaticCanvas)f!=="prototype"&&(v.Canvas[f]=v.StaticCanvas[f])}(),function(){var h=v.util.addListener,x=v.util.removeListener,l={passive:!1};function f(n,a){return n.button&&n.button===a-1}v.util.object.extend(v.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(h,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(n,a){var c=this.upperCanvasEl,A=this._getEventPrefix();n(v.window,"resize",this._onResize),n(c,A+"down",this._onMouseDown),n(c,A+"move",this._onMouseMove,l),n(c,A+"out",this._onMouseOut),n(c,A+"enter",this._onMouseEnter),n(c,"wheel",this._onMouseWheel),n(c,"contextmenu",this._onContextMenu),n(c,"dblclick",this._onDoubleClick),n(c,"dragover",this._onDragOver),n(c,"dragenter",this._onDragEnter),n(c,"dragleave",this._onDragLeave),n(c,"drop",this._onDrop),this.enablePointerEvents||n(c,"touchstart",this._onTouchStart,l),typeof eventjs!="undefined"&&a in eventjs&&(eventjs[a](c,"gesture",this._onGesture),eventjs[a](c,"drag",this._onDrag),eventjs[a](c,"orientation",this._onOrientationChange),eventjs[a](c,"shake",this._onShake),eventjs[a](c,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(x,"remove");var n=this._getEventPrefix();x(v.document,n+"up",this._onMouseUp),x(v.document,"touchend",this._onTouchEnd,l),x(v.document,n+"move",this._onMouseMove,l),x(v.document,"touchmove",this._onMouseMove,l)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(n,a){this.__onTransformGesture&&this.__onTransformGesture(n,a)},_onDrag:function(n,a){this.__onDrag&&this.__onDrag(n,a)},_onMouseWheel:function(n){this.__onMouseWheel(n)},_onMouseOut:function(n){var a=this._hoveredTarget;this.fire("mouse:out",{target:a,e:n}),this._hoveredTarget=null,a&&a.fire("mouseout",{e:n});var c=this;this._hoveredTargets.forEach(function(A){c.fire("mouse:out",{target:a,e:n}),A&&a.fire("mouseout",{e:n})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(A){A.isEditing&&A.hiddenTextarea.focus()})},_onMouseEnter:function(n){this._currentTransform||this.findTarget(n)||(this.fire("mouse:over",{target:null,e:n}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(n,a){this.__onOrientationChange&&this.__onOrientationChange(n,a)},_onShake:function(n,a){this.__onShake&&this.__onShake(n,a)},_onLongPress:function(n,a){this.__onLongPress&&this.__onLongPress(n,a)},_onDragOver:function(n){n.preventDefault();var a=this._simpleEventHandler("dragover",n);this._fireEnterLeaveEvents(a,n)},_onDrop:function(n){return this._simpleEventHandler("drop:before",n),this._simpleEventHandler("drop",n)},_onContextMenu:function(n){return this.stopContextMenu&&(n.stopPropagation(),n.preventDefault()),!1},_onDoubleClick:function(n){this._cacheTransformEventData(n),this._handleEvent(n,"dblclick"),this._resetTransformEventData(n)},getPointerId:function(n){var a=n.changedTouches;return a?a[0]&&a[0].identifier:this.enablePointerEvents?n.pointerId:-1},_isMainEvent:function(n){return n.isPrimary===!0||n.isPrimary!==!1&&(n.type==="touchend"&&n.touches.length===0||!n.changedTouches||n.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(n){n.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(n)),this.__onMouseDown(n),this._resetTransformEventData();var a=this.upperCanvasEl,c=this._getEventPrefix();h(v.document,"touchend",this._onTouchEnd,l),h(v.document,"touchmove",this._onMouseMove,l),x(a,c+"down",this._onMouseDown)},_onMouseDown:function(n){this.__onMouseDown(n),this._resetTransformEventData();var a=this.upperCanvasEl,c=this._getEventPrefix();x(a,c+"move",this._onMouseMove,l),h(v.document,c+"up",this._onMouseUp),h(v.document,c+"move",this._onMouseMove,l)},_onTouchEnd:function(n){if(!(n.touches.length>0)){this.__onMouseUp(n),this._resetTransformEventData(),this.mainTouchId=null;var a=this._getEventPrefix();x(v.document,"touchend",this._onTouchEnd,l),x(v.document,"touchmove",this._onMouseMove,l);var c=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){h(c.upperCanvasEl,a+"down",c._onMouseDown),c._willAddMouseDown=0},400)}},_onMouseUp:function(n){this.__onMouseUp(n),this._resetTransformEventData();var a=this.upperCanvasEl,c=this._getEventPrefix();this._isMainEvent(n)&&(x(v.document,c+"up",this._onMouseUp),x(v.document,c+"move",this._onMouseMove,l),h(a,c+"move",this._onMouseMove,l))},_onMouseMove:function(n){!this.allowTouchScrolling&&n.preventDefault&&n.preventDefault(),this.__onMouseMove(n)},_onResize:function(){this.calcOffset()},_shouldRender:function(n){var a=this._activeObject;return!!(!!a!=!!n||a&&n&&a!==n)||(a&&a.isEditing,!1)},__onMouseUp:function(n){var a,c=this._currentTransform,A=this._groupSelector,E=!1,d=!A||A.left===0&&A.top===0;if(this._cacheTransformEventData(n),a=this._target,this._handleEvent(n,"up:before"),f(n,3))this.fireRightClick&&this._handleEvent(n,"up",3,d);else{if(f(n,2))return this.fireMiddleClick&&this._handleEvent(n,"up",2,d),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(n);else if(this._isMainEvent(n)){if(c&&(this._finalizeCurrentTransform(n),E=c.actionPerformed),!d){var p=a===this._activeObject;this._maybeGroupObjects(n),E||(E=this._shouldRender(a)||!p&&a===this._activeObject)}var C,y;if(a){if(C=a._findTargetCorner(this.getPointer(n,!0),v.util.isTouchEvent(n)),a.selectable&&a!==this._activeObject&&a.activeOn==="up")this.setActiveObject(a,n),E=!0;else{var S=a.controls[C],w=S&&S.getMouseUpHandler(n,a,S);w&&w(n,c,(y=this.getPointer(n)).x,y.y)}a.isMoving=!1}if(c&&(c.target!==a||c.corner!==C)){var b=c.target&&c.target.controls[c.corner],O=b&&b.getMouseUpHandler(n,a,S);y=y||this.getPointer(n),O&&O(n,c,y.x,y.y)}this._setCursorFromEvent(n,a),this._handleEvent(n,"up",1,d),this._groupSelector=null,this._currentTransform=null,a&&(a.__corner=0),E?this.requestRenderAll():d||this.renderTop()}}},_simpleEventHandler:function(n,a){var c=this.findTarget(a),A=this.targets,E={e:a,target:c,subTargets:A};if(this.fire(n,E),c&&c.fire(n,E),!A)return c;for(var d=0;d<A.length;d++)A[d].fire(n,E);return c},_handleEvent:function(n,a,c,A){var E=this._target,d=this.targets||[],p={e:n,target:E,subTargets:d,button:c||1,isClick:A||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};a==="up"&&(p.currentTarget=this.findTarget(n),p.currentSubTargets=this.targets),this.fire("mouse:"+a,p),E&&E.fire("mouse"+a,p);for(var C=0;C<d.length;C++)d[C].fire("mouse"+a,p)},_finalizeCurrentTransform:function(n){var a=this._currentTransform,c=a.target,A={e:n,target:c,transform:a,action:a.action};c._scaling&&(c._scaling=!1),c.setCoords(),(a.actionPerformed||this.stateful&&c.hasStateChanged())&&this._fire("modified",A)},_onMouseDownInDrawingMode:function(n){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(n).requestRenderAll();var a=this.getPointer(n);this.freeDrawingBrush.onMouseDown(a,{e:n,pointer:a}),this._handleEvent(n,"down")},_onMouseMoveInDrawingMode:function(n){if(this._isCurrentlyDrawing){var a=this.getPointer(n);this.freeDrawingBrush.onMouseMove(a,{e:n,pointer:a})}this.setCursor(this.freeDrawingCursor),this._handleEvent(n,"move")},_onMouseUpInDrawingMode:function(n){var a=this.getPointer(n);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:n,pointer:a}),this._handleEvent(n,"up")},__onMouseDown:function(n){this._cacheTransformEventData(n),this._handleEvent(n,"down:before");var a=this._target;if(f(n,3))this.fireRightClick&&this._handleEvent(n,"down",3);else if(f(n,2))this.fireMiddleClick&&this._handleEvent(n,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(n);else if(this._isMainEvent(n)&&!this._currentTransform){var c=this._pointer;this._previousPointer=c;var A=this._shouldRender(a),E=this._shouldGroup(n,a);if(this._shouldClearSelection(n,a)?this.discardActiveObject(n):E&&(this._handleGrouping(n,a),a=this._activeObject),!this.selection||a&&(a.selectable||a.isEditing||a===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),a){var d=a===this._activeObject;a.selectable&&a.activeOn==="down"&&this.setActiveObject(a,n);var p=a._findTargetCorner(this.getPointer(n,!0),v.util.isTouchEvent(n));if(a.__corner=p,a===this._activeObject&&(p||!E)){this._setupCurrentTransform(n,a,d);var C=a.controls[p],y=(c=this.getPointer(n),C&&C.getMouseDownHandler(n,a,C));y&&y(n,this._currentTransform,c.x,c.y)}}this._handleEvent(n,"down"),(A||E)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(n){this._resetTransformEventData(),this._pointer=this.getPointer(n,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(n)||null},_beforeTransform:function(n){var a=this._currentTransform;this.stateful&&a.target.saveState(),this.fire("before:transform",{e:n,transform:a})},__onMouseMove:function(n){var a,c;if(this._handleEvent(n,"move:before"),this._cacheTransformEventData(n),this.isDrawingMode)this._onMouseMoveInDrawingMode(n);else if(this._isMainEvent(n)){var A=this._groupSelector;A?(c=this._absolutePointer,A.left=c.x-A.ex,A.top=c.y-A.ey,this.renderTop()):this._currentTransform?this._transformObject(n):(a=this.findTarget(n)||null,this._setCursorFromEvent(n,a),this._fireOverOutEvents(a,n)),this._handleEvent(n,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(n,a){var c=this._hoveredTarget,A=this._hoveredTargets,E=this.targets,d=Math.max(A.length,E.length);this.fireSyntheticInOutEvents(n,a,{oldTarget:c,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var p=0;p<d;p++)this.fireSyntheticInOutEvents(E[p],a,{oldTarget:A[p],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(n,a){var c=this._draggedoverTarget,A=this._hoveredTargets,E=this.targets,d=Math.max(A.length,E.length);this.fireSyntheticInOutEvents(n,a,{oldTarget:c,evtOut:"dragleave",evtIn:"dragenter"});for(var p=0;p<d;p++)this.fireSyntheticInOutEvents(E[p],a,{oldTarget:A[p],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=n},fireSyntheticInOutEvents:function(n,a,c){var A,E,d,p=c.oldTarget,C=p!==n,y=c.canvasEvtIn,S=c.canvasEvtOut;C&&(A={e:a,target:n,previousTarget:p},E={e:a,target:p,nextTarget:n}),d=n&&C,p&&C&&(S&&this.fire(S,E),p.fire(c.evtOut,E)),d&&(y&&this.fire(y,A),n.fire(c.evtIn,A))},__onMouseWheel:function(n){this._cacheTransformEventData(n),this._handleEvent(n,"wheel"),this._resetTransformEventData()},_transformObject:function(n){var a=this.getPointer(n),c=this._currentTransform;c.reset=!1,c.shiftKey=n.shiftKey,c.altKey=n[this.centeredKey],this._performTransformAction(n,c,a),c.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(n,a,c){var A=c.x,E=c.y,d=a.action,p=!1,C=a.actionHandler;C&&(p=C(n,a,A,E)),d==="drag"&&p&&(a.target.isMoving=!0,this.setCursor(a.target.moveCursor||this.moveCursor)),a.actionPerformed=a.actionPerformed||p},_fire:v.controlsUtils.fireEvent,_setCursorFromEvent:function(n,a){if(!a)return this.setCursor(this.defaultCursor),!1;var c=a.hoverCursor||this.hoverCursor,A=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,E=(!A||!A.contains(a))&&a._findTargetCorner(this.getPointer(n,!0));E?this.setCursor(this.getCornerCursor(E,a,n)):(a.subTargetCheck&&this.targets.concat().reverse().map(function(d){c=d.hoverCursor||c}),this.setCursor(c))},getCornerCursor:function(n,a,c){var A=a.controls[n];return A.cursorStyleHandler(c,A,a)}})}(),X=Math.min,te=Math.max,v.util.object.extend(v.Canvas.prototype,{_shouldGroup:function(h,x){var l=this._activeObject;return l&&this._isSelectionKeyPressed(h)&&x&&x.selectable&&this.selection&&(l!==x||l.type==="activeSelection")&&!x.onSelect({e:h})},_handleGrouping:function(h,x){var l=this._activeObject;l.__corner||(x!==l||(x=this.findTarget(h,!0))&&x.selectable)&&(l&&l.type==="activeSelection"?this._updateActiveSelection(x,h):this._createActiveSelection(x,h))},_updateActiveSelection:function(h,x){var l=this._activeObject,f=l._objects.slice(0);l.contains(h)?(l.removeWithUpdate(h),this._hoveredTarget=h,this._hoveredTargets=this.targets.concat(),l.size()===1&&this._setActiveObject(l.item(0),x)):(l.addWithUpdate(h),this._hoveredTarget=l,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(f,x)},_createActiveSelection:function(h,x){var l=this.getActiveObjects(),f=this._createGroup(h);this._hoveredTarget=f,this._setActiveObject(f,x),this._fireSelectionEvents(l,x)},_createGroup:function(h){var x=this._objects,l=x.indexOf(this._activeObject)<x.indexOf(h)?[this._activeObject,h]:[h,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new v.ActiveSelection(l,{canvas:this})},_groupSelectedObjects:function(h){var x,l=this._collectObjects(h);l.length===1?this.setActiveObject(l[0],h):l.length>1&&(x=new v.ActiveSelection(l.reverse(),{canvas:this}),this.setActiveObject(x,h))},_collectObjects:function(h){for(var x,l=[],f=this._groupSelector.ex,n=this._groupSelector.ey,a=f+this._groupSelector.left,c=n+this._groupSelector.top,A=new v.Point(X(f,a),X(n,c)),E=new v.Point(te(f,a),te(n,c)),d=!this.selectionFullyContained,p=f===a&&n===c,C=this._objects.length;C--&&!((x=this._objects[C])&&x.selectable&&x.visible&&(d&&x.intersectsWithRect(A,E,!0)||x.isContainedWithinRect(A,E,!0)||d&&x.containsPoint(A,null,!0)||d&&x.containsPoint(E,null,!0))&&(l.push(x),p)););return l.length>1&&(l=l.filter(function(y){return!y.onSelect({e:h})})),l},_maybeGroupObjects:function(h){this.selection&&this._groupSelector&&this._groupSelectedObjects(h),this.setCursor(this.defaultCursor),this._groupSelector=null}}),v.util.object.extend(v.StaticCanvas.prototype,{toDataURL:function(h){h||(h={});var x=h.format||"png",l=h.quality||1,f=(h.multiplier||1)*(h.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(f,h);return v.util.toDataURL(n,x,l)},toCanvasElement:function(h,x){h=h||1;var l=((x=x||{}).width||this.width)*h,f=(x.height||this.height)*h,n=this.getZoom(),a=this.width,c=this.height,A=n*h,E=this.viewportTransform,d=(E[4]-(x.left||0))*h,p=(E[5]-(x.top||0))*h,C=this.interactive,y=[A,0,0,A,d,p],S=this.enableRetinaScaling,w=v.util.createCanvasElement(),b=this.contextTop;return w.width=l,w.height=f,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=y,this.width=l,this.height=f,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),this._objects),this.viewportTransform=E,this.width=a,this.height=c,this.calcViewportBoundaries(),this.interactive=C,this.enableRetinaScaling=S,this.contextTop=b,w}}),v.util.object.extend(v.StaticCanvas.prototype,{loadFromJSON:function(h,x,l){if(h){var f=typeof h=="string"?JSON.parse(h):v.util.object.clone(h),n=this,a=f.clipPath,c=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete f.clipPath,this._enlivenObjects(f.objects,function(A){n.clear(),n._setBgOverlay(f,function(){a?n._enlivenObjects([a],function(E){n.clipPath=E[0],n.__setupCanvas.call(n,f,A,c,x)}):n.__setupCanvas.call(n,f,A,c,x)})},l),this}},__setupCanvas:function(h,x,l,f){var n=this;x.forEach(function(a,c){n.insertAt(a,c)}),this.renderOnAddRemove=l,delete h.objects,delete h.backgroundImage,delete h.overlayImage,delete h.background,delete h.overlay,this._setOptions(h),this.renderAll(),f&&f()},_setBgOverlay:function(h,x){var l={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(h.backgroundImage||h.overlayImage||h.background||h.overlay){var f=function(){l.backgroundImage&&l.overlayImage&&l.backgroundColor&&l.overlayColor&&x&&x()};this.__setBgOverlay("backgroundImage",h.backgroundImage,l,f),this.__setBgOverlay("overlayImage",h.overlayImage,l,f),this.__setBgOverlay("backgroundColor",h.background,l,f),this.__setBgOverlay("overlayColor",h.overlay,l,f)}else x&&x()},__setBgOverlay:function(h,x,l,f){var n=this;if(!x)return l[h]=!0,void(f&&f());h==="backgroundImage"||h==="overlayImage"?v.util.enlivenObjects([x],function(a){n[h]=a[0],l[h]=!0,f&&f()}):this["set"+v.util.string.capitalize(h,!0)](x,function(){l[h]=!0,f&&f()})},_enlivenObjects:function(h,x,l){h&&h.length!==0?v.util.enlivenObjects(h,function(f){x&&x(f)},null,l):x&&x([])},_toDataURL:function(h,x){this.clone(function(l){x(l.toDataURL(h))})},_toDataURLWithMultiplier:function(h,x,l){this.clone(function(f){l(f.toDataURLWithMultiplier(h,x))})},clone:function(h,x){var l=JSON.stringify(this.toJSON(x));this.cloneWithoutData(function(f){f.loadFromJSON(l,function(){h&&h(f)})})},cloneWithoutData:function(h){var x=v.util.createCanvasElement();x.width=this.width,x.height=this.height;var l=new v.Canvas(x);this.backgroundImage?(l.setBackgroundImage(this.backgroundImage.src,function(){l.renderAll(),h&&h(l)}),l.backgroundImageOpacity=this.backgroundImageOpacity,l.backgroundImageStretch=this.backgroundImageStretch):h&&h(l)}}),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.util.object.clone,n=x.util.toFixed,a=x.util.string.capitalize,c=x.util.degreesToRadians,A=!x.isLikelyNode;x.Object||(x.Object=x.util.createClass(x.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:A,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(E){E&&this.setOptions(E)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=x.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(E){var d=x.perfLimitSizeTotal,p=E.width,C=E.height,y=x.maxCacheSideLimit,S=x.minCacheSideLimit;if(p<=y&&C<=y&&p*C<=d)return p<S&&(E.width=S),C<S&&(E.height=S),E;var w=p/C,b=x.util.limitDimsByArea(w,d),O=x.util.capValue,N=O(S,b.x,y),j=O(S,b.y,y);return p>N&&(E.zoomX/=p/N,E.width=N,E.capped=!0),C>j&&(E.zoomY/=C/j,E.height=j,E.capped=!0),E},_getCacheCanvasDimensions:function(){var E=this.getTotalObjectScaling(),d=this._getTransformedDimensions(0,0),p=d.x*E.scaleX/this.scaleX,C=d.y*E.scaleY/this.scaleY;return{width:p+2,height:C+2,zoomX:E.scaleX,zoomY:E.scaleY,x:p,y:C}},_updateCacheCanvas:function(){var E=this.canvas;if(this.noScaleCache&&E&&E._currentTransform){var d=E._currentTransform.target,p=E._currentTransform.action;if(this===d&&p.slice&&p.slice(0,5)==="scale")return!1}var C,y,S=this._cacheCanvas,w=this._limitCacheSize(this._getCacheCanvasDimensions()),b=x.minCacheSideLimit,O=w.width,N=w.height,j=w.zoomX,Z=w.zoomY,Y=O!==this.cacheWidth||N!==this.cacheHeight,W=this.zoomX!==j||this.zoomY!==Z,P=Y||W,R=0,V=0,J=!1;if(Y){var q=this._cacheCanvas.width,L=this._cacheCanvas.height,M=O>q||N>L;J=M||(O<.9*q||N<.9*L)&&q>b&&L>b,M&&!w.capped&&(O>b||N>b)&&(R=.1*O,V=.1*N)}return this instanceof x.Text&&this.path&&(P=!0,J=!0,R+=this.getHeightOfLine(0)*this.zoomX,V+=this.getHeightOfLine(0)*this.zoomY),!!P&&(J?(S.width=Math.ceil(O+R),S.height=Math.ceil(N+V)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,S.width,S.height)),C=w.x/2,y=w.y/2,this.cacheTranslationX=Math.round(S.width/2-C)+C,this.cacheTranslationY=Math.round(S.height/2-y)+y,this.cacheWidth=O,this.cacheHeight=N,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(j,Z),this.zoomX=j,this.zoomY=Z,!0)},setOptions:function(E){this._setOptions(E),this._initGradient(E.fill,"fill"),this._initGradient(E.stroke,"stroke"),this._initPattern(E.fill,"fill"),this._initPattern(E.stroke,"stroke")},transform:function(E){var d=this.group&&!this.group._transformDone||this.group&&this.canvas&&E===this.canvas.contextTop,p=this.calcTransformMatrix(!d);E.transform(p[0],p[1],p[2],p[3],p[4],p[5])},toObject:function(E){var d=x.Object.NUM_FRACTION_DIGITS,p={type:this.type,version:x.version,originX:this.originX,originY:this.originY,left:n(this.left,d),top:n(this.top,d),width:n(this.width,d),height:n(this.height,d),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,d),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,d),scaleX:n(this.scaleX,d),scaleY:n(this.scaleY,d),angle:n(this.angle,d),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,d),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,d),skewY:n(this.skewY,d)};return this.clipPath&&!this.clipPath.excludeFromExport&&(p.clipPath=this.clipPath.toObject(E),p.clipPath.inverted=this.clipPath.inverted,p.clipPath.absolutePositioned=this.clipPath.absolutePositioned),x.util.populateWithProperties(this,p,E),this.includeDefaultValues||(p=this._removeDefaultValues(p)),p},toDatalessObject:function(E){return this.toObject(E)},_removeDefaultValues:function(E){var d=x.util.getKlass(E.type).prototype;return d.stateProperties.forEach(function(p){p!=="left"&&p!=="top"&&(E[p]===d[p]&&delete E[p],Array.isArray(E[p])&&Array.isArray(d[p])&&E[p].length===0&&d[p].length===0&&delete E[p])}),E},toString:function(){return"#<fabric."+a(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var E=x.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(E.scaleX),scaleY:Math.abs(E.scaleY)}},getTotalObjectScaling:function(){var E=this.getObjectScaling(),d=E.scaleX,p=E.scaleY;if(this.canvas){var C=this.canvas.getZoom(),y=this.canvas.getRetinaScaling();d*=C*y,p*=C*y}return{scaleX:d,scaleY:p}},getObjectOpacity:function(){var E=this.opacity;return this.group&&(E*=this.group.getObjectOpacity()),E},_set:function(E,d){var p=E==="scaleX"||E==="scaleY",C=this[E]!==d,y=!1;return p&&(d=this._constrainScale(d)),E==="scaleX"&&d<0?(this.flipX=!this.flipX,d*=-1):E==="scaleY"&&d<0?(this.flipY=!this.flipY,d*=-1):E!=="shadow"||!d||d instanceof x.Shadow?E==="dirty"&&this.group&&this.group.set("dirty",d):d=new x.Shadow(d),this[E]=d,C&&(y=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(E)>-1?(this.dirty=!0,y&&this.group.set("dirty",!0)):y&&this.stateProperties.indexOf(E)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:x.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(E){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(E.save(),this._setupCompositeOperation(E),this.drawSelectionBackground(E),this.transform(E),this._setOpacity(E),this._setShadow(E,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(E)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(E),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),E.restore())},renderCache:function(E){E=E||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,E.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!(this.paintFirst!=="stroke"||!this.hasFill()||!this.hasStroke()||typeof this.shadow!="object")||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(E,d){if(E.save(),d.inverted?E.globalCompositeOperation="destination-out":E.globalCompositeOperation="destination-in",d.absolutePositioned){var p=x.util.invertTransform(this.calcTransformMatrix());E.transform(p[0],p[1],p[2],p[3],p[4],p[5])}d.transform(E),E.scale(1/d.zoomX,1/d.zoomY),E.drawImage(d._cacheCanvas,-d.cacheTranslationX,-d.cacheTranslationY),E.restore()},drawObject:function(E,d){var p=this.fill,C=this.stroke;d?(this.fill="black",this.stroke="",this._setClippingProperties(E)):this._renderBackground(E),this._render(E),this._drawClipPath(E,this.clipPath),this.fill=p,this.stroke=C},_drawClipPath:function(E,d){d&&(d.canvas=this.canvas,d.shouldCache(),d._transformDone=!0,d.renderCache({forClipping:!0}),this.drawClipPathOnCache(E,d))},drawCacheOnCanvas:function(E){E.scale(1/this.zoomX,1/this.zoomY),E.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(E){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!E&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!E){var d=this.cacheWidth/this.zoomX,p=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-d/2,-p/2,d,p)}return!0}return!1},_renderBackground:function(E){if(this.backgroundColor){var d=this._getNonTransformedDimensions();E.fillStyle=this.backgroundColor,E.fillRect(-d.x/2,-d.y/2,d.x,d.y),this._removeShadow(E)}},_setOpacity:function(E){this.group&&!this.group._transformDone?E.globalAlpha=this.getObjectOpacity():E.globalAlpha*=this.opacity},_setStrokeStyles:function(E,d){var p=d.stroke;p&&(E.lineWidth=d.strokeWidth,E.lineCap=d.strokeLineCap,E.lineDashOffset=d.strokeDashOffset,E.lineJoin=d.strokeLineJoin,E.miterLimit=d.strokeMiterLimit,p.toLive?p.gradientUnits==="percentage"||p.gradientTransform||p.patternTransform?this._applyPatternForTransformedGradient(E,p):(E.strokeStyle=p.toLive(E,this),this._applyPatternGradientTransform(E,p)):E.strokeStyle=d.stroke)},_setFillStyles:function(E,d){var p=d.fill;p&&(p.toLive?(E.fillStyle=p.toLive(E,this),this._applyPatternGradientTransform(E,d.fill)):E.fillStyle=p)},_setClippingProperties:function(E){E.globalAlpha=1,E.strokeStyle="transparent",E.fillStyle="#000000"},_setLineDash:function(E,d){d&&d.length!==0&&(1&d.length&&d.push.apply(d,d),E.setLineDash(d))},_renderControls:function(E,d){var p,C,y,S=this.getViewportTransform(),w=this.calcTransformMatrix();C=(d=d||{}).hasBorders!==void 0?d.hasBorders:this.hasBorders,y=d.hasControls!==void 0?d.hasControls:this.hasControls,w=x.util.multiplyTransformMatrices(S,w),p=x.util.qrDecompose(w),E.save(),E.translate(p.translateX,p.translateY),E.lineWidth=1*this.borderScaleFactor,this.group||(E.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(p.angle-=180),E.rotate(c(this.group?p.angle:this.angle)),d.forActiveSelection||this.group?C&&this.drawBordersInGroup(E,p,d):C&&this.drawBorders(E,d),y&&this.drawControls(E,d),E.restore()},_setShadow:function(E){if(this.shadow){var d,p=this.shadow,C=this.canvas,y=C&&C.viewportTransform[0]||1,S=C&&C.viewportTransform[3]||1;d=p.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),C&&C._isRetinaScaling()&&(y*=x.devicePixelRatio,S*=x.devicePixelRatio),E.shadowColor=p.color,E.shadowBlur=p.blur*x.browserShadowBlurConstant*(y+S)*(d.scaleX+d.scaleY)/4,E.shadowOffsetX=p.offsetX*y*d.scaleX,E.shadowOffsetY=p.offsetY*S*d.scaleY}},_removeShadow:function(E){this.shadow&&(E.shadowColor="",E.shadowBlur=E.shadowOffsetX=E.shadowOffsetY=0)},_applyPatternGradientTransform:function(E,d){if(!d||!d.toLive)return{offsetX:0,offsetY:0};var p=d.gradientTransform||d.patternTransform,C=-this.width/2+d.offsetX||0,y=-this.height/2+d.offsetY||0;return d.gradientUnits==="percentage"?E.transform(this.width,0,0,this.height,C,y):E.transform(1,0,0,1,C,y),p&&E.transform(p[0],p[1],p[2],p[3],p[4],p[5]),{offsetX:C,offsetY:y}},_renderPaintInOrder:function(E){this.paintFirst==="stroke"?(this._renderStroke(E),this._renderFill(E)):(this._renderFill(E),this._renderStroke(E))},_render:function(){},_renderFill:function(E){this.fill&&(E.save(),this._setFillStyles(E,this),this.fillRule==="evenodd"?E.fill("evenodd"):E.fill(),E.restore())},_renderStroke:function(E){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(E),E.save(),this.strokeUniform&&this.group){var d=this.getObjectScaling();E.scale(1/d.scaleX,1/d.scaleY)}else this.strokeUniform&&E.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(E,this.strokeDashArray),this._setStrokeStyles(E,this),E.stroke(),E.restore()}},_applyPatternForTransformedGradient:function(E,d){var p,C=this._limitCacheSize(this._getCacheCanvasDimensions()),y=x.util.createCanvasElement(),S=this.canvas.getRetinaScaling(),w=C.x/this.scaleX/S,b=C.y/this.scaleY/S;y.width=w,y.height=b,(p=y.getContext("2d")).beginPath(),p.moveTo(0,0),p.lineTo(w,0),p.lineTo(w,b),p.lineTo(0,b),p.closePath(),p.translate(w/2,b/2),p.scale(C.zoomX/this.scaleX/S,C.zoomY/this.scaleY/S),this._applyPatternGradientTransform(p,d),p.fillStyle=d.toLive(E),p.fill(),E.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),E.scale(S*this.scaleX/C.zoomX,S*this.scaleY/C.zoomY),E.strokeStyle=p.createPattern(y,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var E=x.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",E.scaleX),this.set("scaleY",E.scaleY),this.angle=E.angle,this.skewX=E.skewX,this.skewY=0}},_removeTransformMatrix:function(E){var d=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),d=x.util.transformPoint(d,this.transformMatrix)),this.transformMatrix=null,E&&(this.scaleX*=E.scaleX,this.scaleY*=E.scaleY,this.cropX=E.cropX,this.cropY=E.cropY,d.x+=E.offsetLeft,d.y+=E.offsetTop,this.width=E.width,this.height=E.height),this.setPositionByOrigin(d,"center","center")},clone:function(E,d){var p=this.toObject(d);this.constructor.fromObject?this.constructor.fromObject(p,E):x.Object._fromObject("Object",p,E)},cloneAsImage:function(E,d){var p=this.toCanvasElement(d);return E&&E(new x.Image(p)),this},toCanvasElement:function(E){E||(E={});var d=x.util,p=d.saveObjectTransform(this),C=this.group,y=this.shadow,S=Math.abs,w=(E.multiplier||1)*(E.enableRetinaScaling?x.devicePixelRatio:1);delete this.group,E.withoutTransform&&d.resetObjectTransform(this),E.withoutShadow&&(this.shadow=null);var b,O,N,j,Z=x.util.createCanvasElement(),Y=this.getBoundingRect(!0,!0),W=this.shadow,P={x:0,y:0};W&&(O=W.blur,b=W.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),P.x=2*Math.round(S(W.offsetX)+O)*S(b.scaleX),P.y=2*Math.round(S(W.offsetY)+O)*S(b.scaleY)),N=Y.width+P.x,j=Y.height+P.y,Z.width=Math.ceil(N),Z.height=Math.ceil(j);var R=new x.StaticCanvas(Z,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});E.format==="jpeg"&&(R.backgroundColor="#fff"),this.setPositionByOrigin(new x.Point(R.width/2,R.height/2),"center","center");var V=this.canvas;R.add(this);var J=R.toCanvasElement(w||1,E);return this.shadow=y,this.set("canvas",V),C&&(this.group=C),this.set(p).setCoords(),R._objects=[],R.dispose(),R=null,J},toDataURL:function(E){return E||(E={}),x.util.toDataURL(this.toCanvasElement(E),E.format||"png",E.quality||1)},isType:function(E){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===E},complexity:function(){return 1},toJSON:function(E){return this.toObject(E)},rotate:function(E){var d=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return d&&this._setOriginToCenter(),this.set("angle",E),d&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(E,d){d=d||this.canvas.getPointer(E);var p=new x.Point(d.x,d.y),C=this._getLeftTopCoords();return this.angle&&(p=x.util.rotatePoint(p,C,c(-this.angle))),{x:p.x-C.x,y:p.y-C.y}},_setupCompositeOperation:function(E){this.globalCompositeOperation&&(E.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){x.runningAnimations&&x.runningAnimations.cancelByTarget(this)}}),x.util.createAccessors&&x.util.createAccessors(x.Object),l(x.Object.prototype,x.Observable),x.Object.NUM_FRACTION_DIGITS=2,x.Object.ENLIVEN_PROPS=["clipPath"],x.Object._fromObject=function(E,d,p,C){var y=x[E];d=f(d,!0),x.util.enlivenPatterns([d.fill,d.stroke],function(S){S[0]!==void 0&&(d.fill=S[0]),S[1]!==void 0&&(d.stroke=S[1]),x.util.enlivenObjectEnlivables(d,d,function(){var w=C?new y(d[C],d):new y(d);p&&p(w)})})},x.Object.__uid=0)}(e),ne=v.util.degreesToRadians,re={left:-.5,center:0,right:.5},ue={top:-.5,center:0,bottom:.5},v.util.object.extend(v.Object.prototype,{translateToGivenOrigin:function(h,x,l,f,n){var a,c,A,E=h.x,d=h.y;return typeof x=="string"?x=re[x]:x-=.5,typeof f=="string"?f=re[f]:f-=.5,typeof l=="string"?l=ue[l]:l-=.5,typeof n=="string"?n=ue[n]:n-=.5,c=n-l,((a=f-x)||c)&&(A=this._getTransformedDimensions(),E=h.x+a*A.x,d=h.y+c*A.y),new v.Point(E,d)},translateToCenterPoint:function(h,x,l){var f=this.translateToGivenOrigin(h,x,l,"center","center");return this.angle?v.util.rotatePoint(f,h,ne(this.angle)):f},translateToOriginPoint:function(h,x,l){var f=this.translateToGivenOrigin(h,"center","center",x,l);return this.angle?v.util.rotatePoint(f,h,ne(this.angle)):f},getCenterPoint:function(){var h=new v.Point(this.left,this.top);return this.translateToCenterPoint(h,this.originX,this.originY)},getPointByOrigin:function(h,x){var l=this.getCenterPoint();return this.translateToOriginPoint(l,h,x)},toLocalPoint:function(h,x,l){var f,n,a=this.getCenterPoint();return f=x!==void 0&&l!==void 0?this.translateToGivenOrigin(a,"center","center",x,l):new v.Point(this.left,this.top),n=new v.Point(h.x,h.y),this.angle&&(n=v.util.rotatePoint(n,a,-ne(this.angle))),n.subtractEquals(f)},setPositionByOrigin:function(h,x,l){var f=this.translateToCenterPoint(h,x,l),n=this.translateToOriginPoint(f,this.originX,this.originY);this.set("left",n.x),this.set("top",n.y)},adjustPosition:function(h){var x,l,f=ne(this.angle),n=this.getScaledWidth(),a=v.util.cos(f)*n,c=v.util.sin(f)*n;x=typeof this.originX=="string"?re[this.originX]:this.originX-.5,l=typeof h=="string"?re[h]:h-.5,this.left+=a*(l-x),this.top+=c*(l-x),this.setCoords(),this.originX=h},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var h=this.getCenterPoint();this.originX="center",this.originY="center",this.left=h.x,this.top=h.y},_resetOrigin:function(){var h=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=h.x,this.top=h.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var h=v.util,x=h.degreesToRadians,l=h.multiplyTransformMatrices,f=h.transformPoint;h.object.extend(v.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(n,a){return a?n?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),n?this.aCoords:this.lineCoords)},getCoords:function(n,a){return c=this._getCoords(n,a),[new v.Point(c.tl.x,c.tl.y),new v.Point(c.tr.x,c.tr.y),new v.Point(c.br.x,c.br.y),new v.Point(c.bl.x,c.bl.y)];var c},intersectsWithRect:function(n,a,c,A){var E=this.getCoords(c,A);return v.Intersection.intersectPolygonRectangle(E,n,a).status==="Intersection"},intersectsWithObject:function(n,a,c){return v.Intersection.intersectPolygonPolygon(this.getCoords(a,c),n.getCoords(a,c)).status==="Intersection"||n.isContainedWithinObject(this,a,c)||this.isContainedWithinObject(n,a,c)},isContainedWithinObject:function(n,a,c){for(var A=this.getCoords(a,c),E=a?n.aCoords:n.lineCoords,d=0,p=n._getImageLines(E);d<4;d++)if(!n.containsPoint(A[d],p))return!1;return!0},isContainedWithinRect:function(n,a,c,A){var E=this.getBoundingRect(c,A);return E.left>=n.x&&E.left+E.width<=a.x&&E.top>=n.y&&E.top+E.height<=a.y},containsPoint:function(n,a,c,A){var E=this._getCoords(c,A),d=(a=a||this._getImageLines(E),this._findCrossPoints(n,a));return d!==0&&d%2==1},isOnScreen:function(n){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,c=this.canvas.vptCoords.br;return!!this.getCoords(!0,n).some(function(A){return A.x<=c.x&&A.x>=a.x&&A.y<=c.y&&A.y>=a.y})||!!this.intersectsWithRect(a,c,!0,n)||this._containsCenterOfCanvas(a,c,n)},_containsCenterOfCanvas:function(n,a,c){var A={x:(n.x+a.x)/2,y:(n.y+a.y)/2};return!!this.containsPoint(A,null,!0,c)},isPartiallyOnScreen:function(n){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,c=this.canvas.vptCoords.br;return!!this.intersectsWithRect(a,c,!0,n)||this.getCoords(!0,n).every(function(A){return(A.x>=c.x||A.x<=a.x)&&(A.y>=c.y||A.y<=a.y)})&&this._containsCenterOfCanvas(a,c,n)},_getImageLines:function(n){return{topline:{o:n.tl,d:n.tr},rightline:{o:n.tr,d:n.br},bottomline:{o:n.br,d:n.bl},leftline:{o:n.bl,d:n.tl}}},_findCrossPoints:function(n,a){var c,A,E,d=0;for(var p in a)if(!((E=a[p]).o.y<n.y&&E.d.y<n.y||E.o.y>=n.y&&E.d.y>=n.y||(E.o.x===E.d.x&&E.o.x>=n.x?A=E.o.x:(c=(E.d.y-E.o.y)/(E.d.x-E.o.x),A=-(n.y-0*n.x-(E.o.y-c*E.o.x))/(0-c)),A>=n.x&&(d+=1),d!==2)))break;return d},getBoundingRect:function(n,a){var c=this.getCoords(n,a);return h.makeBoundingBoxFromPoints(c)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(n){return Math.abs(n)<this.minScaleLimit?n<0?-this.minScaleLimit:this.minScaleLimit:n===0?1e-4:n},scale:function(n){return this._set("scaleX",n),this._set("scaleY",n),this.setCoords()},scaleToWidth:function(n,a){var c=this.getBoundingRect(a).width/this.getScaledWidth();return this.scale(n/this.width/c)},scaleToHeight:function(n,a){var c=this.getBoundingRect(a).height/this.getScaledHeight();return this.scale(n/this.height/c)},calcLineCoords:function(){var n=this.getViewportTransform(),a=this.padding,c=x(this.angle),A=h.cos(c)*a,E=h.sin(c)*a,d=A+E,p=A-E,C=this.calcACoords(),y={tl:f(C.tl,n),tr:f(C.tr,n),bl:f(C.bl,n),br:f(C.br,n)};return a&&(y.tl.x-=p,y.tl.y-=d,y.tr.x+=d,y.tr.y-=p,y.bl.x-=d,y.bl.y+=p,y.br.x+=p,y.br.y+=d),y},calcOCoords:function(){var n=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),c=this.getViewportTransform(),A=l(c,a),E=l(A,n),d=(E=l(E,[1/c[0],0,0,1/c[3],0,0]),this._calculateCurrentDimensions()),p={};return this.forEachControl(function(C,y,S){p[y]=C.positionHandler(d,E,S)}),p},calcACoords:function(){var n=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),c=l(a,n),A=this._getTransformedDimensions(),E=A.x/2,d=A.y/2;return{tl:f({x:-E,y:-d},c),tr:f({x:E,y:-d},c),bl:f({x:-E,y:d},c),br:f({x:E,y:d},c)}},setCoords:function(n){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),n||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return h.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var n=this.getCenterPoint();return[1,0,0,1,n.x,n.y]},transformMatrixKey:function(n){var a="_",c="";return!n&&this.group&&(c=this.group.transformMatrixKey(n)+a),c+this.top+a+this.left+a+this.scaleX+a+this.scaleY+a+this.skewX+a+this.skewY+a+this.angle+a+this.originX+a+this.originY+a+this.width+a+this.height+a+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(n){var a=this.calcOwnMatrix();if(n||!this.group)return a;var c=this.transformMatrixKey(n),A=this.matrixCache||(this.matrixCache={});return A.key===c?A.value:(this.group&&(a=l(this.group.calcTransformMatrix(!1),a)),A.key=c,A.value=a,a)},calcOwnMatrix:function(){var n=this.transformMatrixKey(!0),a=this.ownMatrixCache||(this.ownMatrixCache={});if(a.key===n)return a.value;var c=this._calcTranslateMatrix(),A={angle:this.angle,translateX:c[4],translateY:c[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return a.key=n,a.value=h.composeMatrix(A),a.value},_getNonTransformedDimensions:function(){var n=this.strokeWidth;return{x:this.width+n,y:this.height+n}},_getTransformedDimensions:function(n,a){n===void 0&&(n=this.skewX),a===void 0&&(a=this.skewY);var c,A,E,d=n===0&&a===0;if(this.strokeUniform?(A=this.width,E=this.height):(A=(c=this._getNonTransformedDimensions()).x,E=c.y),d)return this._finalizeDimensions(A*this.scaleX,E*this.scaleY);var p=h.sizeAfterTransform(A,E,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:n,skewY:a});return this._finalizeDimensions(p.x,p.y)},_finalizeDimensions:function(n,a){return this.strokeUniform?{x:n+this.strokeWidth,y:a+this.strokeWidth}:{x:n,y:a}},_calculateCurrentDimensions:function(){var n=this.getViewportTransform(),a=this._getTransformedDimensions();return f(a,n,!0).scalarAdd(2*this.padding)}})}(),v.util.object.extend(v.Object.prototype,{sendToBack:function(){return this.group?v.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?v.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(h){return this.group?v.StaticCanvas.prototype.sendBackwards.call(this.group,this,h):this.canvas&&this.canvas.sendBackwards(this,h),this},bringForward:function(h){return this.group?v.StaticCanvas.prototype.bringForward.call(this.group,this,h):this.canvas&&this.canvas.bringForward(this,h),this},moveTo:function(h){return this.group&&this.group.type!=="activeSelection"?v.StaticCanvas.prototype.moveTo.call(this.group,this,h):this.canvas&&this.canvas.moveTo(this,h),this}}),function(){function h(l,f){if(f){if(f.toLive)return l+": url(#SVGID_"+f.id+"); ";var n=new v.Color(f),a=l+": "+n.toRgb()+"; ",c=n.getAlpha();return c!==1&&(a+=l+"-opacity: "+c.toString()+"; "),a}return l+": none; "}var x=v.util.toFixed;v.util.object.extend(v.Object.prototype,{getSvgStyles:function(l){var f=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",a=this.strokeDashArray?this.strokeDashArray.join(" "):"none",c=this.strokeDashOffset?this.strokeDashOffset:"0",A=this.strokeLineCap?this.strokeLineCap:"butt",E=this.strokeLineJoin?this.strokeLineJoin:"miter",d=this.strokeMiterLimit?this.strokeMiterLimit:"4",p=this.opacity!==void 0?this.opacity:"1",C=this.visible?"":" visibility: hidden;",y=l?"":this.getSvgFilter(),S=h("fill",this.fill);return[h("stroke",this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",a,"; ","stroke-linecap: ",A,"; ","stroke-dashoffset: ",c,"; ","stroke-linejoin: ",E,"; ","stroke-miterlimit: ",d,"; ",S,"fill-rule: ",f,"; ","opacity: ",p,";",y,C].join("")},getSvgSpanStyles:function(l,f){var n="; ",a=l.fontFamily?"font-family: "+(l.fontFamily.indexOf("'")===-1&&l.fontFamily.indexOf('"')===-1?"'"+l.fontFamily+"'":l.fontFamily)+n:"",c=l.strokeWidth?"stroke-width: "+l.strokeWidth+n:"",A=l.fontSize?"font-size: "+l.fontSize+"px"+n:"",E=l.fontStyle?"font-style: "+l.fontStyle+n:"",d=l.fontWeight?"font-weight: "+l.fontWeight+n:"",p=l.fill?h("fill",l.fill):"",C=l.stroke?h("stroke",l.stroke):"",y=this.getSvgTextDecoration(l);return y&&(y="text-decoration: "+y+n),[C,c,a,A,E,d,y,p,l.deltaY?"baseline-shift: "+-l.deltaY+"; ":"",f?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(l){return["overline","underline","line-through"].filter(function(f){return l[f.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(l,f){var n=l?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+v.util.matrixToSVG(n)+(f||"")+'" '},_setSVGBg:function(l){if(this.backgroundColor){var f=v.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',x(-this.width/2,f),'" y="',x(-this.height/2,f),'" width="',x(this.width,f),'" height="',x(this.height,f),`"></rect>
`)}},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(l),{reviver:l})},toClipPathSVG:function(l){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(l),{reviver:l})},_createBaseClipPathSVGMarkup:function(l,f){var n=(f=f||{}).reviver,a=f.additionalTransform||"",c=[this.getSvgTransform(!0,a),this.getSvgCommons()].join(""),A=l.indexOf("COMMON_PARTS");return l[A]=c,n?n(l.join("")):l.join("")},_createBaseSVGMarkup:function(l,f){var n,a,c=(f=f||{}).noStyle,A=f.reviver,E=c?"":'style="'+this.getSvgStyles()+'" ',d=f.withShadow?'style="'+this.getSvgFilter()+'" ':"",p=this.clipPath,C=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",y=p&&p.absolutePositioned,S=this.stroke,w=this.fill,b=this.shadow,O=[],N=l.indexOf("COMMON_PARTS"),j=f.additionalTransform;return p&&(p.clipPathId="CLIPPATH_"+v.Object.__uid++,a='<clipPath id="'+p.clipPathId+`" >
`+p.toClipPathSVG(A)+`</clipPath>
`),y&&O.push("<g ",d,this.getSvgCommons(),` >
`),O.push("<g ",this.getSvgTransform(!1),y?"":d+this.getSvgCommons(),` >
`),n=[E,C,c?"":this.addPaintOrder()," ",j?'transform="'+j+'" ':""].join(""),l[N]=n,w&&w.toLive&&O.push(w.toSVG(this)),S&&S.toLive&&O.push(S.toSVG(this)),b&&O.push(b.toSVG(this)),p&&O.push(a),O.push(l.join("")),O.push(`</g>
`),y&&O.push(`</g>
`),A?A(O.join("")):O.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var h=v.util.object.extend,x="stateProperties";function l(n,a,c){var A={};c.forEach(function(E){A[E]=n[E]}),h(n[a],A,!0)}function f(n,a,c){if(n===a)return!0;if(Array.isArray(n)){if(!Array.isArray(a)||n.length!==a.length)return!1;for(var A=0,E=n.length;A<E;A++)if(!f(n[A],a[A]))return!1;return!0}if(n&&typeof n=="object"){var d,p=Object.keys(n);if(!a||typeof a!="object"||!c&&p.length!==Object.keys(a).length)return!1;for(A=0,E=p.length;A<E;A++)if((d=p[A])!=="canvas"&&d!=="group"&&!f(n[d],a[d]))return!1;return!0}}v.util.object.extend(v.Object.prototype,{hasStateChanged:function(n){var a="_"+(n=n||x);return Object.keys(this[a]).length<this[n].length||!f(this[a],this,!0)},saveState:function(n){var a=n&&n.propertySet||x,c="_"+a;return this[c]?(l(this,c,this[a]),n&&n.stateProperties&&l(this,c,n.stateProperties),this):this.setupState(n)},setupState:function(n){var a=(n=n||{}).propertySet||x;return n.propertySet=a,this["_"+a]={},this.saveState(n),this}})}(),function(){var h=v.util.degreesToRadians;v.util.object.extend(v.Object.prototype,{_findTargetCorner:function(x,l){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var f,n,a,c=x.x,A=x.y,E=Object.keys(this.oCoords),d=E.length-1;for(this.__corner=0;d>=0;d--)if(a=E[d],this.isControlVisible(a)&&(n=this._getImageLines(l?this.oCoords[a].touchCorner:this.oCoords[a].corner),(f=this._findCrossPoints({x:c,y:A},n))!==0&&f%2==1))return this.__corner=a,a;return!1},forEachControl:function(x){for(var l in this.controls)x(this.controls[l],l,this)},_setCornerCoords:function(){var x=this.oCoords;for(var l in x){var f=this.controls[l];x[l].corner=f.calcCornerCoords(this.angle,this.cornerSize,x[l].x,x[l].y,!1),x[l].touchCorner=f.calcCornerCoords(this.angle,this.touchCornerSize,x[l].x,x[l].y,!0)}},drawSelectionBackground:function(x){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;x.save();var l=this.getCenterPoint(),f=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return x.translate(l.x,l.y),x.scale(1/n[0],1/n[3]),x.rotate(h(this.angle)),x.fillStyle=this.selectionBackgroundColor,x.fillRect(-f.x/2,-f.y/2,f.x,f.y),x.restore(),this},drawBorders:function(x,l){l=l||{};var f=this._calculateCurrentDimensions(),n=this.borderScaleFactor,a=f.x+n,c=f.y+n,A=l.hasControls!==void 0?l.hasControls:this.hasControls,E=!1;return x.save(),x.strokeStyle=l.borderColor||this.borderColor,this._setLineDash(x,l.borderDashArray||this.borderDashArray),x.strokeRect(-a/2,-c/2,a,c),A&&(x.beginPath(),this.forEachControl(function(d,p,C){d.withConnection&&d.getVisibility(C,p)&&(E=!0,x.moveTo(d.x*a,d.y*c),x.lineTo(d.x*a+d.offsetX,d.y*c+d.offsetY))}),E&&x.stroke()),x.restore(),this},drawBordersInGroup:function(x,l,f){f=f||{};var n=v.util.sizeAfterTransform(this.width,this.height,l),a=this.strokeWidth,c=this.strokeUniform,A=this.borderScaleFactor,E=n.x+a*(c?this.canvas.getZoom():l.scaleX)+A,d=n.y+a*(c?this.canvas.getZoom():l.scaleY)+A;return x.save(),this._setLineDash(x,f.borderDashArray||this.borderDashArray),x.strokeStyle=f.borderColor||this.borderColor,x.strokeRect(-E/2,-d/2,E,d),x.restore(),this},drawControls:function(x,l){l=l||{},x.save();var f,n,a=this.canvas.getRetinaScaling();return x.setTransform(a,0,0,a,0,0),x.strokeStyle=x.fillStyle=l.cornerColor||this.cornerColor,this.transparentCorners||(x.strokeStyle=l.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(x,l.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(f=this.group.calcTransformMatrix()),this.forEachControl(function(c,A,E){n=E.oCoords[A],c.getVisibility(E,A)&&(f&&(n=v.util.transformPoint(n,f)),c.render(x,n.x,n.y,l,E))}),x.restore(),this},isControlVisible:function(x){return this.controls[x]&&this.controls[x].getVisibility(this,x)},setControlVisible:function(x,l){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[x]=l,this},setControlsVisibility:function(x){for(var l in x||(x={}),x)this.setControlVisible(l,x[l]);return this},onDeselect:function(){},onSelect:function(){}})}(),v.util.object.extend(v.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(h,x){var l=function(){},f=(x=x||{}).onComplete||l,n=x.onChange||l,a=this;return v.util.animate({target:this,startValue:h.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(c){h.set("left",c),a.requestRenderAll(),n()},onComplete:function(){h.setCoords(),f()}})},fxCenterObjectV:function(h,x){var l=function(){},f=(x=x||{}).onComplete||l,n=x.onChange||l,a=this;return v.util.animate({target:this,startValue:h.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(c){h.set("top",c),a.requestRenderAll(),n()},onComplete:function(){h.setCoords(),f()}})},fxRemove:function(h,x){var l=function(){},f=(x=x||{}).onComplete||l,n=x.onChange||l,a=this;return v.util.animate({target:this,startValue:h.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(c){h.set("opacity",c),a.requestRenderAll(),n()},onComplete:function(){a.remove(h),f()}})}}),v.util.object.extend(v.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var h,x,l=[],f=[];for(h in arguments[0])l.push(h);for(var n=0,a=l.length;n<a;n++)h=l[n],x=n!==a-1,f.push(this._animate(h,arguments[0][h],arguments[1],x));return f}return this._animate.apply(this,arguments)},_animate:function(h,x,l,f){var n,a=this;x=x.toString(),l=l?v.util.object.clone(l):{},~h.indexOf(".")&&(n=h.split("."));var c=a.colorProperties.indexOf(h)>-1||n&&a.colorProperties.indexOf(n[1])>-1,A=n?this.get(n[0])[n[1]]:this.get(h);"from"in l||(l.from=A),c||(x=~x.indexOf("=")?A+parseFloat(x.replace("=","")):parseFloat(x));var E={target:this,startValue:l.from,endValue:x,byValue:l.by,easing:l.easing,duration:l.duration,abort:l.abort&&function(d,p,C){return l.abort.call(a,d,p,C)},onChange:function(d,p,C){n?a[n[0]][n[1]]=d:a.set(h,d),f||l.onChange&&l.onChange(d,p,C)},onComplete:function(d,p,C){f||(a.setCoords(),l.onComplete&&l.onComplete(d,p,C))}};return c?v.util.animateColor(E.startValue,E.endValue,E.duration,E):v.util.animate(E)}}),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};function a(c,A){var E=c.origin,d=c.axis1,p=c.axis2,C=c.dimension,y=A.nearest,S=A.center,w=A.farthest;return function(){switch(this.get(E)){case y:return Math.min(this.get(d),this.get(p));case S:return Math.min(this.get(d),this.get(p))+.5*this.get(C);case w:return Math.max(this.get(d),this.get(p))}}}x.Line?x.warn("fabric.Line is already defined"):(x.Line=x.util.createClass(x.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:x.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(c,A){c||(c=[0,0,0,0]),this.callSuper("initialize",A),this.set("x1",c[0]),this.set("y1",c[1]),this.set("x2",c[2]),this.set("y2",c[3]),this._setWidthHeight(A)},_setWidthHeight:function(c){c||(c={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in c?c.left:this._getLeftToOriginX(),this.top="top"in c?c.top:this._getTopToOriginY()},_set:function(c,A){return this.callSuper("_set",c,A),n[c]!==void 0&&this._setWidthHeight(),this},_getLeftToOriginX:a({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:a({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(c){c.beginPath();var A=this.calcLinePoints();c.moveTo(A.x1,A.y1),c.lineTo(A.x2,A.y2),c.lineWidth=this.strokeWidth;var E=c.strokeStyle;c.strokeStyle=this.stroke||c.fillStyle,this.stroke&&this._renderStroke(c),c.strokeStyle=E},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(c){return l(this.callSuper("toObject",c),this.calcLinePoints())},_getNonTransformedDimensions:function(){var c=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(c.y-=this.strokeWidth),this.height===0&&(c.x-=this.strokeWidth)),c},calcLinePoints:function(){var c=this.x1<=this.x2?-1:1,A=this.y1<=this.y2?-1:1,E=c*this.width*.5,d=A*this.height*.5;return{x1:E,x2:c*this.width*-.5,y1:d,y2:A*this.height*-.5}},_toSVG:function(){var c=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',c.x1,'" y1="',c.y1,'" x2="',c.x2,'" y2="',c.y2,`" />
`]}}),x.Line.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),x.Line.fromElement=function(c,A,E){E=E||{};var d=x.parseAttributes(c,x.Line.ATTRIBUTE_NAMES),p=[d.x1||0,d.y1||0,d.x2||0,d.y2||0];A(new x.Line(p,l(d,E)))},x.Line.fromObject=function(c,A){var E=f(c,!0);E.points=[c.x1,c.y1,c.x2,c.y2],x.Object._fromObject("Line",E,function(d){delete d.points,A&&A(d)},"points")})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.degreesToRadians;x.Circle?x.warn("fabric.Circle is already defined."):(x.Circle=x.util.createClass(x.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:x.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(f,n){return this.callSuper("_set",f,n),f==="radius"&&this.setRadius(n),this},toObject:function(f){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(f))},_toSVG:function(){var f,n=(this.endAngle-this.startAngle)%360;if(n===0)f=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,`" />
`];else{var a=l(this.startAngle),c=l(this.endAngle),A=this.radius;f=['<path d="M '+x.util.cos(a)*A+" "+x.util.sin(a)*A," A "+A+" "+A," 0 ",+(n>180?"1":"0")+" 1"," "+x.util.cos(c)*A+" "+x.util.sin(c)*A,'" ',"COMMON_PARTS",` />
`]}return f},_render:function(f){f.beginPath(),f.arc(0,0,this.radius,l(this.startAngle),l(this.endAngle),!1),this._renderPaintInOrder(f)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(f){return this.radius=f,this.set("width",2*f).set("height",2*f)}}),x.Circle.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),x.Circle.fromElement=function(f,n){var a,c=x.parseAttributes(f,x.Circle.ATTRIBUTE_NAMES);if(!("radius"in(a=c)&&a.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");c.left=(c.left||0)-c.radius,c.top=(c.top||0)-c.radius,n(new x.Circle(c))},x.Circle.fromObject=function(f,n){x.Object._fromObject("Circle",f,n)})}(e),function(h){var x=h.fabric||(h.fabric={});x.Triangle?x.warn("fabric.Triangle is already defined"):(x.Triangle=x.util.createClass(x.Object,{type:"triangle",width:100,height:100,_render:function(l){var f=this.width/2,n=this.height/2;l.beginPath(),l.moveTo(-f,n),l.lineTo(0,-n),l.lineTo(f,n),l.closePath(),this._renderPaintInOrder(l)},_toSVG:function(){var l=this.width/2,f=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-l+" "+f,"0 "+-f,l+" "+f].join(","),'" />']}}),x.Triangle.fromObject=function(l,f){return x.Object._fromObject("Triangle",l,f)})}(e),function(h){var x=h.fabric||(h.fabric={}),l=2*Math.PI;x.Ellipse?x.warn("fabric.Ellipse is already defined."):(x.Ellipse=x.util.createClass(x.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:x.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this.set("rx",f&&f.rx||0),this.set("ry",f&&f.ry||0)},_set:function(f,n){switch(this.callSuper("_set",f,n),f){case"rx":this.rx=n,this.set("width",2*n);break;case"ry":this.ry=n,this.set("height",2*n)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(f){f.beginPath(),f.save(),f.transform(1,0,0,this.ry/this.rx,0,0),f.arc(0,0,this.rx,0,l,!1),f.restore(),this._renderPaintInOrder(f)}}),x.Ellipse.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),x.Ellipse.fromElement=function(f,n){var a=x.parseAttributes(f,x.Ellipse.ATTRIBUTE_NAMES);a.left=(a.left||0)-a.rx,a.top=(a.top||0)-a.ry,n(new x.Ellipse(a))},x.Ellipse.fromObject=function(f,n){x.Object._fromObject("Ellipse",f,n)})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend;x.Rect?x.warn("fabric.Rect is already defined"):(x.Rect=x.util.createClass(x.Object,{stateProperties:x.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:x.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(f){var n=this.rx?Math.min(this.rx,this.width/2):0,a=this.ry?Math.min(this.ry,this.height/2):0,c=this.width,A=this.height,E=-this.width/2,d=-this.height/2,p=n!==0||a!==0,C=.4477152502;f.beginPath(),f.moveTo(E+n,d),f.lineTo(E+c-n,d),p&&f.bezierCurveTo(E+c-C*n,d,E+c,d+C*a,E+c,d+a),f.lineTo(E+c,d+A-a),p&&f.bezierCurveTo(E+c,d+A-C*a,E+c-C*n,d+A,E+c-n,d+A),f.lineTo(E+n,d+A),p&&f.bezierCurveTo(E+C*n,d+A,E,d+A-C*a,E,d+A-a),f.lineTo(E,d+a),p&&f.bezierCurveTo(E,d+C*a,E+C*n,d,E+n,d),f.closePath(),this._renderPaintInOrder(f)},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),x.Rect.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),x.Rect.fromElement=function(f,n,a){if(!f)return n(null);a=a||{};var c=x.parseAttributes(f,x.Rect.ATTRIBUTE_NAMES);c.left=c.left||0,c.top=c.top||0,c.height=c.height||0,c.width=c.width||0;var A=new x.Rect(l(a?x.util.object.clone(a):{},c));A.visible=A.visible&&A.width>0&&A.height>0,n(A)},x.Rect.fromObject=function(f,n){return x.Object._fromObject("Rect",f,n)})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.util.array.min,n=x.util.array.max,a=x.util.toFixed,c=x.util.projectStrokeOnPoints;x.Polyline?x.warn("fabric.Polyline is already defined"):(x.Polyline=x.util.createClass(x.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:x.Object.prototype.cacheProperties.concat("points"),initialize:function(A,E){E=E||{},this.points=A||[],this.callSuper("initialize",E),this._setPositionDimensions(E)},_projectStrokeOnPoints:function(){return c(this.points,this,!0)},_setPositionDimensions:function(A){var E,d=this._calcDimensions(A),p=this.exactBoundingBox?this.strokeWidth:0;this.width=d.width-p,this.height=d.height-p,A.fromSVG||(E=this.translateToGivenOrigin({x:d.left-this.strokeWidth/2+p/2,y:d.top-this.strokeWidth/2+p/2},"left","top",this.originX,this.originY)),A.left===void 0&&(this.left=A.fromSVG?d.left:E.x),A.top===void 0&&(this.top=A.fromSVG?d.top:E.y),this.pathOffset={x:d.left+this.width/2+p/2,y:d.top+this.height/2+p/2}},_calcDimensions:function(){var A=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,E=f(A,"x")||0,d=f(A,"y")||0;return{left:E,top:d,width:(n(A,"x")||0)-E,height:(n(A,"y")||0)-d}},toObject:function(A){return l(this.callSuper("toObject",A),{points:this.points.concat()})},_toSVG:function(){for(var A=[],E=this.pathOffset.x,d=this.pathOffset.y,p=x.Object.NUM_FRACTION_DIGITS,C=0,y=this.points.length;C<y;C++)A.push(a(this.points[C].x-E,p),",",a(this.points[C].y-d,p)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',A.join(""),`" />
`]},commonRender:function(A){var E,d=this.points.length,p=this.pathOffset.x,C=this.pathOffset.y;if(!d||isNaN(this.points[d-1].y))return!1;A.beginPath(),A.moveTo(this.points[0].x-p,this.points[0].y-C);for(var y=0;y<d;y++)E=this.points[y],A.lineTo(E.x-p,E.y-C);return!0},_render:function(A){this.commonRender(A)&&this._renderPaintInOrder(A)},complexity:function(){return this.get("points").length}}),x.Polyline.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat(),x.Polyline.fromElementGenerator=function(A){return function(E,d,p){if(!E)return d(null);p||(p={});var C=x.parsePointsAttribute(E.getAttribute("points")),y=x.parseAttributes(E,x[A].ATTRIBUTE_NAMES);y.fromSVG=!0,d(new x[A](C,l(y,p)))}},x.Polyline.fromElement=x.Polyline.fromElementGenerator("Polyline"),x.Polyline.fromObject=function(A,E){return x.Object._fromObject("Polyline",A,E,"points")})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.projectStrokeOnPoints;x.Polygon?x.warn("fabric.Polygon is already defined"):(x.Polygon=x.util.createClass(x.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return l(this.points,this)},_render:function(f){this.commonRender(f)&&(f.closePath(),this._renderPaintInOrder(f))}}),x.Polygon.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat(),x.Polygon.fromElement=x.Polyline.fromElementGenerator("Polygon"),x.Polygon.fromObject=function(f,n){x.Object._fromObject("Polygon",f,n,"points")})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.array.min,f=x.util.array.max,n=x.util.object.extend,a=x.util.object.clone,c=x.util.toFixed;x.Path?x.warn("fabric.Path is already defined"):(x.Path=x.util.createClass(x.Object,{type:"path",path:null,cacheProperties:x.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:x.Object.prototype.stateProperties.concat("path"),initialize:function(A,E){delete(E=a(E||{})).path,this.callSuper("initialize",E),this._setPath(A||[],E)},_setPath:function(A,E){this.path=x.util.makePathSimpler(Array.isArray(A)?A:x.util.parsePath(A)),x.Polyline.prototype._setPositionDimensions.call(this,E||{})},_renderPathCommands:function(A){var E,d=0,p=0,C=0,y=0,S=0,w=0,b=-this.pathOffset.x,O=-this.pathOffset.y;A.beginPath();for(var N=0,j=this.path.length;N<j;++N)switch((E=this.path[N])[0]){case"L":C=E[1],y=E[2],A.lineTo(C+b,y+O);break;case"M":d=C=E[1],p=y=E[2],A.moveTo(C+b,y+O);break;case"C":C=E[5],y=E[6],S=E[3],w=E[4],A.bezierCurveTo(E[1]+b,E[2]+O,S+b,w+O,C+b,y+O);break;case"Q":A.quadraticCurveTo(E[1]+b,E[2]+O,E[3]+b,E[4]+O),C=E[3],y=E[4],S=E[1],w=E[2];break;case"z":case"Z":C=d,y=p,A.closePath()}},_render:function(A){this._renderPathCommands(A),this._renderPaintInOrder(A)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(A){return n(this.callSuper("toObject",A),{path:this.path.map(function(E){return E.slice()})})},toDatalessObject:function(A){var E=this.toObject(["sourcePath"].concat(A));return E.sourcePath&&delete E.path,E},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',x.util.joinPath(this.path),'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var A=x.Object.NUM_FRACTION_DIGITS;return" translate("+c(-this.pathOffset.x,A)+", "+c(-this.pathOffset.y,A)+")"},toClipPathSVG:function(A){var E=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:A,additionalTransform:E})},toSVG:function(A){var E=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:A,additionalTransform:E})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var A,E,d=[],p=[],C=0,y=0,S=0,w=0,b=0,O=this.path.length;b<O;++b){switch((A=this.path[b])[0]){case"L":S=A[1],w=A[2],E=[];break;case"M":C=S=A[1],y=w=A[2],E=[];break;case"C":E=x.util.getBoundsOfCurve(S,w,A[1],A[2],A[3],A[4],A[5],A[6]),S=A[5],w=A[6];break;case"Q":E=x.util.getBoundsOfCurve(S,w,A[1],A[2],A[1],A[2],A[3],A[4]),S=A[3],w=A[4];break;case"z":case"Z":S=C,w=y}E.forEach(function(Z){d.push(Z.x),p.push(Z.y)}),d.push(S),p.push(w)}var N=l(d)||0,j=l(p)||0;return{left:N,top:j,width:(f(d)||0)-N,height:(f(p)||0)-j}}}),x.Path.fromObject=function(A,E){if(typeof A.sourcePath=="string"){var d=A.sourcePath;x.loadSVGFromURL(d,function(p){var C=p[0];C.setOptions(A),E&&E(C)})}else x.Object._fromObject("Path",A,E,"path")},x.Path.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat(["d"]),x.Path.fromElement=function(A,E,d){var p=x.parseAttributes(A,x.Path.ATTRIBUTE_NAMES);p.fromSVG=!0,E(new x.Path(p.d,n(p,d)))})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.array.min,f=x.util.array.max;x.Group||(x.Group=x.util.createClass(x.Object,x.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,a,c){a=a||{},this._objects=[],c&&this.callSuper("initialize",a),this._objects=n||[];for(var A=this._objects.length;A--;)this._objects[A].group=this;if(c)this._updateObjectsACoords();else{var E=a&&a.centerPoint;a.originX!==void 0&&(this.originX=a.originX),a.originY!==void 0&&(this.originY=a.originY),E||this._calcBounds(),this._updateObjectsCoords(E),delete a.centerPoint,this.callSuper("initialize",a)}this.setCoords()},_updateObjectsACoords:function(){for(var n=this._objects.length;n--;)this._objects[n].setCoords(!0)},_updateObjectsCoords:function(n){n=n||this.getCenterPoint();for(var a=this._objects.length;a--;)this._updateObjectCoords(this._objects[a],n)},_updateObjectCoords:function(n,a){var c=n.left,A=n.top;n.set({left:c-a.x,top:A-a.y}),n.group=this,n.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var a=!!this.group;return this._restoreObjectsState(),x.util.resetObjectTransform(this),n&&(a&&x.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,a?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),x.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,a){var c=this._objects.length;if(this.useSetOnGroup)for(;c--;)this._objects[c].setOnGroup(n,a);if(n==="canvas")for(;c--;)this._objects[c]._set(n,a);x.Object.prototype._set.call(this,n,a)},toObject:function(n){var a=this.includeDefaultValues,c=this._objects.filter(function(E){return!E.excludeFromExport}).map(function(E){var d=E.includeDefaultValues;E.includeDefaultValues=a;var p=E.toObject(n);return E.includeDefaultValues=d,p}),A=x.Object.prototype.toObject.call(this,n);return A.objects=c,A},toDatalessObject:function(n){var a,c=this.sourcePath;if(c)a=c;else{var A=this.includeDefaultValues;a=this._objects.map(function(d){var p=d.includeDefaultValues;d.includeDefaultValues=A;var C=d.toDatalessObject(n);return d.includeDefaultValues=p,C})}var E=x.Object.prototype.toDatalessObject.call(this,n);return E.objects=a,E},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=x.Object.prototype.shouldCache.call(this);if(n){for(var a=0,c=this._objects.length;a<c;a++)if(this._objects[a].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(x.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,a=this._objects.length;n<a;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var a=0,c=this._objects.length;a<c;a++)this._objects[a].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var a=0,c=this._objects.length;a<c;a++)if(this._objects[a].isCacheDirty(!0)){if(this._cacheCanvas){var A=this.cacheWidth/this.zoomX,E=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-A/2,-E/2,A,E)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(a){x.util.addTransformToObject(a,n),delete a.group,a.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,a=this.canvas;this._objects=[];var c=this.toObject();delete c.objects;var A=new x.ActiveSelection([]);return A.set(c),A.type="activeSelection",a.remove(this),n.forEach(function(E){E.group=A,E.dirty=!0,a.add(E)}),A.canvas=a,A._objects=n,a._activeObject=A,A.setCoords(),A}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(n){n.setCoords(!0)}),this},_calcBounds:function(n){for(var a,c,A,E,d=[],p=[],C=["tr","br","bl","tl"],y=0,S=this._objects.length,w=C.length;y<S;++y){for(A=(a=this._objects[y]).calcACoords(),E=0;E<w;E++)c=C[E],d.push(A[c].x),p.push(A[c].y);a.aCoords=A}this._getBounds(d,p,n)},_getBounds:function(n,a,c){var A=new x.Point(l(n),l(a)),E=new x.Point(f(n),f(a)),d=A.y||0,p=A.x||0,C=E.x-A.x||0,y=E.y-A.y||0;this.width=C,this.height=y,c||this.setPositionByOrigin({x:p,y:d},"left","top")},_toSVG:function(n){for(var a=["<g ","COMMON_PARTS",` >
`],c=0,A=this._objects.length;c<A;c++)a.push("		",this._objects[c].toSVG(n));return a.push(`</g>
`),a},getSvgStyles:function(){var n=this.opacity!==void 0&&this.opacity!==1?"opacity: "+this.opacity+";":"",a=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),a].join("")},toClipPathSVG:function(n){for(var a=[],c=0,A=this._objects.length;c<A;c++)a.push("	",this._objects[c].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(a,{reviver:n})}}),x.Group.fromObject=function(n,a){var c=n.objects,A=x.util.object.clone(n,!0);delete A.objects,typeof c!="string"?x.util.enlivenObjects(c,function(E){var d=x.util.object.clone(n,!0);delete d.objects,x.util.enlivenObjectEnlivables(n,d,function(){a&&a(new x.Group(E,d,!0))})}):x.loadSVGFromURL(c,function(E){var d=x.util.groupSVGElements(E,n,c);d.set(A),a&&a(d)})})}(e),function(h){var x=h.fabric||(h.fabric={});x.ActiveSelection||(x.ActiveSelection=x.util.createClass(x.Group,{type:"activeSelection",initialize:function(l,f){f=f||{},this._objects=l||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;f.originX&&(this.originX=f.originX),f.originY&&(this.originY=f.originY),this._calcBounds(),this._updateObjectsCoords(),x.Object.prototype.initialize.call(this,f),this.setCoords()},toGroup:function(){var l=this._objects.concat();this._objects=[];var f=x.Object.prototype.toObject.call(this),n=new x.Group([]);if(delete f.type,n.set(f),l.forEach(function(c){c.canvas.remove(c),c.group=n}),n._objects=l,!this.canvas)return n;var a=this.canvas;return a.add(n),a._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(l,f,n){l.save(),l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",l,f),(n=n||{}).hasControls===void 0&&(n.hasControls=!1),n.forActiveSelection=!0;for(var a=0,c=this._objects.length;a<c;a++)this._objects[a]._renderControls(l,n);l.restore()}}),x.ActiveSelection.fromObject=function(l,f){x.util.enlivenObjects(l.objects,function(n){delete l.objects,f&&f(new x.ActiveSelection(n,l,!0))})})}(e),function(h){var x=v.util.object.extend;h.fabric||(h.fabric={}),h.fabric.Image?v.warn("fabric.Image is already defined."):(v.Image=v.util.createClass(v.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:v.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:v.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(l,f){f||(f={}),this.filters=[],this.cacheKey="texture"+v.Object.__uid++,this.callSuper("initialize",f),this._initElement(l,f)},getElement:function(){return this._element||{}},setElement:function(l,f){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=l,this._originalElement=l,this._initConfig(f),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(l){var f=v.filterBackend;f&&f.evictCachesForKey&&f.evictCachesForKey(l)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(l){v.util.cleanUpJsdomNode(this[l]),this[l]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var l=this.getElement();return{width:l.naturalWidth||l.width,height:l.naturalHeight||l.height}},_stroke:function(l){if(this.stroke&&this.strokeWidth!==0){var f=this.width/2,n=this.height/2;l.beginPath(),l.moveTo(-f,-n),l.lineTo(f,-n),l.lineTo(f,n),l.lineTo(-f,n),l.lineTo(-f,-n),l.closePath()}},toObject:function(l){var f=[];this.filters.forEach(function(a){a&&f.push(a.toObject())});var n=x(this.callSuper("toObject",["cropX","cropY"].concat(l)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:f});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var l,f=[],n=[],a=this._element,c=-this.width/2,A=-this.height/2,E="",d="";if(!a)return[];if(this.hasCrop()){var p=v.Object.__uid++;f.push('<clipPath id="imageCrop_'+p+`">
`,'	<rect x="'+c+'" y="'+A+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),E=' clip-path="url(#imageCrop_'+p+')" '}if(this.imageSmoothing||(d='" image-rendering="optimizeSpeed'),n.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',c-this.cropX,'" y="',A-this.cropY,'" width="',a.width||a.naturalWidth,'" height="',a.height||a.height,d,'"',E,`></image>
`),this.stroke||this.strokeDashArray){var C=this.fill;this.fill=null,l=["	<rect ",'x="',c,'" y="',A,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=C}return this.paintFirst!=="fill"?f.concat(l,n):f.concat(n,l)},getSrc:function(l){var f=l?this._element:this._originalElement;return f?f.toDataURL?f.toDataURL():this.srcFromAttribute?f.getAttribute("src"):f.src:this.src||""},setSrc:function(l,f,n){return v.util.loadImage(l,function(a,c){this.setElement(a,n),this._setWidthHeight(),f&&f(this,c)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var l=this.resizeFilter,f=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),a=n.scaleX,c=n.scaleY,A=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!l||a>f&&c>f)return this._element=A,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=a,void(this._lastScaleY=c);v.filterBackend||(v.filterBackend=v.initFilterBackend());var E=v.util.createCanvasElement(),d=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,p=A.width,C=A.height;E.width=p,E.height=C,this._element=E,this._lastScaleX=l.scaleX=a,this._lastScaleY=l.scaleY=c,v.filterBackend.applyFilters([l],A,p,C,this._element,d),this._filterScalingX=E.width/this._originalElement.width,this._filterScalingY=E.height/this._originalElement.height},applyFilters:function(l){if(l=(l=l||this.filters||[]).filter(function(A){return A&&!A.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),l.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var f=this._originalElement,n=f.naturalWidth||f.width,a=f.naturalHeight||f.height;if(this._element===this._originalElement){var c=v.util.createCanvasElement();c.width=n,c.height=a,this._element=c,this._filteredEl=c}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,a),this._lastScaleX=1,this._lastScaleY=1;return v.filterBackend||(v.filterBackend=v.initFilterBackend()),v.filterBackend.applyFilters(l,this._originalElement,n,a,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(l){v.util.setImageSmoothing(l,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(l),this._renderPaintInOrder(l)},drawCacheOnCanvas:function(l){v.util.setImageSmoothing(l,this.imageSmoothing),v.Object.prototype.drawCacheOnCanvas.call(this,l)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(l){var f=this._element;if(f){var n=this._filterScalingX,a=this._filterScalingY,c=this.width,A=this.height,E=Math.min,d=Math.max,p=d(this.cropX,0),C=d(this.cropY,0),y=f.naturalWidth||f.width,S=f.naturalHeight||f.height,w=p*n,b=C*a,O=E(c*n,y-w),N=E(A*a,S-b),j=-c/2,Z=-A/2,Y=E(c,y/n-p),W=E(A,S/a-C);f&&l.drawImage(f,w,b,O,N,j,Z,Y,W)}},_needsResize:function(){var l=this.getTotalObjectScaling();return l.scaleX!==this._lastScaleX||l.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(l,f){this.setElement(v.util.getById(l),f),v.util.addClass(this.getElement(),v.Image.CSS_CANVAS)},_initConfig:function(l){l||(l={}),this.setOptions(l),this._setWidthHeight(l)},_initFilters:function(l,f){l&&l.length?v.util.enlivenObjects(l,function(n){f&&f(n)},"fabric.Image.filters"):f&&f()},_setWidthHeight:function(l){l||(l={});var f=this.getElement();this.width=l.width||f.naturalWidth||f.width||0,this.height=l.height||f.naturalHeight||f.height||0},parsePreserveAspectRatioAttribute:function(){var l,f=v.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),n=this._element.width,a=this._element.height,c=1,A=1,E=0,d=0,p=0,C=0,y=this.width,S=this.height,w={width:y,height:S};return!f||f.alignX==="none"&&f.alignY==="none"?(c=y/n,A=S/a):(f.meetOrSlice==="meet"&&(l=(y-n*(c=A=v.util.findScaleToFit(this._element,w)))/2,f.alignX==="Min"&&(E=-l),f.alignX==="Max"&&(E=l),l=(S-a*A)/2,f.alignY==="Min"&&(d=-l),f.alignY==="Max"&&(d=l)),f.meetOrSlice==="slice"&&(l=n-y/(c=A=v.util.findScaleToCover(this._element,w)),f.alignX==="Mid"&&(p=l/2),f.alignX==="Max"&&(p=l),l=a-S/A,f.alignY==="Mid"&&(C=l/2),f.alignY==="Max"&&(C=l),n=y/c,a=S/A)),{width:n,height:a,scaleX:c,scaleY:A,offsetLeft:E,offsetTop:d,cropX:p,cropY:C}}}),v.Image.CSS_CANVAS="canvas-img",v.Image.prototype.getSvgSrc=v.Image.prototype.getSrc,v.Image.fromObject=function(l,f){var n=v.util.object.clone(l);v.util.loadImage(n.src,function(a,c){c?f&&f(null,!0):v.Image.prototype._initFilters.call(n,n.filters,function(A){n.filters=A||[],v.Image.prototype._initFilters.call(n,[n.resizeFilter],function(E){n.resizeFilter=E[0],v.util.enlivenObjectEnlivables(n,n,function(){var d=new v.Image(a,n);f(d,!1)})})})},null,n.crossOrigin)},v.Image.fromURL=function(l,f,n){v.util.loadImage(l,function(a,c){f&&f(new v.Image(a,n),c)},null,n&&n.crossOrigin)},v.Image.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),v.Image.fromElement=function(l,f,n){var a=v.parseAttributes(l,v.Image.ATTRIBUTE_NAMES);v.Image.fromURL(a["xlink:href"],f,x(n?v.util.object.clone(n):{},a))})}(e),v.util.object.extend(v.Object.prototype,{_getAngleValueForStraighten:function(){var h=this.angle%360;return h>0?90*Math.round((h-1)/90):90*Math.round(h/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(h){var x=function(){},l=(h=h||{}).onComplete||x,f=h.onChange||x,n=this;return v.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(a){n.rotate(a),f()},onComplete:function(){n.setCoords(),l()}})}}),v.util.object.extend(v.StaticCanvas.prototype,{straightenObject:function(h){return h.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(h){return h.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function h(l,f){var n="precision "+f+` float;
void main(){}`,a=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(a,n),l.compileShader(a),!!l.getShaderParameter(a,l.COMPILE_STATUS)}function x(l){l&&l.tileSize&&(this.tileSize=l.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}v.isWebglSupported=function(l){if(v.isLikelyNode)return!1;l=l||v.WebglFilterBackend.prototype.tileSize;var f=document.createElement("canvas"),n=f.getContext("webgl")||f.getContext("experimental-webgl"),a=!1;if(n){v.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),a=v.maxTextureSize>=l;for(var c=["highp","mediump","lowp"],A=0;A<3;A++)if(h(n,c[A])){v.webGlPrecision=c[A];break}}return this.isSupported=a,a},v.WebglFilterBackend=x,x.prototype={tileSize:2048,resources:{},setupGLContext:function(l,f){this.dispose(),this.createWebGLCanvas(l,f),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(l,f)},chooseFastestCopyGLTo2DMethod:function(l,f){var n,a=window.performance!==void 0;try{new ImageData(1,1),n=!0}catch{n=!1}var c=typeof ArrayBuffer!="undefined",A=typeof Uint8ClampedArray!="undefined";if(a&&n&&c&&A){var E=v.util.createCanvasElement(),d=new ArrayBuffer(l*f*4);if(v.forceGLPutImageData)return this.imageBuffer=d,void(this.copyGLTo2D=je);var p,C,y={imageBuffer:d,destinationWidth:l,destinationHeight:f,targetCanvas:E};E.width=l,E.height=f,p=window.performance.now(),be.call(y,this.gl,y),C=window.performance.now()-p,p=window.performance.now(),je.call(y,this.gl,y),C>window.performance.now()-p?(this.imageBuffer=d,this.copyGLTo2D=je):this.copyGLTo2D=be}},createWebGLCanvas:function(l,f){var n=v.util.createCanvasElement();n.width=l,n.height=f;var a={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},c=n.getContext("webgl",a);c||(c=n.getContext("experimental-webgl",a)),c&&(c.clearColor(0,0,0,0),this.canvas=n,this.gl=c)},applyFilters:function(l,f,n,a,c,A){var E,d=this.gl;A&&(E=this.getCachedTexture(A,f));var p={originalWidth:f.width||f.originalWidth,originalHeight:f.height||f.originalHeight,sourceWidth:n,sourceHeight:a,destinationWidth:n,destinationHeight:a,context:d,sourceTexture:this.createTexture(d,n,a,!E&&f),targetTexture:this.createTexture(d,n,a),originalTexture:E||this.createTexture(d,n,a,!E&&f),passes:l.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:c},C=d.createFramebuffer();return d.bindFramebuffer(d.FRAMEBUFFER,C),l.forEach(function(y){y&&y.applyTo(p)}),function(y){var S=y.targetCanvas,w=S.width,b=S.height,O=y.destinationWidth,N=y.destinationHeight;w===O&&b===N||(S.width=O,S.height=N)}(p),this.copyGLTo2D(d,p),d.bindTexture(d.TEXTURE_2D,null),d.deleteTexture(p.sourceTexture),d.deleteTexture(p.targetTexture),d.deleteFramebuffer(C),c.getContext("2d").setTransform(1,0,0,1,0,0),p},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(l,f,n,a){var c=l.createTexture();return l.bindTexture(l.TEXTURE_2D,c),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),a?l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,a):l.texImage2D(l.TEXTURE_2D,0,l.RGBA,f,n,0,l.RGBA,l.UNSIGNED_BYTE,null),c},getCachedTexture:function(l,f){if(this.textureCache[l])return this.textureCache[l];var n=this.createTexture(this.gl,f.width,f.height,f);return this.textureCache[l]=n,n},evictCachesForKey:function(l){this.textureCache[l]&&(this.gl.deleteTexture(this.textureCache[l]),delete this.textureCache[l])},copyGLTo2D:be,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var l=this.gl,f={renderer:"",vendor:""};if(!l)return f;var n=l.getExtension("WEBGL_debug_renderer_info");if(n){var a=l.getParameter(n.UNMASKED_RENDERER_WEBGL),c=l.getParameter(n.UNMASKED_VENDOR_WEBGL);a&&(f.renderer=a.toLowerCase()),c&&(f.vendor=c.toLowerCase())}return this.gpuInfo=f,f}}}(),function(){var h=function(){};function x(){}v.Canvas2dFilterBackend=x,x.prototype={evictCachesForKey:h,dispose:h,clearWebGLCaches:h,resources:{},applyFilters:function(l,f,n,a,c){var A=c.getContext("2d");A.drawImage(f,0,0,n,a);var E={sourceWidth:n,sourceHeight:a,imageData:A.getImageData(0,0,n,a),originalEl:f,originalImageData:A.getImageData(0,0,n,a),canvasEl:c,ctx:A,filterBackend:this};return l.forEach(function(d){d.applyTo(E)}),E.imageData.width===n&&E.imageData.height===a||(c.width=E.imageData.width,c.height=E.imageData.height),A.putImageData(E.imageData,0,0),E}}}(),v.Image=v.Image||{},v.Image.filters=v.Image.filters||{},v.Image.filters.BaseFilter=v.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(h){h&&this.setOptions(h)},setOptions:function(h){for(var x in h)this[x]=h[x]},createProgram:function(h,x,l){x=x||this.fragmentSource,l=l||this.vertexSource,v.webGlPrecision!=="highp"&&(x=x.replace(/precision highp float/g,"precision "+v.webGlPrecision+" float"));var f=h.createShader(h.VERTEX_SHADER);if(h.shaderSource(f,l),h.compileShader(f),!h.getShaderParameter(f,h.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+h.getShaderInfoLog(f));var n=h.createShader(h.FRAGMENT_SHADER);if(h.shaderSource(n,x),h.compileShader(n),!h.getShaderParameter(n,h.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+h.getShaderInfoLog(n));var a=h.createProgram();if(h.attachShader(a,f),h.attachShader(a,n),h.linkProgram(a),!h.getProgramParameter(a,h.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+h.getProgramInfoLog(a));var c=this.getAttributeLocations(h,a),A=this.getUniformLocations(h,a)||{};return A.uStepW=h.getUniformLocation(a,"uStepW"),A.uStepH=h.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:c,uniformLocations:A}},getAttributeLocations:function(h,x){return{aPosition:h.getAttribLocation(x,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(h,x,l){var f=x.aPosition,n=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,n),h.enableVertexAttribArray(f),h.vertexAttribPointer(f,2,h.FLOAT,!1,0,0),h.bufferData(h.ARRAY_BUFFER,l,h.STATIC_DRAW)},_setupFrameBuffer:function(h){var x,l,f=h.context;h.passes>1?(x=h.destinationWidth,l=h.destinationHeight,h.sourceWidth===x&&h.sourceHeight===l||(f.deleteTexture(h.targetTexture),h.targetTexture=h.filterBackend.createTexture(f,x,l)),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,h.targetTexture,0)):(f.bindFramebuffer(f.FRAMEBUFFER,null),f.finish())},_swapTextures:function(h){h.passes--,h.pass++;var x=h.targetTexture;h.targetTexture=h.sourceTexture,h.sourceTexture=x},isNeutralState:function(){var h=this.mainParameter,x=v.Image.filters[this.type].prototype;if(h){if(Array.isArray(x[h])){for(var l=x[h].length;l--;)if(this[h][l]!==x[h][l])return!1;return!0}return x[h]===this[h]}return!1},applyTo:function(h){h.webgl?(this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h)):this.applyTo2d(h)},retrieveShader:function(h){return h.programCache.hasOwnProperty(this.type)||(h.programCache[this.type]=this.createProgram(h.context)),h.programCache[this.type]},applyToWebGL:function(h){var x=h.context,l=this.retrieveShader(h);h.pass===0&&h.originalTexture?x.bindTexture(x.TEXTURE_2D,h.originalTexture):x.bindTexture(x.TEXTURE_2D,h.sourceTexture),x.useProgram(l.program),this.sendAttributeData(x,l.attributeLocations,h.aPosition),x.uniform1f(l.uniformLocations.uStepW,1/h.sourceWidth),x.uniform1f(l.uniformLocations.uStepH,1/h.sourceHeight),this.sendUniformData(x,l.uniformLocations),x.viewport(0,0,h.destinationWidth,h.destinationHeight),x.drawArrays(x.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(h,x,l){h.activeTexture(l),h.bindTexture(h.TEXTURE_2D,x),h.activeTexture(h.TEXTURE0)},unbindAdditionalTexture:function(h,x){h.activeTexture(x),h.bindTexture(h.TEXTURE_2D,null),h.activeTexture(h.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(h){this[this.mainParameter]=h},sendUniformData:function(){},createHelpLayer:function(h){if(!h.helpLayer){var x=document.createElement("canvas");x.width=h.sourceWidth,x.height=h.sourceHeight,h.helpLayer=x}},toObject:function(){var h={type:this.type},x=this.mainParameter;return x&&(h[x]=this[x]),h},toJSON:function(){return this.toObject()}}),v.Image.filters.BaseFilter.fromObject=function(h,x){var l=new v.Image.filters[h.type](h);return x&&x(l),l},function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.ColorMatrix=f(l.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var a,c,A,E,d,p=n.imageData.data,C=p.length,y=this.matrix,S=this.colorsOnly;for(d=0;d<C;d+=4)a=p[d],c=p[d+1],A=p[d+2],S?(p[d]=a*y[0]+c*y[1]+A*y[2]+255*y[4],p[d+1]=a*y[5]+c*y[6]+A*y[7]+255*y[9],p[d+2]=a*y[10]+c*y[11]+A*y[12]+255*y[14]):(E=p[d+3],p[d]=a*y[0]+c*y[1]+A*y[2]+E*y[3]+255*y[4],p[d+1]=a*y[5]+c*y[6]+A*y[7]+E*y[8]+255*y[9],p[d+2]=a*y[10]+c*y[11]+A*y[12]+E*y[13]+255*y[14],p[d+3]=a*y[15]+c*y[16]+A*y[17]+E*y[18]+255*y[19])},getUniformLocations:function(n,a){return{uColorMatrix:n.getUniformLocation(a,"uColorMatrix"),uConstants:n.getUniformLocation(a,"uConstants")}},sendUniformData:function(n,a){var c=this.matrix,A=[c[0],c[1],c[2],c[3],c[5],c[6],c[7],c[8],c[10],c[11],c[12],c[13],c[15],c[16],c[17],c[18]],E=[c[4],c[9],c[14],c[19]];n.uniformMatrix4fv(a.uColorMatrix,!1,A),n.uniform4fv(a.uConstants,E)}}),x.Image.filters.ColorMatrix.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Brightness=f(l.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var a,c=n.imageData.data,A=c.length,E=Math.round(255*this.brightness);for(a=0;a<A;a+=4)c[a]=c[a]+E,c[a+1]=c[a+1]+E,c[a+2]=c[a+2]+E}},getUniformLocations:function(n,a){return{uBrightness:n.getUniformLocation(a,"uBrightness")}},sendUniformData:function(n,a){n.uniform1f(a.uBrightness,this.brightness)}}),x.Image.filters.Brightness.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.Image.filters,n=x.util.createClass;f.Convolute=n(f.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(a){var c=Math.sqrt(this.matrix.length),A=this.type+"_"+c+"_"+(this.opaque?1:0),E=this.fragmentSource[A];return a.programCache.hasOwnProperty(A)||(a.programCache[A]=this.createProgram(a.context,E)),a.programCache[A]},applyTo2d:function(a){var c,A,E,d,p,C,y,S,w,b,O,N,j,Z=a.imageData,Y=Z.data,W=this.matrix,P=Math.round(Math.sqrt(W.length)),R=Math.floor(P/2),V=Z.width,J=Z.height,q=a.ctx.createImageData(V,J),L=q.data,M=this.opaque?1:0;for(O=0;O<J;O++)for(b=0;b<V;b++){for(p=4*(O*V+b),c=0,A=0,E=0,d=0,j=0;j<P;j++)for(N=0;N<P;N++)C=b+N-R,(y=O+j-R)<0||y>=J||C<0||C>=V||(S=4*(y*V+C),w=W[j*P+N],c+=Y[S]*w,A+=Y[S+1]*w,E+=Y[S+2]*w,M||(d+=Y[S+3]*w));L[p]=c,L[p+1]=A,L[p+2]=E,L[p+3]=M?Y[p+3]:d}a.imageData=q},getUniformLocations:function(a,c){return{uMatrix:a.getUniformLocation(c,"uMatrix"),uOpaque:a.getUniformLocation(c,"uOpaque"),uHalfSize:a.getUniformLocation(c,"uHalfSize"),uSize:a.getUniformLocation(c,"uSize")}},sendUniformData:function(a,c){a.uniform1fv(c.uMatrix,this.matrix)},toObject:function(){return l(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),x.Image.filters.Convolute.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Grayscale=f(l.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var a,c,A=n.imageData.data,E=A.length,d=this.mode;for(a=0;a<E;a+=4)d==="average"?c=(A[a]+A[a+1]+A[a+2])/3:d==="lightness"?c=(Math.min(A[a],A[a+1],A[a+2])+Math.max(A[a],A[a+1],A[a+2]))/2:d==="luminosity"&&(c=.21*A[a]+.72*A[a+1]+.07*A[a+2]),A[a]=c,A[a+1]=c,A[a+2]=c},retrieveShader:function(n){var a=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(a)){var c=this.fragmentSource[this.mode];n.programCache[a]=this.createProgram(n.context,c)}return n.programCache[a]},getUniformLocations:function(n,a){return{uMode:n.getUniformLocation(a,"uMode")}},sendUniformData:function(n,a){n.uniform1i(a.uMode,1)},isNeutralState:function(){return!1}}),x.Image.filters.Grayscale.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Invert=f(l.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var a,c=n.imageData.data,A=c.length;for(a=0;a<A;a+=4)c[a]=255-c[a],c[a+1]=255-c[a+1],c[a+2]=255-c[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,a){return{uInvert:n.getUniformLocation(a,"uInvert")}},sendUniformData:function(n,a){n.uniform1i(a.uInvert,this.invert)}}),x.Image.filters.Invert.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.Image.filters,n=x.util.createClass;f.Noise=n(f.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(a){if(this.noise!==0){var c,A,E=a.imageData.data,d=E.length,p=this.noise;for(c=0,d=E.length;c<d;c+=4)A=(.5-Math.random())*p,E[c]+=A,E[c+1]+=A,E[c+2]+=A}},getUniformLocations:function(a,c){return{uNoise:a.getUniformLocation(c,"uNoise"),uSeed:a.getUniformLocation(c,"uSeed")}},sendUniformData:function(a,c){a.uniform1f(c.uNoise,this.noise/255),a.uniform1f(c.uSeed,Math.random())},toObject:function(){return l(this.callSuper("toObject"),{noise:this.noise})}}),x.Image.filters.Noise.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Pixelate=f(l.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var a,c,A,E,d,p,C,y,S,w,b,O=n.imageData,N=O.data,j=O.height,Z=O.width;for(c=0;c<j;c+=this.blocksize)for(A=0;A<Z;A+=this.blocksize)for(E=N[a=4*c*Z+4*A],d=N[a+1],p=N[a+2],C=N[a+3],w=Math.min(c+this.blocksize,j),b=Math.min(A+this.blocksize,Z),y=c;y<w;y++)for(S=A;S<b;S++)N[a=4*y*Z+4*S]=E,N[a+1]=d,N[a+2]=p,N[a+3]=C},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,a){return{uBlocksize:n.getUniformLocation(a,"uBlocksize"),uStepW:n.getUniformLocation(a,"uStepW"),uStepH:n.getUniformLocation(a,"uStepH")}},sendUniformData:function(n,a){n.uniform1f(a.uBlocksize,this.blocksize)}}),x.Image.filters.Pixelate.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.Image.filters,n=x.util.createClass;f.RemoveColor=n(f.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(a){var c,A,E,d,p=a.imageData.data,C=255*this.distance,y=new x.Color(this.color).getSource(),S=[y[0]-C,y[1]-C,y[2]-C],w=[y[0]+C,y[1]+C,y[2]+C];for(c=0;c<p.length;c+=4)A=p[c],E=p[c+1],d=p[c+2],A>S[0]&&E>S[1]&&d>S[2]&&A<w[0]&&E<w[1]&&d<w[2]&&(p[c+3]=0)},getUniformLocations:function(a,c){return{uLow:a.getUniformLocation(c,"uLow"),uHigh:a.getUniformLocation(c,"uHigh")}},sendUniformData:function(a,c){var A=new x.Color(this.color).getSource(),E=parseFloat(this.distance),d=[0+A[0]/255-E,0+A[1]/255-E,0+A[2]/255-E,1],p=[A[0]/255+E,A[1]/255+E,A[2]/255+E,1];a.uniform4fv(c.uLow,d),a.uniform4fv(c.uHigh,p)},toObject:function(){return l(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),x.Image.filters.RemoveColor.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var a in n)l[a]=f(l.ColorMatrix,{type:a,matrix:n[a],mainParameter:!1,colorsOnly:!0}),x.Image.filters[a].fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric,l=x.Image.filters,f=x.util.createClass;l.BlendColor=f(l.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var a,c=this.type+"_"+this.mode;return n.programCache.hasOwnProperty(c)||(a=this.buildSource(this.mode),n.programCache[c]=this.createProgram(n.context,a)),n.programCache[c]},applyTo2d:function(n){var a,c,A,E,d,p,C,y=n.imageData.data,S=y.length,w=1-this.alpha;a=(C=new x.Color(this.color).getSource())[0]*this.alpha,c=C[1]*this.alpha,A=C[2]*this.alpha;for(var b=0;b<S;b+=4)switch(E=y[b],d=y[b+1],p=y[b+2],this.mode){case"multiply":y[b]=E*a/255,y[b+1]=d*c/255,y[b+2]=p*A/255;break;case"screen":y[b]=255-(255-E)*(255-a)/255,y[b+1]=255-(255-d)*(255-c)/255,y[b+2]=255-(255-p)*(255-A)/255;break;case"add":y[b]=E+a,y[b+1]=d+c,y[b+2]=p+A;break;case"diff":case"difference":y[b]=Math.abs(E-a),y[b+1]=Math.abs(d-c),y[b+2]=Math.abs(p-A);break;case"subtract":y[b]=E-a,y[b+1]=d-c,y[b+2]=p-A;break;case"darken":y[b]=Math.min(E,a),y[b+1]=Math.min(d,c),y[b+2]=Math.min(p,A);break;case"lighten":y[b]=Math.max(E,a),y[b+1]=Math.max(d,c),y[b+2]=Math.max(p,A);break;case"overlay":y[b]=a<128?2*E*a/255:255-2*(255-E)*(255-a)/255,y[b+1]=c<128?2*d*c/255:255-2*(255-d)*(255-c)/255,y[b+2]=A<128?2*p*A/255:255-2*(255-p)*(255-A)/255;break;case"exclusion":y[b]=a+E-2*a*E/255,y[b+1]=c+d-2*c*d/255,y[b+2]=A+p-2*A*p/255;break;case"tint":y[b]=a+E*w,y[b+1]=c+d*w,y[b+2]=A+p*w}},getUniformLocations:function(n,a){return{uColor:n.getUniformLocation(a,"uColor")}},sendUniformData:function(n,a){var c=new x.Color(this.color).getSource();c[0]=this.alpha*c[0]/255,c[1]=this.alpha*c[1]/255,c[2]=this.alpha*c[2]/255,c[3]=this.alpha,n.uniform4fv(a.uColor,c)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),x.Image.filters.BlendColor.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric,l=x.Image.filters,f=x.util.createClass;l.BlendImage=f(l.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var a=this.type+"_"+this.mode,c=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(a)||(n.programCache[a]=this.createProgram(n.context,c)),n.programCache[a]},applyToWebGL:function(n){var a=n.context,c=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(a,c,a.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(a,a.TEXTURE1)},createTexture:function(n,a){return n.getCachedTexture(a.cacheKey,a._element)},calculateMatrix:function(){var n=this.image,a=n._element.width,c=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/a,-n.top/c,1]},applyTo2d:function(n){var a,c,A,E,d,p,C,y,S,w,b,O=n.imageData,N=n.filterBackend.resources,j=O.data,Z=j.length,Y=O.width,W=O.height,P=this.image;N.blendImage||(N.blendImage=x.util.createCanvasElement()),w=(S=N.blendImage).getContext("2d"),S.width!==Y||S.height!==W?(S.width=Y,S.height=W):w.clearRect(0,0,Y,W),w.setTransform(P.scaleX,0,0,P.scaleY,P.left,P.top),w.drawImage(P._element,0,0,Y,W),b=w.getImageData(0,0,Y,W).data;for(var R=0;R<Z;R+=4)switch(d=j[R],p=j[R+1],C=j[R+2],y=j[R+3],a=b[R],c=b[R+1],A=b[R+2],E=b[R+3],this.mode){case"multiply":j[R]=d*a/255,j[R+1]=p*c/255,j[R+2]=C*A/255,j[R+3]=y*E/255;break;case"mask":j[R+3]=E}},getUniformLocations:function(n,a){return{uTransformMatrix:n.getUniformLocation(a,"uTransformMatrix"),uImage:n.getUniformLocation(a,"uImage")}},sendUniformData:function(n,a){var c=this.calculateMatrix();n.uniform1i(a.uImage,1),n.uniformMatrix3fv(a.uTransformMatrix,!1,c)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),x.Image.filters.BlendImage.fromObject=function(n,a){x.Image.fromObject(n.image,function(c){var A=x.util.object.clone(n);A.image=c,a(new x.Image.filters.BlendImage(A))})}}(e),function(h){var x=h.fabric||(h.fabric={}),l=Math.pow,f=Math.floor,n=Math.sqrt,a=Math.abs,c=Math.round,A=Math.sin,E=Math.ceil,d=x.Image.filters,p=x.util.createClass;d.Resize=p(d.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(C,y){return{uDelta:C.getUniformLocation(y,"uDelta"),uTaps:C.getUniformLocation(y,"uTaps")}},sendUniformData:function(C,y){C.uniform2fv(y.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),C.uniform1fv(y.uTaps,this.taps)},retrieveShader:function(C){var y=this.getFilterWindow(),S=this.type+"_"+y;if(!C.programCache.hasOwnProperty(S)){var w=this.generateShader(y);C.programCache[S]=this.createProgram(C.context,w)}return C.programCache[S]},getFilterWindow:function(){var C=this.tempScale;return Math.ceil(this.lanczosLobes/C)},getTaps:function(){for(var C=this.lanczosCreate(this.lanczosLobes),y=this.tempScale,S=this.getFilterWindow(),w=new Array(S),b=1;b<=S;b++)w[b-1]=C(b*y);return w},generateShader:function(C){for(var y=new Array(C),S=this.fragmentSourceTOP,w=1;w<=C;w++)y[w-1]=w+".0 * uDelta";return S+="uniform float uTaps["+C+`];
`,S+=`void main() {
`,S+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,S+=`  float sum = 1.0;
`,y.forEach(function(b,O){S+="  color += texture2D(uTexture, vTexCoord + "+b+") * uTaps["+O+`];
`,S+="  color += texture2D(uTexture, vTexCoord - "+b+") * uTaps["+O+`];
`,S+="  sum += 2.0 * uTaps["+O+`];
`}),S+=`  gl_FragColor = color / sum;
`,S+="}"},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(C){C.webgl?(C.passes++,this.width=C.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=C.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),C.destinationWidth=this.dW,this._setupFrameBuffer(C),this.applyToWebGL(C),this._swapTextures(C),C.sourceWidth=C.destinationWidth,this.height=C.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),C.destinationHeight=this.dH,this._setupFrameBuffer(C),this.applyToWebGL(C),this._swapTextures(C),C.sourceHeight=C.destinationHeight):this.applyTo2d(C)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(C){return function(y){if(y>=C||y<=-C)return 0;if(y<11920929e-14&&y>-11920929e-14)return 1;var S=(y*=Math.PI)/C;return A(y)/y*A(S)/S}},applyTo2d:function(C){var y=C.imageData,S=this.scaleX,w=this.scaleY;this.rcpScaleX=1/S,this.rcpScaleY=1/w;var b,O=y.width,N=y.height,j=c(O*S),Z=c(N*w);this.resizeType==="sliceHack"?b=this.sliceByTwo(C,O,N,j,Z):this.resizeType==="hermite"?b=this.hermiteFastResize(C,O,N,j,Z):this.resizeType==="bilinear"?b=this.bilinearFiltering(C,O,N,j,Z):this.resizeType==="lanczos"&&(b=this.lanczosResize(C,O,N,j,Z)),C.imageData=b},sliceByTwo:function(C,y,S,w,b){var O,N,j=C.imageData,Z=.5,Y=!1,W=!1,P=y*Z,R=S*Z,V=x.filterBackend.resources,J=0,q=0,L=y,M=0;for(V.sliceByTwo||(V.sliceByTwo=document.createElement("canvas")),((O=V.sliceByTwo).width<1.5*y||O.height<S)&&(O.width=1.5*y,O.height=S),(N=O.getContext("2d")).clearRect(0,0,1.5*y,S),N.putImageData(j,0,0),w=f(w),b=f(b);!Y||!W;)y=P,S=R,w<f(P*Z)?P=f(P*Z):(P=w,Y=!0),b<f(R*Z)?R=f(R*Z):(R=b,W=!0),N.drawImage(O,J,q,y,S,L,M,P,R),J=L,q=M,M+=R;return N.getImageData(J,q,w,b)},lanczosResize:function(C,y,S,w,b){var O=C.imageData.data,N=C.ctx.createImageData(w,b),j=N.data,Z=this.lanczosCreate(this.lanczosLobes),Y=this.rcpScaleX,W=this.rcpScaleY,P=2/this.rcpScaleX,R=2/this.rcpScaleY,V=E(Y*this.lanczosLobes/2),J=E(W*this.lanczosLobes/2),q={},L={},M={};return function G(ee){var z,ie,de,he,se,Ee,ce,pe,_e,Be,Te;for(L.x=(ee+.5)*Y,M.x=f(L.x),z=0;z<b;z++){for(L.y=(z+.5)*W,M.y=f(L.y),se=0,Ee=0,ce=0,pe=0,_e=0,ie=M.x-V;ie<=M.x+V;ie++)if(!(ie<0||ie>=y)){Be=f(1e3*a(ie-L.x)),q[Be]||(q[Be]={});for(var Re=M.y-J;Re<=M.y+J;Re++)Re<0||Re>=S||(Te=f(1e3*a(Re-L.y)),q[Be][Te]||(q[Be][Te]=Z(n(l(Be*P,2)+l(Te*R,2))/1e3)),(de=q[Be][Te])>0&&(se+=de,Ee+=de*O[he=4*(Re*y+ie)],ce+=de*O[he+1],pe+=de*O[he+2],_e+=de*O[he+3]))}j[he=4*(z*w+ee)]=Ee/se,j[he+1]=ce/se,j[he+2]=pe/se,j[he+3]=_e/se}return++ee<w?G(ee):N}(0)},bilinearFiltering:function(C,y,S,w,b){var O,N,j,Z,Y,W,P,R,V,J=0,q=this.rcpScaleX,L=this.rcpScaleY,M=4*(y-1),G=C.imageData.data,ee=C.ctx.createImageData(w,b),z=ee.data;for(j=0;j<b;j++)for(Z=0;Z<w;Z++)for(Y=q*Z-(O=f(q*Z)),W=L*j-(N=f(L*j)),V=4*(N*y+O),P=0;P<4;P++)R=G[V+P]*(1-Y)*(1-W)+G[V+4+P]*Y*(1-W)+G[V+M+P]*W*(1-Y)+G[V+M+4+P]*Y*W,z[J++]=R;return ee},hermiteFastResize:function(C,y,S,w,b){for(var O=this.rcpScaleX,N=this.rcpScaleY,j=E(O/2),Z=E(N/2),Y=C.imageData.data,W=C.ctx.createImageData(w,b),P=W.data,R=0;R<b;R++)for(var V=0;V<w;V++){for(var J=4*(V+R*w),q=0,L=0,M=0,G=0,ee=0,z=0,ie=0,de=(R+.5)*N,he=f(R*N);he<(R+1)*N;he++)for(var se=a(de-(he+.5))/Z,Ee=(V+.5)*O,ce=se*se,pe=f(V*O);pe<(V+1)*O;pe++){var _e=a(Ee-(pe+.5))/j,Be=n(ce+_e*_e);Be>1&&Be<-1||(q=2*Be*Be*Be-3*Be*Be+1)>0&&(ie+=q*Y[3+(_e=4*(pe+he*y))],M+=q,Y[_e+3]<255&&(q=q*Y[_e+3]/250),G+=q*Y[_e],ee+=q*Y[_e+1],z+=q*Y[_e+2],L+=q)}P[J]=G/L,P[J+1]=ee/L,P[J+2]=z/L,P[J+3]=ie/M}return W},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),x.Image.filters.Resize.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Contrast=f(l.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var a,c=n.imageData.data,A=c.length,E=Math.floor(255*this.contrast),d=259*(E+255)/(255*(259-E));for(a=0;a<A;a+=4)c[a]=d*(c[a]-128)+128,c[a+1]=d*(c[a+1]-128)+128,c[a+2]=d*(c[a+2]-128)+128}},getUniformLocations:function(n,a){return{uContrast:n.getUniformLocation(a,"uContrast")}},sendUniformData:function(n,a){n.uniform1f(a.uContrast,this.contrast)}}),x.Image.filters.Contrast.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Saturation=f(l.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var a,c,A=n.imageData.data,E=A.length,d=-this.saturation;for(a=0;a<E;a+=4)c=Math.max(A[a],A[a+1],A[a+2]),A[a]+=c!==A[a]?(c-A[a])*d:0,A[a+1]+=c!==A[a+1]?(c-A[a+1])*d:0,A[a+2]+=c!==A[a+2]?(c-A[a+2])*d:0}},getUniformLocations:function(n,a){return{uSaturation:n.getUniformLocation(a,"uSaturation")}},sendUniformData:function(n,a){n.uniform1f(a.uSaturation,-this.saturation)}}),x.Image.filters.Saturation.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Vibrance=f(l.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var a,c,A,E,d=n.imageData.data,p=d.length,C=-this.vibrance;for(a=0;a<p;a+=4)c=Math.max(d[a],d[a+1],d[a+2]),A=(d[a]+d[a+1]+d[a+2])/3,E=2*Math.abs(c-A)/255*C,d[a]+=c!==d[a]?(c-d[a])*E:0,d[a+1]+=c!==d[a+1]?(c-d[a+1])*E:0,d[a+2]+=c!==d[a+2]?(c-d[a+2])*E:0}},getUniformLocations:function(n,a){return{uVibrance:n.getUniformLocation(a,"uVibrance")}},sendUniformData:function(n,a){n.uniform1f(a.uVibrance,-this.vibrance)}}),x.Image.filters.Vibrance.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Blur=f(l.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var a,c,A=n.filterBackend.resources,E=n.imageData.width,d=n.imageData.height;A.blurLayer1||(A.blurLayer1=x.util.createCanvasElement(),A.blurLayer2=x.util.createCanvasElement()),a=A.blurLayer1,c=A.blurLayer2,a.width===E&&a.height===d||(c.width=a.width=E,c.height=a.height=d);var p,C,y,S,w=a.getContext("2d"),b=c.getContext("2d"),O=.06*this.blur*.5;for(w.putImageData(n.imageData,0,0),b.clearRect(0,0,E,d),S=-15;S<=15;S++)y=O*(C=S/15)*E+(p=(Math.random()-.5)/4),b.globalAlpha=1-Math.abs(C),b.drawImage(a,y,p),w.drawImage(c,0,0),b.globalAlpha=1,b.clearRect(0,0,c.width,c.height);for(S=-15;S<=15;S++)y=O*(C=S/15)*d+(p=(Math.random()-.5)/4),b.globalAlpha=1-Math.abs(C),b.drawImage(a,p,y),w.drawImage(c,0,0),b.globalAlpha=1,b.clearRect(0,0,c.width,c.height);n.ctx.drawImage(a,0,0);var N=n.ctx.getImageData(0,0,a.width,a.height);return w.globalAlpha=1,w.clearRect(0,0,a.width,a.height),N},getUniformLocations:function(n,a){return{delta:n.getUniformLocation(a,"uDelta")}},sendUniformData:function(n,a){var c=this.chooseRightDelta();n.uniform2fv(a.delta,c)},chooseRightDelta:function(){var n,a=1,c=[0,0];return this.horizontal?this.aspectRatio>1&&(a=1/this.aspectRatio):this.aspectRatio<1&&(a=this.aspectRatio),n=a*this.blur*.12,this.horizontal?c[0]=n:c[1]=n,c}}),l.Blur.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Gamma=f(l.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],l.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var a,c=n.imageData.data,A=this.gamma,E=c.length,d=1/A[0],p=1/A[1],C=1/A[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),a=0,E=256;a<E;a++)this.rVals[a]=255*Math.pow(a/255,d),this.gVals[a]=255*Math.pow(a/255,p),this.bVals[a]=255*Math.pow(a/255,C);for(a=0,E=c.length;a<E;a+=4)c[a]=this.rVals[c[a]],c[a+1]=this.gVals[c[a+1]],c[a+2]=this.bVals[c[a+2]]},getUniformLocations:function(n,a){return{uGamma:n.getUniformLocation(a,"uGamma")}},sendUniformData:function(n,a){n.uniform3fv(a.uGamma,this.gamma)}}),x.Image.filters.Gamma.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Composed=f(l.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(a){a.applyTo(n)})},toObject:function(){return x.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),x.Image.filters.Composed.fromObject=function(n,a){var c=(n.subFilters||[]).map(function(E){return new x.Image.filters[E.type](E)}),A=new x.Image.filters.Composed({subFilters:c});return a&&a(A),A}}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.HueRotation=f(l.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,a=x.util.cos(n),c=x.util.sin(n),A=1/3,E=Math.sqrt(A)*c,d=1-a;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=a+d/3,this.matrix[1]=A*d-E,this.matrix[2]=A*d+E,this.matrix[5]=A*d+E,this.matrix[6]=a+A*d,this.matrix[7]=A*d-E,this.matrix[10]=A*d-E,this.matrix[11]=A*d+E,this.matrix[12]=a+A*d},isNeutralState:function(n){return this.calculateMatrix(),l.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),l.BaseFilter.prototype.applyTo.call(this,n)}}),x.Image.filters.HueRotation.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.clone;if(x.Text)x.warn("fabric.Text is already defined");else{var f="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");x.Text=x.util.createClass(x.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:x.Object.prototype.stateProperties.concat(f),cacheProperties:x.Object.prototype.cacheProperties.concat(f),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,a){this.styles=a&&a.styles||{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",a),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=x.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return x._measuringContext||(x._measuringContext=this.canvas&&this.canvas.contextCache||x.util.createCanvasElement().getContext("2d")),x._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,a,c,A,E,d,p,C=0,y=this._textLines.length;C<y;C++)if((this.textAlign==="justify"||C!==y-1&&!this.isEndOfWrapping(C))&&(A=0,E=this._textLines[C],(a=this.getLineWidth(C))<this.width&&(p=this.textLines[C].match(this._reSpacesAndTabs)))){c=p.length,n=(this.width-a)/c;for(var S=0,w=E.length;S<=w;S++)d=this.__charBounds[C][S],this._reSpaceAndTab.test(E[S])?(d.width+=n,d.kernedWidth+=n,d.left+=A,A+=n):d.left+=A}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),a=this.fontSize;return n.width+=a*n.zoomX,n.height+=a*n.zoomY,n},_render:function(n){var a=this.path;a&&!a.isNotVisible()&&a._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,a,c){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom"}n.font=this._getFontDeclaration(a,c)},calcTextWidth:function(){for(var n=this.getLineWidth(0),a=1,c=this._textLines.length;a<c;a++){var A=this.getLineWidth(a);A>n&&(n=A)}return n},_renderTextLine:function(n,a,c,A,E,d){this._renderChars(n,a,c,A,E,d)},_renderTextLinesBackground:function(n){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var a,c,A,E,d,p,C,y=n.fillStyle,S=this._getLeftOffset(),w=this._getTopOffset(),b=0,O=0,N=this.path,j=0,Z=this._textLines.length;j<Z;j++)if(a=this.getHeightOfLine(j),this.textBackgroundColor||this.styleHas("textBackgroundColor",j)){A=this._textLines[j],c=this._getLineLeftOffset(j),O=0,b=0,E=this.getValueOfPropertyAt(j,0,"textBackgroundColor");for(var Y=0,W=A.length;Y<W;Y++)d=this.__charBounds[j][Y],p=this.getValueOfPropertyAt(j,Y,"textBackgroundColor"),N?(n.save(),n.translate(d.renderLeft,d.renderTop),n.rotate(d.angle),n.fillStyle=p,p&&n.fillRect(-d.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),d.width,a/this.lineHeight),n.restore()):p!==E?(C=S+c+b,this.direction==="rtl"&&(C=this.width-C-O),n.fillStyle=E,E&&n.fillRect(C,w,O,a/this.lineHeight),b=d.left,O=d.width,E=p):O+=d.kernedWidth;p&&!N&&(C=S+c+b,this.direction==="rtl"&&(C=this.width-C-O),n.fillStyle=p,n.fillRect(C,w,O,a/this.lineHeight)),w+=a}else w+=a;n.fillStyle=y,this._removeShadow(n)}},getFontCache:function(n){var a=n.fontFamily.toLowerCase();x.charWidthsCache[a]||(x.charWidthsCache[a]={});var c=x.charWidthsCache[a],A=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return c[A]||(c[A]={}),c[A]},_measureChar:function(n,a,c,A){var E,d,p,C,y=this.getFontCache(a),S=c+n,w=this._getFontDeclaration(a)===this._getFontDeclaration(A),b=a.fontSize/this.CACHE_FONT_SIZE;if(c&&y[c]!==void 0&&(p=y[c]),y[n]!==void 0&&(C=E=y[n]),w&&y[S]!==void 0&&(C=(d=y[S])-p),E===void 0||p===void 0||d===void 0){var O=this.getMeasuringContext();this._setTextStyles(O,a,!0)}return E===void 0&&(C=E=O.measureText(n).width,y[n]=E),p===void 0&&w&&c&&(p=O.measureText(c).width,y[c]=p),w&&d===void 0&&(d=O.measureText(S).width,y[S]=d,C=d-p),{width:E*b,kernedWidth:C*b}},getHeightOfChar:function(n,a){return this.getValueOfPropertyAt(n,a,"fontSize")},measureLine:function(n){var a=this._measureLine(n);return this.charSpacing!==0&&(a.width-=this._getWidthOfCharSpacing()),a.width<0&&(a.width=0),a},_measureLine:function(n){var a,c,A,E,d,p,C=0,y=this._textLines[n],S=new Array(y.length),w=0,b=this.path,O=this.pathSide==="right";for(this.__charBounds[n]=S,a=0;a<y.length;a++)c=y[a],E=this._getGraphemeBox(c,n,a,A),S[a]=E,C+=E.kernedWidth,A=c;if(S[a]={left:E?E.left+E.width:0,width:0,kernedWidth:0,height:this.fontSize},b){switch(p=b.segmentsInfo[b.segmentsInfo.length-1].length,(d=x.util.getPointOnPath(b.path,0,b.segmentsInfo)).x+=b.pathOffset.x,d.y+=b.pathOffset.y,this.textAlign){case"left":w=O?p-C:0;break;case"center":w=(p-C)/2;break;case"right":w=O?0:p-C}for(w+=this.pathStartOffset*(O?-1:1),a=O?y.length-1:0;O?a>=0:a<y.length;O?a--:a++)E=S[a],w>p?w%=p:w<0&&(w+=p),this._setGraphemeOnPath(w,E,d),w+=E.kernedWidth}return{width:C,numOfSpaces:0}},_setGraphemeOnPath:function(n,a,c){var A=n+a.kernedWidth/2,E=this.path,d=x.util.getPointOnPath(E.path,A,E.segmentsInfo);a.renderLeft=d.x-c.x,a.renderTop=d.y-c.y,a.angle=d.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,a,c,A,E){var d,p=this.getCompleteStyleDeclaration(a,c),C=A?this.getCompleteStyleDeclaration(a,c-1):{},y=this._measureChar(n,p,A,C),S=y.kernedWidth,w=y.width;this.charSpacing!==0&&(w+=d=this._getWidthOfCharSpacing(),S+=d);var b={width:w,left:0,height:p.fontSize,kernedWidth:S,deltaY:p.deltaY};if(c>0&&!E){var O=this.__charBounds[a][c-1];b.left=O.left+O.width+y.kernedWidth-y.width}return b},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var a=this._textLines[n],c=this.getHeightOfChar(n,0),A=1,E=a.length;A<E;A++)c=Math.max(this.getHeightOfChar(n,A),c);return this.__lineHeights[n]=c*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,a=0,c=0,A=this._textLines.length;c<A;c++)n=this.getHeightOfLine(c),a+=c===A-1?n/this.lineHeight:n;return a},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,a){n.save();for(var c=0,A=this._getLeftOffset(),E=this._getTopOffset(),d=0,p=this._textLines.length;d<p;d++){var C=this.getHeightOfLine(d),y=C/this.lineHeight,S=this._getLineLeftOffset(d);this._renderTextLine(a,n,this._textLines[d],A+S,E+c+y,d),c+=C}n.restore()},_renderTextFill:function(n){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,a,c,A,E,d){var p,C,y,S,w,b=this.getHeightOfLine(d),O=this.textAlign.indexOf("justify")!==-1,N="",j=0,Z=this.path,Y=!O&&this.charSpacing===0&&this.isEmptyStyles(d)&&!Z,W=this.direction==="ltr",P=this.direction==="ltr"?1:-1,R=a.canvas.getAttribute("dir");if(a.save(),R!==this.direction&&(a.canvas.setAttribute("dir",W?"ltr":"rtl"),a.direction=W?"ltr":"rtl",a.textAlign=W?"left":"right"),E-=b*this._fontSizeFraction/this.lineHeight,Y)return this._renderChar(n,a,d,0,c.join(""),A,E,b),void a.restore();for(var V=0,J=c.length-1;V<=J;V++)S=V===J||this.charSpacing||Z,N+=c[V],y=this.__charBounds[d][V],j===0?(A+=P*(y.kernedWidth-y.width),j+=y.width):j+=y.kernedWidth,O&&!S&&this._reSpaceAndTab.test(c[V])&&(S=!0),S||(p=p||this.getCompleteStyleDeclaration(d,V),C=this.getCompleteStyleDeclaration(d,V+1),S=this._hasStyleChanged(p,C)),S&&(Z?(a.save(),a.translate(y.renderLeft,y.renderTop),a.rotate(y.angle),this._renderChar(n,a,d,V,N,-j/2,0,b),a.restore()):(w=A,this._renderChar(n,a,d,V,N,w,E,b)),N="",p=C,A+=P*j,j=0);a.restore()},_applyPatternGradientTransformText:function(n){var a,c=x.util.createCanvasElement(),A=this.width+this.strokeWidth,E=this.height+this.strokeWidth;return c.width=A,c.height=E,(a=c.getContext("2d")).beginPath(),a.moveTo(0,0),a.lineTo(A,0),a.lineTo(A,E),a.lineTo(0,E),a.closePath(),a.translate(A/2,E/2),a.fillStyle=n.toLive(a),this._applyPatternGradientTransform(a,n),a.fill(),a.createPattern(c,"no-repeat")},handleFiller:function(n,a,c){var A,E;return c.toLive?c.gradientUnits==="percentage"||c.gradientTransform||c.patternTransform?(A=-this.width/2,E=-this.height/2,n.translate(A,E),n[a]=this._applyPatternGradientTransformText(c),{offsetX:A,offsetY:E}):(n[a]=c.toLive(n,this),this._applyPatternGradientTransform(n,c)):(n[a]=c,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,a){return n.lineWidth=a.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",a.stroke)},_setFillStyles:function(n,a){return this.handleFiller(n,"fillStyle",a.fill)},_renderChar:function(n,a,c,A,E,d,p){var C,y,S=this._getStyleDeclaration(c,A),w=this.getCompleteStyleDeclaration(c,A),b=n==="fillText"&&w.fill,O=n==="strokeText"&&w.stroke&&w.strokeWidth;(O||b)&&(a.save(),b&&(C=this._setFillStyles(a,w)),O&&(y=this._setStrokeStyles(a,w)),a.font=this._getFontDeclaration(w),S&&S.textBackgroundColor&&this._removeShadow(a),S&&S.deltaY&&(p+=S.deltaY),b&&a.fillText(E,d-C.offsetX,p-C.offsetY),O&&a.strokeText(E,d-y.offsetX,p-y.offsetY),a.restore())},setSuperscript:function(n,a){return this._setScript(n,a,this.superscript)},setSubscript:function(n,a){return this._setScript(n,a,this.subscript)},_setScript:function(n,a,c){var A=this.get2DCursorLocation(n,!0),E=this.getValueOfPropertyAt(A.lineIndex,A.charIndex,"fontSize"),d=this.getValueOfPropertyAt(A.lineIndex,A.charIndex,"deltaY"),p={fontSize:E*c.size,deltaY:d+E*c.baseline};return this.setSelectionStyles(p,n,a),this},_hasStyleChanged:function(n,a){return n.fill!==a.fill||n.stroke!==a.stroke||n.strokeWidth!==a.strokeWidth||n.fontSize!==a.fontSize||n.fontFamily!==a.fontFamily||n.fontWeight!==a.fontWeight||n.fontStyle!==a.fontStyle||n.deltaY!==a.deltaY},_hasStyleChangedForSvg:function(n,a){return this._hasStyleChanged(n,a)||n.overline!==a.overline||n.underline!==a.underline||n.linethrough!==a.linethrough},_getLineLeftOffset:function(n){var a=this.getLineWidth(n),c=this.width-a,A=this.textAlign,E=this.direction,d=0,p=this.isEndOfWrapping(n);return A==="justify"||A==="justify-center"&&!p||A==="justify-right"&&!p||A==="justify-left"&&!p?0:(A==="center"&&(d=c/2),A==="right"&&(d=c),A==="justify-center"&&(d=c/2),A==="justify-right"&&(d=c),E==="rtl"&&(d-=c),d)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var a=this.measureLine(n).width;return this.__lineWidths[n]=a,a},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,a,c){var A=this._getStyleDeclaration(n,a);return A&&A[c]!==void 0?A[c]:this[c]},_renderTextDecoration:function(n,a){if(this[a]||this.styleHas(a)){for(var c,A,E,d,p,C,y,S,w,b,O,N,j,Z,Y,W,P=this._getLeftOffset(),R=this._getTopOffset(),V=this.path,J=this._getWidthOfCharSpacing(),q=this.offsets[a],L=0,M=this._textLines.length;L<M;L++)if(c=this.getHeightOfLine(L),this[a]||this.styleHas(a,L)){y=this._textLines[L],Z=c/this.lineHeight,d=this._getLineLeftOffset(L),b=0,O=0,S=this.getValueOfPropertyAt(L,0,a),W=this.getValueOfPropertyAt(L,0,"fill"),w=R+Z*(1-this._fontSizeFraction),A=this.getHeightOfChar(L,0),p=this.getValueOfPropertyAt(L,0,"deltaY");for(var G=0,ee=y.length;G<ee;G++)if(N=this.__charBounds[L][G],j=this.getValueOfPropertyAt(L,G,a),Y=this.getValueOfPropertyAt(L,G,"fill"),E=this.getHeightOfChar(L,G),C=this.getValueOfPropertyAt(L,G,"deltaY"),V&&j&&Y)n.save(),n.fillStyle=W,n.translate(N.renderLeft,N.renderTop),n.rotate(N.angle),n.fillRect(-N.kernedWidth/2,q*E+C,N.kernedWidth,this.fontSize/15),n.restore();else if((j!==S||Y!==W||E!==A||C!==p)&&O>0){var z=P+d+b;this.direction==="rtl"&&(z=this.width-z-O),S&&W&&(n.fillStyle=W,n.fillRect(z,w+q*A+p,O,this.fontSize/15)),b=N.left,O=N.width,S=j,W=Y,A=E,p=C}else O+=N.kernedWidth;z=P+d+b,this.direction==="rtl"&&(z=this.width-z-O),n.fillStyle=Y,j&&Y&&n.fillRect(z,w+q*A+p,O-J,this.fontSize/15),R+=c}else R+=c;this._removeShadow(n)}},_getFontDeclaration:function(n,a){var c=n||this,A=this.fontFamily,E=x.Text.genericFonts.indexOf(A.toLowerCase())>-1,d=A===void 0||A.indexOf("'")>-1||A.indexOf(",")>-1||A.indexOf('"')>-1||E?c.fontFamily:'"'+c.fontFamily+'"';return[x.isLikelyNode?c.fontWeight:c.fontStyle,x.isLikelyNode?c.fontStyle:c.fontWeight,a?this.CACHE_FONT_SIZE+"px":c.fontSize+"px",d].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var a=n.split(this._reNewline),c=new Array(a.length),A=[`
`],E=[],d=0;d<a.length;d++)c[d]=x.util.string.graphemeSplit(a[d]),E=E.concat(c[d],A);return E.pop(),{_unwrappedLines:c,lines:a,graphemeText:E,graphemeLines:c}},toObject:function(n){var a=f.concat(n),c=this.callSuper("toObject",a);return c.styles=l(this.styles,!0),c.path&&(c.path=this.path.toObject()),c},set:function(n,a){this.callSuper("set",n,a);var c=!1,A=!1;if(typeof n=="object")for(var E in n)E==="path"&&this.setPathInfo(),c=c||this._dimensionAffectingProps.indexOf(E)!==-1,A=A||E==="path";else c=this._dimensionAffectingProps.indexOf(n)!==-1,A=n==="path";return A&&this.setPathInfo(),c&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),x.Text.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),x.Text.DEFAULT_SVG_FONT_SIZE=16,x.Text.fromElement=function(n,a,c){if(!n)return a(null);var A=x.parseAttributes(n,x.Text.ATTRIBUTE_NAMES),E=A.textAnchor||"left";if((c=x.util.object.extend(c?l(c):{},A)).top=c.top||0,c.left=c.left||0,A.textDecoration){var d=A.textDecoration;d.indexOf("underline")!==-1&&(c.underline=!0),d.indexOf("overline")!==-1&&(c.overline=!0),d.indexOf("line-through")!==-1&&(c.linethrough=!0),delete c.textDecoration}"dx"in A&&(c.left+=A.dx),"dy"in A&&(c.top+=A.dy),"fontSize"in c||(c.fontSize=x.Text.DEFAULT_SVG_FONT_SIZE);var p="";"textContent"in n?p=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(p=n.firstChild.data),p=p.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var C=c.strokeWidth;c.strokeWidth=0;var y=new x.Text(p,c),S=y.getScaledHeight()/y.height,w=((y.height+y.strokeWidth)*y.lineHeight-y.height)*S,b=y.getScaledHeight()+w,O=0;E==="center"&&(O=y.getScaledWidth()/2),E==="right"&&(O=y.getScaledWidth()),y.set({left:y.left-O,top:y.top-(b-y.fontSize*(.07+y._fontSizeFraction))/y.lineHeight,strokeWidth:C!==void 0?C:1}),a(y)},x.Text.fromObject=function(n,a){var c=l(n),A=n.path;return delete c.path,x.Object._fromObject("Text",c,function(E){A?x.Object._fromObject("Path",A,function(d){E.set("path",d),a(E)},"path"):a(E)},"text")},x.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],x.util.createAccessors&&x.util.createAccessors(x.Text)}}(e),v.util.object.extend(v.Text.prototype,{isEmptyStyles:function(h){if(!this.styles||h!==void 0&&!this.styles[h])return!0;var x=h===void 0?this.styles:{line:this.styles[h]};for(var l in x)for(var f in x[l])for(var n in x[l][f])return!1;return!0},styleHas:function(h,x){if(!this.styles||!h||h===""||x!==void 0&&!this.styles[x])return!1;var l=x===void 0?this.styles:{0:this.styles[x]};for(var f in l)for(var n in l[f])if(l[f][n][h]!==void 0)return!0;return!1},cleanStyle:function(h){if(!this.styles||!h||h==="")return!1;var x,l,f=this.styles,n=0,a=!0,c=0;for(var A in f){for(var E in x=0,f[A]){var d;n++,(d=f[A][E]).hasOwnProperty(h)?(l?d[h]!==l&&(a=!1):l=d[h],d[h]===this[h]&&delete d[h]):a=!1,Object.keys(d).length!==0?x++:delete f[A][E]}x===0&&delete f[A]}for(var p=0;p<this._textLines.length;p++)c+=this._textLines[p].length;a&&n===c&&(this[h]=l,this.removeStyle(h))},removeStyle:function(h){if(this.styles&&h&&h!==""){var x,l,f,n=this.styles;for(l in n){for(f in x=n[l])delete x[f][h],Object.keys(x[f]).length===0&&delete x[f];Object.keys(x).length===0&&delete n[l]}}},_extendStyles:function(h,x){var l=this.get2DCursorLocation(h);this._getLineStyle(l.lineIndex)||this._setLineStyle(l.lineIndex),this._getStyleDeclaration(l.lineIndex,l.charIndex)||this._setStyleDeclaration(l.lineIndex,l.charIndex,{}),v.util.object.extend(this._getStyleDeclaration(l.lineIndex,l.charIndex),x)},get2DCursorLocation:function(h,x){h===void 0&&(h=this.selectionStart);for(var l=x?this._unwrappedTextLines:this._textLines,f=l.length,n=0;n<f;n++){if(h<=l[n].length)return{lineIndex:n,charIndex:h};h-=l[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:l[n-1].length<h?l[n-1].length:h}},getSelectionStyles:function(h,x,l){h===void 0&&(h=this.selectionStart||0),x===void 0&&(x=this.selectionEnd||h);for(var f=[],n=h;n<x;n++)f.push(this.getStyleAtPosition(n,l));return f},getStyleAtPosition:function(h,x){var l=this.get2DCursorLocation(h);return(x?this.getCompleteStyleDeclaration(l.lineIndex,l.charIndex):this._getStyleDeclaration(l.lineIndex,l.charIndex))||{}},setSelectionStyles:function(h,x,l){x===void 0&&(x=this.selectionStart||0),l===void 0&&(l=this.selectionEnd||x);for(var f=x;f<l;f++)this._extendStyles(f,h);return this._forceClearCache=!0,this},_getStyleDeclaration:function(h,x){var l=this.styles&&this.styles[h];return l?l[x]:null},getCompleteStyleDeclaration:function(h,x){for(var l,f=this._getStyleDeclaration(h,x)||{},n={},a=0;a<this._styleProperties.length;a++)n[l=this._styleProperties[a]]=f[l]===void 0?this[l]:f[l];return n},_setStyleDeclaration:function(h,x,l){this.styles[h][x]=l},_deleteStyleDeclaration:function(h,x){delete this.styles[h][x]},_getLineStyle:function(h){return!!this.styles[h]},_setLineStyle:function(h){this.styles[h]={}},_deleteLineStyle:function(h){delete this.styles[h]}}),function(){function h(x){x.textDecoration&&(x.textDecoration.indexOf("underline")>-1&&(x.underline=!0),x.textDecoration.indexOf("line-through")>-1&&(x.linethrough=!0),x.textDecoration.indexOf("overline")>-1&&(x.overline=!0),delete x.textDecoration)}v.IText=v.util.createClass(v.Text,v.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(x,l){this.callSuper("initialize",x,l),this.initBehavior()},setSelectionStart:function(x){x=Math.max(x,0),this._updateAndFire("selectionStart",x)},setSelectionEnd:function(x){x=Math.min(x,this.text.length),this._updateAndFire("selectionEnd",x)},_updateAndFire:function(x,l){this[x]!==l&&(this._fireSelectionChanged(),this[x]=l),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(x){this.clearContextTop(),this.callSuper("render",x),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(x){this.callSuper("_render",x)},clearContextTop:function(x){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var l=this.canvas.contextTop,f=this.canvas.viewportTransform;l.save(),l.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this.transform(l),this._clearTextArea(l),x||l.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var x=this._getCursorBoundaries(),l=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(x,l):this.renderSelection(x,l),l.restore()}},_clearTextArea:function(x){var l=this.width+4,f=this.height+4;x.clearRect(-l/2,-f/2,l,f)},_getCursorBoundaries:function(x){x===void 0&&(x=this.selectionStart);var l=this._getLeftOffset(),f=this._getTopOffset(),n=this._getCursorBoundariesOffsets(x);return{left:l,top:f,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(x){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var l,f,n,a,c=0,A=0,E=this.get2DCursorLocation(x);n=E.charIndex,f=E.lineIndex;for(var d=0;d<f;d++)c+=this.getHeightOfLine(d);l=this._getLineLeftOffset(f);var p=this.__charBounds[f][n];return p&&(A=p.left),this.charSpacing!==0&&n===this._textLines[f].length&&(A-=this._getWidthOfCharSpacing()),a={top:c,left:l+(A>0?A:0)},this.direction==="rtl"&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(x,l){var f=this.get2DCursorLocation(),n=f.lineIndex,a=f.charIndex>0?f.charIndex-1:0,c=this.getValueOfPropertyAt(n,a,"fontSize"),A=this.scaleX*this.canvas.getZoom(),E=this.cursorWidth/A,d=x.topOffset,p=this.getValueOfPropertyAt(n,a,"deltaY");d+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-c*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(x,l),l.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,a,"fill"),l.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,l.fillRect(x.left+x.leftOffset-E/2,d+x.top+p,E,c)},renderSelection:function(x,l){for(var f=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,a=this.textAlign.indexOf("justify")!==-1,c=this.get2DCursorLocation(f),A=this.get2DCursorLocation(n),E=c.lineIndex,d=A.lineIndex,p=c.charIndex<0?0:c.charIndex,C=A.charIndex<0?0:A.charIndex,y=E;y<=d;y++){var S,w=this._getLineLeftOffset(y)||0,b=this.getHeightOfLine(y),O=0,N=0;if(y===E&&(O=this.__charBounds[E][p].left),y>=E&&y<d)N=a&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===d)if(C===0)N=this.__charBounds[d][C].left;else{var j=this._getWidthOfCharSpacing();N=this.__charBounds[d][C-1].left+this.__charBounds[d][C-1].width-j}S=b,(this.lineHeight<1||y===d&&this.lineHeight>1)&&(b/=this.lineHeight);var Z=x.left+w+O,Y=N-O,W=b,P=0;this.inCompositionMode?(l.fillStyle=this.compositionColor||"black",W=1,P=b):l.fillStyle=this.selectionColor,this.direction==="rtl"&&(Z=this.width-Z-Y),l.fillRect(Z,x.top+x.topOffset+P,Y,W),x.topOffset+=S}},getCurrentCharFontSize:function(){var x=this._getCurrentCharIndex();return this.getValueOfPropertyAt(x.l,x.c,"fontSize")},getCurrentCharColor:function(){var x=this._getCurrentCharIndex();return this.getValueOfPropertyAt(x.l,x.c,"fill")},_getCurrentCharIndex:function(){var x=this.get2DCursorLocation(this.selectionStart,!0),l=x.charIndex>0?x.charIndex-1:0;return{l:x.lineIndex,c:l}}}),v.IText.fromObject=function(x,l){if(h(x),x.styles)for(var f in x.styles)for(var n in x.styles[f])h(x.styles[f][n]);v.Object._fromObject("IText",x,l,"text")}}(),Ae=v.util.object.clone,v.util.object.extend(v.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var h=this;this.on("added",function(){var x=h.canvas;x&&(x._hasITextHandlers||(x._hasITextHandlers=!0,h._initCanvasHandlers(x)),x._iTextInstances=x._iTextInstances||[],x._iTextInstances.push(h))})},initRemovedHandler:function(){var h=this;this.on("removed",function(){var x=h.canvas;x&&(x._iTextInstances=x._iTextInstances||[],v.util.removeFromArray(x._iTextInstances,h),x._iTextInstances.length===0&&(x._hasITextHandlers=!1,h._removeCanvasHandlers(x)))})},_initCanvasHandlers:function(h){h._mouseUpITextHandler=function(){h._iTextInstances&&h._iTextInstances.forEach(function(x){x.__isMousedown=!1})},h.on("mouse:up",h._mouseUpITextHandler)},_removeCanvasHandlers:function(h){h.off("mouse:up",h._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(h,x,l,f){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},h.animate("_currentCursorOpacity",x,{duration:l,onComplete:function(){n.isAborted||h[f]()},onChange:function(){h.canvas&&h.selectionStart===h.selectionEnd&&h.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var h=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){h._currentTickCompleteState=h._animateCursor(h,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(h){var x=this,l=h?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){x._tick()},l)},abortCursorAnimation:function(){var h=this._currentTickState||this._currentTickCompleteState,x=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,h&&x&&x.clearContext(x.contextTop||x.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(h){var x=0,l=h-1;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)x++,l--;for(;/\S/.test(this._text[l])&&l>-1;)x++,l--;return h-x},findWordBoundaryRight:function(h){var x=0,l=h;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)x++,l++;for(;/\S/.test(this._text[l])&&l<this._text.length;)x++,l++;return h+x},findLineBoundaryLeft:function(h){for(var x=0,l=h-1;!/\n/.test(this._text[l])&&l>-1;)x++,l--;return h-x},findLineBoundaryRight:function(h){for(var x=0,l=h;!/\n/.test(this._text[l])&&l<this._text.length;)x++,l++;return h+x},searchWordBoundary:function(h,x){for(var l=this._text,f=this._reSpace.test(l[h])?h-1:h,n=l[f],a=v.reNonWord;!a.test(n)&&f>0&&f<l.length;)n=l[f+=x];return a.test(n)&&(f+=x===1?0:1),f},selectWord:function(h){h=h||this.selectionStart;var x=this.searchWordBoundary(h,-1),l=this.searchWordBoundary(h,1);this.selectionStart=x,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(h){h=h||this.selectionStart;var x=this.findLineBoundaryLeft(h),l=this.findLineBoundaryRight(h);return this.selectionStart=x,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(h){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(h),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(h){h._iTextInstances&&h._iTextInstances.forEach(function(x){x.selected=!1,x.isEditing&&x.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(h){if(this.__isMousedown&&this.isEditing){var x=this.getSelectionStartFromPointer(h.e),l=this.selectionStart,f=this.selectionEnd;(x===this.__selectionStartOnMouseDown&&l!==f||l!==x&&f!==x)&&(x>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=x):(this.selectionStart=x,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===l&&this.selectionEnd===f||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(h,x,l){var f=l.slice(0,h),n=v.util.string.graphemeSplit(f).length;if(h===x)return{selectionStart:n,selectionEnd:n};var a=l.slice(h,x);return{selectionStart:n,selectionEnd:n+v.util.string.graphemeSplit(a).length}},fromGraphemeToStringSelection:function(h,x,l){var f=l.slice(0,h).join("").length;return h===x?{selectionStart:f,selectionEnd:f}:{selectionStart:f,selectionEnd:f+l.slice(h,x).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var h=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=h.selectionStart,this.hiddenTextarea.selectionEnd=h.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var h=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=h.selectionEnd,this.inCompositionMode||(this.selectionStart=h.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var h=this._calcTextareaPosition();this.hiddenTextarea.style.left=h.left,this.hiddenTextarea.style.top=h.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var h=this.inCompositionMode?this.compositionStart:this.selectionStart,x=this._getCursorBoundaries(h),l=this.get2DCursorLocation(h),f=l.lineIndex,n=l.charIndex,a=this.getValueOfPropertyAt(f,n,"fontSize")*this.lineHeight,c=x.leftOffset,A=this.calcTransformMatrix(),E={x:x.left+c,y:x.top+x.topOffset+a},d=this.canvas.getRetinaScaling(),p=this.canvas.upperCanvasEl,C=p.width/d,y=p.height/d,S=C-a,w=y-a,b=p.clientWidth/C,O=p.clientHeight/y;return E=v.util.transformPoint(E,A),(E=v.util.transformPoint(E,this.canvas.viewportTransform)).x*=b,E.y*=O,E.x<0&&(E.x=0),E.x>S&&(E.x=S),E.y<0&&(E.y=0),E.y>w&&(E.y=w),E.x+=this.canvas._offset.left,E.y+=this.canvas._offset.top,{left:E.x+"px",top:E.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var h=this._textBeforeEdit!==this.text,x=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,x&&(x.blur&&x.blur(),x.parentNode&&x.parentNode.removeChild(x)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),h&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),h&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var h in this.styles)this._textLines[h]||delete this.styles[h]},removeStyleFromTo:function(h,x){var l,f,n=this.get2DCursorLocation(h,!0),a=this.get2DCursorLocation(x,!0),c=n.lineIndex,A=n.charIndex,E=a.lineIndex,d=a.charIndex;if(c!==E){if(this.styles[c])for(l=A;l<this._unwrappedTextLines[c].length;l++)delete this.styles[c][l];if(this.styles[E])for(l=d;l<this._unwrappedTextLines[E].length;l++)(f=this.styles[E][l])&&(this.styles[c]||(this.styles[c]={}),this.styles[c][A+l-d]=f);for(l=c+1;l<=E;l++)delete this.styles[l];this.shiftLineStyles(E,c-E)}else if(this.styles[c]){f=this.styles[c];var p,C,y=d-A;for(l=A;l<d;l++)delete f[l];for(C in this.styles[c])(p=parseInt(C,10))>=d&&(f[p-y]=f[C],delete f[C])}},shiftLineStyles:function(h,x){var l=Ae(this.styles);for(var f in this.styles){var n=parseInt(f,10);n>h&&(this.styles[n+x]=l[n],l[n-x]||delete this.styles[n])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(h,x,l,f){var n,a={},c=!1,A=this._unwrappedTextLines[h].length===x;for(var E in l||(l=1),this.shiftLineStyles(h,l),this.styles[h]&&(n=this.styles[h][x===0?x:x-1]),this.styles[h]){var d=parseInt(E,10);d>=x&&(c=!0,a[d-x]=this.styles[h][E],A&&x===0||delete this.styles[h][E])}var p=!1;for(c&&!A&&(this.styles[h+l]=a,p=!0),p&&l--;l>0;)f&&f[l-1]?this.styles[h+l]={0:Ae(f[l-1])}:n?this.styles[h+l]={0:Ae(n)}:delete this.styles[h+l],l--;this._forceClearCache=!0},insertCharStyleObject:function(h,x,l,f){this.styles||(this.styles={});var n=this.styles[h],a=n?Ae(n):{};for(var c in l||(l=1),a){var A=parseInt(c,10);A>=x&&(n[A+l]=a[A],a[A-l]||delete n[A])}if(this._forceClearCache=!0,f)for(;l--;)Object.keys(f[l]).length&&(this.styles[h]||(this.styles[h]={}),this.styles[h][x+l]=Ae(f[l]));else if(n)for(var E=n[x?x-1:1];E&&l--;)this.styles[h][x+l]=Ae(E)},insertNewStyleBlock:function(h,x,l){for(var f=this.get2DCursorLocation(x,!0),n=[0],a=0,c=0;c<h.length;c++)h[c]===`
`?n[++a]=0:n[a]++;for(n[0]>0&&(this.insertCharStyleObject(f.lineIndex,f.charIndex,n[0],l),l=l&&l.slice(n[0]+1)),a&&this.insertNewlineStyleObject(f.lineIndex,f.charIndex+n[0],a),c=1;c<a;c++)n[c]>0?this.insertCharStyleObject(f.lineIndex+c,0,n[c],l):l&&this.styles[f.lineIndex+c]&&l[0]&&(this.styles[f.lineIndex+c][0]=l[0]),l=l&&l.slice(n[c]+1);n[c]>0&&this.insertCharStyleObject(f.lineIndex+c,0,n[c],l)},setSelectionStartEndWithShift:function(h,x,l){l<=h?(x===h?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=h),this.selectionStart=l):l>h&&l<x?this._selectionDirection==="right"?this.selectionEnd=l:this.selectionStart=l:(x===h?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=x),this.selectionEnd=l)},setSelectionInBoundaries:function(){var h=this.text.length;this.selectionStart>h?this.selectionStart=h:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>h?this.selectionEnd=h:this.selectionEnd<0&&(this.selectionEnd=0)}}),v.util.object.extend(v.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(h){if(this.canvas){this.__newClickTime=+new Date;var x=h.pointer;this.isTripleClick(x)&&(this.fire("tripleclick",h),this._stopEvent(h.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=x,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(h){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===h.x&&this.__lastPointer.y===h.y},_stopEvent:function(h){h.preventDefault&&h.preventDefault(),h.stopPropagation&&h.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(h){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(h.e))},tripleClickHandler:function(h){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(h.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(h.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(h){if(this.__isMousedown=!1,!(!this.editable||this.group||h.transform&&h.transform.actionPerformed||h.e.button&&h.e.button!==1)){if(this.canvas){var x=this.canvas._activeObject;if(x&&x!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(h.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(h){var x=this.getSelectionStartFromPointer(h),l=this.selectionStart,f=this.selectionEnd;h.shiftKey?this.setSelectionStartEndWithShift(l,f,x):(this.selectionStart=x,this.selectionEnd=x),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(h){for(var x,l=this.getLocalPointer(h),f=0,n=0,a=0,c=0,A=0,E=0,d=this._textLines.length;E<d&&a<=l.y;E++)a+=this.getHeightOfLine(E)*this.scaleY,A=E,E>0&&(c+=this._textLines[E-1].length+this.missingNewlineOffset(E-1));n=this._getLineLeftOffset(A)*this.scaleX,x=this._textLines[A],this.direction==="rtl"&&(l.x=this.width*this.scaleX-l.x+n);for(var p=0,C=x.length;p<C&&(f=n,(n+=this.__charBounds[A][p].kernedWidth*this.scaleX)<=l.x);p++)c++;return this._getNewSelectionStartFromOffset(l,f,n,c,C)},_getNewSelectionStartFromOffset:function(h,x,l,f,n){var a=h.x-x,c=l-h.x,A=f+(c>a||c<0?0:1);return this.flipX&&(A=n-A),A>this._text.length&&(A=this._text.length),A}}),v.util.object.extend(v.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=v.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var h=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+h.top+"; left: "+h.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+h.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):v.document.body.appendChild(this.hiddenTextarea),v.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),v.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),v.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),v.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),v.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),v.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),v.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),v.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),v.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(v.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(h){if(this.isEditing){var x=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(h.keyCode in x)this[x[h.keyCode]](h);else{if(!(h.keyCode in this.ctrlKeysMapDown)||!h.ctrlKey&&!h.metaKey)return;this[this.ctrlKeysMapDown[h.keyCode]](h)}h.stopImmediatePropagation(),h.preventDefault(),h.keyCode>=33&&h.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(h){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:h.keyCode in this.ctrlKeysMapUp&&(h.ctrlKey||h.metaKey)&&(this[this.ctrlKeysMapUp[h.keyCode]](h),h.stopImmediatePropagation(),h.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(h){var x=this.fromPaste;if(this.fromPaste=!1,h&&h.stopPropagation(),this.isEditing){var l,f,n,a,c,A=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,E=this._text.length,d=A.length,p=d-E,C=this.selectionStart,y=this.selectionEnd,S=C!==y;if(this.hiddenTextarea.value==="")return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var w=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),b=C>w.selectionStart;S?(l=this._text.slice(C,y),p+=y-C):d<E&&(l=b?this._text.slice(y+p,y):this._text.slice(C,C-p)),f=A.slice(w.selectionEnd-p,w.selectionEnd),l&&l.length&&(f.length&&(n=this.getSelectionStyles(C,C+1,!1),n=f.map(function(){return n[0]})),S?(a=C,c=y):b?(a=y-l.length,c=y):(a=y,c=y+l.length),this.removeStyleFromTo(a,c)),f.length&&(x&&f.join("")===v.copiedText&&!v.disableStyleCopyPaste&&(n=v.copiedTextStyle),this.insertNewStyleBlock(f,C,n)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(h){this.compositionStart=h.target.selectionStart,this.compositionEnd=h.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(v.copiedText=this.getSelectedText(),v.disableStyleCopyPaste?v.copiedTextStyle=null:v.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(h){return h&&h.clipboardData||v.window.clipboardData},_getWidthBeforeCursor:function(h,x){var l,f=this._getLineLeftOffset(h);return x>0&&(f+=(l=this.__charBounds[h][x-1]).left+l.width),f},getDownCursorOffset:function(h,x){var l=this._getSelectionForOffset(h,x),f=this.get2DCursorLocation(l),n=f.lineIndex;if(n===this._textLines.length-1||h.metaKey||h.keyCode===34)return this._text.length-l;var a=f.charIndex,c=this._getWidthBeforeCursor(n,a),A=this._getIndexOnLine(n+1,c);return this._textLines[n].slice(a).length+A+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(h,x){return h.shiftKey&&this.selectionStart!==this.selectionEnd&&x?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(h,x){var l=this._getSelectionForOffset(h,x),f=this.get2DCursorLocation(l),n=f.lineIndex;if(n===0||h.metaKey||h.keyCode===33)return-l;var a=f.charIndex,c=this._getWidthBeforeCursor(n,a),A=this._getIndexOnLine(n-1,c),E=this._textLines[n].slice(0,a),d=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+A-E.length+(1-d)},_getIndexOnLine:function(h,x){for(var l,f,n=this._textLines[h],a=this._getLineLeftOffset(h),c=0,A=0,E=n.length;A<E;A++)if((a+=l=this.__charBounds[h][A].width)>x){f=!0;var d=a-l,p=a,C=Math.abs(d-x);c=Math.abs(p-x)<C?A:A-1;break}return f||(c=n.length-1),c},moveCursorDown:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",h)},moveCursorUp:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",h)},_moveCursorUpOrDown:function(h,x){var l=this["get"+h+"CursorOffset"](x,this._selectionDirection==="right");x.shiftKey?this.moveCursorWithShift(l):this.moveCursorWithoutShift(l),l!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(h){var x=this._selectionDirection==="left"?this.selectionStart+h:this.selectionEnd+h;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,x),h!==0},moveCursorWithoutShift:function(h){return h<0?(this.selectionStart+=h,this.selectionEnd=this.selectionStart):(this.selectionEnd+=h,this.selectionStart=this.selectionEnd),h!==0},moveCursorLeft:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",h)},_move:function(h,x,l){var f;if(h.altKey)f=this["findWordBoundary"+l](this[x]);else{if(!h.metaKey&&h.keyCode!==35&&h.keyCode!==36)return this[x]+=l==="Left"?-1:1,!0;f=this["findLineBoundary"+l](this[x])}if(typeof f!==void 0&&this[x]!==f)return this[x]=f,!0},_moveLeft:function(h,x){return this._move(h,x,"Left")},_moveRight:function(h,x){return this._move(h,x,"Right")},moveCursorLeftWithoutShift:function(h){var x=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(x=this._moveLeft(h,"selectionStart")),this.selectionEnd=this.selectionStart,x},moveCursorLeftWithShift:function(h){return this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd?this._moveLeft(h,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection="left",this._moveLeft(h,"selectionStart")):void 0},moveCursorRight:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",h)},_moveCursorLeftOrRight:function(h,x){var l="moveCursor"+h+"With";this._currentCursorOpacity=1,x.shiftKey?l+="Shift":l+="outShift",this[l](x)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(h){return this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd?this._moveRight(h,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(h,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(h){var x=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(x=this._moveRight(h,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,x},removeChars:function(h,x){x===void 0&&(x=h+1),this.removeStyleFromTo(h,x),this._text.splice(h,x-h),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(h,x,l,f){f===void 0&&(f=l),f>l&&this.removeStyleFromTo(l,f);var n=v.util.string.graphemeSplit(h);this.insertNewStyleBlock(n,l,x),this._text=[].concat(this._text.slice(0,l),n,this._text.slice(f)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var h=v.util.toFixed,x=/  +/g;v.util.object.extend(v.Text.prototype,{_toSVG:function(){var l=this._getSVGLeftTopOffsets(),f=this._getSVGTextAndBg(l.textTop,l.textLeft);return this._wrapSVGTextAndBg(f)},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(),{reviver:l,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(l){var f=this.getSvgTextDecoration(this);return[l.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",f?'text-decoration="'+f+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",l.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(l,f){var n,a=[],c=[],A=l;this._setSVGBg(c);for(var E=0,d=this._textLines.length;E<d;E++)n=this._getLineLeftOffset(E),(this.textBackgroundColor||this.styleHas("textBackgroundColor",E))&&this._setSVGTextLineBg(c,E,f+n,A),this._setSVGTextLineText(a,E,f+n,A),A+=this.getHeightOfLine(E);return{textSpans:a,textBgRects:c}},_createTextCharSpan:function(l,f,n,a){var c=l!==l.trim()||l.match(x),A=this.getSvgSpanStyles(f,c),E=A?'style="'+A+'"':"",d=f.deltaY,p="",C=v.Object.NUM_FRACTION_DIGITS;return d&&(p=' dy="'+h(d,C)+'" '),['<tspan x="',h(n,C),'" y="',h(a,C),'" ',p,E,">",v.util.string.escapeXml(l),"</tspan>"].join("")},_setSVGTextLineText:function(l,f,n,a){var c,A,E,d,p,C=this.getHeightOfLine(f),y=this.textAlign.indexOf("justify")!==-1,S="",w=0,b=this._textLines[f];a+=C*(1-this._fontSizeFraction)/this.lineHeight;for(var O=0,N=b.length-1;O<=N;O++)p=O===N||this.charSpacing,S+=b[O],E=this.__charBounds[f][O],w===0?(n+=E.kernedWidth-E.width,w+=E.width):w+=E.kernedWidth,y&&!p&&this._reSpaceAndTab.test(b[O])&&(p=!0),p||(c=c||this.getCompleteStyleDeclaration(f,O),A=this.getCompleteStyleDeclaration(f,O+1),p=this._hasStyleChangedForSvg(c,A)),p&&(d=this._getStyleDeclaration(f,O)||{},l.push(this._createTextCharSpan(S,d,n,a)),S="",c=A,n+=w,w=0)},_pushTextBgRect:function(l,f,n,a,c,A){var E=v.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(f),' x="',h(n,E),'" y="',h(a,E),'" width="',h(c,E),'" height="',h(A,E),`"></rect>
`)},_setSVGTextLineBg:function(l,f,n,a){for(var c,A,E=this._textLines[f],d=this.getHeightOfLine(f)/this.lineHeight,p=0,C=0,y=this.getValueOfPropertyAt(f,0,"textBackgroundColor"),S=0,w=E.length;S<w;S++)c=this.__charBounds[f][S],(A=this.getValueOfPropertyAt(f,S,"textBackgroundColor"))!==y?(y&&this._pushTextBgRect(l,y,n+C,a,p,d),C=c.left,p=c.width,y=A):p+=c.kernedWidth;A&&this._pushTextBgRect(l,A,n+C,a,p,d)},_getFillAttributes:function(l){var f=l&&typeof l=="string"?new v.Color(l):"";return f&&f.getSource()&&f.getAlpha()!==1?'opacity="'+f.getAlpha()+'" fill="'+f.setAlpha(1).toRgb()+'"':'fill="'+l+'"'},_getSVGLineTopOffset:function(l){for(var f,n=0,a=0;a<l;a++)n+=this.getHeightOfLine(a);return f=this.getHeightOfLine(a),{lineTop:n,offset:(this._fontSizeMult-this._fontSizeFraction)*f/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(l){return v.Object.prototype.getSvgStyles.call(this,l)+" white-space: pre;"}})}(),function(h){var x=h.fabric||(h.fabric={});x.Textbox=x.util.createClass(x.IText,x.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:x.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(l){for(var f=0,n=0,a=0,c={},A=0;A<l.graphemeLines.length;A++)l.graphemeText[a]===`
`&&A>0?(n=0,a++,f++):!this.splitByGrapheme&&this._reSpaceAndTab.test(l.graphemeText[a])&&A>0&&(n++,a++),c[A]={line:f,offset:n},a+=l.graphemeLines[A].length,n+=l.graphemeLines[A].length;return c},styleHas:function(l,f){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[f];n&&(f=n.line)}return x.Text.prototype.styleHas.call(this,l,f)},isEmptyStyles:function(l){if(!this.styles)return!0;var f,n,a=0,c=!1,A=this._styleMap[l],E=this._styleMap[l+1];for(var d in A&&(l=A.line,a=A.offset),E&&(c=E.line===l,f=E.offset),n=l===void 0?this.styles:{line:this.styles[l]})for(var p in n[d])if(p>=a&&(!c||p<f))for(var C in n[d][p])return!1;return!0},_getStyleDeclaration:function(l,f){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[l];if(!n)return null;l=n.line,f=n.offset+f}return this.callSuper("_getStyleDeclaration",l,f)},_setStyleDeclaration:function(l,f,n){var a=this._styleMap[l];l=a.line,f=a.offset+f,this.styles[l][f]=n},_deleteStyleDeclaration:function(l,f){var n=this._styleMap[l];l=n.line,f=n.offset+f,delete this.styles[l][f]},_getLineStyle:function(l){var f=this._styleMap[l];return!!this.styles[f.line]},_setLineStyle:function(l){var f=this._styleMap[l];this.styles[f.line]={}},_wrapText:function(l,f){var n,a=[];for(this.isWrapping=!0,n=0;n<l.length;n++)a=a.concat(this._wrapLine(l[n],n,f));return this.isWrapping=!1,a},_measureWord:function(l,f,n){var a,c=0;n=n||0;for(var A=0,E=l.length;A<E;A++)c+=this._getGraphemeBox(l[A],f,A+n,a,!0).kernedWidth,a=l[A];return c},_wrapLine:function(l,f,n,a){var c=0,A=this.splitByGrapheme,E=[],d=[],p=A?x.util.string.graphemeSplit(l):l.split(this._wordJoiners),C="",y=0,S=A?"":" ",w=0,b=0,O=0,N=!0,j=this._getWidthOfCharSpacing();a=a||0,p.length===0&&p.push([]),n-=a;for(var Z=0;Z<p.length;Z++)C=A?p[Z]:x.util.string.graphemeSplit(p[Z]),w=this._measureWord(C,f,y),y+=C.length,(c+=b+w-j)>n&&!N?(E.push(d),d=[],c=w,N=!0):c+=j,N||A||d.push(S),d=d.concat(C),b=A?0:this._measureWord([S],f,y),y++,N=!1,w>O&&(O=w);return Z&&E.push(d),O+a>this.dynamicMinWidth&&(this.dynamicMinWidth=O-j+a),E},isEndOfWrapping:function(l){return!this._styleMap[l+1]||this._styleMap[l+1].line!==this._styleMap[l].line},missingNewlineOffset:function(l){return this.splitByGrapheme?this.isEndOfWrapping(l)?1:0:1},_splitTextIntoLines:function(l){for(var f=x.Text.prototype._splitTextIntoLines.call(this,l),n=this._wrapText(f.lines,this.width),a=new Array(n.length),c=0;c<n.length;c++)a[c]=n[c].join("");return f.lines=a,f.graphemeLines=n,f},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var l={};for(var f in this._styleMap)this._textLines[f]&&(l[this._styleMap[f].line]=1);for(var f in this.styles)l[f]||delete this.styles[f]},toObject:function(l){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(l))}}),x.Textbox.fromObject=function(l,f){return x.Object._fromObject("Textbox",l,f,"text")}}(e),function(){var h=v.controlsUtils,x=h.scaleSkewCursorStyleHandler,l=h.scaleCursorStyleHandler,f=h.scalingEqually,n=h.scalingYOrSkewingX,a=h.scalingXOrSkewingY,c=h.scaleOrSkewActionName,A=v.Object.prototype.controls;if(A.ml=new v.Control({x:-.5,y:0,cursorStyleHandler:x,actionHandler:a,getActionName:c}),A.mr=new v.Control({x:.5,y:0,cursorStyleHandler:x,actionHandler:a,getActionName:c}),A.mb=new v.Control({x:0,y:.5,cursorStyleHandler:x,actionHandler:n,getActionName:c}),A.mt=new v.Control({x:0,y:-.5,cursorStyleHandler:x,actionHandler:n,getActionName:c}),A.tl=new v.Control({x:-.5,y:-.5,cursorStyleHandler:l,actionHandler:f}),A.tr=new v.Control({x:.5,y:-.5,cursorStyleHandler:l,actionHandler:f}),A.bl=new v.Control({x:-.5,y:.5,cursorStyleHandler:l,actionHandler:f}),A.br=new v.Control({x:.5,y:.5,cursorStyleHandler:l,actionHandler:f}),A.mtr=new v.Control({x:0,y:-.5,actionHandler:h.rotationWithSnapping,cursorStyleHandler:h.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),v.Textbox){var E=v.Textbox.prototype.controls={};E.mtr=A.mtr,E.tr=A.tr,E.br=A.br,E.tl=A.tl,E.bl=A.bl,E.mt=A.mt,E.mb=A.mb,E.mr=new v.Control({x:.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:x,actionName:"resizing"}),E.ml=new v.Control({x:-.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:x,actionName:"resizing"})}}()},192:()=>{},898:()=>{},245:()=>{}},$n={};function br(r){var e=$n[r];if(e!==void 0)return e.exports;var t=$n[r]={exports:{}};return Ga[r](t,t.exports,br),t.exports}br.d=(r,e)=>{for(var t in e)br.o(e,t)&&!br.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},br.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var C0={};(()=>{let r;br.d(C0,{R:()=>r}),r=typeof document!="undefined"&&typeof window!="undefined"?br(653).fabric:{version:"5.2.1"}})();var Gt=C0.R;const Tn=typeof self=="undefined";let Nr,Vt,Bi,un,xr;if(typeof navigator!="undefined"&&(Nr=navigator,Vt=Nr.userAgent,Bi=Nr.platform,un=Nr.mediaDevices),!Tn){const r={init:function(){this.browser=this.searchString(this.dataBrowser)||"unknownBrowser",this.version=this.searchVersion(Vt)||this.searchVersion(Nr.appVersion)||0,this.OS=this.searchString(this.dataOS)||"unknownOS",this.OS=="Linux"&&Vt.indexOf("Windows NT")!=-1&&(this.OS="HarmonyOS")},searchString:function(e){for(let t=0;t<e.length;t++){let i=e[t].string,o=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,i){if(i.indexOf(e[t].subString)!=-1)return e[t].identity}else if(o)return e[t].identity}},searchVersion:function(e){let t=e.indexOf(this.versionSearchString);if(t!=-1)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:Vt,subString:"Edge",identity:"Edge"},{string:Vt,subString:"OPR",identity:"OPR"},{string:Vt,subString:"Chrome",identity:"Chrome"},{string:Nr.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:Vt,subString:"Firefox",identity:"Firefox"},{string:Vt,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:Vt,subString:"HarmonyOS",identity:"HarmonyOS"},{string:Vt,subString:"Android",identity:"Android"},{string:Vt,subString:"iPhone",identity:"iPhone"},{string:Bi,subString:"Win",identity:"Windows"},{string:Bi,subString:"Mac",identity:"Mac"},{string:Bi,subString:"Linux",identity:"Linux"}]};r.init(),xr={browser:r.browser,version:r.version,OS:r.OS}}Tn&&(xr={browser:"ssr",version:0,OS:"ssr"});typeof WebAssembly!="undefined"&&Vt&&(/Safari/.test(Vt)&&!/Chrome/.test(Vt)&&/\(.+\s11_2_([2-6]).*\)/.test(Vt));!un||un.getUserMedia;xr.browser==="Chrome"&&xr.version>66||xr.browser==="Safari"&&xr.version>13||xr.browser==="OPR"&&xr.version>43||xr.browser==="Edge"&&xr.version;(()=>{if(!Tn&&document.currentScript){let r=document.currentScript.src,e=r.indexOf("?");if(e!=-1)r=r.substring(0,e);else{let t=r.indexOf("#");t!=-1&&(r=r.substring(0,t))}return r.substring(0,r.lastIndexOf("/")+1)}return"./"})();typeof document!="undefined"&&typeof window!="undefined"&&(Gt.StaticCanvas.prototype.dispose=function(){return this.isRendering&&(Gt.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(r){r.dispose&&r.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),Gt.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},Gt.Object.prototype.transparentCorners=!1,Gt.Object.prototype.cornerSize=20,Gt.Object.prototype.touchCornerSize=100,Gt.Object.prototype.cornerColor="rgb(254,142,20)",Gt.Object.prototype.cornerStyle="circle",Gt.Object.prototype.strokeUniform=!0,Gt.Object.prototype.hasBorders=!1,Gt.ActiveSelection.prototype.onDeselect=function(){return this.getObjects().forEach(r=>{setTimeout(r.onDeselect,0)}),this.destroy(),!1},Gt.Canvas.prototype.containerClass="",Gt.Canvas.prototype.getPointer=function(r,e){if(this._absolutePointer&&!e)return this._absolutePointer;if(this._pointer&&e)return this._pointer;var t,i=this.upperCanvasEl,o=Gt.util.getPointer(r,i),s=i.getBoundingClientRect(),u=s.width||0,g=s.height||0;u&&g||("top"in s&&"bottom"in s&&(g=Math.abs(s.top-s.bottom)),"right"in s&&"left"in s&&(u=Math.abs(s.right-s.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,e||(o=this.restorePointerVpt(o));var B=this.getRetinaScaling();if(B!==1&&(o.x/=B,o.y/=B),u!==0&&g!==0){var _=window.getComputedStyle(i).objectFit,m=i.width,D=i.height,F=u,T=g;t={width:m/F,height:D/T};var I,k,U=m/D,K=F/T;return _==="contain"?U>K?(I=F,k=F/U,{x:o.x*t.width,y:(o.y-(T-k)/2)*t.width}):(I=T*U,k=T,{x:(o.x-(F-I)/2)*t.height,y:o.y*t.height}):_==="cover"?U>K?{x:(m-t.height*F)/2+o.x*t.height,y:o.y*t.height}:{x:o.x*t.width,y:(D-t.width*T)/2+o.y*t.width}:{x:o.x*t.width,y:o.y*t.height}}return t={width:1,height:1},{x:o.x*t.width,y:o.y*t.height}});var eo,to,ro,io,no,oo,ao,so,xo,lo,ho,co,uo,fo,Eo,go,Ao,po,Bo,vo,_o,Co,mo,yo,Do,wo,Fo;(function(r){r[r.BICM_DARK_ON_LIGHT=1]="BICM_DARK_ON_LIGHT",r[r.BICM_LIGHT_ON_DARK=2]="BICM_LIGHT_ON_DARK",r[r.BICM_DARK_ON_DARK=4]="BICM_DARK_ON_DARK",r[r.BICM_LIGHT_ON_LIGHT=8]="BICM_LIGHT_ON_LIGHT",r[r.BICM_DARK_LIGHT_MIXED=16]="BICM_DARK_LIGHT_MIXED",r[r.BICM_DARK_ON_LIGHT_DARK_SURROUNDING=32]="BICM_DARK_ON_LIGHT_DARK_SURROUNDING",r[r.BICM_SKIP=0]="BICM_SKIP",r[r.BICM_REV=2147483648]="BICM_REV"})(eo||(eo={})),function(r){r[r.BCM_AUTO=1]="BCM_AUTO",r[r.BCM_GENERAL=2]="BCM_GENERAL",r[r.BCM_SKIP=0]="BCM_SKIP",r[r.BCM_REV=2147483648]="BCM_REV"}(to||(to={})),function(r){r[r.BF2_NULL=0]="BF2_NULL",r[r.BF2_POSTALCODE=32505856]="BF2_POSTALCODE",r[r.BF2_NONSTANDARD_BARCODE=1]="BF2_NONSTANDARD_BARCODE",r[r.BF2_USPSINTELLIGENTMAIL=1048576]="BF2_USPSINTELLIGENTMAIL",r[r.BF2_POSTNET=2097152]="BF2_POSTNET",r[r.BF2_PLANET=4194304]="BF2_PLANET",r[r.BF2_AUSTRALIANPOST=8388608]="BF2_AUSTRALIANPOST",r[r.BF2_RM4SCC=16777216]="BF2_RM4SCC",r[r.BF2_DOTCODE=2]="BF2_DOTCODE",r[r.BF2_PHARMACODE_ONE_TRACK=4]="BF2_PHARMACODE_ONE_TRACK",r[r.BF2_PHARMACODE_TWO_TRACK=8]="BF2_PHARMACODE_TWO_TRACK",r[r.BF2_PHARMACODE=12]="BF2_PHARMACODE"}(ro||(ro={})),function(r){r[r.BM_AUTO=1]="BM_AUTO",r[r.BM_LOCAL_BLOCK=2]="BM_LOCAL_BLOCK",r[r.BM_SKIP=0]="BM_SKIP",r[r.BM_THRESHOLD=4]="BM_THRESHOLD",r[r.BM_REV=2147483648]="BM_REV"}(io||(io={})),function(r){r[r.ECCM_CONTRAST=1]="ECCM_CONTRAST"}(no||(no={})),function(r){r[r.CFM_GENERAL=1]="CFM_GENERAL"}(oo||(oo={})),function(r){r[r.CCM_AUTO=1]="CCM_AUTO",r[r.CCM_GENERAL_HSV=2]="CCM_GENERAL_HSV",r[r.CCM_SKIP=0]="CCM_SKIP",r[r.CCM_REV=2147483648]="CCM_REV"}(ao||(ao={})),function(r){r[r.CICM_GENERAL=1]="CICM_GENERAL",r[r.CICM_SKIP=0]="CICM_SKIP",r[r.CICM_REV=2147483648]="CICM_REV"}(so||(so={})),function(r){r[r.CM_IGNORE=1]="CM_IGNORE",r[r.CM_OVERWRITE=2]="CM_OVERWRITE"}(xo||(xo={})),function(r){r[r.DM_SKIP=0]="DM_SKIP",r[r.DM_DIRECT_BINARIZATION=1]="DM_DIRECT_BINARIZATION",r[r.DM_THRESHOLD_BINARIZATION=2]="DM_THRESHOLD_BINARIZATION",r[r.DM_GRAY_EQUALIZATION=4]="DM_GRAY_EQUALIZATION",r[r.DM_SMOOTHING=8]="DM_SMOOTHING",r[r.DM_MORPHING=16]="DM_MORPHING",r[r.DM_DEEP_ANALYSIS=32]="DM_DEEP_ANALYSIS",r[r.DM_SHARPENING=64]="DM_SHARPENING",r[r.DM_BASED_ON_LOC_BIN=128]="DM_BASED_ON_LOC_BIN",r[r.DM_SHARPENING_SMOOTHING=256]="DM_SHARPENING_SMOOTHING"}(lo||(lo={})),function(r){r[r.DRM_AUTO=1]="DRM_AUTO",r[r.DRM_GENERAL=2]="DRM_GENERAL",r[r.DRM_BROAD_WARP=4]="DRM_BROAD_WARP",r[r.DRM_LOCAL_REFERENCE=8]="DRM_LOCAL_REFERENCE",r[r.DRM_DEWRINKLE=16]="DRM_DEWRINKLE",r[r.DRM_SKIP=0]="DRM_SKIP",r[r.DRM_REV=2147483648]="DRM_REV"}(ho||(ho={})),function(r){r[r.DPMCRM_AUTO=1]="DPMCRM_AUTO",r[r.DPMCRM_GENERAL=2]="DPMCRM_GENERAL",r[r.DPMCRM_SKIP=0]="DPMCRM_SKIP",r[r.DPMCRM_REV=2147483648]="DPMCRM_REV"}(co||(co={})),function(r){r[r.GTM_INVERTED=1]="GTM_INVERTED",r[r.GTM_ORIGINAL=2]="GTM_ORIGINAL",r[r.GTM_SKIP=0]="GTM_SKIP",r[r.GTM_REV=2147483648]="GTM_REV"}(uo||(uo={})),function(r){r[r.IPM_AUTO=1]="IPM_AUTO",r[r.IPM_GENERAL=2]="IPM_GENERAL",r[r.IPM_GRAY_EQUALIZE=4]="IPM_GRAY_EQUALIZE",r[r.IPM_GRAY_SMOOTH=8]="IPM_GRAY_SMOOTH",r[r.IPM_SHARPEN_SMOOTH=16]="IPM_SHARPEN_SMOOTH",r[r.IPM_MORPHOLOGY=32]="IPM_MORPHOLOGY",r[r.IPM_SKIP=0]="IPM_SKIP",r[r.IPM_REV=2147483648]="IPM_REV"}(fo||(fo={})),function(r){r[r.IRSM_MEMORY=1]="IRSM_MEMORY",r[r.IRSM_FILESYSTEM=2]="IRSM_FILESYSTEM",r[r.IRSM_BOTH=4]="IRSM_BOTH"}(Eo||(Eo={})),function(r){r[r.IRT_NO_RESULT=0]="IRT_NO_RESULT",r[r.IRT_ORIGINAL_IMAGE=1]="IRT_ORIGINAL_IMAGE",r[r.IRT_COLOUR_CLUSTERED_IMAGE=2]="IRT_COLOUR_CLUSTERED_IMAGE",r[r.IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE=4]="IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE",r[r.IRT_TRANSFORMED_GRAYSCALE_IMAGE=8]="IRT_TRANSFORMED_GRAYSCALE_IMAGE",r[r.IRT_PREDETECTED_REGION=16]="IRT_PREDETECTED_REGION",r[r.IRT_PREPROCESSED_IMAGE=32]="IRT_PREPROCESSED_IMAGE",r[r.IRT_BINARIZED_IMAGE=64]="IRT_BINARIZED_IMAGE",r[r.IRT_TEXT_ZONE=128]="IRT_TEXT_ZONE",r[r.IRT_CONTOUR=256]="IRT_CONTOUR",r[r.IRT_LINE_SEGMENT=512]="IRT_LINE_SEGMENT",r[r.IRT_FORM=1024]="IRT_FORM",r[r.IRT_SEGMENTATION_BLOCK=2048]="IRT_SEGMENTATION_BLOCK",r[r.IRT_TYPED_BARCODE_ZONE=4096]="IRT_TYPED_BARCODE_ZONE",r[r.IRT_PREDETECTED_QUADRILATERAL=8192]="IRT_PREDETECTED_QUADRILATERAL"}(go||(go={})),function(r){r[r.LM_SKIP=0]="LM_SKIP",r[r.LM_AUTO=1]="LM_AUTO",r[r.LM_CONNECTED_BLOCKS=2]="LM_CONNECTED_BLOCKS",r[r.LM_LINES=8]="LM_LINES",r[r.LM_STATISTICS=4]="LM_STATISTICS",r[r.LM_SCAN_DIRECTLY=16]="LM_SCAN_DIRECTLY",r[r.LM_STATISTICS_MARKS=32]="LM_STATISTICS_MARKS",r[r.LM_STATISTICS_POSTAL_CODE=64]="LM_STATISTICS_POSTAL_CODE",r[r.LM_CENTRE=128]="LM_CENTRE",r[r.LM_ONED_FAST_SCAN=256]="LM_ONED_FAST_SCAN",r[r.LM_REV=2147483648]="LM_REV"}(Ao||(Ao={})),function(r){r[r.PDFRM_RASTER=1]="PDFRM_RASTER",r[r.PDFRM_AUTO=2]="PDFRM_AUTO",r[r.PDFRM_VECTOR=4]="PDFRM_VECTOR",r[r.PDFRM_REV=2147483648]="PDFRM_REV"}(po||(po={})),function(r){r[r.QRECL_ERROR_CORRECTION_H=0]="QRECL_ERROR_CORRECTION_H",r[r.QRECL_ERROR_CORRECTION_L=1]="QRECL_ERROR_CORRECTION_L",r[r.QRECL_ERROR_CORRECTION_M=2]="QRECL_ERROR_CORRECTION_M",r[r.QRECL_ERROR_CORRECTION_Q=3]="QRECL_ERROR_CORRECTION_Q"}(Bo||(Bo={})),function(r){r[r.RPM_AUTO=1]="RPM_AUTO",r[r.RPM_GENERAL=2]="RPM_GENERAL",r[r.RPM_GENERAL_RGB_CONTRAST=4]="RPM_GENERAL_RGB_CONTRAST",r[r.RPM_GENERAL_GRAY_CONTRAST=8]="RPM_GENERAL_GRAY_CONTRAST",r[r.RPM_GENERAL_HSV_CONTRAST=16]="RPM_GENERAL_HSV_CONTRAST",r[r.RPM_SKIP=0]="RPM_SKIP",r[r.RPM_REV=2147483648]="RPM_REV"}(vo||(vo={})),function(r){r[r.RCT_PIXEL=1]="RCT_PIXEL",r[r.RCT_PERCENTAGE=2]="RCT_PERCENTAGE"}(_o||(_o={})),function(r){r[r.RT_STANDARD_TEXT=0]="RT_STANDARD_TEXT",r[r.RT_RAW_TEXT=1]="RT_RAW_TEXT",r[r.RT_CANDIDATE_TEXT=2]="RT_CANDIDATE_TEXT",r[r.RT_PARTIAL_TEXT=3]="RT_PARTIAL_TEXT"}(Co||(Co={})),function(r){r[r.SUM_AUTO=1]="SUM_AUTO",r[r.SUM_LINEAR_INTERPOLATION=2]="SUM_LINEAR_INTERPOLATION",r[r.SUM_NEAREST_NEIGHBOUR_INTERPOLATION=4]="SUM_NEAREST_NEIGHBOUR_INTERPOLATION",r[r.SUM_SKIP=0]="SUM_SKIP",r[r.SUM_REV=2147483648]="SUM_REV"}(mo||(mo={})),function(r){r[r.TP_REGION_PREDETECTED=1]="TP_REGION_PREDETECTED",r[r.TP_IMAGE_PREPROCESSED=2]="TP_IMAGE_PREPROCESSED",r[r.TP_IMAGE_BINARIZED=4]="TP_IMAGE_BINARIZED",r[r.TP_BARCODE_LOCALIZED=8]="TP_BARCODE_LOCALIZED",r[r.TP_BARCODE_TYPE_DETERMINED=16]="TP_BARCODE_TYPE_DETERMINED",r[r.TP_BARCODE_RECOGNIZED=32]="TP_BARCODE_RECOGNIZED"}(yo||(yo={})),function(r){r[r.TFM_AUTO=1]="TFM_AUTO",r[r.TFM_GENERAL_CONTOUR=2]="TFM_GENERAL_CONTOUR",r[r.TFM_SKIP=0]="TFM_SKIP",r[r.TFM_REV=2147483648]="TFM_REV"}(Do||(Do={})),function(r){r[r.TROM_CONFIDENCE=1]="TROM_CONFIDENCE",r[r.TROM_POSITION=2]="TROM_POSITION",r[r.TROM_FORMAT=4]="TROM_FORMAT",r[r.TROM_SKIP=0]="TROM_SKIP",r[r.TROM_REV=2147483648]="TROM_REV"}(wo||(wo={})),function(r){r[r.TDM_AUTO=1]="TDM_AUTO",r[r.TDM_GENERAL_WIDTH_CONCENTRATION=2]="TDM_GENERAL_WIDTH_CONCENTRATION",r[r.TDM_SKIP=0]="TDM_SKIP",r[r.TDM_REV=2147483648]="TDM_REV"}(Fo||(Fo={}));const On=r=>{let e=parseInt(r).toString(16);const t=e.length;if(t<4)for(let i=0;i<4-t;i++)e="0"+e;return e.toUpperCase()};var Zt={},wt={},ct=Zt,ai=String.fromCharCode,Wa=Array.prototype.slice,m0=Object.prototype.toString,y0=Object.prototype.hasOwnProperty,So=Array.isArray,bo=Object.keys;function Ha(r){var e=typeof r;return e==="function"||e==="object"&&!!r}wt.isObject=Ha;function In(r){return So?So(r):m0.call(r)==="[object Array]"}wt.isArray=In;function Xa(r){return typeof r=="string"||m0.call(r)==="[object String]"}wt.isString=Xa;function D0(r){if(bo)return bo(r);var e=[];for(var t in r)y0.call(r,t)&&(e[e.length]=t);return e}wt.objectKeys=D0;function w0(r,e){if(ct.HAS_TYPED)switch(r){case 8:return new Uint8Array(e);case 16:return new Uint16Array(e)}return new Array(e)}wt.createBuffer=w0;function Ya(r){for(var e=r.length,t=w0(16,e),i=0;i<e;i++)t[i]=r.charCodeAt(i);return t}wt.stringToBuffer=Ya;function F0(r){if(ct.CAN_CHARCODE_APPLY&&ct.CAN_CHARCODE_APPLY_TYPED){var e=r&&r.length;if(e<ct.APPLY_BUFFER_SIZE&&ct.APPLY_BUFFER_SIZE_OK)return ai.apply(null,r);if(ct.APPLY_BUFFER_SIZE_OK===null)try{var t=ai.apply(null,r);return e>ct.APPLY_BUFFER_SIZE&&(ct.APPLY_BUFFER_SIZE_OK=!0),t}catch{ct.APPLY_BUFFER_SIZE_OK=!1}}return S0(r)}wt.codeToString_fast=F0;function S0(r){for(var e="",t=r&&r.length,i=0,o;i<t;){if(r.subarray?o=r.subarray(i,i+ct.APPLY_BUFFER_SIZE):o=r.slice(i,i+ct.APPLY_BUFFER_SIZE),i+=ct.APPLY_BUFFER_SIZE,ct.APPLY_BUFFER_SIZE_OK){e+=ai.apply(null,o);continue}if(ct.APPLY_BUFFER_SIZE_OK===null)try{e+=ai.apply(null,o),o.length>ct.APPLY_BUFFER_SIZE&&(ct.APPLY_BUFFER_SIZE_OK=!0);continue}catch{ct.APPLY_BUFFER_SIZE_OK=!1}return b0(r)}return e}wt.codeToString_chunked=S0;function b0(r){for(var e="",t=r&&r.length,i=0;i<t;i++)e+=ai(r[i]);return e}wt.codeToString_slow=b0;function za(r){for(var e=[],t=r&&r.length,i=0;i<t;i++)e[i]=r.charCodeAt(i);return e}wt.stringToCode=za;function Ka(r){if(ct.HAS_TYPED)return new Uint16Array(r);if(In(r))return r;for(var e=r&&r.length,t=[],i=0;i<e;i++)t[i]=r[i];return t}wt.codeToBuffer=Ka;function Ja(r){return In(r)?r:Wa.call(r)}wt.bufferToCode=Ja;function qa(r){for(var e="",t=(""+r).toUpperCase().replace(/[^A-Z0-9]+/g,""),i=D0(ct.EncodingAliases),o=i.length,s=0,u,g,B,_=0;_<o;_++){if(u=i[_],u===t){e=u;break}for(g=u.length,B=s;B<g;B++)(u.slice(0,B)===t.slice(0,B)||u.slice(-B)===t.slice(-B))&&(e=u,s=B)}return y0.call(ct.EncodingAliases,e)?ct.EncodingAliases[e]:e}wt.canonicalizeEncodingName=qa;var cr=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],vi=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],tn="=".charCodeAt(0);function Za(r){var e,t,i,o,s,u;for(i=r&&r.length,t=0,e=[];t<i;){if(o=r[t++],t==i){e[e.length]=cr[o>>2],e[e.length]=cr[(o&3)<<4],e[e.length]=tn,e[e.length]=tn;break}if(s=r[t++],t==i){e[e.length]=cr[o>>2],e[e.length]=cr[(o&3)<<4|(s&240)>>4],e[e.length]=cr[(s&15)<<2],e[e.length]=tn;break}u=r[t++],e[e.length]=cr[o>>2],e[e.length]=cr[(o&3)<<4|(s&240)>>4],e[e.length]=cr[(s&15)<<2|(u&192)>>6],e[e.length]=cr[u&63]}return F0(e)}wt.base64encode=Za;function Qa(r){var e,t,i,o,s,u,g;for(u=r&&r.length,s=0,g=[];s<u;){do e=vi[r.charCodeAt(s++)&255];while(s<u&&e==-1);if(e==-1)break;do t=vi[r.charCodeAt(s++)&255];while(s<u&&t==-1);if(t==-1)break;g[g.length]=e<<2|(t&48)>>4;do{if(i=r.charCodeAt(s++)&255,i==61)return g;i=vi[i]}while(s<u&&i==-1);if(i==-1)break;g[g.length]=(t&15)<<4|(i&60)>>2;do{if(o=r.charCodeAt(s++)&255,o==61)return g;o=vi[o]}while(s<u&&o==-1);if(o==-1)break;g[g.length]=(i&3)<<6|o}return g}wt.base64decode=Qa;var Xr={},$a={15711649:33,15711650:34,15711651:35,15711652:36,15711653:37,15711654:38,15711655:39,15711656:40,15711657:41,15711658:42,15711659:43,15711660:44,15711661:45,15711662:46,15711663:47,15711664:48,15711665:49,15711666:50,15711667:51,15711668:52,15711669:53,15711670:54,15711671:55,15711672:56,15711673:57,15711674:58,15711675:59,15711676:60,15711677:61,15711678:62,15711679:63,15711872:64,15711873:65,15711874:66,15711875:67,15711876:68,15711877:69,15711878:70,15711879:71,15711880:72,15711881:73,15711882:74,15711883:75,15711884:76,15711885:77,15711886:78,15711887:79,15711888:80,15711889:81,15711890:82,15711891:83,15711892:84,15711893:85,15711894:86,15711895:87,15711896:88,15711897:89,15711898:90,15711899:91,15711900:92,15711901:93,15711902:94,15711903:95,14848416:11553,14848417:11554,14848418:11555,14848419:11556,14848420:11557,14848421:11558,14848422:11559,14848423:11560,14848424:11561,14848425:11562,14848426:11563,14848427:11564,14848428:11565,14848429:11566,14848430:11567,14848431:11568,14848432:11569,14848433:11570,14848434:11571,14848435:11572,14845344:11573,14845345:11574,14845346:11575,14845347:11576,14845348:11577,14845349:11578,14845350:11579,14845351:11580,14845352:11581,14845353:11582,14912905:11584,14912660:11585,14912674:11586,14912909:11587,14912664:11588,14912679:11589,14912643:11590,14912694:11591,14912913:11592,14912919:11593,14912653:11594,14912678:11595,14912675:11596,14912683:11597,14912906:11598,14912699:11599,14913180:11600,14913181:11601,14913182:11602,14913166:11603,14913167:11604,14913412:11605,14913185:11606,14912955:11615,14909597:11616,14909599:11617,14845078:11618,14913421:11619,14845089:11620,14912164:11621,14912165:11622,14912166:11623,14912167:11624,14912168:11625,14911665:11626,14911666:11627,14911673:11628,14912958:11629,14912957:11630,14912956:11631,14846126:11635,14846097:11636,14846111:11640,14846655:11641,14909568:8481,14909569:8482,14909570:8483,15711372:8484,15711374:8485,14910395:8486,15711386:8487,15711387:8488,15711391:8489,15711361:8490,14910107:8491,14910108:8492,49844:8493,15711616:8494,49832:8495,15711422:8496,15712163:8497,15711423:8498,14910397:8499,14910398:8500,14910109:8501,14910110:8502,14909571:8503,14990237:8504,14909573:8505,14909574:8506,14909575:8507,14910396:8508,14844053:8509,14844048:8510,15711375:8511,15711420:8512,15711646:8513,14844054:8514,15711644:8515,14844070:8516,14844069:8517,14844056:8518,14844057:8519,14844060:8520,14844061:8521,15711368:8522,15711369:8523,14909588:8524,14909589:8525,15711419:8526,15711421:8527,15711643:8528,15711645:8529,14909576:8530,14909577:8531,14909578:8532,14909579:8533,14909580:8534,14909581:8535,14909582:8536,14909583:8537,14909584:8538,14909585:8539,15711371:8540,15711373:8541,49841:8542,50071:8543,50103:8544,15711389:8545,14846368:8546,15711388:8547,15711390:8548,14846374:8549,14846375:8550,14846110:8551,14846132:8552,14850434:8553,14850432:8554,49840:8555,14844082:8556,14844083:8557,14845059:8558,15712165:8559,15711364:8560,15712160:8561,15712161:8562,15711365:8563,15711363:8564,15711366:8565,15711370:8566,15711392:8567,49831:8568,14850182:8569,14850181:8570,14849931:8571,14849935:8572,14849934:8573,14849927:8574,14849926:8737,14849697:8738,14849696:8739,14849715:8740,14849714:8741,14849725:8742,14849724:8743,14844091:8744,14909586:8745,14845586:8746,14845584:8747,14845585:8748,14845587:8749,14909587:8750,14846088:8762,14846091:8763,14846598:8764,14846599:8765,14846594:8766,14846595:8767,14846122:8768,14846121:8769,14846119:8778,14846120:8779,49836:8780,14845842:8781,14845844:8782,14846080:8783,14846083:8784,14846112:8796,14846629:8797,14847122:8798,14846082:8799,14846087:8800,14846369:8801,14846354:8802,14846378:8803,14846379:8804,14846106:8805,14846141:8806,14846109:8807,14846133:8808,14846123:8809,14846124:8810,14845099:8818,14844080:8819,14850479:8820,14850477:8821,14850474:8822,14844064:8823,14844065:8824,49846:8825,14849967:8830,15711376:9008,15711377:9009,15711378:9010,15711379:9011,15711380:9012,15711381:9013,15711382:9014,15711383:9015,15711384:9016,15711385:9017,15711393:9025,15711394:9026,15711395:9027,15711396:9028,15711397:9029,15711398:9030,15711399:9031,15711400:9032,15711401:9033,15711402:9034,15711403:9035,15711404:9036,15711405:9037,15711406:9038,15711407:9039,15711408:9040,15711409:9041,15711410:9042,15711411:9043,15711412:9044,15711413:9045,15711414:9046,15711415:9047,15711416:9048,15711417:9049,15711418:9050,15711617:9057,15711618:9058,15711619:9059,15711620:9060,15711621:9061,15711622:9062,15711623:9063,15711624:9064,15711625:9065,15711626:9066,15711627:9067,15711628:9068,15711629:9069,15711630:9070,15711631:9071,15711632:9072,15711633:9073,15711634:9074,15711635:9075,15711636:9076,15711637:9077,15711638:9078,15711639:9079,15711640:9080,15711641:9081,15711642:9082,14909825:9249,14909826:9250,14909827:9251,14909828:9252,14909829:9253,14909830:9254,14909831:9255,14909832:9256,14909833:9257,14909834:9258,14909835:9259,14909836:9260,14909837:9261,14909838:9262,14909839:9263,14909840:9264,14909841:9265,14909842:9266,14909843:9267,14909844:9268,14909845:9269,14909846:9270,14909847:9271,14909848:9272,14909849:9273,14909850:9274,14909851:9275,14909852:9276,14909853:9277,14909854:9278,14909855:9279,14909856:9280,14909857:9281,14909858:9282,14909859:9283,14909860:9284,14909861:9285,14909862:9286,14909863:9287,14909864:9288,14909865:9289,14909866:9290,14909867:9291,14909868:9292,14909869:9293,14909870:9294,14909871:9295,14909872:9296,14909873:9297,14909874:9298,14909875:9299,14909876:9300,14909877:9301,14909878:9302,14909879:9303,14909880:9304,14909881:9305,14909882:9306,14909883:9307,14909884:9308,14909885:9309,14909886:9310,14909887:9311,14910080:9312,14910081:9313,14910082:9314,14910083:9315,14910084:9316,14910085:9317,14910086:9318,14910087:9319,14910088:9320,14910089:9321,14910090:9322,14910091:9323,14910092:9324,14910093:9325,14910094:9326,14910095:9327,14910096:9328,14910097:9329,14910098:9330,14910099:9331,14910113:9505,14910114:9506,14910115:9507,14910116:9508,14910117:9509,14910118:9510,14910119:9511,14910120:9512,14910121:9513,14910122:9514,14910123:9515,14910124:9516,14910125:9517,14910126:9518,14910127:9519,14910128:9520,14910129:9521,14910130:9522,14910131:9523,14910132:9524,14910133:9525,14910134:9526,14910135:9527,14910136:9528,14910137:9529,14910138:9530,14910139:9531,14910140:9532,14910141:9533,14910142:9534,14910143:9535,14910336:9536,14910337:9537,14910338:9538,14910339:9539,14910340:9540,14910341:9541,14910342:9542,14910343:9543,14910344:9544,14910345:9545,14910346:9546,14910347:9547,14910348:9548,14910349:9549,14910350:9550,14910351:9551,14910352:9552,14910353:9553,14910354:9554,14910355:9555,14910356:9556,14910357:9557,14910358:9558,14910359:9559,14910360:9560,14910361:9561,14910362:9562,14910363:9563,14910364:9564,14910365:9565,14910366:9566,14910367:9567,14910368:9568,14910369:9569,14910370:9570,14910371:9571,14910372:9572,14910373:9573,14910374:9574,14910375:9575,14910376:9576,14910377:9577,14910378:9578,14910379:9579,14910380:9580,14910381:9581,14910382:9582,14910383:9583,14910384:9584,14910385:9585,14910386:9586,14910387:9587,14910388:9588,14910389:9589,14910390:9590,52881:9761,52882:9762,52883:9763,52884:9764,52885:9765,52886:9766,52887:9767,52888:9768,52889:9769,52890:9770,52891:9771,52892:9772,52893:9773,52894:9774,52895:9775,52896:9776,52897:9777,52899:9778,52900:9779,52901:9780,52902:9781,52903:9782,52904:9783,52905:9784,52913:9793,52914:9794,52915:9795,52916:9796,52917:9797,52918:9798,52919:9799,52920:9800,52921:9801,52922:9802,52923:9803,52924:9804,52925:9805,52926:9806,52927:9807,53120:9808,53121:9809,53123:9810,53124:9811,53125:9812,53126:9813,53127:9814,53128:9815,53129:9816,53392:10017,53393:10018,53394:10019,53395:10020,53396:10021,53397:10022,53377:10023,53398:10024,53399:10025,53400:10026,53401:10027,53402:10028,53403:10029,53404:10030,53405:10031,53406:10032,53407:10033,53408:10034,53409:10035,53410:10036,53411:10037,53412:10038,53413:10039,53414:10040,53415:10041,53416:10042,53417:10043,53418:10044,53419:10045,53420:10046,53421:10047,53422:10048,53423:10049,53424:10065,53425:10066,53426:10067,53427:10068,53428:10069,53429:10070,53649:10071,53430:10072,53431:10073,53432:10074,53433:10075,53434:10076,53435:10077,53436:10078,53437:10079,53438:10080,53439:10081,53632:10082,53633:10083,53634:10084,53635:10085,53636:10086,53637:10087,53638:10088,53639:10089,53640:10090,53641:10091,53642:10092,53643:10093,53644:10094,53645:10095,53646:10096,53647:10097,14849152:10273,14849154:10274,14849164:10275,14849168:10276,14849176:10277,14849172:10278,14849180:10279,14849196:10280,14849188:10281,14849204:10282,14849212:10283,14849153:10284,14849155:10285,14849167:10286,14849171:10287,14849179:10288,14849175:10289,14849187:10290,14849203:10291,14849195:10292,14849211:10293,14849419:10294,14849184:10295,14849199:10296,14849192:10297,14849207:10298,14849215:10299,14849181:10300,14849200:10301,14849189:10302,14849208:10303,14849410:10304,14989980:12321,15045782:12322,15050883:12323,15308991:12324,15045504:12325,15107227:12326,15109288:12327,15050678:12328,15302818:12329,15241653:12330,15240348:12331,15182224:12332,15106730:12333,15110049:12334,15120549:12335,15112109:12336,15241638:12337,15239846:12338,15314869:12339,15114899:12340,15047847:12341,15111841:12342,15108529:12343,15052443:12344,15050640:12345,15243707:12346,15311796:12347,15185314:12348,15185598:12349,15314574:12350,15108246:12351,15184543:12352,15246007:12353,15052425:12354,15055541:12355,15109257:12356,15112855:12357,15114632:12358,15308679:12359,15310477:12360,15113615:12361,14990245:12362,14990474:12363,14990733:12364,14991005:12365,15040905:12366,15047602:12367,15049911:12368,15050644:12369,15050881:12370,15052937:12371,15106975:12372,15107215:12373,15107504:12374,15112339:12375,15115397:12376,15172282:12377,15177103:12378,15177136:12379,15181755:12380,15185581:12381,15185839:12382,15238019:12383,15241358:12384,15245731:12385,15248514:12386,15303061:12387,15303098:12388,15043771:12389,14989973:12390,14989989:12391,15048607:12392,15237810:12393,15303553:12394,15180719:12395,14989440:12396,15049649:12397,15121058:12398,15302840:12399,15182002:12400,15240360:12401,15239819:12402,15315119:12403,15041921:12404,15044016:12405,15045309:12406,15045537:12407,15047584:12408,15050683:12409,15056021:12410,15311794:12411,15120299:12412,15238052:12413,15242413:12414,15309218:12577,15309232:12578,15309472:12579,15310779:12580,15044747:12581,15044531:12582,15052423:12583,15172495:12584,15187645:12585,15253378:12586,15309736:12587,15044015:12588,15316380:12589,15182522:12590,14989457:12591,15180435:12592,15239100:12593,15120550:12594,15046808:12595,15045764:12596,15117469:12597,15242394:12598,15315131:12599,15050661:12600,15044265:12601,15119782:12602,15176604:12603,15308431:12604,15047042:12605,14989969:12606,15303051:12607,15309746:12608,15240591:12609,15312012:12610,15044513:12611,15046326:12612,15051952:12613,15056305:12614,15112352:12615,15113139:12616,15114372:12617,15118520:12618,15119283:12619,15119529:12620,15176091:12621,15178632:12622,15182222:12623,15311028:12624,15240113:12625,15245723:12626,15247776:12627,15305645:12628,15120050:12629,15177387:12630,15178634:12631,15312773:12632,15106726:12633,15248513:12634,15251082:12635,15308466:12636,15115918:12637,15044269:12638,15042182:12639,15047826:12640,15048880:12641,15050116:12642,15052468:12643,15055798:12644,15106216:12645,15109801:12646,15110068:12647,15119039:12648,15121556:12649,15172238:12650,15172756:12651,15173017:12652,15173525:12653,15174847:12654,15186049:12655,15239606:12656,15240081:12657,15242903:12658,15303072:12659,15305115:12660,15316123:12661,15049129:12662,15111868:12663,15118746:12664,15176869:12665,15042489:12666,15049902:12667,15050149:12668,15056512:12669,15056796:12670,15108796:12833,15112122:12834,15116458:12835,15117479:12836,15118004:12837,15175307:12838,15187841:12839,15246742:12840,15316140:12841,15316110:12842,15317892:12843,15053473:12844,15118998:12845,15240635:12846,15041668:12847,15053195:12848,15107766:12849,15239046:12850,15114678:12851,15174049:12852,14989721:12853,14991290:12854,15044024:12855,15106473:12856,15120553:12857,15182223:12858,15310771:12859,14989451:12860,15043734:12861,14990254:12862,14990741:12863,14990525:12864,14991009:12865,14990771:12866,15043232:12867,15044527:12868,15046793:12869,15049871:12870,15051649:12871,15052470:12872,15052705:12873,15181713:12874,15112839:12875,15113884:12876,15113910:12877,15117708:12878,15119027:12879,15172011:12880,15175554:12881,15181453:12882,15181502:12883,15182012:12884,15183495:12885,15239857:12886,15240091:12887,15240324:12888,15240631:12889,15241135:12890,15241107:12891,15244710:12892,15248050:12893,15046825:12894,15250088:12895,15253414:12896,15303054:12897,15309982:12898,15243914:12899,14991236:12900,15053736:12901,15108241:12902,15174041:12903,15176891:12904,15239077:12905,15239869:12906,15244222:12907,15250304:12908,15309701:12909,15312019:12910,15312789:12911,14990219:12912,14990490:12913,15247267:12914,15047582:12915,15049098:12916,15049610:12917,15055803:12918,15056811:12919,15106218:12920,15106708:12921,15106466:12922,15107984:12923,15108242:12924,15109008:12925,15111353:12926,15314305:13089,15112614:13090,15114928:13091,15119799:13092,15172016:13093,15177100:13094,15178374:13095,15185333:13096,15239845:13097,15245241:13098,15308427:13099,15309454:13100,15250077:13101,15042481:13102,15043262:13103,15049878:13104,15045299:13105,15052467:13106,15053974:13107,15107496:13108,15115906:13109,15120047:13110,15180429:13111,15242123:13112,15245719:13113,15247794:13114,15306407:13115,15313592:13116,15119788:13117,15312552:13118,15244185:13119,15048355:13120,15114175:13121,15244174:13122,15304846:13123,15043203:13124,15047303:13125,15044740:13126,15055763:13127,15109025:13128,15110841:13129,15114428:13130,15114424:13131,15118011:13132,15175090:13133,15180474:13134,15182251:13135,15247002:13136,15247250:13137,15250859:13138,15252611:13139,15303597:13140,15308451:13141,15309460:13142,15310249:13143,15052198:13144,15053491:13145,15115709:13146,15311245:13147,15311246:13148,15109787:13149,15183008:13150,15116459:13151,15116735:13152,15114934:13153,15315085:13154,15121823:13155,15042994:13156,15046301:13157,15106480:13158,15109036:13159,15119547:13160,15120519:13161,15121297:13162,15241627:13163,15246480:13164,15252868:13165,14989460:13166,15315129:13167,15044534:13168,15115419:13169,15116474:13170,15310468:13171,15114410:13172,15041948:13173,15182723:13174,15241906:13175,15304604:13176,15306380:13177,15047067:13178,15316136:13179,15114402:13180,15240325:13181,15241393:13182,15184549:13345,15042696:13346,15240069:13347,15176614:13348,14989758:13349,14990979:13350,15042208:13351,15052690:13352,15042698:13353,15043480:13354,15043495:13355,15054779:13356,15046298:13357,15048874:13358,15050662:13359,15052428:13360,15052440:13361,15052699:13362,15055282:13363,15055289:13364,15106723:13365,15107231:13366,15107491:13367,15107774:13368,15110043:13369,15111586:13370,15114129:13371,15114643:13372,15115194:13373,15117502:13374,15117715:13375,15118743:13376,15121570:13377,15122071:13378,15121797:13379,15176368:13380,15176856:13381,15178659:13382,15178891:13383,15182783:13384,15183521:13385,15184033:13386,15185833:13387,15187126:13388,15187888:13389,15237789:13390,15239590:13391,15240862:13392,15247027:13393,15248268:13394,15250091:13395,15303300:13396,15307153:13397,15308435:13398,15308433:13399,15308450:13400,15309221:13401,15310739:13402,15312040:13403,15239320:13404,14989496:13405,15044779:13406,15053496:13407,15054732:13408,15175337:13409,15178124:13410,15178940:13411,15053481:13412,15187883:13413,15250571:13414,15309697:13415,15310993:13416,15311252:13417,15311256:13418,14990465:13419,14990478:13420,15044017:13421,15046300:13422,15047080:13423,15048634:13424,15050119:13425,15051913:13426,15052676:13427,15053456:13428,15054988:13429,15055294:13430,15056780:13431,15110062:13432,15113402:13433,15112087:13434,15112098:13435,15113375:13436,15115147:13437,15115140:13438,15116703:13601,15055024:13602,15118213:13603,15118487:13604,15118781:13605,15177151:13606,15181192:13607,15052195:13608,15181952:13609,15185024:13610,15056573:13611,15246991:13612,15247512:13613,15250100:13614,15250871:13615,15252364:13616,15252637:13617,15311778:13618,15313038:13619,15314108:13620,14989952:13621,15040957:13622,15041664:13623,15050387:13624,15052444:13625,15108271:13626,15108736:13627,15111084:13628,15117498:13629,15174304:13630,15177361:13631,15181191:13632,15187625:13633,15245243:13634,15248060:13635,15248816:13636,15109804:13637,15241098:13638,15310496:13639,15044745:13640,15044739:13641,15046315:13642,15114644:13643,15116696:13644,15247792:13645,15179943:13646,15113653:13647,15317901:13648,15044020:13649,15052450:13650,15238298:13651,15243664:13652,15302790:13653,14989464:13654,14989701:13655,14990215:13656,14990481:13657,15044490:13658,15044792:13659,15052462:13660,15056019:13661,15106213:13662,15111569:13663,15113405:13664,15118722:13665,15118770:13666,15119267:13667,15172024:13668,15175811:13669,15182262:13670,15182510:13671,15182984:13672,15185050:13673,15184830:13674,15185318:13675,15112103:13676,15174043:13677,15044283:13678,15053189:13679,15054760:13680,15109010:13681,15109024:13682,15109273:13683,15120544:13684,15243674:13685,15247537:13686,15251357:13687,15305656:13688,15121537:13689,15181478:13690,15314330:13691,14989992:13692,14989995:13693,14989996:13694,14991003:13857,14991008:13858,15041425:13859,15041927:13860,15182774:13861,15041969:13862,15042486:13863,15043988:13864,15043745:13865,15044031:13866,15044523:13867,15046316:13868,15049347:13869,15053729:13870,15056055:13871,15056266:13872,15106223:13873,15106448:13874,15106477:13875,15109279:13876,15111577:13877,15116683:13878,15119233:13879,15174530:13880,15174573:13881,15179695:13882,15238072:13883,15238277:13884,15239304:13885,15242638:13886,15303607:13887,15306657:13888,15310783:13889,15312279:13890,15313306:13891,14990256:13892,15042461:13893,15052973:13894,15112833:13895,15115693:13896,15053184:13897,15113138:13898,15115701:13899,15175305:13900,15114640:13901,15184513:13902,15041413:13903,15043492:13904,15048071:13905,15054782:13906,15305894:13907,15111844:13908,15117475:13909,15117501:13910,15175860:13911,15181441:13912,15181501:13913,15183243:13914,15185802:13915,15239865:13916,15241100:13917,15245759:13918,15246751:13919,15248569:13920,15253393:13921,15304593:13922,15044767:13923,15305344:13924,14989725:13925,15040694:13926,15044517:13927,15043770:13928,15174551:13929,15175318:13930,15179689:13931,15240102:13932,15252143:13933,15312774:13934,15312776:13935,15312786:13936,15041975:13937,15107226:13938,15243678:13939,15046320:13940,15182266:13941,15040950:13942,15052691:13943,15303047:13944,15309445:13945,14989490:13946,15117211:13947,15304615:13948,15053201:13949,15053192:13950,15109784:14113,15182495:14114,15118995:14115,15310260:14116,15252897:14117,15182506:14118,15173258:14119,15309448:14120,15184514:14121,15114391:14122,15186352:14123,15114641:14124,15306156:14125,15043506:14126,15044763:14127,15242923:14128,15247507:14129,15187620:14130,15252365:14131,15303585:14132,15044006:14133,15245960:14134,15181185:14135,14991234:14136,15041214:14137,15042705:14138,15041924:14139,15046035:14140,15047853:14141,15175594:14142,15048331:14143,15050129:14144,15056290:14145,15056516:14146,15106485:14147,15107510:14148,15107495:14149,15107753:14150,15109810:14151,15110330:14152,15111596:14153,15112623:14154,15114626:14155,15120531:14156,15177126:14157,15182013:14158,15184827:14159,15185292:14160,15185561:14161,15186315:14162,15187371:14163,15240334:14164,15240586:14165,15244173:14166,15247496:14167,15247779:14168,15248806:14169,15252413:14170,15311002:14171,15316623:14172,15239864:14173,15253390:14174,15314856:14175,15043207:14176,15108255:14177,15110787:14178,15122304:14179,15309465:14180,15114625:14181,15041169:14182,15117472:14183,15118778:14184,15121812:14185,15182260:14186,15185296:14187,15245696:14188,15247523:14189,15113352:14190,14990262:14191,15040697:14192,15040678:14193,15040933:14194,15041980:14195,15042744:14196,15042979:14197,15046311:14198,15047823:14199,15048837:14200,15051660:14201,15055802:14202,15107762:14203,15108024:14204,15109043:14205,15109554:14206,15115420:14369,15116457:14370,15174077:14371,15174316:14372,15174830:14373,15179924:14374,15180207:14375,15185337:14376,15178892:14377,15237801:14378,15246987:14379,15248537:14380,15250338:14381,15252370:14382,15303075:14383,15306165:14384,15309242:14385,15311253:14386,15313043:14387,15317432:14388,15041923:14389,15044255:14390,15044275:14391,15055291:14392,15056038:14393,15120539:14394,15121040:14395,15175300:14396,15175614:14397,15185283:14398,15239351:14399,15247488:14400,15248314:14401,15309200:14402,14989710:14403,15040651:14404,15044516:14405,15045052:14406,15047610:14407,15050641:14408,15052196:14409,15054769:14410,15055531:14411,15056039:14412,15108280:14413,15111557:14414,15113903:14415,15120790:14416,15174544:14417,15184778:14418,15246004:14419,15237793:14420,15238049:14421,15241136:14422,15243662:14423,15248007:14424,15251368:14425,15304887:14426,15309703:14427,15311271:14428,15318163:14429,14989972:14430,14989970:14431,14990477:14432,15043976:14433,15045001:14434,15044798:14435,15050927:14436,15056524:14437,15056545:14438,15106719:14439,15114919:14440,15116942:14441,15176090:14442,15180417:14443,15248030:14444,15248036:14445,15248823:14446,15304336:14447,14989726:14448,15314825:14449,14989988:14450,14990780:14451,14991023:14452,15040665:14453,15040662:14454,15041929:14455,15041964:14456,15043231:14457,15043257:14458,15043518:14459,15044250:14460,15044515:14461,15044753:14462,15044750:14625,15046281:14626,15048081:14627,15048354:14628,15050173:14629,15052180:14630,15052189:14631,15052431:14632,15054757:14633,15054759:14634,15054775:14635,15055288:14636,15055491:14637,15055514:14638,15055543:14639,15056024:14640,15106450:14641,15107468:14642,15108759:14643,15109016:14644,15109799:14645,15111355:14646,15112322:14647,15112579:14648,15113140:14649,15113645:14650,15114401:14651,15114903:14652,15116171:14653,15118751:14654,15119530:14655,15119785:14656,15120559:14657,15121053:14658,15176882:14659,15178375:14660,15180204:14661,15182015:14662,15184800:14663,15185029:14664,15185048:14665,15185310:14666,15185585:14667,15237269:14668,15237251:14669,15237807:14670,15237809:14671,15238548:14672,15238799:14673,15239338:14674,15240594:14675,15245708:14676,15245729:14677,15248539:14678,15250082:14679,15250364:14680,15303562:14681,15304117:14682,15305137:14683,15179967:14684,15305660:14685,15308452:14686,15309197:14687,15310981:14688,15312537:14689,15313816:14690,15316155:14691,15042971:14692,15043243:14693,15044535:14694,15044744:14695,15049621:14696,15109047:14697,15122336:14698,15249834:14699,15252895:14700,15317689:14701,15041931:14702,15042747:14703,15045002:14704,15047613:14705,15182208:14706,15304119:14707,15316384:14708,15317906:14709,15175044:14710,15121545:14711,15238576:14712,15176849:14713,15056829:14714,15106970:14715,15313576:14716,15174555:14717,15253180:14718,15117732:14881,15310979:14882,14990218:14883,15047600:14884,15048100:14885,15049406:14886,15051162:14887,15106472:14888,15107975:14889,15112335:14890,15112326:14891,15114425:14892,15114929:14893,15120311:14894,15177621:14895,15185082:14896,15239598:14897,15314306:14898,14989979:14899,14990736:14900,15044489:14901,15045766:14902,15054255:14903,15054758:14904,15054766:14905,15114171:14906,15119001:14907,15176115:14908,15179906:14909,15247760:14910,15306390:14911,15246239:14912,15048080:14913,15055527:14914,15109291:14915,15041205:14916,15041196:14917,15042189:14918,15113344:14919,15045513:14920,15049118:14921,15050427:14922,15052464:14923,15056297:14924,15108493:14925,15109793:14926,15114429:14927,15117747:14928,15120520:14929,15172029:14930,15304583:14931,15174272:14932,15179925:14933,15179942:14934,15181229:14935,15111822:14936,15185072:14937,15241116:14938,15246209:14939,15252617:14940,15309467:14941,15042980:14942,15047848:14943,15113616:14944,15187370:14945,15250081:14946,15042228:14947,15048066:14948,15308970:14949,15048890:14950,15115914:14951,15237812:14952,15045298:14953,15053966:14954,15048636:14955,15180437:14956,15316922:14957,14990748:14958,15042954:14959,15045259:14960,15110334:14961,15112360:14962,15113364:14963,15114165:14964,15182468:14965,15183254:14966,15185058:14967,15305903:14968,15114652:14969,15314605:14970,15183033:14971,15043737:14972,15042186:14973,15042743:14974,15052703:15137,15109046:15138,15110830:15139,15111078:15140,15113389:15141,15118010:15142,15242921:15143,15309713:15144,15178384:15145,15314838:15146,15109516:15147,15305862:15148,15314603:15149,15178431:15150,15112594:15151,14989449:15152,15041176:15153,15044482:15154,15053233:15155,15106984:15156,15110802:15157,15111587:15158,15114655:15159,15173542:15160,15175562:15161,15176867:15162,15183511:15163,15186562:15164,15243925:15165,15249027:15166,15250331:15167,15304120:15168,15312016:15169,15111852:15170,15112875:15171,15117963:15172,14990229:15173,14990228:15174,14990522:15175,14990783:15176,15042746:15177,15044536:15178,15044530:15179,15046563:15180,15047579:15181,15049643:15182,15050635:15183,15050633:15184,15050687:15185,15052176:15186,15053197:15187,15054978:15188,15055019:15189,15056791:15190,15106205:15191,15109255:15192,15111343:15193,15052188:15194,15111855:15195,15111869:15196,15112104:15197,15113885:15198,15117730:15199,15117755:15200,15118479:15201,15175045:15202,15181193:15203,15181697:15204,15184824:15205,15185049:15206,15185067:15207,15237794:15208,15238274:15209,15239091:15210,15246998:15211,15247774:15212,15247785:15213,15247782:15214,15248012:15215,15248302:15216,15250311:15217,15250332:15218,15309708:15219,15311804:15220,15117743:15221,14989963:15222,14990524:15223,14990989:15224,15041936:15225,15052183:15226,15052730:15227,15107464:15228,15109249:15229,15112578:15230,15117473:15393,15121291:15394,15119035:15395,15173822:15396,15176381:15397,15177620:15398,15180673:15399,15180986:15400,15237260:15401,15237299:15402,15239082:15403,15241876:15404,15253150:15405,15118736:15406,15317439:15407,15056015:15408,15248792:15409,15316139:15410,15182778:15411,15252408:15412,15052429:15413,15309739:15414,14989443:15415,15044529:15416,15048631:15417,15049905:15418,15051657:15419,15052452:15420,15106697:15421,15120831:15422,15121542:15423,15177406:15424,15250346:15425,15052447:15426,15242368:15427,15183776:15428,15040946:15429,15114164:15430,15239837:15431,15053217:15432,15242634:15433,15186078:15434,15239310:15435,15042201:15436,15052932:15437,15109544:15438,15250854:15439,15111836:15440,15173038:15441,15180990:15442,15185047:15443,15237253:15444,15248541:15445,15252362:15446,15303086:15447,15244167:15448,15303338:15449,15040671:15450,15043514:15451,15052986:15452,15113619:15453,15172028:15454,15173813:15455,15304076:15456,15304584:15457,15305899:15458,15240101:15459,15052674:15460,15056049:15461,15107001:15462,14989499:15463,15044502:15464,15052424:15465,15108491:15466,15113393:15467,15117962:15468,15174569:15469,15175584:15470,15181998:15471,15238571:15472,15251107:15473,15304082:15474,15312534:15475,15041682:15476,15044503:15477,15045034:15478,15052735:15479,15109768:15480,15116473:15481,15185580:15482,15309952:15483,15047578:15484,15044494:15485,15045032:15486,15052439:15649,15052977:15650,15054750:15651,14991278:15652,15107201:15653,15109054:15654,15119538:15655,15181696:15656,15181707:15657,15185282:15658,15186317:15659,15187858:15660,15239085:15661,15239327:15662,15241872:15663,15245702:15664,15246770:15665,15249040:15666,15251892:15667,15252655:15668,15302833:15669,15304075:15670,15304108:15671,15309702:15672,15304348:15673,14990208:15674,14990735:15675,15041925:15676,15043969:15677,15056531:15678,15108238:15679,15114132:15680,15118721:15681,15120523:15682,15175075:15683,15186086:15684,15304589:15685,15305347:15686,15044500:15687,15049881:15688,15052479:15689,15120273:15690,15181213:15691,15186094:15692,15184539:15693,15049150:15694,15173279:15695,15042490:15696,15245715:15697,15253424:15698,14991242:15699,15053755:15700,15112357:15701,15179436:15702,15182755:15703,15239324:15704,15312831:15705,15042438:15706,15056554:15707,15112108:15708,15115695:15709,15117961:15710,15120307:15711,15121046:15712,15121828:15713,15178686:15714,15185044:15715,15054753:15716,15303093:15717,15304327:15718,15310982:15719,15042470:15720,15042717:15721,15108480:15722,15112849:15723,15113113:15724,15120538:15725,15055542:15726,15185810:15727,15187378:15728,15113144:15729,15242927:15730,15243191:15731,15248312:15732,15043241:15733,15044505:15734,15050163:15735,15055503:15736,15056528:15737,15106453:15738,15305636:15739,15309220:15740,15041207:15741,15041695:15742,15043485:15905,15043744:15906,15043975:15907,15044524:15908,15045544:15909,15046022:15910,15045809:15911,15046807:15912,15050152:15913,15050430:15914,15050940:15915,15052469:15916,15052934:15917,15052943:15918,15052945:15919,15052954:15920,15055492:15921,15055498:15922,15055776:15923,15056304:15924,15108543:15925,15108740:15926,15109019:15927,15109772:15928,15109559:15929,15112327:15930,15112332:15931,15112365:15932,15112630:15933,15113662:15934,15114914:15935,15116447:15936,15116469:15937,15119036:15938,15120008:15939,15120521:15940,15120792:15941,15172796:15942,15172774:15943,15173031:15944,15177607:15945,15178881:15946,15180189:15947,15180929:15948,15181221:15949,15181744:15950,15182752:15951,15182993:15952,15184551:15953,15185081:15954,15237782:15955,15241110:15956,15241867:15957,15242633:15958,15245725:15959,15246259:15960,15247519:15961,15247548:15962,15247764:15963,15247795:15964,15249825:15965,15250334:15966,15304356:15967,15305126:15968,15306174:15969,15306904:15970,15309468:15971,15310488:15972,14989450:15973,14989448:15974,14989470:15975,14989719:15976,15042199:15977,15042992:15978,15048590:15979,15048884:15980,15049612:15981,15051938:15982,15055032:15983,15106949:15984,15111102:15985,15113633:15986,15113622:15987,15119748:15988,15174326:15989,15177139:15990,15182243:15991,15241912:15992,15248818:15993,15304376:15994,15305888:15995,15046833:15996,15048628:15997,15311806:15998,15109037:16161,15115405:16162,15117974:16163,15173549:16164,15186324:16165,15237559:16166,15239602:16167,15247270:16168,15311775:16169,15244693:16170,15253169:16171,15052987:16172,14990520:16173,14991265:16174,14991029:16175,15045767:16176,15050912:16177,15052701:16178,15052713:16179,15056771:16180,15107470:16181,15109295:16182,15111856:16183,15112587:16184,15115182:16185,15115931:16186,15119800:16187,15120305:16188,15176883:16189,15177401:16190,15178911:16191,15181214:16192,15181734:16193,15185075:16194,15239075:16195,15239855:16196,15242922:16197,15247018:16198,15247546:16199,15252139:16200,15253147:16201,15302834:16202,15304605:16203,15309959:16204,14990010:16205,14990209:16206,15042691:16207,15049141:16208,15049644:16209,15052939:16210,15176858:16211,15052989:16212,15238542:16213,15247498:16214,15253381:16215,15309219:16216,15310253:16217,15183013:16218,15248271:16219,15310984:16220,15304098:16221,15047603:16222,15044264:16223,15302807:16224,15044793:16225,15048322:16226,15055013:16227,15109800:16228,15118516:16229,15172234:16230,15179169:16231,15184523:16232,15187872:16233,15245744:16234,15303042:16235,15304084:16236,15305872:16237,15305880:16238,15309455:16239,15176094:16240,15313796:16241,15053959:16242,15054249:16243,15111600:16244,15113890:16245,15251112:16246,15309723:16247,15109550:16248,15113609:16249,15115417:16250,15241093:16251,15310999:16252,15309696:16253,15246270:16254,15122052:16417,15110586:16418,15052728:16419,14989462:16420,15171756:16421,15177117:16422,15112367:16423,15042436:16424,15042742:16425,15043490:16426,15050643:16427,15056513:16428,15106215:16429,15108240:16430,15111359:16431,15111604:16432,15112351:16433,15112628:16434,15115186:16435,15114390:16436,15117731:16437,15120517:16438,15174066:16439,15176863:16440,15178651:16441,15184574:16442,15237526:16443,15049648:16444,15246269:16445,15246783:16446,15248032:16447,15248019:16448,15248267:16449,15302813:16450,15304338:16451,15310226:16452,15310233:16453,15111817:16454,15181966:16455,15238278:16456,15309499:16457,15055021:16458,15106972:16459,15108250:16460,15111845:16461,15112340:16462,15113872:16463,15179699:16464,15182221:16465,15184269:16466,15186110:16467,15238282:16468,15250092:16469,15250852:16470,15251361:16471,15251871:16472,15180457:16473,15042695:16474,15109017:16475,15109797:16476,15110530:16477,15108760:16478,15247533:16479,15182467:16480,15183744:16481,15248044:16482,15309738:16483,15185334:16484,15239308:16485,15244681:16486,14990233:16487,15041928:16488,15043971:16489,15044e3:16490,15052451:16491,15052930:16492,15052950:16493,15054749:16494,15108262:16495,15108487:16496,15110832:16497,15114387:16498,15114420:16499,15119241:16500,15119749:16501,15119511:16502,15114131:16503,15121820:16504,15173006:16505,15173053:16506,15112075:16507,15182271:16508,15183533:16509,15185818:16510,15186314:16673,15187624:16674,15238586:16675,15239323:16676,15239353:16677,15242918:16678,15247790:16679,15250318:16680,15251381:16681,15303096:16682,15303095:16683,15305389:16684,15305361:16685,15308419:16686,15314606:16687,15042957:16688,15046276:16689,15121592:16690,15172790:16691,15041960:16692,15181445:16693,15186325:16694,15238835:16695,15184782:16696,15047052:16697,15049105:16698,15053480:16699,15109802:16700,15113150:16701,15113149:16702,15115674:16703,15174553:16704,15177359:16705,15177358:16706,15180942:16707,15181206:16708,15181727:16709,15184535:16710,15185056:16711,15185284:16712,15243399:16713,15247540:16714,15308987:16715,15303073:16716,15318176:16717,15041447:16718,15042997:16719,15044492:16720,15044514:16721,15040649:16722,15046314:16723,15049646:16724,15050127:16725,15173821:16726,15052427:16727,15053220:16728,15043741:16729,15106979:16730,15106995:16731,15109532:16732,15109763:16733,15109311:16734,15109819:16735,15111053:16736,15112105:16737,15113145:16738,15054755:16739,15116173:16740,15116221:16741,15121557:16742,15173541:16743,14989961:16744,15177641:16745,15178680:16746,15182483:16747,15184799:16748,15185807:16749,15185564:16750,15237537:16751,15240585:16752,15240600:16753,15241644:16754,15241916:16755,15243195:16756,15246213:16757,15250864:16758,15302785:16759,15303085:16760,15306391:16761,15309980:16762,15313042:16763,15041423:16764,15049367:16765,15107726:16766,15239059:16929,15242421:16930,15250568:16931,15302816:16932,14991235:16933,15040948:16934,15042951:16935,15044019:16936,15106479:16937,15109513:16938,15113631:16939,15120556:16940,15251123:16941,15302815:16942,14991255:16943,15053214:16944,15250314:16945,15112079:16946,15185562:16947,15043986:16948,15245974:16949,15041974:16950,15110019:16951,15052184:16952,15052203:16953,15052938:16954,15110285:16955,15113617:16956,15303068:16957,14990230:16958,15049882:16959,15049898:16960,15118768:16961,15247761:16962,15045822:16963,15048853:16964,15050405:16965,15106992:16966,15108499:16967,15114113:16968,15239349:16969,15115669:16970,15309184:16971,15312772:16972,15313064:16973,14990739:16974,15048838:16975,15052734:16976,15237264:16977,15053489:16978,15055023:16979,15056517:16980,15106208:16981,15107467:16982,15108276:16983,15113151:16984,15119280:16985,15121310:16986,15238030:16987,15238591:16988,15240084:16989,15245963:16990,15250104:16991,15302784:16992,15302830:16993,15309450:16994,15317915:16995,15314843:16996,14990243:16997,15044528:16998,15049895:16999,15183020:17e3,15304333:17001,15311244:17002,15316921:17003,15121309:17004,15171751:17005,15043987:17006,15046020:17007,15052421:17008,15108504:17009,15108766:17010,15109011:17011,15119010:17012,15122351:17013,15175842:17014,15247511:17015,15306936:17016,15122305:17017,15248318:17018,15240376:17019,15042471:17020,15244216:17021,15044522:17022,15044521:17185,14990726:17186,15303060:17187,15253168:17188,15050154:17189,15238321:17190,15054781:17191,15182762:17192,15253183:17193,15115162:17194,15249591:17195,15174584:17196,15315336:17197,15116477:17198,15248048:17199,14989497:17200,15043992:17201,15046790:17202,15048102:17203,15108997:17204,15109794:17205,15112102:17206,15117710:17207,15120289:17208,15120795:17209,15172269:17210,15179693:17211,15182767:17212,15183530:17213,15185595:17214,15237309:17215,15238022:17216,15244171:17217,15248021:17218,15306139:17219,15047587:17220,15049607:17221,15056062:17222,15111853:17223,15112854:17224,15116928:17225,15118005:17226,15176887:17227,15248263:17228,15040676:17229,15179685:17230,15047856:17231,15056027:17232,15106469:17233,15112634:17234,15118752:17235,15177652:17236,15181978:17237,15187374:17238,15239092:17239,15244440:17240,15303045:17241,15312563:17242,15183753:17243,15177116:17244,15182777:17245,15183249:17246,15242116:17247,15302800:17248,15181737:17249,15182482:17250,15240374:17251,15051681:17252,15179136:17253,14989485:17254,14990258:17255,15052441:17256,15056800:17257,15108797:17258,15112380:17259,15114161:17260,15119272:17261,15243691:17262,15245751:17263,15247547:17264,15304078:17265,15305651:17266,15312784:17267,15116439:17268,15171750:17269,15174826:17270,15240103:17271,15241623:17272,15250095:17273,14989441:17274,15041926:17275,15042443:17276,15046283:17277,15052725:17278,15054998:17441,15055027:17442,15055489:17443,15056020:17444,15056053:17445,15056299:17446,15056564:17447,15108018:17448,15109265:17449,15112866:17450,15113373:17451,15121838:17452,15174034:17453,15176890:17454,15178938:17455,15237556:17456,15238329:17457,15238584:17458,15244726:17459,15248063:17460,15248284:17461,15251077:17462,15251379:17463,15305370:17464,15308215:17465,15310978:17466,15315877:17467,15043461:17468,15109527:17469,15178676:17470,15113365:17471,15118984:17472,15175565:17473,15250307:17474,15306414:17475,15309235:17476,15119525:17477,15049372:17478,15115406:17479,15116172:17480,15253437:17481,15306394:17482,15177627:17483,15302810:17484,15049114:17485,15114370:17486,15109812:17487,15116219:17488,14990723:17489,15121580:17490,15114136:17491,15253179:17492,15242406:17493,15185588:17494,15306132:17495,15115455:17496,15121840:17497,15048106:17498,15049655:17499,15051948:17500,15185068:17501,15173802:17502,15044746:17503,15304611:17504,15316660:17505,14989997:17506,14990734:17507,15040924:17508,15040949:17509,15042947:17510,15250078:17511,15045e3:17512,15048868:17513,15052442:17514,15055005:17515,15055509:17516,15055533:17517,15055799:17518,15056031:17519,15106700:17520,15108789:17521,15109306:17522,15110032:17523,15114927:17524,15118720:17525,15180423:17526,15181454:17527,15181963:17528,15185824:17529,15239559:17530,15247490:17531,15248294:17532,15251844:17533,15302803:17534,15303352:17697,15303853:17698,15304600:17699,15318158:17700,15119269:17701,15110552:17702,15111074:17703,15111605:17704,15121332:17705,15178372:17706,15183003:17707,15303081:17708,15306641:17709,15121082:17710,15045554:17711,15056569:17712,15110820:17713,15252877:17714,15253421:17715,15305092:17716,15041976:17717,15049131:17718,15049897:17719,15053205:17720,15055511:17721,15120315:17722,15186575:17723,15176860:17724,15250108:17725,15252386:17726,15311259:17727,15172281:17728,14990493:17729,15118015:17730,15122097:17731,15176880:17732,15309755:17733,15041934:17734,15044752:17735,15048885:17736,15049111:17737,15050412:17738,15053216:17739,15056530:17740,15111831:17741,15113628:17742,15120545:17743,15178171:17744,15241119:17745,15250349:17746,15302804:17747,15303613:17748,15306125:17749,15179941:17750,15179962:17751,15043242:17752,15055526:17753,15047839:17754,15050164:17755,15106194:17756,15040658:17757,15041946:17758,15042220:17759,15042445:17760,15042688:17761,15045776:17762,15049108:17763,15049112:17764,15050135:17765,15052437:17766,15053750:17767,15054475:17768,15106748:17769,15108757:17770,15110317:17771,15113649:17772,15114627:17773,15114940:17774,15115167:17775,15178647:17776,15120280:17777,15120815:17778,15120027:17779,15172015:17780,15173512:17781,15056275:17782,15177624:17783,15181239:17784,15183241:17785,15183252:17786,15183250:17787,15184790:17788,15185329:17789,15042736:17790,15241635:17953,15242665:17954,15243172:17955,15247502:17956,15248516:17957,15249798:17958,15251599:17959,15302787:17960,15302799:17961,15306905:17962,15309238:17963,15311021:17964,15313072:17965,15308696:17966,15041421:17967,15043477:17968,15044748:17969,15048834:17970,15052942:17971,15107751:17972,15110814:17973,15119518:17974,15179443:17975,15182757:17976,15238068:17977,15241348:17978,15303059:17979,15305349:17980,15053728:17981,15316103:17982,15043775:17983,15056535:17984,15056563:17985,15120028:17986,15174073:17987,15179171:17988,15181503:17989,15183780:17990,15118226:17991,15174572:17992,15248045:17993,15114371:17994,15116705:17995,15042488:17996,15182465:17997,15115444:17998,15053194:17999,15315894:18e3,15240107:18001,15052677:18002,15304073:18003,15171742:18004,15047096:18005,15053231:18006,15106951:18007,15111590:18008,15118988:18009,15249818:18010,15303041:18011,15310995:18012,15045009:18013,15113095:18014,15304845:18015,15050120:18016,15303331:18017,15042181:18018,14989709:18019,15042474:18020,15242905:18021,15248526:18022,15171992:18023,15109562:18024,15306123:18025,15115682:18026,15312564:18027,15186052:18028,15177143:18029,15043991:18030,15115680:18031,15252383:18032,15309731:18033,15118749:18034,14989964:18035,15052988:18036,15056016:18037,15253417:18038,15043714:18039,15250321:18040,15237769:18041,15243705:18042,15055807:18043,15112101:18044,14989747:18045,15041957:18046,15050370:18209,15052991:18210,15310766:18211,14990267:18212,15050378:18213,15056781:18214,15248013:18215,15122337:18216,15181488:18217,15181218:18218,15052711:18219,15241649:18220,15174827:18221,15173297:18222,15055284:18223,15056821:18224,15109563:18225,15110810:18226,15173507:18227,15184536:18228,14989699:18229,15055804:18230,14989707:18231,15048604:18232,15047330:18233,15106729:18234,15122307:18235,15185037:18236,15238077:18237,15238323:18238,15238847:18239,15253170:18240,15246999:18241,15243940:18242,15054772:18243,15108746:18244,15110829:18245,15246983:18246,15113655:18247,15119266:18248,15119550:18249,15175862:18250,15179956:18251,15051142:18252,15187381:18253,15239853:18254,15312556:18255,14991283:18256,15055747:18257,15109021:18258,15109778:18259,15111575:18260,15113647:18261,15178627:18262,15174028:18263,15238028:18264,15237818:18265,15252649:18266,15304077:18267,15040653:18268,15048633:18269,15051410:18270,15114885:18271,15115699:18272,15173028:18273,15174589:18274,15250103:18275,15049650:18276,15250336:18277,15309226:18278,15302809:18279,15244735:18280,15181732:18281,15179687:18282,15241385:18283,14990511:18284,15042981:18285,15043994:18286,15109005:18287,15114127:18288,15119242:18289,15178173:18290,15183508:18291,15184533:18292,15239350:18293,15242884:18294,15253419:18295,15113117:18296,15121568:18297,15173766:18298,15186075:18299,15240875:18300,15312769:18301,15317670:18302,15042493:18465,15183537:18466,15180210:18467,15183544:18468,15237767:18469,15183240:18470,15117224:18471,15055265:18472,15237772:18473,15177105:18474,15177120:18475,15041963:18476,15305122:18477,15121036:18478,15178170:18479,15304343:18480,15313834:18481,14990480:18482,15187376:18483,15108764:18484,15183247:18485,15308453:18486,15315881:18487,15047098:18488,15049113:18489,15244196:18490,15309500:18491,14990516:18492,15042724:18493,15043978:18494,15044493:18495,15044507:18496,15054982:18497,15110316:18498,15111825:18499,15113663:18500,15118526:18501,15118734:18502,15174024:18503,15174319:18504,15175597:18505,15177108:18506,15186305:18507,15239340:18508,15243177:18509,15250089:18510,15183748:18511,15304582:18512,15173033:18513,15310994:18514,15311791:18515,15109309:18516,15112617:18517,15177130:18518,15178660:18519,15180688:18520,15242627:18521,15244206:18522,15043754:18523,15043985:18524,15044774:18525,15050371:18526,15055495:18527,15056316:18528,15106738:18529,15108489:18530,15108537:18531,15108779:18532,15111824:18533,15118228:18534,15119244:18535,15177394:18536,15178414:18537,15180433:18538,15181720:18539,15185803:18540,15187383:18541,15237797:18542,15245995:18543,15248057:18544,15250107:18545,15303103:18546,15310238:18547,15311771:18548,15116427:18549,15184056:18550,15041177:18551,15052990:18552,15056558:18553,15113863:18554,15118232:18555,15175861:18556,15178889:18557,15187598:18558,15318203:18721,15114122:18722,15181975:18723,15043769:18724,15177355:18725,15313837:18726,15056294:18727,15238813:18728,15241137:18729,15237784:18730,15056060:18731,15056773:18732,15177122:18733,15183238:18734,15302844:18735,15114663:18736,15050667:18737,15051419:18738,15185040:18739,15178174:18740,15248556:18741,14991285:18742,15056298:18743,15116441:18744,15118519:18745,15121538:18746,15176610:18747,15181224:18748,15245736:18749,15247765:18750,15249849:18751,15055775:18752,15110031:18753,15177605:18754,15181714:18755,15240087:18756,15305896:18757,15305650:18758,15241884:18759,15244205:18760,15315117:18761,15045505:18762,15056300:18763,15111820:18764,15119772:18765,15171733:18766,15250087:18767,15250323:18768,15311035:18769,15111567:18770,15176630:18771,14989453:18772,14990232:18773,15048608:18774,15049899:18775,15051174:18776,15052684:18777,15042216:18778,15054979:18779,15055516:18780,15106198:18781,15108534:18782,15111607:18783,15111847:18784,15112622:18785,15119790:18786,15173814:18787,15183014:18788,15238544:18789,15238810:18790,15239833:18791,15248796:18792,15250080:18793,15250342:18794,15250868:18795,15308956:18796,15309188:18797,14991022:18798,15110827:18799,15117734:18800,15239326:18801,15241633:18802,15242666:18803,15303592:18804,15052929:18805,15115667:18806,15311528:18807,15241658:18808,15242647:18809,14990479:18810,15042991:18811,15056553:18812,15055237:18813,15113357:18814,15181455:18977,15238585:18978,15246471:18979,15246982:18980,15120309:18981,15056023:18982,15108501:18983,15119032:18984,14990223:18985,15174057:18986,15314578:18987,15042694:18988,15044795:18989,15047092:18990,15049395:18991,15107748:18992,15108526:18993,15172762:18994,15050158:18995,15184521:18996,15184798:18997,15185051:18998,15309744:18999,15111815:19e3,15237534:19001,14989465:19002,14990773:19003,15041973:19004,15049088:19005,15055267:19006,15055283:19007,15056010:19008,15114116:19009,14989478:19010,15242429:19011,15308425:19012,15309211:19013,15184307:19014,15310977:19015,15041467:19016,15049601:19017,15178134:19018,15180455:19019,15042725:19020,15179429:19021,15242385:19022,15183494:19023,15040911:19024,15049865:19025,15174023:19026,15183751:19027,15185832:19028,15253178:19029,15253396:19030,15303053:19031,14991039:19032,15043465:19033,15050921:19034,15056001:19035,15310509:19036,14991261:19037,15239319:19038,15305642:19039,15047811:19040,15109525:19041,15117737:19042,15176875:19043,15246236:19044,15252628:19045,15182210:19046,15043487:19047,15049363:19048,15107477:19049,15108234:19050,15112878:19051,15118221:19052,15184063:19053,15241129:19054,15040675:19055,14991288:19056,15043717:19057,15044998:19058,15048881:19059,15050121:19060,15052445:19061,15053744:19062,15053743:19063,15053993:19064,15055510:19065,15108785:19066,15109543:19067,15111358:19068,15111865:19069,15113355:19070,15119253:19233,15119265:19234,15172537:19235,15179954:19236,15186091:19237,15238046:19238,15239859:19239,15241356:19240,15242156:19241,15244418:19242,15246482:19243,15247530:19244,15249802:19245,15303334:19246,15305618:19247,15311805:19248,15315891:19249,15316396:19250,14989711:19251,14989985:19252,15041165:19253,15042966:19254,15048074:19255,15050408:19256,15055037:19257,15056792:19258,15056793:19259,15108287:19260,15112884:19261,15113371:19262,15114128:19263,15115154:19264,15042194:19265,15185057:19266,15237802:19267,15238824:19268,15248512:19269,15250060:19270,15250111:19271,15305150:19272,15308978:19273,15044768:19274,15311020:19275,15043735:19276,15041429:19277,15043996:19278,15049384:19279,15110834:19280,15113396:19281,15174055:19282,15179174:19283,15182214:19284,15304614:19285,15043459:19286,15119009:19287,15117958:19288,15048832:19289,15055244:19290,15050132:19291,15113388:19292,15187899:19293,15042465:19294,15178630:19295,15110569:19296,15180712:19297,15314324:19298,15317691:19299,15048587:19300,15050425:19301,15112359:19302,15113882:19303,15118222:19304,15045545:19305,15116185:19306,15055253:19307,15238812:19308,15113877:19309,15314602:19310,15114174:19311,15315346:19312,15114653:19313,14989990:19314,14991267:19315,15044488:19316,15108793:19317,15113387:19318,15119019:19319,15253380:19320,14991021:19321,15186349:19322,15317695:19323,14989447:19324,15107490:19325,15121024:19326,15121579:19489,15242387:19490,15045043:19491,15113386:19492,15314309:19493,15054771:19494,15183509:19495,15053484:19496,15052678:19497,15244444:19498,15120778:19499,15242129:19500,15181972:19501,15238280:19502,15050393:19503,15184525:19504,15118481:19505,15178912:19506,15043481:19507,15049890:19508,15172769:19509,15174047:19510,15179675:19511,15309991:19512,15316385:19513,15115403:19514,15051199:19515,15050904:19516,15042213:19517,15044749:19518,15045053:19519,15112334:19520,15178655:19521,15253431:19522,15305368:19523,15315892:19524,15050666:19525,15174045:19526,15121285:19527,15041933:19528,15115145:19529,15185599:19530,15185836:19531,15310242:19532,15317690:19533,15110584:19534,15116449:19535,15240322:19536,15050372:19537,15052191:19538,15118235:19539,15174811:19540,15178674:19541,15185586:19542,15237271:19543,15241881:19544,15041714:19545,15113384:19546,15317913:19547,15178670:19548,15113634:19549,15043519:19550,15312005:19551,15052964:19552,15108283:19553,15184318:19554,15250096:19555,15046031:19556,15106742:19557,15185035:19558,15308416:19559,15043713:19560,14989727:19561,15042230:19562,15049884:19563,15173818:19564,15237302:19565,15304590:19566,15056037:19567,15179682:19568,15044228:19569,15056313:19570,15185028:19571,15242924:19572,15247539:19573,15252109:19574,15310230:19575,15114163:19576,15242926:19577,15307155:19578,15107209:19579,15107208:19580,15119033:19581,15178130:19582,15248301:19745,15252664:19746,15045807:19747,14990737:19748,15041706:19749,15043463:19750,15044491:19751,15052453:19752,15055293:19753,15106720:19754,15107714:19755,15110038:19756,15113353:19757,15114138:19758,15120807:19759,15120012:19760,15174838:19761,15174839:19762,15176881:19763,15181200:19764,15246229:19765,15248024:19766,15303050:19767,15303313:19768,15303605:19769,15309700:19770,15244941:19771,15049877:19772,14989960:19773,14990745:19774,14989454:19775,15248009:19776,15252671:19777,15310992:19778,15041197:19779,15055292:19780,15050390:19781,15052473:19782,15055544:19783,15110042:19784,15110074:19785,15111041:19786,15113116:19787,15115658:19788,15116184:19789,15119499:19790,15121078:19791,15173268:19792,15176872:19793,15182511:19794,15187594:19795,15237248:19796,15241609:19797,15242121:19798,15246977:19799,15248545:19800,15251594:19801,15303077:19802,15309245:19803,15312010:19804,15107518:19805,15108753:19806,15117490:19807,15118979:19808,15119796:19809,15187852:19810,15187900:19811,15120256:19812,15187589:19813,15244986:19814,15246264:19815,15113637:19816,15240881:19817,15311036:19818,15309751:19819,15119515:19820,15185313:19821,15241405:19822,15304106:19823,14989745:19824,15044021:19825,15054224:19826,15117444:19827,15122347:19828,15243149:19829,15243437:19830,15247015:19831,15042729:19832,15044751:19833,15053221:19834,15113614:19835,15114920:19836,15175814:19837,15176323:19838,15177634:20001,15246223:20002,15246241:20003,15304588:20004,15309730:20005,15309240:20006,15056523:20007,15175303:20008,15182731:20009,15241614:20010,15109792:20011,15177125:20012,15043209:20013,15119745:20014,15121052:20015,15175817:20016,15177113:20017,15180203:20018,15184530:20019,15309446:20020,15182748:20021,15318669:20022,14991030:20023,15107502:20024,15112069:20025,15243676:20026,14989958:20027,14989998:20028,15041434:20029,14989473:20030,15042444:20031,15052718:20032,15111833:20033,15114881:20034,15120060:20035,15174815:20036,15178114:20037,15179437:20038,15181980:20039,15184807:20040,15239599:20041,15248274:20042,15303100:20043,15304591:20044,15309237:20045,15311e3:20046,15043227:20047,15185809:20048,15040683:20049,15044248:20050,15113879:20051,15120267:20052,15173520:20053,15175859:20054,15239080:20055,15252650:20056,15309475:20057,15315351:20058,15317663:20059,15176096:20060,15049089:20061,15120025:20062,15185071:20063,15311262:20064,14990244:20065,14990518:20066,14990987:20067,15042231:20068,15043249:20069,15054522:20070,15106204:20071,15175346:20072,15180988:20073,15240083:20074,15304884:20075,15309495:20076,15309750:20077,15309962:20078,15317655:20079,15318434:20080,15112870:20081,15117748:20082,15042711:20083,15043235:20084,15172488:20085,15246210:20086,15055753:20087,15106443:20088,15107728:20089,15121571:20090,15173001:20091,15184062:20092,15185844:20093,15237551:20094,15242158:20257,15302819:20258,15305900:20259,15044994:20260,15314351:20261,15117203:20262,15172233:20263,15250306:20264,15251375:20265,15310002:20266,15043252:20267,15051137:20268,15055754:20269,15056004:20270,15113367:20271,15115708:20272,15115924:20273,15119786:20274,15121551:20275,15174050:20276,15174588:20277,15183789:20278,15237249:20279,15237566:20280,15244683:20281,15303566:20282,15041965:20283,15317651:20284,15181444:20285,15237771:20286,15305906:20287,15248278:20288,15040685:20289,15045260:20290,15247793:20291,15117738:20292,15250308:20293,15238279:20294,15106961:20295,15113888:20296,15316914:20297,14989977:20298,14989976:20299,15315088:20300,15247787:20301,15243137:20302,15242664:20303,15115392:20304,15120830:20305,15180439:20306,15238549:20307,15056012:20513,14989456:20514,14989461:20515,14989482:20516,14989489:20517,14989494:20518,14989500:20519,14989503:20520,14989698:20521,14989718:20522,14989720:20523,14989954:20524,14989957:20525,15249835:20526,14989962:20527,15239314:20528,15056013:20529,14989966:20530,14989982:20531,14989983:20532,14989984:20533,14989986:20534,1499e4:20535,14990003:20536,14990006:20537,14990222:20538,14990221:20539,14990212:20540,14990214:20541,14990210:20542,14990231:20543,14990238:20544,14990253:20545,14990239:20546,14990263:20547,14990473:20548,14990746:20549,14990512:20550,14990747:20551,14990749:20552,14990743:20553,14990727:20554,14990774:20555,14990984:20556,14990991:20557,14991e3:20558,14990779:20559,14990761:20560,14990768:20561,14990993:20562,14990767:20563,14990982:20564,14990998:20565,15041688:20566,14991252:20567,14991263:20568,14991246:20569,14991256:20570,14991259:20571,14991249:20572,14991258:20573,14991248:20574,14991268:20575,14991269:20576,15040666:20577,15040680:20578,15040660:20579,15040682:20580,15040677:20581,15040645:20582,14990492:20583,14991286:20584,15040673:20585,15040681:20586,15040684:20587,14991294:20588,14991279:20589,15040657:20590,15040646:20591,15040899:20592,15040903:20593,15113347:20594,15040917:20595,15040912:20596,15040904:20597,15040922:20598,15040918:20599,15040940:20600,15040952:20601,15041152:20602,15041178:20603,15041157:20604,15041204:20605,15041202:20606,15041417:20769,15041418:20770,15041203:20771,15041410:20772,15041430:20773,15041438:20774,15041445:20775,15041453:20776,15041443:20777,15041454:20778,15041465:20779,15041461:20780,15041673:20781,15041665:20782,15041666:20783,15041686:20784,15041685:20785,15041684:20786,15041690:20787,15041697:20788,15041722:20789,15041719:20790,15041724:20791,15041723:20792,15041727:20793,15041920:20794,15041938:20795,15041932:20796,15041940:20797,15041954:20798,15182776:20799,15041961:20800,15041962:20801,15041966:20802,15042176:20803,15042178:20804,15047576:20805,15042188:20806,15042185:20807,15042191:20808,15042193:20809,15042195:20810,15042197:20811,15042198:20812,15042212:20813,15042214:20814,15042210:20815,15042217:20816,15042218:20817,15042219:20818,15042227:20819,15042225:20820,15042226:20821,15042224:20822,15042229:20823,15042237:20824,15042437:20825,15042441:20826,15042459:20827,15042464:20828,15243669:20829,15042473:20830,15042477:20831,15042480:20832,15042485:20833,15042494:20834,15042692:20835,15042699:20836,15042708:20837,15042702:20838,15042727:20839,15042730:20840,15042734:20841,15042739:20842,15042745:20843,15042959:20844,15042948:20845,15042955:20846,15042956:20847,15042974:20848,15042964:20849,15042986:20850,15042996:20851,15042985:20852,15042995:20853,15043007:20854,15043005:20855,15043213:20856,15043220:20857,15043218:20858,15042993:20859,15043208:20860,15043217:20861,15253160:20862,15253159:21025,15043244:21026,15043245:21027,15043260:21028,15043253:21029,15043457:21030,15043469:21031,15043479:21032,15043486:21033,15043491:21034,15043494:21035,15311789:21036,15043488:21037,15043507:21038,15043509:21039,15043512:21040,15043513:21041,15043718:21042,15043720:21043,15176888:21044,15043725:21045,15043728:21046,15043727:21047,15043733:21048,15043738:21049,15043747:21050,15043759:21051,15043761:21052,15043763:21053,15043768:21054,15043968:21055,15043974:21056,15043973:21057,14989463:21058,15043977:21059,15043981:21060,15042454:21061,15043998:21062,15044009:21063,15044014:21064,15049880:21065,15044027:21066,15044023:21067,15044226:21068,15044246:21069,15044256:21070,15044262:21071,15044261:21072,15044270:21073,15044272:21074,15044278:21075,15044483:21076,15184018:21077,15309721:21078,15044511:21079,15113148:21080,15173550:21081,15044526:21082,15044520:21083,15044525:21084,15044538:21085,15044737:21086,15044797:21087,15044992:21088,15044780:21089,15044781:21090,15044796:21091,15044782:21092,15044790:21093,15044777:21094,15044765:21095,15045006:21096,15045263:21097,15045045:21098,15045262:21099,15045023:21100,15045041:21101,15045047:21102,15045040:21103,15045266:21104,15045051:21105,15045248:21106,15045046:21107,15045252:21108,15045264:21109,15045254:21110,15045511:21111,15045282:21112,15045304:21113,15045285:21114,15045292:21115,15045508:21116,15045512:21117,15045288:21118,15045291:21281,15045506:21282,15045284:21283,15045310:21284,15045308:21285,15045528:21286,15045541:21287,15045542:21288,15045775:21289,15045780:21290,15045565:21291,15045550:21292,15045549:21293,15045562:21294,15045538:21295,15045817:21296,15046016:21297,15046051:21298,15046028:21299,15045806:21300,15046044:21301,15046021:21302,15046038:21303,15046039:21304,15045816:21305,15045811:21306,15046045:21307,15046297:21308,15046272:21309,15045295:21310,15046282:21311,15046303:21312,15046075:21313,15046078:21314,15046296:21315,15046302:21316,15046318:21317,15046076:21318,15046275:21319,15046313:21320,15046279:21321,15046312:21322,15046554:21323,15046533:21324,15046559:21325,15046532:21326,15046556:21327,15046564:21328,15046548:21329,15046804:21330,15046583:21331,15046806:21332,15046590:21333,15046589:21334,15046811:21335,15046585:21336,15047054:21337,15047056:21338,15173535:21339,15046836:21340,15046838:21341,15046834:21342,15046840:21343,15047083:21344,15047076:21345,15046831:21346,15047084:21347,15047082:21348,15047302:21349,15047296:21350,15047306:21351,15047328:21352,15047316:21353,15047311:21354,15047333:21355,15047342:21356,15047350:21357,15047348:21358,15047554:21359,15047356:21360,15047553:21361,15047555:21362,15047552:21363,15047560:21364,15047566:21365,15047569:21366,15047571:21367,15047575:21368,15047598:21369,15047609:21370,15047808:21371,15047615:21372,15047812:21373,15047817:21374,15047816:21537,15047819:21538,15047821:21539,15047827:21540,15047832:21541,15047830:21542,15046535:21543,15047836:21544,15047846:21545,15047863:21546,15047864:21547,15048078:21548,15047867:21549,15048064:21550,15048079:21551,15048105:21552,15048576:21553,15048328:21554,15048097:21555,15048127:21556,15048329:21557,15048339:21558,15048352:21559,15048371:21560,15048356:21561,15048362:21562,15048368:21563,15048579:21564,15048582:21565,15048596:21566,15048594:21567,15048595:21568,15048842:21569,15048598:21570,15048611:21571,15048843:21572,15048857:21573,15048861:21574,15049138:21575,15048865:21576,15049122:21577,15049099:21578,15049136:21579,15118208:21580,15049106:21581,15048893:21582,15049145:21583,15049349:21584,15049401:21585,15049375:21586,15049387:21587,15049402:21588,15049630:21589,15049403:21590,15049400:21591,15049390:21592,15049605:21593,15049619:21594,15049617:21595,15049623:21596,15049625:21597,15049624:21598,15049637:21599,15049628:21600,15049636:21601,15049631:21602,15049647:21603,15049658:21604,15049657:21605,15049659:21606,15049660:21607,15049661:21608,15049858:21609,15049866:21610,15049872:21611,15049883:21612,15114918:21613,15049893:21614,15049900:21615,15049901:21616,15049906:21617,15049912:21618,15049918:21619,15182738:21620,15050133:21621,15050128:21622,15050126:21623,15050138:21624,15050136:21625,15050146:21626,15050144:21627,15050151:21628,15050156:21629,15050153:21630,15050168:21793,15050369:21794,15050397:21795,14990750:21796,14991019:21797,15050403:21798,15050418:21799,15050630:21800,15050664:21801,15050652:21802,15050381:21803,15050649:21804,15050650:21805,15050917:21806,15050911:21807,15050897:21808,15050908:21809,15050889:21810,15050906:21811,15051136:21812,15051180:21813,15051145:21814,15050933:21815,15050934:21816,15051170:21817,15051178:21818,15051418:21819,15051452:21820,15051454:21821,15051659:21822,15051650:21823,15051453:21824,15051683:21825,15051671:21826,15051686:21827,15051689:21828,15051670:21829,15051706:21830,15051707:21831,15051916:21832,15051915:21833,15051926:21834,15051954:21835,15051664:21836,15051946:21837,15051958:21838,15051966:21839,15052163:21840,15052165:21841,15052160:21842,15052177:21843,15052181:21844,15052186:21845,15052187:21846,15052197:21847,15052201:21848,15052208:21849,15052211:21850,15052213:21851,15052216:21852,15111816:21853,15052218:21854,15052416:21855,15052419:21856,15052454:21857,15052472:21858,15052675:21859,15052679:21860,15052681:21861,15052692:21862,15052688:21863,15052708:21864,15052710:21865,15052706:21866,15052702:21867,15052709:21868,15052715:21869,15052720:21870,15052726:21871,15052723:21872,15052933:21873,15052935:21874,15052936:21875,15052941:21876,15052947:21877,15052960:21878,15052962:21879,15052968:21880,15052984:21881,15052985:21882,15053185:21883,15053190:21884,15053198:21885,15053203:21886,15053200:22049,15053199:22050,15052209:22051,15053228:22052,15053230:22053,14989730:22054,15053238:22055,15053241:22056,15053452:22057,15053457:22058,15053460:22059,15050395:22060,15053483:22061,15053499:22062,15053494:22063,15053500:22064,15053495:22065,15053701:22066,15053502:22067,15053703:22068,15053721:22069,15053737:22070,15053757:22071,15053754:22072,15053741:22073,15054476:22074,15053738:22075,15053963:22076,15053973:22077,15053975:22078,15054236:22079,15053983:22080,15053979:22081,15053969:22082,15053972:22083,15053986:22084,15053978:22085,15053977:22086,15053976:22087,15054220:22088,15054226:22089,15054222:22090,15054219:22091,15054252:22092,15054259:22093,15054262:22094,15054471:22095,15054468:22096,15054466:22097,15054498:22098,15054493:22099,15054508:22100,15054510:22101,15054525:22102,15054480:22103,15054519:22104,15054524:22105,15054729:22106,15054733:22107,15054739:22108,15054738:22109,15054742:22110,15054747:22111,15054763:22112,15054770:22113,15054773:22114,15054987:22115,15055002:22116,15055001:22117,15054993:22118,15055003:22119,15055030:22120,15055031:22121,15055236:22122,15055235:22123,15055232:22124,15055246:22125,15055255:22126,15055252:22127,15055263:22128,15055266:22129,15055268:22130,15055239:22131,15055285:22132,15055286:22133,15055290:22134,15317692:22135,15055295:22136,15055520:22137,15055745:22138,15055746:22139,15055752:22140,15055760:22141,15055759:22142,15055766:22305,15055779:22306,15055773:22307,15055770:22308,15055771:22309,15055778:22310,15055777:22311,15055784:22312,15055785:22313,15055788:22314,15055793:22315,15055795:22316,15055792:22317,15055796:22318,15055800:22319,15055806:22320,15056003:22321,15056009:22322,15056285:22323,15056284:22324,15056011:22325,15056017:22326,15056022:22327,15056041:22328,15056045:22329,15056056:22330,15056257:22331,15056264:22332,15056268:22333,15056270:22334,15056047:22335,15056273:22336,15056278:22337,15056279:22338,15056281:22339,15056289:22340,15056301:22341,15056307:22342,15056311:22343,15056515:22344,15056514:22345,15056319:22346,15056522:22347,15056520:22348,15056529:22349,15056519:22350,15056542:22351,15056537:22352,15056536:22353,15056544:22354,15056552:22355,15056557:22356,15056572:22357,15056790:22358,15056827:22359,15056804:22360,15056824:22361,15056817:22362,15056797:22363,15106739:22364,15056831:22365,15106209:22366,15106464:22367,15106201:22368,15106192:22369,15106217:22370,15106190:22371,15106225:22372,15106203:22373,15106197:22374,15106219:22375,15106214:22376,15106191:22377,15106234:22378,15106458:22379,15106433:22380,15106474:22381,15106487:22382,15106463:22383,15106442:22384,15106438:22385,15106445:22386,15106467:22387,15106435:22388,15106468:22389,15106434:22390,15106476:22391,15106475:22392,15106457:22393,15106689:22394,15106701:22395,15106983:22396,15106691:22397,15106714:22398,15106692:22561,15106715:22562,15106710:22563,15106711:22564,15106706:22565,15106727:22566,15106699:22567,15106977:22568,15106744:22569,15106976:22570,15106963:22571,15106740:22572,15056816:22573,15106749:22574,15106950:22575,15106741:22576,15106968:22577,15107469:22578,15107221:22579,15107206:22580,15106998:22581,15106999:22582,15107200:22583,15106996:22584,15107002:22585,15107203:22586,15107233:22587,15107003:22588,15106993:22589,15107213:22590,15107214:22591,15107463:22592,15107262:22593,15107240:22594,15107239:22595,15107466:22596,15107263:22597,15107260:22598,15107244:22599,15107252:22600,15107261:22601,15107458:22602,15107460:22603,15107507:22604,15107511:22605,15107480:22606,15107481:22607,15107482:22608,15107499:22609,15107508:22610,15107503:22611,15107493:22612,15107505:22613,15107487:22614,15107485:22615,15107475:22616,15107509:22617,15107737:22618,15107734:22619,15107719:22620,15107756:22621,15107732:22622,15107738:22623,15107722:22624,15107729:22625,15107755:22626,15107758:22627,15107980:22628,15107978:22629,15107977:22630,15108023:22631,15107976:22632,15107971:22633,15107974:22634,15107770:22635,15107979:22636,15187385:22637,15107981:22638,15108006:22639,15108003:22640,15108022:22641,15108026:22642,15108020:22643,15108031:22644,15108029:22645,15108028:22646,15108030:22647,15108224:22648,15108232:22649,15108233:22650,15108237:22651,15108236:22652,15108244:22653,15108251:22654,15108254:22817,15108257:22818,15108266:22819,15108270:22820,15108272:22821,15108274:22822,15108275:22823,15108481:22824,15108494:22825,15108510:22826,15108515:22827,15108507:22828,15108512:22829,15108520:22830,15108540:22831,15108738:22832,15108745:22833,15108542:22834,15108754:22835,15108755:22836,15108758:22837,15109012:22838,15108739:22839,15108756:22840,15109015:22841,15109009:22842,15108795:22843,15109007:22844,15109055:22845,15108998:22846,15111060:22847,15109e3:22848,15109020:22849,15109004:22850,15109002:22851,15108994:22852,15108999:22853,15108763:22854,15109001:22855,15109260:22856,15109038:22857,15109041:22858,15109287:22859,15109250:22860,15109256:22861,15109039:22862,15109045:22863,15109520:22864,15109310:22865,15109517:22866,15110300:22867,15109519:22868,15109782:22869,15109774:22870,15109760:22871,15109803:22872,15109558:22873,15109795:22874,15109775:22875,15109769:22876,15109791:22877,15109813:22878,15109547:22879,15109545:22880,15109822:22881,15110057:22882,15110016:22883,15110022:22884,15110051:22885,15110025:22886,15110034:22887,15110070:22888,15110020:22889,15110294:22890,15110324:22891,15110278:22892,15110291:22893,15110310:22894,15110326:22895,15111325:22896,15110295:22897,15110312:22898,15110287:22899,15110567:22900,15110575:22901,15110582:22902,15110542:22903,15111338:22904,15110805:22905,15110803:22906,15110821:22907,15110825:22908,15110792:22909,15110844:22910,15111066:23073,15111058:23074,15111045:23075,15111047:23076,15110843:23077,15111064:23078,15111042:23079,15111089:23080,15111079:23081,15239305:23082,15111072:23083,15111073:23084,15108780:23085,15111075:23086,15111087:23087,15111340:23088,15111094:23089,15111092:23090,15111090:23091,15111098:23092,15111296:23093,15111101:23094,15111320:23095,15111324:23096,15111301:23097,15111332:23098,15111331:23099,15111339:23100,15111348:23101,15111349:23102,15111351:23103,15111350:23104,15111352:23105,15177099:23106,15111560:23107,15111574:23108,15111573:23109,15111565:23110,15111576:23111,15111582:23112,15111581:23113,15111602:23114,15111608:23115,15111810:23116,15111811:23117,15249034:23118,15111835:23119,15111839:23120,15111851:23121,15111863:23122,15112067:23123,15112070:23124,15112065:23125,15112068:23126,15112076:23127,15112082:23128,15112091:23129,15112089:23130,15112096:23131,15112097:23132,15112113:23133,15113650:23134,15112330:23135,15112323:23136,15112123:23137,15113651:23138,15112373:23139,15112374:23140,15112372:23141,15112348:23142,15112591:23143,15112580:23144,15112585:23145,15112577:23146,15112606:23147,15112605:23148,15112612:23149,15112615:23150,15112616:23151,15112607:23152,15112610:23153,15112624:23154,15112835:23155,15112840:23156,15112846:23157,15112841:23158,15112836:23159,15112856:23160,15112861:23161,15113089:23162,15112889:23163,15113097:23164,15112894:23165,15112892:23166,15113092:23329,15112888:23330,15113110:23331,15113114:23332,15113120:23333,15112383:23334,15113126:23335,15113129:23336,15113136:23337,15113141:23338,15113143:23339,15113359:23340,15113366:23341,15113374:23342,15113382:23343,15113383:23344,15310008:23345,15113390:23346,15113407:23347,15113398:23348,15113601:23349,15113400:23350,15113399:23351,15113606:23352,15113630:23353,15113632:23354,15113625:23355,15113635:23356,15113636:23357,15113865:23358,15113648:23359,15113897:23360,15113660:23361,15113642:23362,15113868:23363,15113867:23364,15113894:23365,15113889:23366,15113861:23367,15113911:23368,15114159:23369,15113908:23370,15114156:23371,15113907:23372,15114153:23373,15113912:23374,15114148:23375,15114142:23376,15114141:23377,15114146:23378,15114158:23379,15113913:23380,15114126:23381,15114118:23382,15114151:23383,15116956:23384,15114398:23385,15114630:23386,15114409:23387,15114624:23388,15114637:23389,15114418:23390,15114638:23391,15114931:23392,15114411:23393,15114649:23394,15114659:23395,15114679:23396,15114687:23397,15114911:23398,15114895:23399,15114925:23400,15114900:23401,15114909:23402,15114907:23403,15114883:23404,15116974:23405,15114937:23406,15114676:23407,15114933:23408,15114912:23409,15114938:23410,15115407:23411,15114893:23412,15114686:23413,15115393:23414,15115146:23415,15115400:23416,15115160:23417,15115426:23418,15115430:23419,15115169:23420,15115404:23421,15115149:23422,15115156:23585,15115175:23586,15115157:23587,15115446:23588,15115410:23589,15115396:23590,15115159:23591,15115171:23592,15115429:23593,15115193:23594,15115168:23595,15115183:23596,15115432:23597,15115434:23598,15115418:23599,15115427:23600,15115425:23601,15115142:23602,15115705:23603,15115703:23604,15115676:23605,15115704:23606,15115691:23607,15115668:23608,15115710:23609,15115694:23610,15115449:23611,15115700:23612,15115453:23613,15115673:23614,15115440:23615,15115681:23616,15115678:23617,15115677:23618,15115905:23619,15115690:23620,15115954:23621,15115950:23622,15116176:23623,15115967:23624,15116161:23625,15116179:23626,15115966:23627,15116174:23628,15052712:23629,15116170:23630,15116189:23631,15115963:23632,15116163:23633,15115943:23634,15116462:23635,15115921:23636,15115936:23637,15115932:23638,15115925:23639,15115956:23640,15116190:23641,15116200:23642,15116418:23643,15116443:23644,15116223:23645,15117450:23646,15116217:23647,15116210:23648,15116199:23649,15116421:23650,15115953:23651,15116446:23652,15116205:23653,15116436:23654,15116203:23655,15116426:23656,15116434:23657,15117185:23658,15116451:23659,15116435:23660,15116676:23661,15116428:23662,15116722:23663,15116470:23664,15116728:23665,15116679:23666,15116706:23667,15116697:23668,15116710:23669,15116680:23670,15116472:23671,15116450:23672,15116944:23673,15116941:23674,15116960:23675,15116932:23676,15116962:23677,15116963:23678,15116951:23841,15243415:23842,15116987:23843,15117187:23844,15117186:23845,15116984:23846,15116979:23847,15116972:23848,15117214:23849,15117201:23850,15117215:23851,15116970:23852,15117210:23853,15117226:23854,15117243:23855,15117445:23856,15243414:23857,15117242:23858,15117458:23859,15117462:23860,15314097:23861,15117471:23862,15117496:23863,15117495:23864,15178652:23865,15117497:23866,15311790:23867,15117703:23868,15117699:23869,15117705:23870,15117712:23871,15117721:23872,15117716:23873,15117723:23874,15117727:23875,15117729:23876,15117752:23877,15117753:23878,15117759:23879,15117952:23880,15117956:23881,15117955:23882,15117965:23883,15117976:23884,15117973:23885,15117982:23886,15117988:23887,15117994:23888,15117995:23889,15117999:23890,15118002:23891,15118001:23892,15118003:23893,15118007:23894,15118012:23895,15118214:23896,15118219:23897,15118227:23898,15118239:23899,15118252:23900,15118251:23901,15118259:23902,15118255:23903,15317694:23904,15118472:23905,15118483:23906,15118484:23907,15118491:23908,15118500:23909,15118499:23910,15118750:23911,15118741:23912,15118754:23913,15118762:23914,15118978:23915,15118989:23916,15119002:23917,15118977:23918,15119003:23919,15118782:23920,15118760:23921,15118771:23922,15118994:23923,15118992:23924,15119236:23925,15119281:23926,15119251:23927,15119037:23928,15119255:23929,15119237:23930,15119261:23931,15119022:23932,15119025:23933,15119038:23934,15119034:24097,15119259:24098,15119279:24099,15119257:24100,15119274:24101,15119519:24102,15245709:24103,15119542:24104,15119531:24105,15119549:24106,15119544:24107,15119513:24108,15119541:24109,15119539:24110,15119506:24111,15119500:24112,15119779:24113,15120019:24114,15119780:24115,15119770:24116,15119801:24117,15119769:24118,15120014:24119,15120021:24120,15122340:24121,15120005:24122,15120313:24123,15120533:24124,15120522:24125,15120053:24126,15120263:24127,15120294:24128,15120056:24129,15120262:24130,15120300:24131,15120286:24132,15120268:24133,15120296:24134,15120274:24135,15120261:24136,15120314:24137,15120281:24138,15120292:24139,15120277:24140,15120298:24141,15120302:24142,15120557:24143,15120814:24144,15120558:24145,15120537:24146,15120818:24147,15120799:24148,15120574:24149,15120547:24150,15120811:24151,15120555:24152,15120822:24153,15120781:24154,15120543:24155,15120771:24156,15120570:24157,15120782:24158,15120548:24159,15121343:24160,15120541:24161,15120568:24162,15121026:24163,15121066:24164,15121048:24165,15121289:24166,15121079:24167,15121299:24168,15121085:24169,15121071:24170,15121284:24171,15121074:24172,15121300:24173,15121301:24174,15121039:24175,15121061:24176,15121282:24177,15121055:24178,15121793:24179,15121553:24180,15171980:24181,15121324:24182,15121336:24183,15121342:24184,15121599:24185,15121330:24186,15121585:24187,15121327:24188,15121586:24189,15121292:24190,15121598:24353,15121555:24354,15121335:24355,15122054:24356,15121850:24357,15121848:24358,15122049:24359,15122048:24360,15121839:24361,15121819:24362,15122355:24363,15121837:24364,15122050:24365,15121852:24366,15121816:24367,15122062:24368,15122065:24369,15122306:24370,15121830:24371,15122099:24372,15122083:24373,15122081:24374,15122084:24375,15122105:24376,15122310:24377,15122090:24378,15122335:24379,15122325:24380,15122348:24381,15122324:24382,15122328:24383,15122353:24384,15122350:24385,15122331:24386,15171721:24387,15171723:24388,15122362:24389,15171729:24390,15171713:24391,15171727:24392,15122366:24393,15171739:24394,15171738:24395,15121844:24396,15171741:24397,15171736:24398,15171743:24399,15171760:24400,15171774:24401,15171762:24402,15171985:24403,15172003:24404,15172249:24405,15172242:24406,15172271:24407,15172529:24408,15172268:24409,15172280:24410,15172275:24411,15172270:24412,15172511:24413,15172491:24414,15172509:24415,15172505:24416,15172745:24417,15172541:24418,15172764:24419,15172761:24420,15173029:24421,15173013:24422,15173256:24423,15173030:24424,15173026:24425,15173004:24426,15173014:24427,15173036:24428,15173263:24429,15173563:24430,15173252:24431,15173269:24432,15173288:24433,15173292:24434,15173527:24435,15173305:24436,15173310:24437,15173522:24438,15173513:24439,15173524:24440,15173518:24441,15173536:24442,15173548:24443,15173543:24444,15173557:24445,15173564:24446,15173561:24609,15173567:24610,15173773:24611,15173776:24612,15173787:24613,15173800:24614,15173805:24615,15173804:24616,15173808:24617,15173810:24618,15173819:24619,15173820:24620,15173823:24621,15174016:24622,15174022:24623,15174027:24624,15174040:24625,15174068:24626,15174078:24627,15174274:24628,15174273:24629,15174279:24630,15174290:24631,15174294:24632,15174306:24633,15174311:24634,15174329:24635,15174322:24636,15174531:24637,15174534:24638,15174532:24639,15174542:24640,15174546:24641,15174562:24642,15174560:24643,15174561:24644,15174585:24645,15174583:24646,15040655:24647,15174807:24648,15174794:24649,15174812:24650,15174806:24651,15174813:24652,15174836:24653,15174831:24654,15174825:24655,15174821:24656,15174846:24657,15175054:24658,15175055:24659,15317912:24660,15175063:24661,15175082:24662,15175080:24663,15175088:24664,15175096:24665,15175093:24666,15175099:24667,15175098:24668,15175560:24669,15175347:24670,15175566:24671,15175355:24672,15175552:24673,15175589:24674,15175598:24675,15175582:24676,15176354:24677,15175813:24678,15176111:24679,15175845:24680,15175608:24681,15175858:24682,15175866:24683,15176085:24684,15175871:24685,15176095:24686,15176089:24687,15176065:24688,15176092:24689,15176105:24690,15176112:24691,15176099:24692,15176106:24693,15176118:24694,15176126:24695,15176331:24696,15176350:24697,15176359:24698,15176586:24699,15176591:24700,15176596:24701,15175601:24702,15176608:24865,15176611:24866,15176615:24867,15176617:24868,15176622:24869,15176626:24870,15176624:24871,15176625:24872,15176632:24873,15176631:24874,15176836:24875,15176835:24876,15176837:24877,15176844:24878,15176846:24879,15176845:24880,15176853:24881,15176851:24882,15176862:24883,15176870:24884,15176876:24885,15176892:24886,15177092:24887,15177101:24888,15177098:24889,15177097:24890,15177115:24891,15177094:24892,15177114:24893,15177129:24894,15177124:24895,15177127:24896,15177131:24897,15177133:24898,15177144:24899,15177142:24900,15177350:24901,15177351:24902,15177140:24903,15177354:24904,15177353:24905,15177346:24906,15177364:24907,15177370:24908,15177373:24909,15177381:24910,15177379:24911,15177602:24912,15177395:24913,15177603:24914,15177397:24915,15177405:24916,15177400:24917,15177404:24918,15177393:24919,15177613:24920,15177610:24921,15177618:24922,15177625:24923,15177635:24924,15177630:24925,15177662:24926,15177663:24927,15177660:24928,15177857:24929,15177648:24930,15177658:24931,15177650:24932,15177651:24933,15177867:24934,15177869:24935,15177865:24936,15177887:24937,15177895:24938,15177888:24939,15177889:24940,15177890:24941,15177892:24942,15177908:24943,15177904:24944,15177915:24945,15178119:24946,15178120:24947,15178118:24948,15178140:24949,15178136:24950,15178145:24951,15178146:24952,15178152:24953,15178153:24954,15178154:24955,15178151:24956,15178156:24957,15178160:24958,15178162:25121,15178166:25122,15178168:25123,15178172:25124,15178368:25125,15178371:25126,15178376:25127,15178379:25128,15178382:25129,15178390:25130,15178387:25131,15178393:25132,15178394:25133,15178416:25134,15178420:25135,15178424:25136,15178425:25137,15178426:25138,15178626:25139,15178637:25140,15178646:25141,15178642:25142,15178654:25143,15178657:25144,15178661:25145,15178663:25146,15178666:25147,15243439:25148,15178683:25149,15178888:25150,15178887:25151,15178884:25152,15178921:25153,15178916:25154,15178910:25155,15178917:25156,15178918:25157,15178907:25158,15178935:25159,15178936:25160,15179143:25161,15179162:25162,15179176:25163,15179179:25164,15179163:25165,15179173:25166,15179199:25167,15179198:25168,15179193:25169,15179406:25170,15179403:25171,15179409:25172,15179424:25173,15179422:25174,15179440:25175,15179446:25176,15179449:25177,15179455:25178,15179452:25179,15179453:25180,15179451:25181,15179655:25182,15179661:25183,15179671:25184,15179674:25185,15179676:25186,15179683:25187,15179694:25188,15179708:25189,15179916:25190,15179922:25191,15180966:25192,15179936:25193,15180970:25194,15180165:25195,15180430:25196,15180212:25197,15180422:25198,15180220:25199,15180442:25200,15180428:25201,15180451:25202,15180469:25203,15180458:25204,15180463:25205,15180689:25206,15180678:25207,15180683:25208,15180692:25209,15180478:25210,15180476:25211,15180677:25212,15180682:25213,15180716:25214,15180711:25377,15180698:25378,15180733:25379,15180724:25380,15180935:25381,15180946:25382,15180945:25383,15180953:25384,15180972:25385,15180971:25386,15181184:25387,15181216:25388,15181207:25389,15181215:25390,15181210:25391,15181205:25392,15181203:25393,15181242:25394,15181247:25395,15181450:25396,15181469:25397,15181479:25398,15318411:25399,15181482:25400,15181486:25401,15181491:25402,15181497:25403,15181498:25404,15181705:25405,15181717:25406,15181735:25407,15181740:25408,15181729:25409,15181731:25410,15181960:25411,15181965:25412,15181976:25413,15181977:25414,15181984:25415,15181983:25416,15181440:25417,15182001:25418,15182011:25419,15182014:25420,15182007:25421,15182211:25422,15182231:25423,15182217:25424,15182241:25425,15182242:25426,15182249:25427,15318685:25428,15182256:25429,15182265:25430,15182269:25431,15182472:25432,15182487:25433,15182485:25434,15182488:25435,15182486:25436,15182505:25437,15182728:25438,15182512:25439,15182518:25440,15182725:25441,15182724:25442,15182527:25443,15303299:25444,15182727:25445,15182730:25446,15182733:25447,15182735:25448,15182741:25449,15182739:25450,15182745:25451,15182746:25452,15182749:25453,15182753:25454,15182754:25455,15182758:25456,15182765:25457,15182768:25458,15182978:25459,15182991:25460,15182986:25461,15182982:25462,15183027:25463,15183e3:25464,15183001:25465,15183006:25466,15183029:25467,15183016:25468,15183030:25469,15183248:25470,15183290:25633,15182980:25634,15183245:25635,15182987:25636,15183244:25637,15183237:25638,15183285:25639,15183269:25640,15183284:25641,15183271:25642,15183280:25643,15183281:25644,15183276:25645,15183278:25646,15183517:25647,15183512:25648,15183519:25649,15183501:25650,15183516:25651,15183514:25652,15183499:25653,15183506:25654,15183503:25655,15183261:25656,15183513:25657,15183755:25658,15183745:25659,15183756:25660,15183759:25661,15183540:25662,15183750:25663,15183773:25664,15183785:25665,15184017:25666,15184020:25667,15183782:25668,15183781:25669,15184288:25670,15184e3:25671,15184007:25672,15184019:25673,15183795:25674,15183799:25675,15184023:25676,15184013:25677,15183798:25678,15184035:25679,15184039:25680,15184042:25681,15184031:25682,15184055:25683,15184043:25684,15184061:25685,15184268:25686,15184259:25687,15184276:25688,15184271:25689,15184256:25690,15184272:25691,15184280:25692,15184287:25693,15184292:25694,15184278:25695,15184293:25696,15184300:25697,15184309:25698,15184515:25699,15184528:25700,15184548:25701,15184557:25702,15184546:25703,15184555:25704,15184545:25705,15184552:25706,15184563:25707,15184562:25708,15184561:25709,15184558:25710,15184569:25711,15184573:25712,15184768:25713,15184773:25714,15184770:25715,15184792:25716,15184786:25717,15184796:25718,15184802:25719,15314107:25720,15184815:25721,15184818:25722,15184820:25723,15184822:25724,15184826:25725,15185030:25726,15185026:25889,15185052:25890,15185045:25891,15185034:25892,15185285:25893,15185291:25894,15185070:25895,15185074:25896,15185087:25897,15185077:25898,15185286:25899,15185331:25900,15185302:25901,15185294:25902,15185330:25903,15185320:25904,15185326:25905,15185295:25906,15185315:25907,15185555:25908,15185545:25909,15185307:25910,15185551:25911,15185341:25912,15185563:25913,15185594:25914,15185582:25915,15185571:25916,15185589:25917,15185799:25918,15185597:25919,15185579:25920,15186109:25921,15185570:25922,15185583:25923,15185820:25924,15185592:25925,15185567:25926,15185584:25927,15185816:25928,15185821:25929,15185828:25930,15185822:25931,15185851:25932,15185842:25933,15185825:25934,15186053:25935,15186058:25936,15186083:25937,15186081:25938,15186066:25939,15186097:25940,15186079:25941,15186057:25942,15186059:25943,15186082:25944,15186310:25945,15186342:25946,15186107:25947,15186101:25948,15186105:25949,15186307:25950,15186103:25951,15186098:25952,15186106:25953,15186343:25954,15186333:25955,15186326:25956,15186334:25957,15186329:25958,15186330:25959,15186361:25960,15186346:25961,15186345:25962,15186364:25963,15186363:25964,15186563:25965,15185813:25966,15186365:25967,15253166:25968,15186367:25969,15186568:25970,15186569:25971,15186572:25972,15186578:25973,15186576:25974,15186579:25975,15186580:25976,15186582:25977,15186574:25978,15186587:25979,15186588:25980,15187128:25981,15187130:25982,15187333:26145,15187340:26146,15187341:26147,15187342:26148,15187344:26149,15187345:26150,15187349:26151,15187348:26152,15187352:26153,15187359:26154,15187360:26155,15187368:26156,15187369:26157,15187367:26158,15187384:26159,15187586:26160,15187590:26161,15187587:26162,15187592:26163,15187591:26164,15187596:26165,15187604:26166,15187614:26167,15187613:26168,15187610:26169,15187619:26170,15187631:26171,15187634:26172,15187641:26173,15187630:26174,15187638:26175,15187640:26176,15248817:26177,15187845:26178,15187846:26179,15187850:26180,15187861:26181,15187860:26182,15187873:26183,15187878:26184,15187881:26185,15187891:26186,15187897:26187,15311772:26188,15237254:26189,15237252:26190,15237259:26191,15237266:26192,15237272:26193,15237273:26194,15237276:26195,15237281:26196,15237288:26197,15237311:26198,15237307:26199,15237514:26200,15237510:26201,15237522:26202,15237528:26203,15237530:26204,15237535:26205,15237538:26206,15237544:26207,15237555:26208,15237554:26209,15237552:26210,15237558:26211,15237561:26212,15237565:26213,15237567:26214,15237764:26215,15237766:26216,15237765:26217,15237787:26218,15237779:26219,15237786:26220,15237805:26221,15042192:26222,15237804:26223,15238043:26224,15238053:26225,15238041:26226,15238045:26227,15238020:26228,15238042:26229,15238038:26230,15238281:26231,15238063:26232,15238065:26233,15238299:26234,15238313:26235,15238307:26236,15238319:26237,15238539:26238,15309451:26401,15238534:26402,15238334:26403,15238547:26404,15238545:26405,15238076:26406,15238577:26407,15238574:26408,15238565:26409,15238566:26410,15238580:26411,15238787:26412,15238792:26413,15238794:26414,15238784:26415,15238786:26416,15238816:26417,15238805:26418,15238820:26419,15238819:26420,15238559:26421,15238803:26422,15238825:26423,15238832:26424,15238837:26425,15238846:26426,15238840:26427,15238845:26428,15239040:26429,15239042:26430,15238842:26431,15239049:26432,15239053:26433,15239057:26434,15239065:26435,15239064:26436,15239048:26437,15239066:26438,15239071:26439,15239072:26440,15239079:26441,15239098:26442,15239099:26443,15239102:26444,15239297:26445,15239298:26446,15239301:26447,15239303:26448,15239306:26449,15239309:26450,15239312:26451,15239318:26452,15239337:26453,15239339:26454,15239352:26455,15239347:26456,15239552:26457,15239577:26458,15239576:26459,15239581:26460,15239578:26461,15239583:26462,15239588:26463,15239586:26464,15239592:26465,15239594:26466,15239595:26467,15239342:26468,15239601:26469,15239607:26470,15239608:26471,15239614:26472,15239821:26473,15239826:26474,15239851:26475,15239839:26476,15239867:26477,15239852:26478,15240097:26479,15240099:26480,15240095:26481,15240082:26482,15240116:26483,15240115:26484,15240122:26485,15240851:26486,15240323:26487,15240123:26488,15240121:26489,15240094:26490,15240326:26491,15240092:26492,15240329:26493,15240089:26494,15240373:26657,15240372:26658,15240342:26659,15240370:26660,15240369:26661,15240576:26662,15240377:26663,15240592:26664,15240581:26665,15240367:26666,15240363:26667,15240343:26668,15240344:26669,15240837:26670,15240858:26671,15240874:26672,15240863:26673,15240866:26674,15240854:26675,15240355:26676,15240846:26677,15240839:26678,15240842:26679,15240636:26680,15240885:26681,15240627:26682,15240629:26683,15240864:26684,15240841:26685,15240872:26686,15241140:26687,15241363:26688,15241131:26689,15241102:26690,15241149:26691,15241347:26692,15241112:26693,15241355:26694,15241089:26695,15241143:26696,15241351:26697,15241120:26698,15241138:26699,15241357:26700,15241378:26701,15241376:26702,15240893:26703,15241400:26704,15242374:26705,15241147:26706,15241645:26707,15241386:26708,15241404:26709,15242650:26710,15241860:26711,15241655:26712,15241643:26713,15241901:26714,15241646:26715,15241858:26716,15241641:26717,15241606:26718,15241388:26719,15241647:26720,15241657:26721,15241397:26722,15242122:26723,15241634:26724,15241913:26725,15241919:26726,15241887:26727,15242137:26728,15242125:26729,15241915:26730,15242138:26731,15242128:26732,15242113:26733,15242118:26734,15242134:26735,15241889:26736,15242401:26737,15242175:26738,15242164:26739,15242391:26740,15242392:26741,15242412:26742,15242399:26743,15242389:26744,15242388:26745,15242172:26746,15242624:26747,15242659:26748,15242648:26749,15242632:26750,15242625:26913,15243394:26914,15242635:26915,15242645:26916,15242880:26917,15242916:26918,15242888:26919,15242897:26920,15242890:26921,15242920:26922,15242669:26923,15242900:26924,15242907:26925,15243178:26926,15242887:26927,15242908:26928,15242679:26929,15242686:26930,15242896:26931,15243145:26932,15242938:26933,15243151:26934,15242937:26935,15243152:26936,15243157:26937,15243165:26938,15243173:26939,15243164:26940,15243193:26941,15243402:26942,15243411:26943,15243403:26944,15243198:26945,15243194:26946,15243398:26947,15243426:26948,15243418:26949,15243440:26950,15243455:26951,15243661:26952,14989717:26953,15243668:26954,15243679:26955,15243687:26956,15243697:26957,15243923:26958,15243939:26959,15243945:26960,15243946:26961,15243915:26962,15243916:26963,15243958:26964,15243951:26965,15244164:26966,15244166:26967,15243952:26968,15244169:26969,15245475:26970,15243947:26971,15244180:26972,15244190:26973,15244201:26974,15244204:26975,15244191:26976,15244187:26977,15244207:26978,15244434:26979,15244422:26980,15244424:26981,15244416:26982,15244419:26983,15244219:26984,15244433:26985,15244425:26986,15244429:26987,15244217:26988,15244426:26989,15244468:26990,15244479:26991,15244471:26992,15244475:26993,15244453:26994,15244457:26995,15244442:26996,15244704:26997,15244703:26998,15244728:26999,15244684:27e3,15244686:27001,15244724:27002,15244695:27003,15244712:27004,15244718:27005,15244697:27006,15244691:27169,15244707:27170,15244714:27171,15245445:27172,15244962:27173,15244959:27174,15244930:27175,15244975:27176,15245195:27177,15244989:27178,15245184:27179,15245200:27180,15309718:27181,15244971:27182,15245188:27183,15244979:27184,15245191:27185,15245190:27186,15244987:27187,15245231:27188,15245234:27189,15245216:27190,15245455:27191,15245453:27192,15245246:27193,15245238:27194,15245239:27195,15245454:27196,15245202:27197,15245457:27198,15245462:27199,15245461:27200,15245474:27201,15245473:27202,15245489:27203,15245494:27204,15245497:27205,15245479:27206,15245499:27207,15245700:27208,15245698:27209,15245714:27210,15245721:27211,15245726:27212,15245730:27213,15245739:27214,15245953:27215,15245758:27216,15245982:27217,15245749:27218,15245757:27219,15246005:27220,15245746:27221,15245954:27222,15245975:27223,15245970:27224,15245998:27225,15245977:27226,15245986:27227,15245965:27228,15245988:27229,15246e3:27230,15246015:27231,15246001:27232,15246211:27233,15246212:27234,15246228:27235,15246232:27236,15246233:27237,15246237:27238,15246265:27239,15246466:27240,15246268:27241,15246260:27242,15246248:27243,15246258:27244,15246468:27245,15246476:27246,15246474:27247,15246483:27248,15246723:27249,15246494:27250,15246501:27251,15246506:27252,15246507:27253,15246721:27254,15246724:27255,15246523:27256,15246518:27257,15246520:27258,15246732:27259,15246493:27260,15246752:27261,15246750:27262,15246758:27425,15246756:27426,15246765:27427,15246762:27428,15246767:27429,15246772:27430,15246775:27431,15246782:27432,15246979:27433,15246984:27434,15246986:27435,15246995:27436,15247e3:27437,15247009:27438,15247017:27439,15247014:27440,15247020:27441,15247023:27442,15247026:27443,15247034:27444,15247037:27445,15247039:27446,15247232:27447,15247258:27448,15247260:27449,15247261:27450,15247271:27451,15247284:27452,15247288:27453,15247491:27454,15247510:27455,15247504:27456,15247500:27457,15247515:27458,15247517:27459,15247525:27460,15247542:27461,15247745:27462,15247771:27463,15247762:27464,15247750:27465,15247752:27466,15247804:27467,15247789:27468,15247788:27469,15247778:27470,15248005:27471,15248002:27472,15248004:27473,15248040:27474,15248033:27475,15248017:27476,15248037:27477,15248038:27478,15248026:27479,15248035:27480,15248260:27481,15248269:27482,15248258:27483,15248282:27484,15248299:27485,15248307:27486,15248295:27487,15248292:27488,15248305:27489,15248532:27490,15248288:27491,15248290:27492,15248311:27493,15248286:27494,15248283:27495,15248524:27496,15248519:27497,15248538:27498,15248289:27499,15248534:27500,15248528:27501,15248535:27502,15248544:27503,15248563:27504,15310507:27505,15248550:27506,15248555:27507,15248574:27508,15248552:27509,15248769:27510,15248780:27511,15248783:27512,15248782:27513,15248777:27514,15248790:27515,15248795:27516,15248794:27517,15248811:27518,15248799:27681,15248812:27682,15248815:27683,15248820:27684,15248829:27685,15249024:27686,15249036:27687,15249038:27688,15249042:27689,15249043:27690,15249046:27691,15249049:27692,15249050:27693,15249594:27694,15249793:27695,15249599:27696,15249800:27697,15249804:27698,15249806:27699,15249808:27700,15249813:27701,15249826:27702,15249836:27703,15249848:27704,15249850:27705,15250050:27706,15250057:27707,15250053:27708,15250058:27709,15250061:27710,15250062:27711,15250068:27712,15249852:27713,15250072:27714,15108253:27715,15250093:27716,15250090:27717,15250109:27718,15250098:27719,15250099:27720,15250094:27721,15250102:27722,15250312:27723,15250305:27724,15250340:27725,15250339:27726,15250330:27727,15250365:27728,15250362:27729,15250363:27730,15250564:27731,15250565:27732,15250570:27733,15250567:27734,15250575:27735,15250573:27736,15250576:27737,15318414:27738,15250579:27739,15250317:27740,15250580:27741,15250582:27742,15250855:27743,15250861:27744,15250865:27745,15250867:27746,15251073:27747,15251097:27748,15251330:27749,15251134:27750,15251130:27751,15251343:27752,15251354:27753,15251350:27754,15251340:27755,15251355:27756,15251339:27757,15251370:27758,15251371:27759,15251359:27760,15251363:27761,15251388:27762,15251592:27763,15251593:27764,15251391:27765,15251613:27766,15251614:27767,15251600:27768,15251615:27769,15251842:27770,15251637:27771,15251632:27772,15251636:27773,15251850:27774,15251847:27937,15251849:27938,15251852:27939,15251856:27940,15251848:27941,15251865:27942,15251876:27943,15251872:27944,15251626:27945,15251875:27946,15251861:27947,15251894:27948,15251890:27949,15251900:27950,15252097:27951,15252103:27952,15252101:27953,15252100:27954,15252107:27955,15252106:27956,15252115:27957,15252113:27958,15252116:27959,15252121:27960,15252138:27961,15252129:27962,15252140:27963,15252144:27964,15252358:27965,15252145:27966,15252158:27967,15252357:27968,15252360:27969,15252363:27970,15252379:27971,15252387:27972,15252412:27973,15252411:27974,15252395:27975,15252414:27976,15252618:27977,15252613:27978,15252629:27979,15252626:27980,15252633:27981,15252627:27982,15252636:27983,15252639:27984,15252635:27985,15252620:27986,15252646:27987,15252659:27988,15252667:27989,15252665:27990,15252869:27991,15252866:27992,15252670:27993,15252876:27994,15252873:27995,15252870:27996,15252878:27997,15252887:27998,15252892:27999,15252898:28e3,15252899:28001,15252900:28002,15253148:28003,15253151:28004,15253155:28005,15253165:28006,15253167:28007,15253175:28008,15253402:28009,15253413:28010,15253410:28011,15253418:28012,15253423:28013,15303303:28014,15253428:28015,15302789:28016,15253433:28017,15253434:28018,15302801:28019,15302805:28020,15302817:28021,15302797:28022,15302814:28023,15302806:28024,15302795:28025,15302823:28026,15302838:28027,15302837:28028,15302841:28029,15253432:28030,15303055:28193,15303056:28194,15303057:28195,15303058:28196,15302798:28197,15303049:28198,15302846:28199,15303062:28200,15303064:28201,15303070:28202,15303080:28203,15303087:28204,15303094:28205,15309480:28206,15303090:28207,15303298:28208,15303101:28209,15303297:28210,15303296:28211,15303306:28212,15303305:28213,15303311:28214,15303336:28215,15303343:28216,15303345:28217,15303349:28218,15303586:28219,15303588:28220,15108488:28221,15303579:28222,15303810:28223,15303826:28224,15303833:28225,15303858:28226,15303856:28227,15304074:28228,15304086:28229,15304088:28230,15304099:28231,15304101:28232,15304105:28233,15304115:28234,15304114:28235,15304331:28236,15304329:28237,15304322:28238,15304354:28239,15304363:28240,15304367:28241,15304362:28242,15304373:28243,15304372:28244,15304378:28245,15304576:28246,15304577:28247,15304585:28248,15304587:28249,15304592:28250,15304598:28251,15304607:28252,15304609:28253,15304603:28254,15304636:28255,15304629:28256,15304630:28257,15304862:28258,15304639:28259,15304852:28260,15304876:28261,15304853:28262,15304849:28263,15305118:28264,15305111:28265,15305093:28266,15305097:28267,15305124:28268,15305096:28269,15305365:28270,15304895:28271,15305099:28272,15305104:28273,15305372:28274,15305366:28275,15305363:28276,15305371:28277,15305114:28278,15305615:28279,15305401:28280,15305399:28281,15305641:28282,15305871:28283,15305658:28284,15306116:28285,15305902:28286,15305881:28449,15305890:28450,15305882:28451,15305891:28452,15305914:28453,15305909:28454,15305915:28455,15306140:28456,15306144:28457,15306172:28458,15306158:28459,15306134:28460,15306416:28461,15306412:28462,15306413:28463,15306388:28464,15306425:28465,15306646:28466,15306647:28467,15306664:28468,15306661:28469,15306648:28470,15306627:28471,15306653:28472,15306640:28473,15306632:28474,15306660:28475,15306906:28476,15306900:28477,15306899:28478,15306883:28479,15306887:28480,15306896:28481,15306934:28482,15306923:28483,15306933:28484,15306913:28485,15306938:28486,15307137:28487,15307154:28488,15307140:28489,15307163:28490,15307168:28491,15307170:28492,15307166:28493,15307178:28494,15304873:28495,15307184:28496,15307189:28497,15307191:28498,15307197:28499,15307162:28500,15307196:28501,15307198:28502,15307393:28503,15307199:28504,15308418:28505,15308423:28506,15308426:28507,15308436:28508,15308438:28509,15308440:28510,15308441:28511,15308448:28512,15308456:28513,15308455:28514,15308461:28515,15308476:28516,15308475:28517,15308473:28518,15308478:28519,15308682:28520,15122358:28521,15308675:28522,15308685:28523,15308684:28524,15308693:28525,15308692:28526,15308694:28527,15308700:28528,15308705:28529,15308709:28530,15308706:28531,15308961:28532,15308968:28533,15308974:28534,15308975:28535,15309186:28536,15309196:28537,15309199:28538,15309195:28539,15309239:28540,15309212:28541,15309214:28542,15309213:28705,15309215:28706,15309222:28707,15309234:28708,15309228:28709,15309453:28710,15309464:28711,15309461:28712,15309463:28713,15309482:28714,15309479:28715,15309489:28716,15309490:28717,15309488:28718,15309492:28719,15309494:28720,15309496:28721,15309497:28722,15309710:28723,15309707:28724,15309705:28725,15309709:28726,15246733:28727,15309724:28728,15309965:28729,15309717:28730,15309753:28731,15309956:28732,15309958:28733,15309960:28734,15309971:28735,15309966:28736,15309969:28737,15309967:28738,15309974:28739,15309977:28740,15309988:28741,15309994:28742,1531e4:28743,15310009:28744,15310013:28745,15310014:28746,15310212:28747,15310214:28748,15310216:28749,15310210:28750,15310217:28751,15310236:28752,15310240:28753,15310244:28754,15310246:28755,15310248:28756,15043474:28757,15310251:28758,15310257:28759,15310265:28760,15310469:28761,15310268:28762,15310465:28763,15310266:28764,15310470:28765,15310475:28766,15310479:28767,15310480:28768,15310492:28769,15310504:28770,15310502:28771,15310499:28772,15310515:28773,15310516:28774,15310723:28775,15310726:28776,15310728:28777,15310731:28778,15310748:28779,15310765:28780,15318415:28781,15310770:28782,15182751:28783,15310774:28784,15310773:28785,15310991:28786,15310988:28787,15311032:28788,15311012:28789,15311009:28790,15311031:28791,15311037:28792,15311238:28793,15311247:28794,15311243:28795,15311275:28796,15311279:28797,15311280:28798,15311281:28961,15311284:28962,15311283:28963,15311530:28964,15311535:28965,15311537:28966,15311542:28967,15311748:28968,15311747:28969,15311750:28970,15311785:28971,15311787:28972,15312003:28973,15312009:28974,15312018:28975,15312020:28976,15312024:28977,15312033:28978,15312029:28979,15312030:28980,15312036:28981,15312032:28982,15312044:28983,15312046:28984,15312061:28985,15312062:28986,15312258:28987,15312265:28988,15312261:28989,15312272:28990,15312267:28991,15312273:28992,15312274:28993,15312268:28994,15312277:28995,15312535:28996,15312536:28997,15312549:28998,15312557:28999,15312558:29e3,15312572:29001,15312799:29002,15312795:29003,15312797:29004,15312792:29005,15312785:29006,15312813:29007,15312814:29008,15312817:29009,15312818:29010,15312827:29011,15312824:29012,15313025:29013,15313039:29014,15313029:29015,15312802:29016,15313049:29017,15313067:29018,15313079:29019,15313285:29020,15313282:29021,15313280:29022,15313283:29023,15313086:29024,15313301:29025,15313293:29026,15313307:29027,15313303:29028,15313311:29029,15313314:29030,15313317:29031,15313316:29032,15313321:29033,15313323:29034,15313322:29035,15313581:29036,15313584:29037,15313596:29038,15313792:29039,15313807:29040,15313809:29041,15313811:29042,15313812:29043,15313822:29044,15313823:29045,15313826:29046,15313827:29047,15313830:29048,15313839:29049,15313835:29050,15313838:29051,15313844:29052,15313841:29053,15313847:29054,15313851:29217,15314054:29218,15314072:29219,15314074:29220,15314079:29221,15314082:29222,15314083:29223,15314085:29224,15314087:29225,15314088:29226,15314089:29227,15314090:29228,15314094:29229,15314095:29230,15314098:29231,15314308:29232,15314307:29233,15314319:29234,15314317:29235,15314318:29236,15314321:29237,15314328:29238,15314356:29239,15314579:29240,15314563:29241,15314577:29242,15314582:29243,15314583:29244,15314591:29245,15314592:29246,15314600:29247,15314612:29248,15314816:29249,15314826:29250,15314617:29251,15314822:29252,15314831:29253,15314833:29254,15314834:29255,15314851:29256,15314850:29257,15314852:29258,15314836:29259,15314849:29260,15315130:29261,15314866:29262,15314865:29263,15314864:29264,15315093:29265,15315092:29266,15315081:29267,15315091:29268,15315084:29269,15315078:29270,15315080:29271,15315090:29272,15315082:29273,15315076:29274,15315118:29275,15315099:29276,15315109:29277,15315108:29278,15315105:29279,15315120:29280,15315335:29281,15315122:29282,15315334:29283,15315134:29284,15315354:29285,15315360:29286,15315367:29287,15315382:29288,15315384:29289,15315879:29290,15315884:29291,15315888:29292,15316105:29293,15316104:29294,15315883:29295,15316099:29296,15316102:29297,15316138:29298,15316134:29299,15316655:29300,15316131:29301,15316127:29302,15316356:29303,15316117:29304,15316114:29305,15316353:29306,15316159:29307,15316158:29308,15316358:29309,15316360:29310,15316381:29473,15316382:29474,15316388:29475,15316369:29476,15316368:29477,15316377:29478,15316402:29479,15316617:29480,15316615:29481,15316651:29482,15316399:29483,15316410:29484,15316634:29485,15316644:29486,15316649:29487,15316658:29488,15316868:29489,15316865:29490,15316667:29491,15316664:29492,15316666:29493,15316870:29494,15316879:29495,15316866:29496,15316889:29497,15316883:29498,15316920:29499,15316902:29500,15316909:29501,15316911:29502,15316925:29503,15317146:29504,15317147:29505,15317150:29506,15317429:29507,15317433:29508,15317437:29509,15317633:29510,15317640:29511,15317643:29512,15317644:29513,15317650:29514,15317653:29515,15317649:29516,15317661:29517,15317669:29518,15317673:29519,15317688:29520,15317674:29521,15317677:29522,15310241:29523,15317900:29524,15317902:29525,15317903:29526,15317904:29527,15317908:29528,15317916:29529,15317918:29530,15317917:29531,15317920:29532,15317925:29533,15317928:29534,15317935:29535,15317940:29536,15317942:29537,15317943:29538,15317945:29539,15317947:29540,15317948:29541,15317949:29542,15318151:29543,15318152:29544,15178423:29545,15318165:29546,15318177:29547,15318188:29548,15318206:29549,15318410:29550,15318418:29551,15318420:29552,15318435:29553,15318431:29554,15318432:29555,15318433:29556,15318438:29557,15318439:29558,15318444:29559,15318442:29560,15318455:29561,15318450:29562,15318454:29563,15318677:29564,15318684:29565,15318688:29566,15048879:29729,15116167:29730,15303065:29731,15176100:29732,15042460:29733,15173273:29734,15186570:31009,15246492:31010,15306120:31011,15305352:31012,15242140:31013,14991241:31014,15172283:31015,15112369:31016,15115144:31017,15305657:31018,15113147:31019,15056261:31020,14989480:31021,14990241:31022,14990268:31023,14990464:31024,14990467:31025,14990521:31026,14990742:31027,14990994:31028,14990986:31029,14991002:31030,14990996:31031,14991245:31032,15040896:31033,15040674:31034,14991295:31035,15040670:31036,15040902:31037,15040944:31038,15040898:31039,15041172:31040,15041460:31041,15041432:31042,15041930:31043,15041956:31044,15042205:31045,15042238:31046,15042476:31047,15042709:31048,15043228:31049,15043238:31050,15043456:31051,15043483:31052,15043712:31053,15043719:31054,15043748:31055,15044018:31056,15044243:31057,15044274:31058,15044509:31059,15706254:31060,15045276:31061,15045258:31062,15045289:31063,15045567:31064,15046278:31065,15048089:31066,15048101:31067,15048364:31068,15048584:31069,15048583:31070,15706255:31071,15706256:31072,15049374:31073,15049394:31074,15049867:31075,15050131:31076,15050139:31077,15050141:31078,15050147:31079,15050404:31080,15050426:31081,15052182:31082,15052672:31083,15176879:31084,15052696:31085,15052716:31086,15052958:31087,15053478:31088,15053498:31089,15053749:31090,15053991:31091,15054227:31092,15706257:31093,15054210:31094,15054253:31095,15054520:31096,15054521:31097,15054736:31098,15056033:31099,15056052:31100,15056295:31101,15056567:31102,15056798:31265,15106461:31266,15106693:31267,15106698:31268,15106974:31269,15106965:31270,15107232:31271,15106994:31272,15107217:31273,15107255:31274,15107248:31275,15107736:31276,15108243:31277,15108774:31278,15110069:31279,15110560:31280,15110813:31281,15111054:31282,15111566:31283,15112320:31284,15112341:31285,15112379:31286,15112329:31287,15112366:31288,15112350:31289,15112356:31290,15112613:31291,15112599:31292,15112601:31293,15706258:31294,15112627:31295,15112857:31296,15112864:31297,15112882:31298,15112895:31299,15113146:31300,15113358:31301,15705257:31302,15113638:31303,15113915:31304,15114642:31305,15114112:31306,15114369:31307,15114628:31308,15115151:31309,15706259:31310,15115688:31311,15706260:31312,15115928:31313,15116194:31314,15116464:31315,15116715:31316,15116678:31317,15116723:31318,15116734:31319,15117218:31320,15117220:31321,15118230:31322,15118527:31323,15118748:31324,15118982:31325,15118767:31326,15119258:31327,15119492:31328,15120007:31329,15119791:31330,15120022:31331,15120044:31332,15120271:31333,15120312:31334,15120306:31335,15120316:31336,15120569:31337,15120796:31338,15120551:31339,15120572:31340,15121087:31341,15122056:31342,15122101:31343,15122357:31344,15171717:31345,15171719:31346,15171752:31347,15172229:31348,15172267:31349,15172751:31350,15172740:31351,15173020:31352,15172998:31353,15172999:31354,15706261:31355,15173505:31356,15173566:31357,15174321:31358,15174334:31521,15174820:31522,15706262:31523,15175095:31524,15175357:31525,15175561:31526,15175574:31527,15175587:31528,15175570:31529,15175815:31530,15175605:31531,15175846:31532,15175850:31533,15175849:31534,15175854:31535,15176098:31536,15176329:31537,15176351:31538,15176833:31539,15177135:31540,15178370:31541,15178396:31542,15178398:31543,15178395:31544,15178406:31545,15706263:31546,15179142:31547,15043247:31548,15179937:31549,15180174:31550,15180196:31551,15180218:31552,15180976:31553,15706264:31554,15706265:31555,15706266:31556,15181460:31557,15706267:31558,15181467:31559,15182737:31560,15182759:31561,15706268:31562,15182763:31563,15183518:31564,15706269:31565,15185288:31566,15185308:31567,15185591:31568,15185568:31569,15185814:31570,15186322:31571,15187335:31572,15187617:31573,15706270:31574,15240321:31575,15240610:31576,15240639:31577,15241095:31578,15241142:31579,15241608:31580,15241908:31581,15242643:31582,15242649:31583,15242667:31584,15706271:31585,15242928:31586,15706272:31587,15706273:31588,15245447:31589,15246261:31590,15247506:31591,15247543:31592,15247801:31593,15248039:31594,15248062:31595,15248287:31596,15706274:31597,15248310:31598,15248787:31599,15248831:31600,15250352:31601,15250356:31602,15250578:31603,15250870:31604,15706275:31605,15252367:31606,15706276:31607,15706277:31608,15303079:31609,15303582:31610,15706278:31611,15303829:31612,15303847:31613,15304602:31614,15304599:31777,15304606:31778,15304621:31779,15304622:31780,15304612:31781,15304613:31782,15304838:31783,15304848:31784,15304842:31785,15304890:31786,15305088:31787,15304892:31788,15305102:31789,15305113:31790,15305105:31791,15304889:31792,15305127:31793,15305383:31794,15305143:31795,15305144:31796,15305639:31797,15305623:31798,15305625:31799,15305616:31800,15706279:31801,15305621:31802,15305632:31803,15305619:31804,15305893:31805,15305889:31806,15305659:31807,15706280:31808,15305886:31809,15305663:31810,15305885:31811,15305858:31812,15306160:31813,15306135:31814,15306404:31815,15306630:31816,15306654:31817,15306680:31818,15306929:31819,15307141:31820,15307144:31821,15308434:31822,15706012:31823,15706281:31824,15309469:31825,15309487:31826,15310003:31827,15310011:31828,15310211:31829,15310221:31830,15310223:31831,15310225:31832,15310229:31833,15311255:31834,15311269:31835,15706282:31836,15706283:31837,15312039:31838,15706284:31839,15312542:31840,15313294:31841,15313817:31842,15313820:31843,15314357:31844,15314354:31845,15314575:31846,15314609:31847,15314619:31848,15315072:31849,15316400:31850,15316395:31851,15706285:31852,15317145:31853,15317905:31854,14845360:31857,14845361:31858,14845362:31859,14845363:31860,14845364:31861,14845365:31862,14845366:31863,14845367:31864,14845368:31865,14845369:31866,15712164:31868,15711367:31869,15711362:31870,14846117:8514,15712162:8780,14846098:74077},es={52120:8751,52103:8752,49848:8753,52121:8754,52125:8755,49839:8756,52123:8757,52122:8758,126:8759,52868:8760,52869:8761,49825:8770,49830:8771,49855:8772,49850:8811,49834:8812,49833:8813,49838:8814,14845090:8815,49828:8816,14845078:8817,52870:9825,52872:9826,52873:9827,52874:9828,52906:9829,52876:9831,52878:9833,52907:9834,52879:9836,52908:9841,52909:9842,52910:9843,52911:9844,53130:9845,52880:9846,53132:9847,53122:9848,53133:9849,53131:9850,52912:9851,53134:9852,53378:10050,53379:10051,53380:10052,53381:10053,53382:10054,53383:10055,53384:10056,53385:10057,53386:10058,53387:10059,53388:10060,53390:10061,53391:10062,53650:10098,53651:10099,53652:10100,53653:10101,53654:10102,53655:10103,53656:10104,53657:10105,53658:10106,53659:10107,53660:10108,53662:10109,53663:10110,50054:10529,50320:10530,50342:10532,50354:10534,50561:10536,50367:10537,50570:10539,50072:10540,50578:10541,50598:10543,50078:10544,50086:10561,50321:10562,50096:10563,50343:10564,50353:10565,50355:10566,50360:10567,50562:10568,50560:10569,50569:10570,50571:10571,50104:10572,50579:10573,50079:10574,50599:10575,50110:10576,50049:10785,50048:10786,50052:10787,50050:10788,50306:10789,51085:10790,50304:10791,50308:10792,50053:10793,50051:10794,50310:10795,50312:10796,50316:10797,50055:10798,50314:10799,50318:10800,50057:10801,50056:10802,50059:10803,50058:10804,50330:10805,50326:10806,50322:10807,50328:10808,50332:10810,50334:10811,50338:10812,50336:10813,50340:10814,50061:10815,50060:10816,50063:10817,50062:10818,51087:10819,50352:10820,50346:10821,50350:10822,50344:10823,50356:10824,50358:10825,50361:10826,50365:10827,50363:10828,50563:10829,50567:10830,50565:10831,50065:10832,50067:10833,50066:10834,50070:10835,50068:10836,51089:10837,50576:10838,50572:10839,50069:10840,50580:10841,50584:10842,50582:10843,50586:10844,50588:10845,50592:10846,50590:10847,50596:10848,50594:10849,50074:10850,50073:10851,50076:10852,50075:10853,50604:10854,51091:10855,50608:10856,50602:10857,50610:10858,50606:10859,50600:10860,51095:10861,51099:10862,51097:10863,51093:10864,50612:10865,50077:10866,50616:10867,50614:10868,50617:10869,50621:10870,50619:10871,50081:11041,50080:11042,50084:11043,50082:11044,50307:11045,51086:11046,50305:11047,50309:11048,50085:11049,50083:11050,50311:11051,50313:11052,50317:11053,50087:11054,50315:11055,50319:11056,50089:11057,50088:11058,50091:11059,50090:11060,50331:11061,50327:11062,50323:11063,50329:11064,51125:11065,50333:11066,50335:11067,50337:11069,50341:11070,50093:11071,50092:11072,50095:11073,50094:11074,51088:11075,50347:11077,50351:11078,50345:11079,50357:11080,50359:11081,50362:11082,50366:11083,50364:11084,50564:11085,50568:11086,50566:11087,50097:11088,50099:11089,50098:11090,50102:11091,50100:11092,51090:11093,50577:11094,50573:11095,50101:11096,50581:11097,50585:11098,50583:11099,50587:11100,50589:11101,50593:11102,50591:11103,50597:11104,50595:11105,50106:11106,50105:11107,50108:11108,50107:11109,50605:11110,51092:11111,50609:11112,50603:11113,50611:11114,50607:11115,50601:11116,51096:11117,51100:11118,51098:11119,51094:11120,50613:11121,50109:11122,50111:11123,50615:11124,50618:11125,50622:11126,50620:11127,14989442:12321,14989444:12322,14989445:12323,14989452:12324,14989458:12325,14989471:12326,14989475:12327,14989476:12328,14989480:12329,14989483:12330,14989486:12331,14989487:12332,14989488:12333,14989493:12334,14989696:12335,14989697:12336,14989700:12337,14989703:12338,14989713:12339,14989722:12340,14989724:12341,14989731:12342,14989736:12343,14989737:12344,14989748:12345,14989749:12346,14989753:12347,14989759:12348,14989965:12349,14989974:12350,14989975:12351,14989981:12352,14989999:12353,14990009:12354,14990211:12355,14990224:12356,14990234:12357,14990235:12358,14990240:12359,14990241:12360,14990242:12361,14990248:12362,14990255:12363,14990257:12364,14990259:12365,14990261:12366,14990269:12367,14990270:12368,14990271:12369,14990464:12370,14990466:12371,14990467:12372,14990472:12373,14990475:12374,14990476:12375,14990482:12376,14990485:12377,14990486:12378,14990487:12379,14990489:12380,14990510:12381,14990513:12382,14990752:12383,14990515:12384,14990517:12385,14990519:12386,14990521:12387,14990523:12388,14990526:12389,14990720:12390,14990722:12391,14990728:12392,14990729:12393,14990731:12394,14990732:12395,14990738:12396,14990740:12397,14990742:12398,14990744:12399,14990751:12400,14990755:12401,14990762:12402,14990764:12403,14990766:12404,14990769:12405,14990775:12406,14990776:12407,14990777:12408,14990778:12409,14990781:12410,14990782:12411,14990977:12412,14990978:12413,14990980:12414,14990981:12577,14990985:12578,14990986:12579,14990988:12580,14990990:12581,14990992:12582,14990994:12583,14990995:12584,14990996:12585,14990999:12586,14991001:12587,14991002:12588,14991006:12589,14991007:12590,14991026:12591,14991031:12592,14991033:12593,14991035:12594,14991036:12595,14991037:12596,14991038:12597,14991232:12598,14991233:12599,14991237:12600,14991238:12601,14991240:12602,14991241:12603,14991243:12604,14991244:12605,14991245:12606,14991247:12607,14991250:12608,14991260:12609,14991264:12610,14991266:12611,14991280:12612,14991282:12613,14991292:12614,14991293:12615,14991295:12616,15040640:12617,15040641:12618,15040644:12619,15040647:12620,15040650:12621,15040652:12622,15040654:12623,15040656:12624,15040659:12625,15040663:12626,15040664:12627,15040667:12628,15040668:12629,15040669:12630,15040670:12631,15040674:12632,15040679:12633,15040686:12634,15040688:12635,15040690:12636,15040691:12637,15040693:12638,15040896:12639,15040897:12640,15040898:12641,15040901:12642,15040902:12643,15040906:12644,15040908:12645,15040910:12646,15040913:12647,15040914:12648,15040915:12649,15040919:12650,15040921:12651,15040927:12652,15040928:12653,15040930:12654,15040931:12655,15040934:12656,15040935:12657,15040938:12658,15040941:12659,15040944:12660,15040945:12661,15040699:12662,15041153:12663,15041155:12664,15041156:12665,15041158:12666,15041162:12667,15041166:12668,15041167:12669,15041168:12670,15041170:12833,15041171:12834,15041172:12835,15041174:12836,15041179:12837,15041180:12838,15041182:12839,15041183:12840,15041184:12841,15041185:12842,15041186:12843,15041194:12844,15041199:12845,15041200:12846,15041209:12847,15041210:12848,15041213:12849,15041408:12850,15041411:12851,15041412:12852,15041415:12853,15041420:12854,15041422:12855,15041424:12856,15041427:12857,15041428:12858,15041432:12859,15041436:12860,15041437:12861,15041439:12862,15041442:12863,15041444:12864,15041446:12865,15041448:12866,15041449:12867,15041455:12868,15041457:12869,15041462:12870,15041466:12871,15041470:12872,15041667:12873,15041670:12874,15041671:12875,15041672:12876,15041675:12877,15041676:12878,15041677:12879,15041678:12880,15041458:12881,15041680:12882,15041687:12883,15041689:12884,15041691:12885,15041692:12886,15041693:12887,15041694:12888,15041699:12889,15041703:12890,15041704:12891,15041708:12892,15041709:12893,15041711:12894,15041713:12895,15041715:12896,15041716:12897,15041717:12898,15041720:12899,15041721:12900,15041922:12901,15041930:12902,15041935:12903,15041939:12904,15041941:12905,15041943:12906,15041944:12907,15041951:12908,15041956:12909,15041958:12910,15041982:12911,15042179:12912,15042180:12913,15042187:12914,15042190:12915,15042200:12916,15042205:12917,15042209:12918,15042211:12919,15042221:12920,15042232:12921,15042234:12922,15042236:12923,15042238:12924,15042239:12925,15042434:12926,15042440:13089,15042447:13090,15042449:13091,15042450:13092,15042451:13093,15042453:13094,15042456:13095,15042462:13096,15042466:13097,15042469:13098,15042478:13099,15042482:13100,15042483:13101,15042484:13102,15042487:13103,15042689:13104,15042690:13105,15042693:13106,15042706:13107,15042707:13108,15042709:13109,15042710:13110,15042712:13111,15042722:13112,15042728:13113,15042737:13114,15042738:13115,15042741:13116,15042748:13117,15042949:13118,15042953:13119,15042965:13120,15042967:13121,15042968:13122,15042970:13123,15042972:13124,15042975:13125,15042976:13126,15042977:13127,15042982:13128,15042990:13129,15042999:13130,15043e3:13131,15043001:13132,15043200:13133,15043202:13134,15043205:13135,15043210:13136,15043212:13137,15043219:13138,15043221:13139,15043222:13140,15043223:13141,15043224:13142,15043226:13143,15043228:13144,15043236:13145,15043237:13146,15043238:13147,15043239:13148,15043247:13149,15043248:13150,15043254:13151,15043255:13152,15043256:13153,15043258:13154,15043259:13155,15043261:13156,15043456:13157,15043460:13158,15043462:13159,15043464:13160,15043468:13161,15043471:13162,15043473:13163,15043476:13164,15043478:13165,15043483:13166,15043484:13167,15043489:13168,15043493:13169,15043496:13170,15043497:13171,15043498:13172,15043500:13173,15043504:13174,15043505:13175,15043508:13176,15043510:13177,15043511:13178,15043712:13179,15043715:13180,15043722:13181,15043723:13182,15043724:13345,15043729:13346,15043731:13347,15043736:13348,15043739:13349,15043740:13350,15043742:13351,15043743:13352,15043749:13353,15043751:13354,15043752:13355,15043753:13356,15043755:13357,15043756:13358,15043757:13359,15043760:13360,15043762:13361,15043765:13362,15043772:13363,15043773:13364,15043774:13365,15043970:13366,15043980:13367,15043979:13368,15043993:13369,15043995:13370,15044001:13371,15044003:13372,15044005:13373,15044012:13374,15044013:13375,15044018:13376,15044025:13377,15044030:13378,15044227:13379,15044231:13380,15044232:13381,15044238:13382,15044243:13383,15044244:13384,15044249:13385,15044253:13386,15044257:13387,15044260:13388,15044266:13389,15044267:13390,15044271:13391,15044274:13392,15044276:13393,15044277:13394,15044279:13395,15044280:13396,15044282:13397,15044285:13398,15044480:13399,15044485:13400,15044495:13401,15044498:13402,15044499:13403,15044501:13404,15044506:13405,15044509:13406,15044510:13407,15044512:13408,15044518:13409,15044519:13410,15044533:13411,15044738:13412,15044755:13413,15044762:13414,15044769:13415,15044775:13416,15044776:13417,15044778:13418,15044783:13419,15044785:13420,15044788:13421,15044789:13422,15044995:13423,15044996:13424,15044999:13425,15045005:13426,15045007:13427,15045022:13428,15045026:13429,15045028:13430,15045030:13431,15045031:13432,15045033:13433,15045035:13434,15045037:13435,15045038:13436,15045044:13437,15045055:13438,15045249:13601,15045251:13602,15045253:13603,15045256:13604,15045257:13605,15045261:13606,15045265:13607,15045269:13608,15045270:13609,15045276:13610,15045279:13611,15045281:13612,15045286:13613,15045287:13614,15045289:13615,15045290:13616,15045293:13617,15045294:13618,15045297:13619,15045303:13620,15045305:13621,15045306:13622,15045307:13623,15045311:13624,15045510:13625,15045514:13626,15045517:13627,15045518:13628,15045536:13629,15045546:13630,15045548:13631,15045551:13632,15045558:13633,15045564:13634,15045566:13635,15045567:13636,15045760:13637,15045761:13638,15045765:13639,15045768:13640,15045769:13641,15045772:13642,15045773:13643,15045774:13644,15045781:13645,15045802:13646,15045803:13647,15045810:13648,15045813:13649,15045814:13650,15045819:13651,15045820:13652,15045821:13653,15046017:13654,15046023:13655,15046025:13656,15046026:13657,15046029:13658,15046032:13659,15046033:13660,15046040:13661,15046042:13662,15046043:13663,15046046:13664,15046048:13665,15046049:13666,15046052:13667,15046054:13668,15046079:13669,15046273:13670,15046274:13671,15046278:13672,15046280:13673,15046286:13674,15046287:13675,15046289:13676,15046290:13677,15046291:13678,15046292:13679,15046295:13680,15046307:13681,15046308:13682,15046317:13683,15046322:13684,15046335:13685,15046529:13686,15046531:13687,15046534:13688,15046537:13689,15046539:13690,15046540:13691,15046542:13692,15046545:13693,15046546:13694,15046547:13857,15046551:13858,15046552:13859,15046555:13860,15046558:13861,15046562:13862,15046569:13863,15046582:13864,15046591:13865,15046789:13866,15046792:13867,15046794:13868,15046797:13869,15046798:13870,15046799:13871,15046800:13872,15046801:13873,15046802:13874,15046809:13875,15046828:13876,15046832:13877,15046835:13878,15046837:13879,15046839:13880,15046841:13881,15046843:13882,15046844:13883,15046845:13884,15046847:13885,15047040:13886,15047041:13887,15047043:13888,15047044:13889,15047046:13890,15047049:13891,15047051:13892,15047053:13893,15047055:13894,15047060:13895,15047070:13896,15047072:13897,15047073:13898,15047074:13899,15047075:13900,15047078:13901,15047081:13902,15047085:13903,15047087:13904,15047089:13905,15047090:13906,15047093:13907,15047300:13908,15047301:13909,15047304:13910,15047307:13911,15047308:13912,15047317:13913,15047321:13914,15047322:13915,15047325:13916,15047326:13917,15047327:13918,15047334:13919,15047335:13920,15047336:13921,15047337:13922,15047339:13923,15047340:13924,15047341:13925,15047345:13926,15047347:13927,15047351:13928,15047358:13929,15047557:13930,15047561:13931,15047562:13932,15047563:13933,15047567:13934,15047568:13935,15047564:13936,15047565:13937,15047577:13938,15047580:13939,15047581:13940,15047583:13941,15047585:13942,15047588:13943,15047589:13944,15047590:13945,15047591:13946,15047592:13947,15047601:13948,15047595:13949,15047597:13950,15047606:14113,15047607:14114,15047809:14115,15047810:14116,15047815:14117,15047818:14118,15047820:14119,15047825:14120,15047829:14121,15047834:14122,15047835:14123,15047837:14124,15047840:14125,15047842:14126,15047843:14127,15047844:14128,15047845:14129,15047849:14130,15047850:14131,15047852:14132,15047854:14133,15047855:14134,15047859:14135,15047860:14136,15047869:14137,15047870:14138,15047871:14139,15048069:14140,15048070:14141,15048076:14142,15048077:14143,15048082:14144,15048098:14145,15048101:14146,15048103:14147,15048104:14148,15048107:14149,15048109:14150,15048110:14151,15048111:14152,15048112:14153,15048113:14154,15048115:14155,15048116:14156,15048117:14157,15048119:14158,15048121:14159,15048122:14160,15048123:14161,15048124:14162,15048126:14163,15048321:14164,15048323:14165,15048332:14166,15048340:14167,15048343:14168,15048345:14169,15048346:14170,15048348:14171,15048349:14172,15048350:14173,15048351:14174,15048353:14175,15048341:14176,15048359:14177,15048360:14178,15048361:14179,15048364:14180,15048376:14181,15048381:14182,15048583:14183,15048584:14184,15048588:14185,15048591:14186,15048597:14187,15048605:14188,15048606:14189,15048612:14190,15048614:14191,15048615:14192,15048617:14193,15048621:14194,15048624:14195,15048629:14196,15048630:14197,15048632:14198,15048637:14199,15048638:14200,15048639:14201,15048835:14202,15048836:14203,15048840:14204,15048841:14205,15048609:14206,15048844:14369,15048845:14370,15048859:14371,15048862:14372,15048863:14373,15048864:14374,15048870:14375,15048871:14376,15048877:14377,15048882:14378,15048889:14379,15048895:14380,15049097:14381,15049100:14382,15049101:14383,15049103:14384,15049104:14385,15049109:14386,15049119:14387,15049121:14388,15049124:14389,15049127:14390,15049128:14391,15049144:14392,15049148:14393,15049151:14394,15049344:14395,15049345:14396,15049351:14397,15049352:14398,15049353:14399,15049354:14400,15049356:14401,15049357:14402,15049359:14403,15049360:14404,15049364:14405,15049366:14406,15049373:14407,15049376:14408,15049377:14409,15049378:14410,15049382:14411,15049385:14412,15049393:14413,15049394:14414,15049604:14415,15049404:14416,15049602:14417,15049608:14418,15049613:14419,15049614:14420,15049616:14421,15049618:14422,15049620:14423,15049622:14424,15049626:14425,15049629:14426,15049633:14427,15049634:14428,15049641:14429,15049651:14430,15049861:14431,15049862:14432,15049867:14433,15049868:14434,15049874:14435,15049875:14436,15049876:14437,15243649:14438,15049885:14439,15049889:14440,15049891:14441,15049892:14442,15049896:14443,15049903:14444,15049904:14445,15049907:14446,15049909:14447,15049910:14448,15049919:14449,15050115:14450,15050118:14451,15050130:14452,15050131:14453,15050137:14454,15050139:14455,15050141:14456,15050142:14457,15050143:14458,15050145:14459,15050147:14460,15050155:14461,15050157:14462,15050159:14625,15050162:14626,15050165:14627,15050166:14628,15050169:14629,15050171:14630,15050172:14631,15050379:14632,15050380:14633,15050382:14634,15050386:14635,15050389:14636,15050391:14637,15050399:14638,15050404:14639,15050407:14640,15050413:14641,15050414:14642,15050415:14643,15050416:14644,15050419:14645,15050423:14646,15050426:14647,15050428:14648,15050625:14649,15050627:14650,15050628:14651,15050632:14652,15050634:14653,15050637:14654,15050642:14655,15050653:14656,15050654:14657,15050655:14658,15050659:14659,15050660:14660,15050663:14661,15050670:14662,15050671:14663,15050673:14664,15050674:14665,15050676:14666,15050679:14667,15050880:14668,15050884:14669,15050892:14670,15050893:14671,15050894:14672,15050898:14673,15050899:14674,15050910:14675,15050915:14676,15050916:14677,15050919:14678,15050920:14679,15050922:14680,15050925:14681,15050928:14682,15051140:14683,15051141:14684,15051143:14685,15051144:14686,15051148:14687,15051152:14688,15051157:14689,15051166:14690,15051171:14691,15051173:14692,15051175:14693,15051181:14694,15051191:14695,15051194:14696,15051195:14697,15051198:14698,15051403:14699,15051408:14700,15051411:14701,15051414:14702,15051417:14703,15051420:14704,15051422:14705,15051423:14706,15051424:14707,15051426:14708,15051431:14709,15051436:14710,15051441:14711,15051442:14712,15051443:14713,15051445:14714,15051448:14715,15051450:14716,15051451:14717,15051455:14718,15051652:14881,15051654:14882,15051656:14883,15051663:14884,15051674:14885,15051676:14886,15051680:14887,15051685:14888,15051690:14889,15051694:14890,15051701:14891,15051702:14892,15051709:14893,15051904:14894,15051905:14895,15051912:14896,15051927:14897,15051956:14898,15051929:14899,15051931:14900,15051933:14901,15051937:14902,15051941:14903,15051949:14904,15051960:14905,15052161:14906,15052171:14907,15052172:14908,15052178:14909,15052182:14910,15052190:14911,15052200:14912,15052206:14913,15052207:14914,15052220:14915,15052221:14916,15052222:14917,15052223:14918,15052417:14919,15052420:14920,15052422:14921,15052426:14922,15052430:14923,15052432:14924,15052433:14925,15052435:14926,15052436:14927,15052438:14928,15052456:14929,15052457:14930,15052460:14931,15052461:14932,15052463:14933,15052465:14934,15052466:14935,15052471:14936,15052474:14937,15052476:14938,15052672:14939,15052673:14940,15052685:14941,15052687:14942,15052694:14943,15052695:14944,15052696:14945,15052697:14946,15052698:14947,15052704:14948,15052719:14949,15052721:14950,15052724:14951,15052733:14952,15052940:14953,15052951:14954,15052958:14955,15052959:14956,15052963:14957,15052966:14958,15052969:14959,15052971:14960,15052972:14961,15052974:14962,15052976:14963,15052978:14964,15052981:14965,15052982:14966,15053209:14967,15053210:14968,15053212:14969,15053218:14970,15053219:14971,15053223:14972,15053224:14973,15053225:14974,15053229:15137,15053232:15138,15053236:15139,15053237:15140,15053242:15141,15053243:15142,15053244:15143,15053245:15144,15053447:15145,15053448:15146,15053450:15147,15053455:15148,15053458:15149,15053469:15150,15053471:15151,15053472:15152,15053474:15153,15053475:15154,15053478:15155,15053482:15156,15053490:15157,15053492:15158,15053493:15159,15053498:15160,15053705:15161,15053707:15162,15053714:15163,15053725:15164,15053719:15165,15053742:15166,15053745:15167,15053746:15168,15053748:15169,15053953:15170,15053958:15171,15053965:15172,15053970:15173,15053995:15174,15053987:15175,15053988:15176,15053990:15177,15053991:15178,15054001:15179,15054004:15180,15054009:15181,15054013:15182,15054015:15183,15054210:15184,15054211:15185,15054214:15186,15054216:15187,15054229:15188,15054225:15189,15054233:15190,15054218:15191,15054239:15192,15054240:15193,15054241:15194,15054242:15195,15054244:15196,15054250:15197,15054253:15198,15054256:15199,15054265:15200,15054266:15201,15054270:15202,15054271:15203,15054465:15204,15054467:15205,15054472:15206,15054474:15207,15054482:15208,15054483:15209,15054484:15210,15054485:15211,15054489:15212,15054491:15213,15054495:15214,15054496:15215,15054503:15216,15054507:15217,15054512:15218,15054516:15219,15054520:15220,15054521:15221,15054723:15222,15054727:15223,15054731:15224,15054736:15225,15054734:15226,15054744:15227,15054745:15228,15054752:15229,15054756:15230,15054761:15393,15054776:15394,15054777:15395,15054976:15396,15054983:15397,15054989:15398,15054994:15399,15054996:15400,15054997:15401,15055e3:15402,15055007:15403,15055008:15404,15055022:15405,15055016:15406,15055026:15407,15055029:15408,15055038:15409,15055243:15410,15055248:15411,15055241:15412,15055249:15413,15055254:15414,15055256:15415,15055259:15416,15055260:15417,15055262:15418,15055272:15419,15055274:15420,15055275:15421,15055276:15422,15055277:15423,15055278:15424,15055280:15425,15055488:15426,15055499:15427,15055502:15428,15055522:15429,15055524:15430,15055525:15431,15055528:15432,15055530:15433,15055532:15434,15055537:15435,15055539:15436,15055549:15437,15055550:15438,15055551:15439,15055750:15440,15055756:15441,15055755:15442,15055758:15443,15055761:15444,15055762:15445,15055764:15446,15055765:15447,15055772:15448,15055774:15449,15055781:15450,15055787:15451,15056002:15452,15056006:15453,15056007:15454,15056008:15455,15056014:15456,15056025:15457,15056028:15458,15056029:15459,15056033:15460,15056034:15461,15056035:15462,15056036:15463,15056040:15464,15056043:15465,15056044:15466,15056046:15467,15056048:15468,15056052:15469,15056054:15470,15056059:15471,15056061:15472,15056063:15473,15056256:15474,15056260:15475,15056261:15476,15056263:15477,15056269:15478,15056272:15479,15056276:15480,15056280:15481,15056283:15482,15056288:15483,15056291:15484,15056292:15485,15056295:15486,15056303:15649,15056306:15650,15056308:15651,15056309:15652,15056312:15653,15056314:15654,15056317:15655,15056318:15656,15056521:15657,15056525:15658,15056527:15659,15056534:15660,15056540:15661,15056541:15662,15056546:15663,15056551:15664,15056555:15665,15056548:15666,15056556:15667,15056559:15668,15056560:15669,15056561:15670,15056568:15671,15056772:15672,15056775:15673,15056776:15674,15056777:15675,15056779:15676,15056784:15677,15056785:15678,15056786:15679,15056787:15680,15056788:15681,15056798:15682,15056801:15683,15056802:15684,15056808:15685,15056809:15686,15056810:15687,15056812:15688,15056813:15689,15056814:15690,15056815:15691,15056818:15692,15056819:15693,15056822:15694,15056826:15695,15056828:15696,15106183:15697,15106186:15698,15106189:15699,15106195:15700,15106196:15701,15106199:15702,15106200:15703,15106202:15704,15106207:15705,15106212:15706,15106221:15707,15106227:15708,15106229:15709,15106432:15710,15106439:15711,15106440:15712,15106441:15713,15106444:15714,15106449:15715,15106452:15716,15106454:15717,15106455:15718,15106461:15719,15106465:15720,15106471:15721,15106481:15722,15106494:15723,15106495:15724,15106690:15725,15106694:15726,15106696:15727,15106698:15728,15106702:15729,15106705:15730,15106707:15731,15106709:15732,15106712:15733,15106717:15734,15106718:15735,15106722:15736,15106724:15737,15106725:15738,15106728:15739,15106736:15740,15106737:15741,15106743:15742,15106747:15905,15106750:15906,15106946:15907,15106948:15908,15106952:15909,15106953:15910,15106954:15911,15106955:15912,15106958:15913,15106959:15914,15106964:15915,15106965:15916,15106969:15917,15106971:15918,15106973:15919,15106974:15920,15106978:15921,15106981:15922,15106994:15923,15106997:15924,15107e3:15925,15107004:15926,15107005:15927,15107202:15928,15107207:15929,15107210:15930,15107212:15931,15107216:15932,15107217:15933,15107218:15934,15107219:15935,15107220:15936,15107222:15937,15107223:15938,15107225:15939,15107228:15940,15107230:15941,15107234:15942,15107242:15943,15107243:15944,15107248:15945,15107249:15946,15107253:15947,15107254:15948,15107255:15949,15107257:15950,15107457:15951,15107461:15952,15107462:15953,15107465:15954,15107486:15955,15107488:15956,15107500:15957,15107506:15958,15107512:15959,15107515:15960,15107516:15961,15107519:15962,15107712:15963,15107713:15964,15107715:15965,15107716:15966,15107723:15967,15107725:15968,15107730:15969,15107731:15970,15107735:15971,15107736:15972,15107740:15973,15107741:15974,15107743:15975,15107744:15976,15107749:15977,15107752:15978,15107754:15979,15107757:15980,15107768:15981,15107769:15982,15107772:15983,15107968:15984,15107969:15985,15107970:15986,15107982:15987,15107983:15988,15107989:15989,15107996:15990,15107997:15991,15107998:15992,15107999:15993,15108001:15994,15108002:15995,15108007:15996,15108009:15997,15108005:15998,15108012:16161,15108013:16162,15108015:16163,15108225:16164,15108227:16165,15108228:16166,15108231:16167,15108243:16168,15108245:16169,15108252:16170,15108256:16171,15108258:16172,15108259:16173,15108263:16174,15108265:16175,15108267:16176,15108281:16177,15108285:16178,15108482:16179,15108483:16180,15108484:16181,15108486:16182,15108492:16183,15108496:16184,15108497:16185,15108498:16186,15108500:16187,15108502:16188,15108506:16189,15108508:16190,15108516:16191,15108525:16192,15108527:16193,15108531:16194,15108538:16195,15108541:16196,15108749:16197,15108750:16198,15108751:16199,15108752:16200,15108774:16201,15108776:16202,15108787:16203,15108790:16204,15108791:16205,15108794:16206,15108798:16207,15108799:16208,15108996:16209,15109006:16210,15109013:16211,15109014:16212,15109018:16213,15109034:16214,15109042:16215,15109044:16216,15109052:16217,15109053:16218,15109251:16219,15109252:16220,15109258:16221,15109259:16222,15109261:16223,15109264:16224,15109267:16225,15109270:16226,15109272:16227,15109289:16228,15109290:16229,15109293:16230,15109301:16231,15109302:16232,15109305:16233,15109308:16234,15109505:16235,15109506:16236,15109507:16237,15109508:16238,15109510:16239,15109514:16240,15109515:16241,15109518:16242,15109522:16243,15109523:16244,15109524:16245,15109528:16246,15109531:16247,15109541:16248,15109542:16249,15109548:16250,15109549:16251,15109553:16252,15109556:16253,15109557:16254,15109560:16417,15109564:16418,15109565:16419,15109567:16420,15109762:16421,15109764:16422,15109767:16423,15109770:16424,15109776:16425,15109780:16426,15109781:16427,15109785:16428,15109786:16429,15109790:16430,15109796:16431,15109798:16432,15109805:16433,15109806:16434,15109807:16435,15109821:16436,15110017:16437,15110021:16438,15110024:16439,15110030:16440,15110033:16441,15110035:16442,15110036:16443,15110037:16444,15110044:16445,15110048:16446,15110053:16447,15110058:16448,15110060:16449,15110066:16450,15110067:16451,15110069:16452,15110072:16453,15110073:16454,15110281:16455,15110282:16456,15110288:16457,15110290:16458,15110292:16459,15110296:16460,15110302:16461,15110304:16462,15110306:16463,15110308:16464,15110309:16465,15110313:16466,15110314:16467,15110319:16468,15110320:16469,15110325:16470,15110333:16471,15110335:16472,15110539:16473,15110543:16474,15110545:16475,15110546:16476,15110547:16477,15110548:16478,15110554:16479,15110555:16480,15110556:16481,15110557:16482,15110559:16483,15110560:16484,15110561:16485,15110563:16486,15110573:16487,15110579:16488,15110580:16489,15110587:16490,15110589:16491,15110789:16492,15110791:16493,15110799:16494,15110800:16495,15110801:16496,15110808:16497,15110809:16498,15110811:16499,15110813:16500,15110815:16501,15110817:16502,15110819:16503,15110822:16504,15110824:16505,15110828:16506,15110835:16507,15110845:16508,15110846:16509,15110847:16510,15111044:16673,15111049:16674,15111050:16675,15111051:16676,15111052:16677,15111054:16678,15111056:16679,15111057:16680,15111061:16681,15111063:16682,15111076:16683,15111077:16684,15111081:16685,15111082:16686,15111085:16687,15111088:16688,15111093:16689,15111095:16690,15111099:16691,15111103:16692,15111297:16693,15111300:16694,15111304:16695,15111305:16696,15111306:16697,15111311:16698,15111315:16699,15111316:16700,15111318:16701,15111321:16702,15111323:16703,15111326:16704,15111327:16705,15111330:16706,15111334:16707,15111337:16708,15111342:16709,15111345:16710,15111354:16711,15111356:16712,15111357:16713,15111555:16714,15111559:16715,15111561:16716,15111568:16717,15111570:16718,15111572:16719,15111583:16720,15111584:16721,15111591:16722,15111595:16723,15111610:16724,15111613:16725,15111809:16726,15111813:16727,15111818:16728,15111826:16729,15111829:16730,15111832:16731,15111837:16732,15111840:16733,15111843:16734,15111846:16735,15111854:16736,15111858:16737,15111859:16738,15111860:16739,15111871:16740,15112066:16741,15112072:16742,15112073:16743,15112078:16744,15112080:16745,15112084:16746,15112086:16747,15112088:16748,15112095:16749,15112112:16750,15112114:16751,15112116:16752,15112117:16753,15112121:16754,15112126:16755,15112127:16756,15112320:16757,15112324:16758,15112328:16759,15112329:16760,15112333:16761,15112337:16762,15112338:16763,15112341:16764,15112342:16765,15112349:16766,15112350:16929,15112353:16930,15112354:16931,15112355:16932,15112356:16933,15112358:16934,15112361:16935,15112362:16936,15112363:16937,15112364:16938,15112366:16939,15112368:16940,15112369:16941,15112371:16942,15112377:16943,15112375:16944,15112576:16945,15112581:16946,15112582:16947,15112586:16948,15112588:16949,15112593:16950,15112590:16951,15112599:16952,15112600:16953,15112601:16954,15112603:16955,15112604:16956,15112608:16957,15112609:16958,15113147:16959,15112618:16960,15112619:16961,15112620:16962,15112638:16963,15112627:16964,15112629:16965,15112639:16966,15112631:16967,15112632:16968,15112633:16969,15112635:16970,15112832:16971,15112636:16972,15112843:16973,15112844:16974,15112845:16975,15112848:16976,15112850:16977,15112857:16978,15112858:16979,15112859:16980,15112860:16981,15112863:16982,15112864:16983,15112868:16984,15112877:16985,15112881:16986,15112882:16987,15112885:16988,15112891:16989,15112895:16990,15113088:16991,15113090:16992,15113091:16993,15113096:16994,15113100:16995,15113102:16996,15113103:16997,15113108:16998,15113115:16999,15113119:17e3,15113128:17001,15113131:17002,15113132:17003,15113134:17004,15113146:17005,15113349:17006,15113351:17007,15113358:17008,15113363:17009,15113369:17010,15113372:17011,15113376:17012,15113378:17013,15113395:17014,15113406:17015,15113605:17016,15113607:17017,15113608:17018,15113612:17019,15113620:17020,15113621:17021,15113629:17022,15113638:17185,15113644:17186,15113646:17187,15113652:17188,15113654:17189,15113659:17190,15113857:17191,15113860:17192,15113870:17193,15113871:17194,15113873:17195,15113875:17196,15113878:17197,15113880:17198,15113881:17199,15113883:17200,15113904:17201,15113905:17202,15113906:17203,15113909:17204,15113915:17205,15113916:17206,15113917:17207,15114169:17208,15114112:17209,15114114:17210,15114115:17211,15114117:17212,15114120:17213,15114121:17214,15114130:17215,15114135:17216,15114137:17217,15114140:17218,15114145:17219,15114150:17220,15114160:17221,15114162:17222,15114166:17223,15114167:17224,15114642:17225,15114388:17226,15114393:17227,15114397:17228,15114399:17229,15114408:17230,15114407:17231,15114412:17232,15114413:17233,15114415:17234,15114416:17235,15114417:17236,15114419:17237,15114427:17238,15114431:17239,15114628:17240,15114629:17241,15114634:17242,15114636:17243,15114645:17244,15114647:17245,15114648:17246,15114651:17247,15114667:17248,15114670:17249,15114671:17250,15114672:17251,15114673:17252,15114674:17253,15114677:17254,15114681:17255,15114682:17256,15114683:17257,15114684:17258,15114882:17259,15114884:17260,15114886:17261,15114888:17262,15114902:17263,15114904:17264,15114906:17265,15114908:17266,15114913:17267,15114915:17268,15114917:17269,15114921:17270,15114922:17271,15114926:17272,15114930:17273,15114939:17274,15115141:17275,15115144:17276,15115148:17277,15115151:17278,15115152:17441,15115153:17442,15115155:17443,15115158:17444,15115161:17445,15115164:17446,15115165:17447,15115173:17448,15115176:17449,15115178:17450,15115179:17451,15115180:17452,15115181:17453,15115184:17454,15115185:17455,15115189:17456,15115190:17457,15115195:17458,15115196:17459,15115197:17460,15115398:17461,15115401:17462,15115402:17463,15115408:17464,15115409:17465,15115411:17466,15115414:17467,15115415:17468,15115441:17469,15115443:17470,15115445:17471,15115448:17472,15115451:17473,15115650:17474,15115653:17475,15115657:17476,15115662:17477,15115671:17478,15115675:17479,15115683:17480,15115684:17481,15115685:17482,15115686:17483,15115688:17484,15115689:17485,15115692:17486,15115696:17487,15115697:17488,15115698:17489,15115706:17490,15115707:17491,15115711:17492,15115904:17493,15115917:17494,15115922:17495,15115926:17496,15115928:17497,15115937:17498,15115941:17499,15115942:17500,15115944:17501,15115947:17502,15115949:17503,15115951:17504,15115959:17505,15115960:17506,15115962:17507,15115964:17508,15116165:17509,15116168:17510,15116177:17511,15116182:17512,15116183:17513,15116194:17514,15116197:17515,15116206:17516,15116207:17517,15116209:17518,15116211:17519,15116213:17520,15116222:17521,15116416:17522,15116417:17523,15116419:17524,15116431:17525,15116433:17526,15116437:17527,15116442:17528,15116445:17529,15116448:17530,15116452:17531,15116456:17532,15116464:17533,15116466:17534,15116468:17697,15116471:17698,15116475:17699,15116478:17700,15116479:17701,15116677:17702,15116678:17703,15116681:17704,15116682:17705,15116686:17706,15116688:17707,15116689:17708,15116690:17709,15116693:17710,15116694:17711,15116699:17712,15116708:17713,15116711:17714,15116714:17715,15116721:17716,15116723:17717,15116734:17718,15116929:17719,15116931:17720,15116934:17721,15116935:17722,15116937:17723,15116939:17724,15116945:17725,15116955:17726,15116957:17727,15116958:17728,15116959:17729,15116965:17730,15116971:17731,15116975:17732,15116976:17733,15116977:17734,15116980:17735,15116989:17736,15116990:17737,15116991:17738,15117190:17739,15117193:17740,15117192:17741,15117196:17742,15117200:17743,15117204:17744,15117205:17745,15117206:17746,15117212:17747,15117213:17748,15117220:17749,15117223:17750,15117228:17751,15117232:17752,15117233:17753,15117234:17754,15117244:17755,15117245:17756,15117442:17757,15117443:17758,15117446:17759,15117447:17760,15117449:17761,15117455:17762,15117456:17763,15117457:17764,15117463:17765,15117467:17766,15117470:17767,15117476:17768,15117480:17769,15117483:17770,15117484:17771,15117487:17772,15117493:17773,15117494:17774,15117499:17775,15117503:17776,15117702:17777,15117706:17778,15117709:17779,15117714:17780,15117718:17781,15117720:17782,15117725:17783,15117728:17784,15117735:17785,15117739:17786,15117742:17787,15117744:17788,15117749:17789,15117757:17790,15117758:17953,15117954:17954,15117957:17955,15117975:17956,15117979:17957,15117983:17958,15117984:17959,15117986:17960,15117987:17961,15117992:17962,15117993:17963,15117996:17964,15117997:17965,15117998:17966,15118e3:17967,15118008:17968,15118009:17969,15118013:17970,15118014:17971,15118211:17972,15118212:17973,15118217:17974,15118220:17975,15118230:17976,15118234:17977,15118241:17978,15118243:17979,15118246:17980,15118247:17981,15118254:17982,15118257:17983,15118263:17984,15118265:17985,15118271:17986,15118466:17987,15118468:17988,15118469:17989,15118473:17990,15118477:17991,15118478:17992,15118480:17993,15118482:17994,15118489:17995,15118495:17996,15118502:17997,15118503:17998,15118504:17999,15118508:18e3,15118510:18001,15118515:18002,15118517:18003,15118518:18004,15118522:18005,15118523:18006,15118527:18007,15118730:18008,15118731:18009,15118733:18010,15118735:18011,15118738:18012,15118740:18013,15118745:18014,15118747:18015,15118748:18016,15118763:18017,15118765:18018,15118767:18019,15118772:18020,15118774:18021,15118776:18022,15118777:18023,15118779:18024,15118981:18025,15118982:18026,15118983:18027,15118985:18028,15118996:18029,15118997:18030,15118999:18031,15119e3:18032,15119004:18033,15119007:18034,15119024:18035,15119026:18036,15119028:18037,15119234:18038,15119238:18039,15119245:18040,15119247:18041,15119248:18042,15119249:18043,15119250:18044,15119252:18045,15119254:18046,15119258:18209,15119260:18210,15119264:18211,15119271:18212,15119273:18213,15119275:18214,15119276:18215,15119278:18216,15119282:18217,15119284:18218,15119492:18219,15119495:18220,15119498:18221,15119502:18222,15119503:18223,15119505:18224,15119507:18225,15119514:18226,15119526:18227,15119527:18228,15119528:18229,15118759:18230,15119534:18231,15119535:18232,15119537:18233,15119545:18234,15119548:18235,15119551:18236,15119767:18237,15119774:18238,15119775:18239,15119777:18240,15119781:18241,15119783:18242,15119791:18243,15119792:18244,15119804:18245,15120002:18246,15120007:18247,15120017:18248,15120018:18249,15120020:18250,15120022:18251,15120023:18252,15120024:18253,15120042:18254,15120044:18255,15120052:18256,15120055:18257,15120057:18258,15120061:18259,15120063:18260,15120260:18261,15120264:18262,15120266:18263,15120270:18264,15120271:18265,15120278:18266,15120283:18267,15120285:18268,15120287:18269,15120288:18270,15120290:18271,15120293:18272,15120297:18273,15120303:18274,15120304:18275,15120308:18276,15120310:18277,15120316:18278,15120512:18279,15120516:18280,15120542:18281,15120546:18282,15120551:18283,15120562:18284,15120566:18285,15120569:18286,15120571:18287,15120572:18288,15120772:18289,15120773:18290,15120776:18291,15120777:18292,15120779:18293,15120783:18294,15120785:18295,15120786:18296,15120787:18297,15120788:18298,15120791:18299,15120796:18300,15120797:18301,15120798:18302,15120802:18465,15120803:18466,15120808:18467,15120819:18468,15120827:18469,15120829:18470,15121037:18471,15121043:18472,15121049:18473,15121056:18474,15121063:18475,15121069:18476,15121070:18477,15121073:18478,15121075:18479,15121083:18480,15121087:18481,15121280:18482,15121281:18483,15121283:18484,15121287:18485,15121288:18486,15121290:18487,15121293:18488,15121294:18489,15121295:18490,15121323:18491,15121325:18492,15121326:18493,15121337:18494,15121339:18495,15121341:18496,15121540:18497,15121544:18498,15121546:18499,15121548:18500,15121549:18501,15121558:18502,15121560:18503,15121562:18504,15121563:18505,15121574:18506,15121577:18507,15121578:18508,15121583:18509,15121584:18510,15121587:18511,15121590:18512,15121595:18513,15121596:18514,15121581:18515,15121807:18516,15121809:18517,15121810:18518,15121811:18519,15121815:18520,15121817:18521,15121818:18522,15121821:18523,15121822:18524,15121825:18525,15121826:18526,15121832:18527,15121836:18528,15121853:18529,15121854:18530,15122051:18531,15122055:18532,15122056:18533,15122059:18534,15122060:18535,15122061:18536,15122064:18537,15122066:18538,15122067:18539,15122068:18540,15122070:18541,15122074:18542,15122079:18543,15122080:18544,15122085:18545,15122086:18546,15122087:18547,15122088:18548,15122094:18549,15122095:18550,15122096:18551,15122101:18552,15122102:18553,15122108:18554,15122309:18555,15122311:18556,15122312:18557,15122314:18558,15122330:18721,15122334:18722,15122344:18723,15122345:18724,15122352:18725,15122357:18726,15122361:18727,15122364:18728,15122365:18729,15171712:18730,15171717:18731,15171718:18732,15171719:18733,15171725:18734,15171735:18735,15171744:18736,15171747:18737,15171759:18738,15171764:18739,15171767:18740,15171769:18741,15171772:18742,15171971:18743,15171972:18744,15171976:18745,15171977:18746,15171978:18747,15171979:18748,15171988:18749,15171989:18750,15171997:18751,15171998:18752,15171982:18753,15172004:18754,15172005:18755,15172012:18756,15172014:18757,15172021:18758,15172022:18759,15172030:18760,15172225:18761,15172229:18762,15172230:18763,15172244:18764,15172245:18765,15172246:18766,15172247:18767,15172248:18768,15172251:18769,15172260:18770,15172267:18771,15172272:18772,15172273:18773,15172276:18774,15172279:18775,15172490:18776,15172497:18777,15172499:18778,15172500:18779,15172501:18780,15172502:18781,15172504:18782,15172508:18783,15172516:18784,15172538:18785,15172739:18786,15172740:18787,15172741:18788,15172742:18789,15172743:18790,15172747:18791,15172748:18792,15172751:18793,15172766:18794,15172768:18795,15172779:18796,15172781:18797,15172783:18798,15172784:18799,15172785:18800,15172792:18801,15172993:18802,15172997:18803,15172998:18804,15172999:18805,15173002:18806,15173003:18807,15173008:18808,15173010:18809,15173015:18810,15173018:18811,15173020:18812,15173022:18813,15173024:18814,15173032:18977,15173049:18978,15173248:18979,15173253:18980,15173255:18981,15173260:18982,15173266:18983,15173274:18984,15173275:18985,15173280:18986,15173282:18987,15173295:18988,15173296:18989,15173298:18990,15173299:18991,15173306:18992,15173311:18993,15173504:18994,15173505:18995,15173508:18996,15173515:18997,15173516:18998,15173523:18999,15173526:19e3,15173529:19001,15173530:19002,15173532:19003,15173560:19004,15173566:19005,15173760:19006,15173767:19007,15173768:19008,15173769:19009,15173779:19010,15173783:19011,15173786:19012,15173789:19013,15173791:19014,15173796:19015,15173803:19016,15173807:19017,15173812:19018,15173816:19019,15173817:19020,15174017:19021,15174018:19022,15174019:19023,15174021:19024,15174030:19025,15174031:19026,15174032:19027,15174035:19028,15174037:19029,15174038:19030,15174042:19031,15174044:19032,15174046:19033,15174048:19034,15174051:19035,15174056:19036,15174059:19037,15174062:19038,15174063:19039,15174065:19040,15174071:19041,15174072:19042,15174075:19043,15174076:19044,15174079:19045,15174276:19046,15174281:19047,15174285:19048,15174286:19049,15174291:19050,15174299:19051,15174312:19052,15174317:19053,15174318:19054,15174321:19055,15174324:19056,15174334:19057,15174529:19058,15174535:19059,15174537:19060,15174540:19061,15174549:19062,15174550:19063,15174552:19064,15174559:19065,15174565:19066,15174579:19067,15174580:19068,15174586:19069,15174587:19070,15174590:19233,15174786:19234,15174788:19235,15174789:19236,15174791:19237,15174795:19238,15174797:19239,15174802:19240,15174803:19241,15174808:19242,15174809:19243,15174814:19244,15174818:19245,15174820:19246,15174823:19247,15174824:19248,15174828:19249,15174833:19250,15174834:19251,15174837:19252,15174842:19253,15174843:19254,15174845:19255,15175043:19256,15175053:19257,15175056:19258,15175058:19259,15175062:19260,15175064:19261,15175069:19262,15175070:19263,15175071:19264,15175072:19265,15175078:19266,15175079:19267,15175081:19268,15175083:19269,15175084:19270,15175086:19271,15175087:19272,15175089:19273,15175095:19274,15175097:19275,15175100:19276,15175296:19277,15175297:19278,15175299:19279,15175301:19280,15175302:19281,15175310:19282,15175312:19283,15175315:19284,15175317:19285,15175319:19286,15175320:19287,15175324:19288,15175326:19289,15175327:19290,15175328:19291,15175330:19292,15175333:19293,15175334:19294,15175338:19295,15175339:19296,15175341:19297,15175349:19298,15175351:19299,15175353:19300,15175356:19301,15175357:19302,15175359:19303,15175557:19304,15175558:19305,15175561:19306,15175563:19307,15175564:19308,15175567:19309,15175570:19310,15175571:19311,15175574:19312,15175577:19313,15175581:19314,15175585:19315,15175587:19316,15175590:19317,15175591:19318,15175593:19319,15175604:19320,15175605:19321,15175607:19322,15175609:19323,15175610:19324,15175611:19325,15175613:19326,15175615:19489,15175808:19490,15175809:19491,15175812:19492,15175815:19493,15175818:19494,15175825:19495,15175834:19496,15175835:19497,15175844:19498,15175846:19499,15175848:19500,15175849:19501,15175850:19502,15175851:19503,15175852:19504,15175853:19505,15175854:19506,15175855:19507,15175856:19508,15175857:19509,15175865:19510,15176064:19511,15176067:19512,15176068:19513,15176070:19514,15176071:19515,15176075:19516,15176077:19517,15176081:19518,15176082:19519,15176087:19520,15176093:19521,15176098:19522,15176102:19523,15176103:19524,15176104:19525,15176107:19526,15176109:19527,15176110:19528,15176113:19529,15176114:19530,15176320:19531,15176321:19532,15176325:19533,15176326:19534,15176327:19535,15176329:19536,15176335:19537,15176336:19538,15176337:19539,15176338:19540,15176344:19541,15176345:19542,15176346:19543,15176348:19544,15176351:19545,15176352:19546,15176353:19547,15176355:19548,15176358:19549,15176360:19550,15176361:19551,15176362:19552,15176363:19553,15176366:19554,15176367:19555,15176369:19556,15176370:19557,15176373:19558,15176377:19559,15176379:19560,15176383:19561,15176584:19562,15176585:19563,15176588:19564,15176592:19565,15176595:19566,15176600:19567,15176602:19568,15176603:19569,15176606:19570,15176607:19571,15176612:19572,15176616:19573,15176618:19574,15176619:19575,15176623:19576,15176628:19577,15176634:19578,15176635:19579,15176636:19580,15176639:19581,15176838:19582,15176850:19745,15176854:19746,15176855:19747,15176864:19748,15176865:19749,15176868:19750,15176871:19751,15176873:19752,15176874:19753,15176879:19754,15176886:19755,15176889:19756,15176893:19757,15176894:19758,15176895:19759,15177088:19760,15177091:19761,15177095:19762,15177096:19763,15177102:19764,15177104:19765,15177106:19766,15177111:19767,15177118:19768,15177119:19769,15177121:19770,15177135:19771,15177137:19772,15177145:19773,15177146:19774,15177147:19775,15177148:19776,15177149:19777,15177150:19778,15177345:19779,15177349:19780,15177360:19781,15177362:19782,15177363:19783,15177365:19784,15177369:19785,15177372:19786,15177378:19787,15177380:19788,15177396:19789,15177402:19790,15177407:19791,15177600:19792,15177601:19793,15177604:19794,15177606:19795,15177612:19796,15177614:19797,15177615:19798,15177623:19799,15177628:19800,15177631:19801,15177632:19802,15177633:19803,15177636:19804,15177639:19805,15177644:19806,15177646:19807,15177647:19808,15177649:19809,15177657:19810,15177856:19811,15177858:19812,15177859:19813,15177860:19814,15177863:19815,15177864:19816,15177866:19817,15177868:19818,15177871:19819,15177874:19820,15177875:19821,15177877:19822,15177878:19823,15177881:19824,15177883:19825,15177884:19826,15177885:19827,15177886:19828,15177891:19829,15177893:19830,15177894:19831,15177897:19832,15177901:19833,15177906:19834,15177907:19835,15177909:19836,15177912:19837,15177913:19838,15177914:20001,15177916:20002,15178122:20003,15178112:20004,15178113:20005,15178115:20006,15178116:20007,15178117:20008,15178121:20009,15178123:20010,15178133:20011,15178137:20012,15178143:20013,15178148:20014,15178149:20015,15178157:20016,15178158:20017,15178159:20018,15178161:20019,15178164:20020,15178369:20021,15178373:20022,15178380:20023,15178381:20024,15178389:20025,15178395:20026,15178396:20027,15178397:20028,15178399:20029,15178400:20030,15178402:20031,15178403:20032,15178404:20033,15178405:20034,15178406:20035,15178407:20036,15178408:20037,15178410:20038,15178413:20039,15178429:20040,15178625:20041,15178629:20042,15178633:20043,15178635:20044,15178636:20045,15178638:20046,15178644:20047,15178649:20048,15178656:20049,15178662:20050,15178664:20051,15178668:20052,15178672:20053,15178673:20054,15178678:20055,15178681:20056,15178684:20057,15178880:20058,15178886:20059,15178890:20060,15178894:20061,15178898:20062,15178900:20063,15178901:20064,15178903:20065,15178905:20066,15178906:20067,15178908:20068,15178914:20069,15178920:20070,15178925:20071,15178926:20072,15178927:20073,15178932:20074,15178933:20075,15178934:20076,15178937:20077,15178941:20078,15178942:20079,15179138:20080,15179141:20081,15179142:20082,15179146:20083,15179149:20084,15179150:20085,15179151:20086,15179154:20087,15179158:20088,15179159:20089,15179164:20090,15179166:20091,15179167:20092,15179168:20093,15179170:20094,15179172:20257,15179175:20258,15179178:20259,15179180:20260,15179184:20261,15179186:20262,15179187:20263,15179188:20264,15179194:20265,15179197:20266,15179392:20267,15179396:20268,15179404:20269,15179405:20270,15179412:20271,15179413:20272,15179414:20273,15179418:20274,15179423:20275,15179426:20276,15179431:20277,15179434:20278,15179438:20279,15179439:20280,15179441:20281,15179445:20282,15179454:20283,15179651:20284,15179657:20285,15179665:20286,15179666:20287,15179669:20288,15179673:20289,15179678:20290,15179679:20291,15179680:20292,15179684:20293,15179686:20294,15179690:20295,15179692:20296,15179696:20297,15179697:20298,15179700:20299,15179704:20300,15179707:20301,15179909:20302,15179910:20303,15179913:20304,15179917:20305,15179918:20306,15179921:20307,15179933:20308,15179937:20309,15179938:20310,15179939:20311,15179949:20312,15179950:20313,15179952:20314,15179957:20315,15179959:20316,15180163:20317,15180164:20318,15180167:20319,15180168:20320,15180172:20321,15180174:20322,15180178:20323,15180188:20324,15180190:20325,15180192:20326,15180193:20327,15180195:20328,15180196:20329,15180200:20330,15180202:20331,15180206:20332,15180218:20333,15180222:20334,15180426:20335,15180431:20336,15180436:20337,15180440:20338,15180449:20339,15180445:20340,15180446:20341,15180447:20342,15180452:20343,15180456:20344,15180460:20345,15180461:20346,15180464:20347,15180465:20348,15180466:20349,15180467:20350,15180475:20513,15180477:20514,15180479:20515,15180679:20516,15180680:20517,15180681:20518,15180684:20519,15180686:20520,15180690:20521,15180691:20522,15180693:20523,15180694:20524,15180708:20525,15180699:20526,15180703:20527,15180704:20528,15180705:20529,15180710:20530,15180714:20531,15180722:20532,15180723:20533,15180928:20534,15180726:20535,15180727:20536,15180730:20537,15180731:20538,15180735:20539,15180934:20540,15180940:20541,15180944:20542,15180954:20543,15180956:20544,15180958:20545,15180959:20546,15180960:20547,15180965:20548,15180967:20549,15180969:20550,15180973:20551,15180977:20552,15180980:20553,15180981:20554,15180987:20555,15180989:20556,15180991:20557,15181188:20558,15181189:20559,15181190:20560,15181194:20561,15181195:20562,15181199:20563,15181201:20564,15181204:20565,15181208:20566,15181211:20567,15181212:20568,15181223:20569,15181225:20570,15181227:20571,15181234:20572,15181241:20573,15181243:20574,15181244:20575,15181246:20576,15181451:20577,15181452:20578,15181457:20579,15181459:20580,15181460:20581,15181461:20582,15181462:20583,15181464:20584,15181467:20585,15181468:20586,15181473:20587,15181480:20588,15181481:20589,15181483:20590,15181487:20591,15181489:20592,15181492:20593,15181496:20594,15181499:20595,15181698:20596,15181700:20597,15181703:20598,15181704:20599,15181706:20600,15181711:20601,15181716:20602,15181718:20603,15181722:20604,15181725:20605,15181726:20606,15181728:20769,15181730:20770,15181733:20771,15181738:20772,15181739:20773,15181741:20774,15181745:20775,15181752:20776,15181756:20777,15181954:20778,15181955:20779,15181959:20780,15181961:20781,15181962:20782,15181964:20783,15181969:20784,15181973:20785,15181979:20786,15181982:20787,15181985:20788,15181991:20789,15181995:20790,15181997:20791,15181999:20792,15182e3:20793,15182004:20794,15182005:20795,15182008:20796,15182009:20797,15182010:20798,15182212:20799,15182213:20800,15182215:20801,15182216:20802,15182220:20803,15182229:20804,15182230:20805,15182233:20806,15182236:20807,15182237:20808,15182239:20809,15182240:20810,15182245:20811,15182247:20812,15182250:20813,15182253:20814,15182261:20815,15182264:20816,15182270:20817,15182464:20818,15182466:20819,15182469:20820,15182470:20821,15182474:20822,15182475:20823,15182480:20824,15182481:20825,15182484:20826,15182494:20827,15182496:20828,15182499:20829,15182508:20830,15182515:20831,15182517:20832,15182521:20833,15182523:20834,15182524:20835,15182726:20836,15182729:20837,15182732:20838,15182734:20839,15182737:20840,15182747:20841,15182760:20842,15182761:20843,15182763:20844,15182764:20845,15182769:20846,15182772:20847,15182779:20848,15182781:20849,15182782:20850,15182983:20851,15182996:20852,15183007:20853,15183011:20854,15183015:20855,15183017:20856,15183018:20857,15183019:20858,15183021:20859,15183022:20860,15183023:20861,15183024:20862,15183025:21025,15183028:21026,15183037:21027,15183039:21028,15183232:21029,15183233:21030,15183239:21031,15183246:21032,15183253:21033,15183264:21034,15183268:21035,15183270:21036,15183273:21037,15183274:21038,15183277:21039,15183279:21040,15183282:21041,15183283:21042,15183287:21043,15183492:21044,15183497:21045,15183502:21046,15183504:21047,15183505:21048,15183510:21049,15183515:21050,15183518:21051,15183520:21052,15183525:21053,15183532:21054,15183535:21055,15183536:21056,15183538:21057,15183541:21058,15183542:21059,15183546:21060,15183547:21061,15183548:21062,15183549:21063,15183746:21064,15183749:21065,15183752:21066,15183754:21067,15183764:21068,15183766:21069,15183767:21070,15183769:21071,15183770:21072,15183771:21073,15183784:21074,15183786:21075,15183794:21076,15183796:21077,15183797:21078,15183800:21079,15183801:21080,15183802:21081,15183804:21082,15183806:21083,15184001:21084,15184002:21085,15184003:21086,15184004:21087,15184006:21088,15184009:21089,15184011:21090,15184012:21091,15184014:21092,15184015:21093,15184025:21094,15184027:21095,15184032:21096,15184037:21097,15184038:21098,15184040:21099,15184044:21100,15184049:21101,15184051:21102,15184052:21103,15184054:21104,15184057:21105,15184058:21106,15184262:21107,15184266:21108,15184277:21109,15184273:21110,15184274:21111,15184275:21112,15184281:21113,15184282:21114,15184283:21115,15184284:21116,15184285:21117,15184286:21118,15184289:21281,15184291:21282,15184295:21283,15184297:21284,15184301:21285,15184302:21286,15184304:21287,15184306:21288,15184313:21289,15184316:21290,15184317:21291,15184518:21292,15184519:21293,15184527:21294,15184532:21295,15184542:21296,15184544:21297,15184550:21298,15184560:21299,15184566:21300,15184567:21301,15184570:21302,15184571:21303,15184572:21304,15184575:21305,15184772:21306,15184775:21307,15184776:21308,15184777:21309,15184781:21310,15184783:21311,15184787:21312,15184788:21313,15184789:21314,15184791:21315,15184793:21316,15184794:21317,15184797:21318,15184806:21319,15184809:21320,15184811:21321,15184821:21322,15185027:21323,15185031:21324,15185032:21325,15185033:21326,15185039:21327,15185041:21328,15185042:21329,15185043:21330,15185046:21331,15185053:21332,15185054:21333,15185059:21334,15185062:21335,15185066:21336,15185069:21337,15185073:21338,15185084:21339,15185085:21340,15185086:21341,15185280:21342,15185281:21343,15185287:21344,15185288:21345,15185293:21346,15185297:21347,15185299:21348,15185303:21349,15185305:21350,15185306:21351,15185308:21352,15185309:21353,15185317:21354,15185319:21355,15185322:21356,15185328:21357,15185336:21358,15185338:21359,15185339:21360,15185343:21361,15185537:21362,15185538:21363,15185539:21364,15185541:21365,15185542:21366,15185544:21367,15185547:21368,15185548:21369,15185549:21370,15185553:21371,15185558:21372,15185559:21373,15185565:21374,15185566:21537,15185574:21538,15185575:21539,15185578:21540,15185587:21541,15185590:21542,15185591:21543,15185593:21544,15185794:21545,15185795:21546,15185796:21547,15185797:21548,15185798:21549,15185804:21550,15185805:21551,15185806:21552,15185815:21553,15185817:21554,15186048:21555,15185826:21556,15185829:21557,15185830:21558,15185834:21559,15185835:21560,15185837:21561,15185841:21562,15185845:21563,15185846:21564,15185849:21565,15185850:21566,15186056:21567,15186064:21568,15186065:21569,15186069:21570,15186071:21571,15186076:21572,15186077:21573,15186080:21574,15186087:21575,15186088:21576,15186092:21577,15186093:21578,15186095:21579,15186099:21580,15186102:21581,15186111:21582,15186308:21583,15186309:21584,15186311:21585,15186318:21586,15186320:21587,15186322:21588,15186328:21589,15186335:21590,15186337:21591,15186338:21592,15186341:21593,15186347:21594,15186350:21595,15186351:21596,15186355:21597,15186360:21598,15186366:21599,15186561:21600,15186566:21601,15186567:21602,15186570:21603,15186573:21604,15186577:21605,15186581:21606,15186584:21607,15186586:21608,15186589:21609,15186590:21610,15187132:21611,15187131:21612,15187133:21613,15187134:21614,15187135:21615,15187331:21616,15187332:21617,15187335:21618,15187343:21619,15187346:21620,15187347:21621,15187355:21622,15187356:21623,15187357:21624,15187361:21625,15187363:21626,15187364:21627,15187365:21628,15187366:21629,15187373:21630,15187377:21793,15187389:21794,15187390:21795,15187391:21796,15187584:21797,15187595:21798,15187597:21799,15187599:21800,15187600:21801,15187601:21802,15187606:21803,15187607:21804,15187612:21805,15187617:21806,15187618:21807,15187622:21808,15187626:21809,15187629:21810,15187636:21811,15187644:21812,15187647:21813,15187840:21814,15187843:21815,15187848:21816,15187854:21817,15187855:21818,15187867:21819,15187871:21820,15187875:21821,15187877:21822,15187880:21823,15187884:21824,15187886:21825,15187887:21826,15187890:21827,15187898:21828,15187901:21829,15187902:21830,15187903:21831,15237255:21832,15237256:21833,15237258:21834,15237261:21835,15237262:21836,15237263:21837,15237265:21838,15237267:21839,15237268:21840,15237270:21841,15237277:21842,15237278:21843,15237279:21844,15237280:21845,15237284:21846,15237286:21847,15237292:21848,15237294:21849,15237296:21850,15237300:21851,15237301:21852,15237303:21853,15237305:21854,15237306:21855,15237308:21856,15237310:21857,15237504:21858,15237508:21859,15237536:21860,15237540:21861,15237542:21862,15237549:21863,15237553:21864,15237557:21865,15237761:21866,15237768:21867,15237774:21868,15237788:21869,15237790:21870,15237798:21871,15237799:21872,15237803:21873,15237816:21874,15237817:21875,15238024:21876,15238029:21877,15238031:21878,15238034:21879,15238036:21880,15238037:21881,15238039:21882,15238040:21883,15238048:21884,15238061:21885,15238062:21886,15238064:22049,15238066:22050,15238067:22051,15238070:22052,15238073:22053,15238074:22054,15238078:22055,15238275:22056,15238283:22057,15238294:22058,15238295:22059,15238296:22060,15238300:22061,15238302:22062,15238304:22063,15238308:22064,15238311:22065,15238316:22066,15238320:22067,15238325:22068,15238330:22069,15238332:22070,15238533:22071,15238535:22072,15238538:22073,15238540:22074,15238546:22075,15238551:22076,15238560:22077,15238561:22078,15238567:22079,15238568:22080,15238569:22081,15238573:22082,15238575:22083,15238583:22084,15238785:22085,15238800:22086,15238788:22087,15238789:22088,15238790:22089,15238795:22090,15238798:22091,15238806:22092,15238808:22093,15238811:22094,15238814:22095,15238818:22096,15238830:22097,15238834:22098,15238836:22099,15238843:22100,15239051:22101,15239043:22102,15239045:22103,15239050:22104,15239054:22105,15239055:22106,15239061:22107,15239063:22108,15239067:22109,15239069:22110,15239070:22111,15239073:22112,15239076:22113,15239083:22114,15239084:22115,15239088:22116,15239089:22117,15239090:22118,15239093:22119,15239094:22120,15239096:22121,15239097:22122,15239101:22123,15239103:22124,15239296:22125,15239299:22126,15239311:22127,15239315:22128,15239316:22129,15239321:22130,15239322:22131,15239325:22132,15239329:22133,15239330:22134,15239336:22135,15239346:22136,15239348:22137,15239354:22138,15239555:22139,15239556:22140,15239557:22141,15239558:22142,15239563:22305,15239566:22306,15239567:22307,15239569:22308,15239574:22309,15239580:22310,15239584:22311,15239587:22312,15239591:22313,15239597:22314,15239604:22315,15239611:22316,15239613:22317,15239615:22318,15239808:22319,15239809:22320,15239811:22321,15239812:22322,15239815:22323,15239817:22324,15239818:22325,15239822:22326,15239825:22327,15239828:22328,15239830:22329,15239832:22330,15239834:22331,15239835:22332,15239840:22333,15239841:22334,15239843:22335,15239844:22336,15239847:22337,15239848:22338,15239849:22339,15239850:22340,15239854:22341,15239856:22342,15239858:22343,15239860:22344,15239863:22345,15239866:22346,15239868:22347,15239870:22348,15239871:22349,15240070:22350,15240080:22351,15240085:22352,15240090:22353,15240096:22354,15240098:22355,15240100:22356,15240104:22357,15240106:22358,15240109:22359,15240111:22360,15240118:22361,15240119:22362,15240125:22363,15240126:22364,15240320:22365,15240321:22366,15240327:22367,15240328:22368,15240330:22369,15240331:22370,15240596:22371,15240347:22372,15240349:22373,15240350:22374,15240351:22375,15240353:22376,15240354:22377,15240364:22378,15240365:22379,15240366:22380,15240368:22381,15240371:22382,15240375:22383,15240378:22384,15240380:22385,15240381:22386,15240578:22387,15240579:22388,15240580:22389,15240583:22390,15240589:22391,15240590:22392,15240593:22393,15240597:22394,15240598:22395,15240599:22396,15240624:22397,15240632:22398,15240637:22561,15240639:22562,15240832:22563,15240834:22564,15240836:22565,15240838:22566,15240845:22567,15240850:22568,15240852:22569,15240853:22570,15240856:22571,15240857:22572,15240859:22573,15240860:22574,15240861:22575,15240870:22576,15240871:22577,15240873:22578,15240876:22579,15240894:22580,15240895:22581,15241088:22582,15241095:22583,15241097:22584,15241103:22585,15241104:22586,15241105:22587,15241108:22588,15241117:22589,15240595:22590,15241128:22591,15241130:22592,15241142:22593,15241144:22594,15241145:22595,15241148:22596,15241345:22597,15241350:22598,15241354:22599,15241359:22600,15241361:22601,15241365:22602,15241369:22603,15240877:22604,15241391:22605,15241401:22606,15241605:22607,15241607:22608,15241608:22609,15241610:22610,15241613:22611,15241615:22612,15241617:22613,15241618:22614,15241622:22615,15241624:22616,15241625:22617,15241626:22618,15241628:22619,15241632:22620,15241636:22621,15241637:22622,15241639:22623,15241642:22624,15241648:22625,15241651:22626,15241652:22627,15241654:22628,15241656:22629,15241660:22630,15241661:22631,15241857:22632,15241861:22633,15241874:22634,15241875:22635,15241877:22636,15241886:22637,15241894:22638,15241896:22639,15241897:22640,15241898:22641,15241903:22642,15241905:22643,15241908:22644,15241914:22645,15241917:22646,15241918:22647,15242112:22648,15242114:22649,15242119:22650,15242120:22651,15242124:22652,15242127:22653,15242131:22654,15242140:22817,15242151:22818,15242154:22819,15242159:22820,15242160:22821,15242161:22822,15242162:22823,15242167:22824,15242418:22825,15242170:22826,15242171:22827,15242173:22828,15242370:22829,15242371:22830,15242375:22831,15242380:22832,15242382:22833,15242384:22834,15242396:22835,15242398:22836,15242402:22837,15242403:22838,15242404:22839,15242405:22840,15242407:22841,15242410:22842,15242411:22843,15242415:22844,15242419:22845,15242420:22846,15242422:22847,15242431:22848,15242630:22849,15242639:22850,15242640:22851,15242641:22852,15242642:22853,15242643:22854,15242646:22855,15242649:22856,15242652:22857,15242653:22858,15242654:22859,15242655:22860,15242656:22861,15242657:22862,15242658:22863,15242660:22864,15242667:22865,15242671:22866,15242681:22867,15242682:22868,15242683:22869,15242685:22870,15242687:22871,15242881:22872,15242885:22873,15242886:22874,15242889:22875,15242891:22876,15242892:22877,15242895:22878,15242899:22879,15242904:22880,15242909:22881,15242911:22882,15242912:22883,15242914:22884,15242917:22885,15242919:22886,15242932:22887,15242934:22888,15242935:22889,15242936:22890,15242940:22891,15242941:22892,15242942:22893,15242943:22894,15243138:22895,15243143:22896,15243146:22897,15243147:22898,15243150:22899,15242925:22900,15243160:22901,15243162:22902,15243167:22903,15243168:22904,15243174:22905,15243176:22906,15243181:22907,15243187:22908,15243190:22909,15243196:22910,15243199:23073,15243392:23074,15243396:23075,15243397:23076,15243405:23077,15243406:23078,15243408:23079,15243409:23080,15243410:23081,15243416:23082,15243417:23083,15243419:23084,15243422:23085,15243425:23086,15243431:23087,15243433:23088,15243446:23089,15243448:23090,15243450:23091,15243452:23092,15243453:23093,15243648:23094,15243650:23095,15243654:23096,15243666:23097,15243667:23098,15243670:23099,15243671:23100,15243672:23101,15243673:23102,15243677:23103,15243680:23104,15243681:23105,15243682:23106,15243683:23107,15243684:23108,15243689:23109,15243692:23110,15243695:23111,15243701:23112,15243702:23113,15243703:23114,15243706:23115,15243917:23116,15243921:23117,15243926:23118,15243928:23119,15243930:23120,15243932:23121,15243937:23122,15243942:23123,15243943:23124,15243944:23125,15243949:23126,15243953:23127,15243955:23128,15243956:23129,15243957:23130,15243959:23131,15243960:23132,15243961:23133,15243967:23134,15244160:23135,15244161:23136,15244163:23137,15244165:23138,15244177:23139,15244178:23140,15244181:23141,15244183:23142,15244186:23143,15244188:23144,15244192:23145,15244195:23146,15244197:23147,15244199:23148,15243912:23149,15244218:23150,15244220:23151,15244221:23152,15244420:23153,15244421:23154,15244423:23155,15244427:23156,15244430:23157,15244431:23158,15244432:23159,15244435:23160,15244436:23161,15244441:23162,15244446:23163,15244447:23164,15244449:23165,15244451:23166,15244456:23329,15244462:23330,15244463:23331,15244465:23332,15244466:23333,15244473:23334,15244474:23335,15244476:23336,15244477:23337,15244478:23338,15244672:23339,15244675:23340,15244677:23341,15244685:23342,15244696:23343,15244701:23344,15244705:23345,15244708:23346,15244709:23347,15244719:23348,15244721:23349,15244722:23350,15244731:23351,15244931:23352,15244932:23353,15244933:23354,15244934:23355,15244935:23356,15244936:23357,15244937:23358,15244939:23359,15244940:23360,15244944:23361,15244947:23362,15244949:23363,15244951:23364,15244952:23365,15244953:23366,15244958:23367,15244960:23368,15244963:23369,15244967:23370,15244972:23371,15244973:23372,15244974:23373,15244977:23374,15244981:23375,15244990:23376,15244991:23377,15245185:23378,15245192:23379,15245193:23380,15245194:23381,15245198:23382,15245205:23383,15245206:23384,15245209:23385,15245210:23386,15245212:23387,15245215:23388,15245218:23389,15245219:23390,15245220:23391,15245226:23392,15245227:23393,15245229:23394,15245233:23395,15245235:23396,15245240:23397,15245242:23398,15245247:23399,15245441:23400,15245443:23401,15245446:23402,15245449:23403,15245450:23404,15245451:23405,15245456:23406,15245465:23407,15245458:23408,15245459:23409,15245460:23410,15245464:23411,15245466:23412,15245467:23413,15245468:23414,15245470:23415,15245471:23416,15245480:23417,15245485:23418,15245486:23419,15245488:23420,15245490:23421,15245493:23422,15245498:23585,15245500:23586,15245697:23587,15245699:23588,15245701:23589,15245704:23590,15245705:23591,15245706:23592,15245707:23593,15245710:23594,15245713:23595,15245717:23596,15245718:23597,15245720:23598,15245722:23599,15245724:23600,15245727:23601,15245728:23602,15245732:23603,15245737:23604,15245745:23605,15245753:23606,15245755:23607,15245952:23608,15245976:23609,15245978:23610,15245979:23611,15245980:23612,15245983:23613,15245984:23614,15245992:23615,15245994:23616,15246010:23617,15246013:23618,15246014:23619,15246208:23620,15246218:23621,15246219:23622,15246220:23623,15246221:23624,15246222:23625,15246225:23626,15246226:23627,15246227:23628,15246235:23629,15246238:23630,15246247:23631,15246255:23632,15246256:23633,15246257:23634,15246261:23635,15246263:23636,15246465:23637,15246470:23638,15246477:23639,15246478:23640,15246479:23641,15246485:23642,15246486:23643,15246488:23644,15246489:23645,15246490:23646,15246492:23647,15246496:23648,15246502:23649,15246503:23650,15246504:23651,15246512:23652,15246513:23653,15246514:23654,15246517:23655,15246521:23656,15246522:23657,15246526:23658,15246720:23659,15246722:23660,15246725:23661,15246726:23662,15246729:23663,15246735:23664,15246738:23665,15246743:23666,15246746:23667,15246747:23668,15246748:23669,15246753:23670,15246754:23671,15246755:23672,15246763:23673,15246766:23674,15246768:23675,15246771:23676,15246773:23677,15246778:23678,15246779:23841,15246780:23842,15246781:23843,15246985:23844,15246989:23845,15246992:23846,15246996:23847,15246997:23848,15247003:23849,15247004:23850,15247007:23851,15247008:23852,15247013:23853,15247024:23854,15247028:23855,15247029:23856,15247030:23857,15247031:23858,15247036:23859,15247252:23860,15247253:23861,15247254:23862,15247255:23863,15247256:23864,15247269:23865,15247273:23866,15247275:23867,15247277:23868,15247281:23869,15247283:23870,15247286:23871,15247289:23872,15247293:23873,15247295:23874,15247492:23875,15247493:23876,15247495:23877,15247503:23878,15247505:23879,15247506:23880,15247508:23881,15247509:23882,15247518:23883,15247520:23884,15247522:23885,15247524:23886,15247526:23887,15247531:23888,15247532:23889,15247535:23890,15247541:23891,15247543:23892,15247549:23893,15247550:23894,15247744:23895,15247747:23896,15247749:23897,15247751:23898,15247753:23899,15247757:23900,15247758:23901,15247763:23902,15247766:23903,15247767:23904,15247768:23905,15247772:23906,15247773:23907,15247777:23908,15247781:23909,15247783:23910,15247797:23911,15247798:23912,15247799:23913,15247801:23914,15247802:23915,15247803:23916,15247806:23917,15247807:23918,15248e3:23919,15248003:23920,15248006:23921,15248011:23922,15248015:23923,15248016:23924,15248018:23925,15248022:23926,15248023:23927,15248025:23928,15248031:23929,15248039:23930,15248041:23931,15248046:23932,15248047:23933,15248051:23934,15248054:24097,15248055:24098,15248059:24099,15248062:24100,15248259:24101,15248262:24102,15248264:24103,15248265:24104,15248266:24105,15248273:24106,15248275:24107,15248276:24108,15248277:24109,15248279:24110,15248285:24111,15248287:24112,15248300:24113,15248304:24114,15248308:24115,15248309:24116,15248310:24117,15248316:24118,15248319:24119,15248517:24120,15248518:24121,15248523:24122,15248529:24123,15248540:24124,15248542:24125,15248543:24126,15248522:24127,15248557:24128,15248560:24129,15248567:24130,15248572:24131,15248770:24132,15248771:24133,15248772:24134,15248773:24135,15248774:24136,15248776:24137,15248786:24138,15248787:24139,15248788:24140,15248793:24141,15248781:24142,15248798:24143,15248803:24144,15248813:24145,15248822:24146,15248824:24147,15248825:24148,15248828:24149,15248830:24150,15249025:24151,15249028:24152,15249029:24153,15249035:24154,15249037:24155,15249039:24156,15249044:24157,15249045:24158,15249052:24159,15249054:24160,15249055:24161,15249592:24162,15249593:24163,15249597:24164,15249598:24165,15249797:24166,15249799:24167,15249801:24168,15249803:24169,15249807:24170,15249809:24171,15249811:24172,15249812:24173,15249815:24174,15249816:24175,15249819:24176,15249821:24177,15249817:24178,15249827:24179,15249828:24180,15249830:24181,15249832:24182,15249833:24183,15249837:24184,15249843:24185,15249845:24186,15249846:24187,15249851:24188,15249854:24189,15250054:24190,15250055:24353,15250059:24354,15250064:24355,15250066:24356,15250067:24357,15250073:24358,15250075:24359,15250076:24360,15250084:24361,15250105:24362,15250106:24363,15250309:24364,15250310:24365,15250313:24366,15250315:24367,15250319:24368,15250326:24369,15250325:24370,15250329:24371,15250333:24372,15250337:24373,15250344:24374,15250348:24375,15250351:24376,15250352:24377,15250354:24378,15250357:24379,15250359:24380,15250360:24381,15250366:24382,15250367:24383,15250561:24384,15250563:24385,15250569:24386,15250578:24387,15250583:24388,15250587:24389,15250853:24390,15250857:24391,15250860:24392,15250862:24393,15250879:24394,15251074:24395,15251076:24396,15251080:24397,15251085:24398,15251088:24399,15251089:24400,15251093:24401,15251102:24402,15251103:24403,15251104:24404,15251110:24405,15251115:24406,15251116:24407,15251119:24408,15251122:24409,15251125:24410,15251127:24411,15251129:24412,15251131:24413,15251328:24414,15251333:24415,15251334:24416,15251335:24417,15251336:24418,15251338:24419,15251342:24420,15251345:24421,15251348:24422,15251349:24423,15251351:24424,15251353:24425,15251364:24426,15251365:24427,15251367:24428,15251372:24429,15251376:24430,15251132:24431,15251377:24432,15251378:24433,15251380:24434,15251389:24435,15251585:24436,15251588:24437,15251589:24438,15251590:24439,15251595:24440,15251601:24441,15251604:24442,15251606:24443,15251616:24444,15251617:24445,15251618:24446,15251619:24609,15251622:24610,15251623:24611,15251633:24612,15251635:24613,15251638:24614,15251639:24615,15251640:24616,15251641:24617,15251645:24618,15251840:24619,15251841:24620,15251851:24621,15251853:24622,15251854:24623,15251855:24624,15251860:24625,15251867:24626,15251868:24627,15251869:24628,15251870:24629,15251873:24630,15251874:24631,15251881:24632,15251884:24633,15251885:24634,15251887:24635,15251888:24636,15251889:24637,15251897:24638,15251898:24639,15251899:24640,15252098:24641,15252099:24642,15252105:24643,15252112:24644,15252114:24645,15252117:24646,15252122:24647,15252123:24648,15252125:24649,15252126:24650,15252130:24651,15252135:24652,15252137:24653,15252141:24654,15252142:24655,15252147:24656,15252149:24657,15252154:24658,15252155:24659,15252352:24660,15252353:24661,15252355:24662,15252356:24663,15252359:24664,15252367:24665,15252369:24666,15252372:24667,15252380:24668,15252392:24669,15252398:24670,15252400:24671,15252401:24672,15252407:24673,15252409:24674,15252410:24675,15252397:24676,15252608:24677,15252610:24678,15252615:24679,15252616:24680,15252623:24681,15252624:24682,15252630:24683,15252631:24684,15252632:24685,15252638:24686,15252640:24687,15252641:24688,15252643:24689,15252645:24690,15252647:24691,15252648:24692,15252652:24693,15252653:24694,15252654:24695,15252660:24696,15252661:24697,15252662:24698,15252663:24699,15252666:24700,15252864:24701,15252865:24702,15252867:24865,15252871:24866,15252879:24867,15252881:24868,15252882:24869,15252883:24870,15252884:24871,15252885:24872,15252888:24873,15252893:24874,15252894:24875,15252901:24876,15253149:24877,15253152:24878,15253153:24879,15253156:24880,15253157:24881,15253158:24882,15253173:24883,15253174:24884,15253176:24885,15253182:24886,15253376:24887,15253377:24888,15253382:24889,15253386:24890,15253387:24891,15253389:24892,15253392:24893,15253394:24894,15253395:24895,15253397:24896,15253408:24897,15253411:24898,15253412:24899,15253416:24900,15253422:24901,15253425:24902,15253429:24903,15253430:24904,15253435:24905,15253438:24906,15302786:24907,15302788:24908,15302792:24909,15302796:24910,15302808:24911,15302811:24912,15302824:24913,15302825:24914,15302831:24915,15302826:24916,15302828:24917,15302829:24918,15302835:24919,15302836:24920,15302839:24921,15302847:24922,15303043:24923,15303044:24924,15303052:24925,15303067:24926,15303069:24927,15303074:24928,15303078:24929,15303079:24930,15303084:24931,15303088:24932,15303092:24933,15303097:24934,15303301:24935,15303304:24936,15303307:24937,15303308:24938,15303310:24939,15303312:24940,15303317:24941,15303319:24942,15303320:24943,15303321:24944,15303323:24945,15303328:24946,15303329:24947,15303330:24948,15303333:24949,15303344:24950,15303346:24951,15303347:24952,15303348:24953,15303350:24954,15303357:24955,15303564:24956,15303358:24957,15303555:24958,15303556:25121,15303557:25122,15303559:25123,15303560:25124,15303573:25125,15303575:25126,15303576:25127,15303577:25128,15303580:25129,15303581:25130,15303583:25131,15303589:25132,15303570:25133,15303606:25134,15303595:25135,15303599:25136,15303600:25137,15303604:25138,15303614:25139,15303615:25140,15303808:25141,15303812:25142,15303813:25143,15303814:25144,15303816:25145,15303821:25146,15303824:25147,15303828:25148,15303830:25149,15303831:25150,15303832:25151,15303834:25152,15303836:25153,15303838:25154,15303840:25155,15303845:25156,15303842:25157,15303843:25158,15303847:25159,15303849:25160,15303854:25161,15303855:25162,15303857:25163,15303860:25164,15303862:25165,15303863:25166,15303865:25167,15303866:25168,15303868:25169,15303869:25170,15304067:25171,15304071:25172,15304072:25173,15304079:25174,15304083:25175,15304087:25176,15304089:25177,15304090:25178,15304091:25179,15304097:25180,15304100:25181,15304103:25182,15304109:25183,15304116:25184,15304121:25185,15304122:25186,15304123:25187,15304321:25188,15304323:25189,15304325:25190,15304326:25191,15304330:25192,15304334:25193,15304337:25194,15304339:25195,15304340:25196,15304341:25197,15304344:25198,15304350:25199,15304353:25200,15304358:25201,15304360:25202,15304364:25203,15304365:25204,15304366:25205,15304368:25206,15304369:25207,15304370:25208,15304371:25209,15304374:25210,15304379:25211,15304380:25212,15304381:25213,15304383:25214,15304578:25377,15304579:25378,15304581:25379,15304595:25380,15304596:25381,15304599:25382,15304601:25383,15304602:25384,15304606:25385,15304612:25386,15304613:25387,15304617:25388,15304618:25389,15304620:25390,15304621:25391,15304622:25392,15304623:25393,15304624:25394,15304625:25395,15304631:25396,15304633:25397,15304635:25398,15304637:25399,15304832:25400,15304833:25401,15304836:25402,15304837:25403,15304838:25404,15304839:25405,15304841:25406,15304842:25407,15304844:25408,15304848:25409,15304850:25410,15304851:25411,15304854:25412,15304856:25413,15304860:25414,15304861:25415,15304867:25416,15304868:25417,15304869:25418,15304870:25419,15304872:25420,15304878:25421,15304879:25422,15304880:25423,15304883:25424,15304885:25425,15304886:25426,15304888:25427,15304889:25428,15304890:25429,15304892:25430,15304894:25431,15305088:25432,15305090:25433,15305091:25434,15305094:25435,15305095:25436,15305098:25437,15305101:25438,15305102:25439,15305103:25440,15305105:25441,15305112:25442,15305113:25443,15305116:25444,15305117:25445,15305120:25446,15305121:25447,15305125:25448,15305127:25449,15305128:25450,15305129:25451,15305134:25452,15305135:25453,15305136:25454,15305141:25455,15305142:25456,15305143:25457,15305144:25458,15305145:25459,15305147:25460,15305148:25461,15305149:25462,15305151:25463,15305352:25464,15305353:25465,15305354:25466,15305357:25467,15305358:25468,15305362:25469,15305367:25470,15305369:25633,15305375:25634,15305376:25635,15305380:25636,15305381:25637,15305383:25638,15305384:25639,15305387:25640,15305391:25641,15305394:25642,15305398:25643,15305400:25644,15305402:25645,15305403:25646,15305404:25647,15305405:25648,15305407:25649,15305600:25650,15305601:25651,15305602:25652,15305603:25653,15305605:25654,15305606:25655,15305607:25656,15305608:25657,15305611:25658,15305612:25659,15305613:25660,15305614:25661,15305616:25662,15305619:25663,15305621:25664,15305623:25665,15305624:25666,15305625:25667,15305628:25668,15305629:25669,15305631:25670,15305632:25671,15305633:25672,15305635:25673,15305637:25674,15305639:25675,15305640:25676,15305644:25677,15305646:25678,15305648:25679,15305657:25680,15305659:25681,15305663:25682,15305856:25683,15305858:25684,15305864:25685,15305869:25686,15305873:25687,15305876:25688,15305877:25689,15305884:25690,15305885:25691,15305886:25692,15305887:25693,15305889:25694,15305892:25695,15305893:25696,15305895:25697,15305897:25698,15305898:25699,15305907:25700,15305908:25701,15305910:25702,15305911:25703,15306119:25704,15306120:25705,15306121:25706,15306128:25707,15306129:25708,15306130:25709,15306133:25710,15306135:25711,15306136:25712,15306138:25713,15306142:25714,15306148:25715,15306149:25716,15306151:25717,15306153:25718,15306154:25719,15306157:25720,15306159:25721,15306160:25722,15306161:25723,15306163:25724,15306164:25725,15306166:25726,15306170:25889,15306173:25890,15306175:25891,15306368:25892,15306369:25893,15306370:25894,15306376:25895,15306378:25896,15306379:25897,15306381:25898,15306383:25899,15306386:25900,15306389:25901,15306392:25902,15306395:25903,15306398:25904,15306401:25905,15306403:25906,15306404:25907,15306406:25908,15306408:25909,15306411:25910,15306420:25911,15306421:25912,15306422:25913,15306426:25914,15306409:25915,15306625:25916,15306628:25917,15306629:25918,15306630:25919,15306631:25920,15306633:25921,15306634:25922,15306635:25923,15306636:25924,15306637:25925,15306643:25926,15306649:25927,15306652:25928,15306654:25929,15306655:25930,15306658:25931,15306662:25932,15306663:25933,15306681:25934,15306679:25935,15306680:25936,15306682:25937,15306683:25938,15306685:25939,15306881:25940,15306882:25941,15306884:25942,15306888:25943,15306889:25944,15306893:25945,15306894:25946,15306895:25947,15306901:25948,15306902:25949,15306903:25950,15306911:25951,15306926:25952,15306927:25953,15306929:25954,15306930:25955,15306931:25956,15306932:25957,15306939:25958,15306943:25959,15306941:25960,15307139:25961,15307141:25962,15307144:25963,15307146:25964,15307148:25965,15307157:25966,15307161:25967,15307164:25968,15307167:25969,15307169:25970,15307171:25971,15307176:25972,15307179:25973,15307181:25974,15307182:25975,15307183:25976,15307185:25977,15307186:25978,15307396:25979,15307395:25980,15308216:25981,15308217:25982,15308222:26145,15308420:26146,15308424:26147,15308428:26148,15308429:26149,15308430:26150,15308445:26151,15308446:26152,15308447:26153,15308449:26154,15308454:26155,15308457:26156,15308459:26157,15308460:26158,15308468:26159,15308470:26160,15308474:26161,15308477:26162,15308479:26163,15308678:26164,15308680:26165,15308681:26166,15308683:26167,15308688:26168,15308689:26169,15308690:26170,15308691:26171,15308697:26172,15308698:26173,15308701:26174,15308702:26175,15308703:26176,15308704:26177,15308708:26178,15308710:26179,15308957:26180,15308958:26181,15308962:26182,15308964:26183,15308965:26184,15308966:26185,15308972:26186,15308977:26187,15308979:26188,15308983:26189,15308984:26190,15308985:26191,15308986:26192,15308988:26193,15308989:26194,15309185:26195,15309202:26196,15309204:26197,15309206:26198,15309207:26199,15309208:26200,15309217:26201,15309230:26202,15309236:26203,15309243:26204,15309244:26205,15309246:26206,15309247:26207,15309441:26208,15309442:26209,15309443:26210,15309444:26211,15309449:26212,15309457:26213,15309462:26214,15309466:26215,15309469:26216,15309471:26217,15309476:26218,15309477:26219,15309478:26220,15309481:26221,15309486:26222,15309487:26223,15309491:26224,15309498:26225,15309706:26226,15309714:26227,15054514:26228,15309720:26229,15309722:26230,15309725:26231,15309726:26232,15309727:26233,15309737:26234,15309743:26235,15309745:26236,15309754:26237,15309954:26238,15309955:26401,15309957:26402,15309961:26403,15309978:26404,15309979:26405,15309981:26406,15309985:26407,15309986:26408,15309987:26409,15309992:26410,15310001:26411,15310003:26412,15310209:26413,15310211:26414,15310218:26415,15310222:26416,15310223:26417,15310229:26418,15310231:26419,15310232:26420,15310234:26421,15310235:26422,15310243:26423,15310247:26424,15310250:26425,15310254:26426,15310259:26427,15310262:26428,15310263:26429,15310264:26430,15310267:26431,15310269:26432,15310271:26433,15310464:26434,15310473:26435,15310485:26436,15310486:26437,15310487:26438,15310489:26439,15310490:26440,15310494:26441,15310495:26442,15310498:26443,15310508:26444,15310510:26445,15310513:26446,15310514:26447,15310517:26448,15310518:26449,15310520:26450,15310521:26451,15310522:26452,15310524:26453,15310526:26454,15310527:26455,15310721:26456,15310724:26457,15310725:26458,15310727:26459,15310729:26460,15310730:26461,15310732:26462,15310733:26463,15310734:26464,15310736:26465,15310737:26466,15310740:26467,15310743:26468,15310744:26469,15310745:26470,15310749:26471,15310750:26472,15310752:26473,15310747:26474,15310753:26475,15310756:26476,15310767:26477,15310769:26478,15310772:26479,15310775:26480,15310776:26481,15310778:26482,15310983:26483,15310986:26484,15311001:26485,15310989:26486,15310990:26487,15310996:26488,15310998:26489,15311004:26490,15311006:26491,15311008:26492,15311011:26493,15311014:26494,15311019:26657,15311022:26658,15311023:26659,15311024:26660,15311026:26661,15311027:26662,15311029:26663,15311013:26664,15311038:26665,15311236:26666,15311239:26667,15311242:26668,15311249:26669,15311250:26670,15311251:26671,15311254:26672,15311255:26673,15311257:26674,15311258:26675,15311266:26676,15311267:26677,15311269:26678,15311270:26679,15311274:26680,15311276:26681,15311531:26682,15311533:26683,15311534:26684,15311536:26685,15311540:26686,15311543:26687,15311544:26688,15311546:26689,15311547:26690,15311551:26691,15311746:26692,15311749:26693,15311752:26694,15311756:26695,15311777:26696,15311779:26697,15311781:26698,15311782:26699,15311783:26700,15311786:26701,15311795:26702,15311798:26703,15312002:26704,15312007:26705,15312008:26706,15312017:26707,15312021:26708,15312022:26709,15312023:26710,15312026:26711,15312027:26712,15312028:26713,15312031:26714,15312034:26715,15312038:26716,15312039:26717,15312043:26718,15312049:26719,15312050:26720,15312051:26721,15312052:26722,15312053:26723,15312057:26724,15312058:26725,15312059:26726,15312060:26727,15312256:26728,15312257:26729,15312262:26730,15312263:26731,15312264:26732,15312269:26733,15312270:26734,15312276:26735,15312280:26736,15312281:26737,15312283:26738,15312284:26739,15312286:26740,15312287:26741,15312288:26742,15312539:26743,15312541:26744,15312543:26745,15312550:26746,15312560:26747,15312561:26748,15312562:26749,15312565:26750,15312569:26913,15312570:26914,15312573:26915,15312575:26916,15312771:26917,15312777:26918,15312787:26919,15312788:26920,15312793:26921,15312794:26922,15312796:26923,15312798:26924,15312807:26925,15312810:26926,15312811:26927,15312812:26928,15312816:26929,15312820:26930,15312821:26931,15312825:26932,15312829:26933,15312830:26934,15313026:26935,15313027:26936,15313028:26937,15313035:26938,15313036:26939,15313040:26940,15313041:26941,15313046:26942,15313054:26943,15313056:26944,15313058:26945,15313059:26946,15313060:26947,15313063:26948,15313069:26949,15313070:26950,15313075:26951,15313077:26952,15313078:26953,15313080:26954,15313287:26955,15313281:26956,15313284:26957,15313290:26958,15313291:26959,15313292:26960,15313294:26961,15313297:26962,15313300:26963,15313302:26964,15313309:26965,15313578:26966,15313580:26967,15313582:26968,15313583:26969,15313586:26970,15313588:26971,15313589:26972,15313590:26973,15313593:26974,15313595:26975,15313598:26976,15313599:26977,15313793:26978,15313795:26979,15313798:26980,15313800:26981,15313806:26982,15313808:26983,15313810:26984,15313813:26985,15313814:26986,15313815:26987,15313819:26988,15313820:26989,15313824:26990,15313828:26991,15313829:26992,15313831:26993,15313833:26994,15313836:26995,15313842:26996,15313843:26997,15313845:26998,15313849:26999,15313850:27e3,15313853:27001,15313855:27002,15314048:27003,15314049:27004,15314050:27005,15314051:27006,15314052:27169,15314053:27170,15314056:27171,15314057:27172,15314059:27173,15314060:27174,15314061:27175,15314062:27176,15314064:27177,15314066:27178,15314070:27179,15314073:27180,15314075:27181,15314076:27182,15314080:27183,15314086:27184,15314091:27185,15314093:27186,15314099:27187,15314100:27188,15314101:27189,15314103:27190,15314105:27191,15314106:27192,15314109:27193,15314312:27194,15314315:27195,15314316:27196,15314325:27197,15314326:27198,15314327:27199,15314331:27200,15314334:27201,15314337:27202,15314339:27203,15314341:27204,15314342:27205,15314344:27206,15314346:27207,15314347:27208,15314348:27209,15314349:27210,15314350:27211,15314355:27212,15314357:27213,15314359:27214,15314360:27215,15314361:27216,15314367:27217,15314560:27218,15314564:27219,15314565:27220,15314566:27221,15314567:27222,15314569:27223,15314570:27224,15314571:27225,15314573:27226,15314575:27227,15314576:27228,15314580:27229,15314586:27230,15314589:27231,15314590:27232,15314598:27233,15314599:27234,15314601:27235,15314604:27236,15314608:27237,15314609:27238,15314610:27239,15314615:27240,15314616:27241,15314619:27242,15314620:27243,15314622:27244,15314623:27245,15314817:27246,15314823:27247,15314824:27248,15314830:27249,15314832:27250,15314839:27251,15314840:27252,15314845:27253,15314847:27254,15314853:27255,15314855:27256,15314858:27257,15314859:27258,15314863:27259,15314867:27260,15314871:27261,15314872:27262,15314873:27425,15314874:27426,15314877:27427,15314879:27428,15315072:27429,15315074:27430,15315083:27431,15315087:27432,15315089:27433,15315094:27434,15315096:27435,15315097:27436,15315098:27437,15315100:27438,15315102:27439,15315106:27440,15315107:27441,15315110:27442,15315111:27443,15315112:27444,15315113:27445,15315114:27446,15315121:27447,15315125:27448,15315126:27449,15315127:27450,15315133:27451,15315329:27452,15315331:27453,15315332:27454,15315333:27455,15315337:27456,15315338:27457,15315342:27458,15315343:27459,15315344:27460,15315347:27461,15315348:27462,15315350:27463,15315352:27464,15315355:27465,15315357:27466,15315358:27467,15315359:27468,15315363:27469,15315369:27470,15315370:27471,15315356:27472,15315371:27473,15315368:27474,15315374:27475,15315376:27476,15315378:27477,15315381:27478,15315383:27479,15315387:27480,15315878:27481,15315890:27482,15315895:27483,15315897:27484,15316107:27485,15316098:27486,15316113:27487,15316119:27488,15316120:27489,15316124:27490,15316125:27491,15316126:27492,15316143:27493,15316144:27494,15316146:27495,15316147:27496,15316148:27497,15316154:27498,15316156:27499,15316357:27500,15316157:27501,15316354:27502,15316355:27503,15316359:27504,15316362:27505,15316371:27506,15316372:27507,15316383:27508,15316387:27509,15316386:27510,15316389:27511,15316393:27512,15316394:27513,15316395:27514,15316400:27515,15316406:27516,15316407:27517,15316411:27518,15316412:27681,15316414:27682,15316611:27683,15316612:27684,15316614:27685,15316618:27686,15316621:27687,15316622:27688,15316626:27689,15316627:27690,15316629:27691,15316630:27692,15316631:27693,15316632:27694,15316641:27695,15316650:27696,15316652:27697,15316654:27698,15316657:27699,15316661:27700,15316665:27701,15316668:27702,15316671:27703,15316867:27704,15316871:27705,15316873:27706,15316874:27707,15316884:27708,15316885:27709,15316886:27710,15316887:27711,15316890:27712,15316894:27713,15316895:27714,15316896:27715,15316901:27716,15316903:27717,15316905:27718,15316907:27719,15316910:27720,15316912:27721,15316915:27722,15316916:27723,15316926:27724,15317130:27725,15317122:27726,15317127:27727,15317134:27728,15317136:27729,15317137:27730,15317138:27731,15317141:27732,15317142:27733,15317145:27734,15317148:27735,15317149:27736,15317434:27737,15317435:27738,15317436:27739,15317632:27740,15317634:27741,15317635:27742,15317636:27743,15317637:27744,15317639:27745,15317646:27746,15317647:27747,15317654:27748,15317656:27749,15317659:27750,15317662:27751,15317668:27752,15317672:27753,15317676:27754,15317678:27755,15317679:27756,15317680:27757,15317683:27758,15317684:27759,15317685:27760,15317894:27761,15317896:27762,15317899:27763,15317909:27764,15317919:27765,15317924:27766,15317927:27767,15317932:27768,15317933:27769,15317934:27770,15317936:27771,15317937:27772,15317938:27773,15317941:27774,15317944:27937,15317951:27938,15318146:27939,15318147:27940,15318153:27941,15318159:27942,15318160:27943,15318161:27944,15318162:27945,15318164:27946,15318166:27947,15318167:27948,15318169:27949,15318170:27950,15318171:27951,15318175:27952,15318178:27953,15318182:27954,15318186:27955,15318187:27956,15318191:27957,15318193:27958,15318194:27959,15318196:27960,15318199:27961,15318201:27962,15318202:27963,15318204:27964,15318205:27965,15318207:27966,15318401:27967,15318403:27968,15318404:27969,15318405:27970,15318406:27971,15318407:27972,15318419:27973,15318421:27974,15318422:27975,15318423:27976,15318424:27977,15318426:27978,15318429:27979,15318430:27980,15318440:27981,15318441:27982,15318445:27983,15318446:27984,15318447:27985,15318448:27986,15318449:27987,15318451:27988,15318453:27989,15318458:27990,15318461:27991,15318671:27992,15318672:27993,15318673:27994,15318674:27995,15318676:27996,15318678:27997,15318679:27998,15318686:27999,15318689:28e3,15318690:28001,15318691:28002,15318693:28003,14909596:8513},ts=null,rs=ts,is=null,ns=is;Xr.UTF8_TO_JIS_TABLE=$a;Xr.UTF8_TO_JISX0212_TABLE=es;Xr.JIS_TO_UTF8_TABLE=rs;Xr.JISX0212_TO_UTF8_TABLE=ns;var fn=wt,ur=Xr;Zt.FALLBACK_CHARACTER=63;var os=Zt.HAS_TYPED=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined",T0=!1,O0=!1;try{String.fromCharCode.apply(null,[97])==="a"&&(T0=!0)}catch{}if(os)try{String.fromCharCode.apply(null,new Uint8Array([97]))==="a"&&(O0=!0)}catch{}Zt.CAN_CHARCODE_APPLY=T0;Zt.CAN_CHARCODE_APPLY_TYPED=O0;Zt.APPLY_BUFFER_SIZE=65533;Zt.APPLY_BUFFER_SIZE_OK=null;var _i=Zt.EncodingNames={UTF32:{order:0},UTF32BE:{alias:["UCS4"]},UTF32LE:null,UTF16:{order:1},UTF16BE:{alias:["UCS2"]},UTF16LE:null,BINARY:{order:2},ASCII:{order:3,alias:["ISO646","CP367"]},JIS:{order:4,alias:["ISO2022JP"]},UTF8:{order:5},EUCJP:{order:6},SJIS:{order:7,alias:["CP932","MSKANJI","WINDOWS31J"]},UNICODE:{order:8}},I0={};Zt.EncodingAliases=I0;Zt.EncodingOrders=function(){for(var r=I0,e=fn.objectKeys(_i),t=[],i,o,s,u,g=0,B=e.length;g<B;g++)if(i=e[g],r[i]=i,o=_i[i],o!=null&&(o.order!=null&&(t[t.length]=i),o.alias))for(s=0,u=o.alias.length;s<u;s++)r[o.alias[s]]=i;return t.sort(function(_,m){return _i[_].order-_i[m].order}),t}();function as(){if(ur.JIS_TO_UTF8_TABLE===null){ur.JIS_TO_UTF8_TABLE={};for(var r=fn.objectKeys(ur.UTF8_TO_JIS_TABLE),e=0,t=r.length,i,o;e<t;e++)i=r[e],o=ur.UTF8_TO_JIS_TABLE[i],o>95&&(ur.JIS_TO_UTF8_TABLE[o]=i|0);for(ur.JISX0212_TO_UTF8_TABLE={},r=fn.objectKeys(ur.UTF8_TO_JISX0212_TABLE),t=r.length,e=0;e<t;e++)i=r[e],o=ur.UTF8_TO_JISX0212_TABLE[i],ur.JISX0212_TO_UTF8_TABLE[o]=i|0}}Zt.init_JIS_TO_UTF8_TABLE=as;var Qt={};function ss(r){for(var e=0,t=r&&r.length,i;e<t;e++){if(i=r[e],i>255)return!1;if(i>=0&&i<=7||i===255)return!0}return!1}Qt.isBINARY=ss;function xs(r){for(var e=0,t=r&&r.length,i;e<t;e++)if(i=r[e],i>255||i>=128&&i<=255||i===27)return!1;return!0}Qt.isASCII=xs;function ls(r){for(var e=0,t=r&&r.length,i,o,s;e<t;e++){if(i=r[e],i>255||i>=128&&i<=255)return!1;if(i===27){if(e+2>=t)return!1;if(o=r[e+1],s=r[e+2],o===36){if(s===40||s===64||s===66)return!0}else{if(o===38&&s===64)return!0;if(o===40&&(s===66||s===73||s===74))return!0}}}return!1}Qt.isJIS=ls;function hs(r){for(var e=0,t=r&&r.length,i;e<t;e++)if(i=r[e],!(i<128)){if(i>255||i<142)return!1;if(i===142){if(e+1>=t||(i=r[++e],i<161||223<i))return!1}else if(i===143){if(e+2>=t||(i=r[++e],i<162||237<i)||(i=r[++e],i<161||254<i))return!1}else if(161<=i&&i<=254){if(e+1>=t||(i=r[++e],i<161||254<i))return!1}else return!1}return!0}Qt.isEUCJP=hs;function cs(r){for(var e=0,t=r&&r.length,i;e<t&&r[e]>128;)if(r[e++]>255)return!1;for(;e<t;e++)if(i=r[e],!(i<=128||161<=i&&i<=223)&&(i===160||i>239||e+1>=t||(i=r[++e],i<64||i===127||i>252)))return!1;return!0}Qt.isSJIS=cs;function us(r){for(var e=0,t=r&&r.length,i;e<t;e++){if(i=r[e],i>255)return!1;if(!(i===9||i===10||i===13||i>=32&&i<=126))if(i>=194&&i<=223){if(e+1>=t||r[e+1]<128||r[e+1]>191)return!1;e++}else if(i===224){if(e+2>=t||r[e+1]<160||r[e+1]>191||r[e+2]<128||r[e+2]>191)return!1;e+=2}else if(i>=225&&i<=236||i===238||i===239){if(e+2>=t||r[e+1]<128||r[e+1]>191||r[e+2]<128||r[e+2]>191)return!1;e+=2}else if(i===237){if(e+2>=t||r[e+1]<128||r[e+1]>159||r[e+2]<128||r[e+2]>191)return!1;e+=2}else if(i===240){if(e+3>=t||r[e+1]<144||r[e+1]>191||r[e+2]<128||r[e+2]>191||r[e+3]<128||r[e+3]>191)return!1;e+=3}else if(i>=241&&i<=243){if(e+3>=t||r[e+1]<128||r[e+1]>191||r[e+2]<128||r[e+2]>191||r[e+3]<128||r[e+3]>191)return!1;e+=3}else if(i===244){if(e+3>=t||r[e+1]<128||r[e+1]>143||r[e+2]<128||r[e+2]>191||r[e+3]<128||r[e+3]>191)return!1;e+=3}else return!1}return!0}Qt.isUTF8=us;function fs(r){var e=0,t=r&&r.length,i=null,o,s,u,g;if(t<2){if(r[0]>255)return!1}else{if(o=r[0],s=r[1],o===255&&s===254||o===254&&s===255)return!0;for(;e<t;e++)if(r[e]===0){i=e;break}else if(r[e]>255)return!1;if(i===null)return!1;if(u=r[i+1],u!==void 0&&u>0&&u<128||(g=r[i-1],g!==void 0&&g>0&&g<128))return!0}return!1}Qt.isUTF16=fs;function Es(r){var e=0,t=r&&r.length,i=null,o,s;if(t<2){if(r[0]>255)return!1}else{if(o=r[0],s=r[1],o===254&&s===255)return!0;for(;e<t;e++)if(r[e]===0){i=e;break}else if(r[e]>255)return!1;if(i===null)return!1;if(i%2===0)return!0}return!1}Qt.isUTF16BE=Es;function ds(r){var e=0,t=r&&r.length,i=null,o,s;if(t<2){if(r[0]>255)return!1}else{if(o=r[0],s=r[1],o===255&&s===254)return!0;for(;e<t;e++)if(r[e]===0){i=e;break}else if(r[e]>255)return!1;if(i===null)return!1;if(i%2!==0)return!0}return!1}Qt.isUTF16LE=ds;function gs(r){var e=0,t=r&&r.length,i=null,o,s,u,g,B,_;if(t<4){for(;e<t;e++)if(r[e]>255)return!1}else{if(o=r[0],s=r[1],u=r[2],g=r[3],o===0&&s===0&&u===254&&g===255||o===255&&s===254&&u===0&&g===0)return!0;for(;e<t;e++)if(r[e]===0&&r[e+1]===0&&r[e+2]===0){i=e;break}else if(r[e]>255)return!1;if(i===null)return!1;if(B=r[i+3],B!==void 0&&B>0&&B<=127)return r[i+2]===0&&r[i+1]===0;if(_=r[i-1],_!==void 0&&_>0&&_<=127)return r[i+1]===0&&r[i+2]===0}return!1}Qt.isUTF32=gs;function As(r){for(var e=0,t=r&&r.length,i;e<t;e++)if(i=r[e],i<0||i>1114111)return!1;return!0}Qt.isUNICODE=As;var Le={},qt=Zt,Rn=wt,Pn=Qt,lr=Xr;function ps(r){for(var e=[],t=0,i=0,o=r&&r.length,s,u;i<o;i++){for(;r[i]===27;)if(r[i+1]===36&&r[i+2]===66||r[i+1]===36&&r[i+2]===64?t=1:r[i+1]===40&&r[i+2]===73?t=2:r[i+1]===36&&r[i+2]===40&&r[i+3]===68?(t=3,i++):t=0,i+=3,r[i]===void 0)return e;t===1?(s=r[i],u=r[++i],s&1?(s>>=1,s<47?s+=113:s-=79,u>95?u+=32:u+=31):(s>>=1,s<=47?s+=112:s-=80,u+=126),e[e.length]=s&255,e[e.length]=u&255):t===2?e[e.length]=r[i]+128&255:t===3?e[e.length]=qt.FALLBACK_CHARACTER:e[e.length]=r[i]&255}return e}Le.JISToSJIS=ps;function Bs(r){for(var e=[],t=0,i=r&&r.length,o=0;o<i;o++){for(;r[o]===27;)if(r[o+1]===36&&r[o+2]===66||r[o+1]===36&&r[o+2]===64?t=1:r[o+1]===40&&r[o+2]===73?t=2:r[o+1]===36&&r[o+2]===40&&r[o+3]===68?(t=3,o++):t=0,o+=3,r[o]===void 0)return e;t===1?(e[e.length]=r[o]+128&255,e[e.length]=r[++o]+128&255):t===2?(e[e.length]=142,e[e.length]=r[o]+128&255):t===3?(e[e.length]=143,e[e.length]=r[o]+128&255,e[e.length]=r[++o]+128&255):e[e.length]=r[o]&255}return e}Le.JISToEUCJP=Bs;function vs(r){for(var e=[],t=0,i=r&&r.length,o=0,s,u,g=[27,40,66,27,36,66,27,40,73];o<i;o++)s=r[o],s>=161&&s<=223?(t!==2&&(t=2,e[e.length]=g[6],e[e.length]=g[7],e[e.length]=g[8]),e[e.length]=s-128&255):s>=128?(t!==1&&(t=1,e[e.length]=g[3],e[e.length]=g[4],e[e.length]=g[5]),s<<=1,u=r[++o],u<159?(s<319?s-=225:s-=97,u>126?u-=32:u-=31):(s<319?s-=224:s-=96,u-=126),e[e.length]=s&255,e[e.length]=u&255):(t!==0&&(t=0,e[e.length]=g[0],e[e.length]=g[1],e[e.length]=g[2]),e[e.length]=s&255);return t!==0&&(e[e.length]=g[0],e[e.length]=g[1],e[e.length]=g[2]),e}Le.SJISToJIS=vs;function _s(r){for(var e=[],t=r&&r.length,i=0,o,s;i<t;i++)o=r[i],o>=161&&o<=223?(e[e.length]=142,e[e.length]=o):o>=129?(s=r[++i],o<<=1,s<159?(o<319?o-=97:o-=225,s>126?s+=96:s+=97):(o<319?o-=96:o-=224,s+=2),e[e.length]=o&255,e[e.length]=s&255):e[e.length]=o&255;return e}Le.SJISToEUCJP=_s;function Cs(r){for(var e=[],t=0,i=r&&r.length,o=0,s,u=[27,40,66,27,36,66,27,40,73,27,36,40,68];o<i;o++)s=r[o],s===142?(t!==2&&(t=2,e[e.length]=u[6],e[e.length]=u[7],e[e.length]=u[8]),e[e.length]=r[++o]-128&255):s===143?(t!==3&&(t=3,e[e.length]=u[9],e[e.length]=u[10],e[e.length]=u[11],e[e.length]=u[12]),e[e.length]=r[++o]-128&255,e[e.length]=r[++o]-128&255):s>142?(t!==1&&(t=1,e[e.length]=u[3],e[e.length]=u[4],e[e.length]=u[5]),e[e.length]=s-128&255,e[e.length]=r[++o]-128&255):(t!==0&&(t=0,e[e.length]=u[0],e[e.length]=u[1],e[e.length]=u[2]),e[e.length]=s&255);return t!==0&&(e[e.length]=u[0],e[e.length]=u[1],e[e.length]=u[2]),e}Le.EUCJPToJIS=Cs;function ms(r){for(var e=[],t=r&&r.length,i=0,o,s;i<t;i++)o=r[i],o===143?(e[e.length]=qt.FALLBACK_CHARACTER,i+=2):o>142?(s=r[++i],o&1?(o>>=1,o<111?o+=49:o+=113,s>223?s-=96:s-=97):(o>>=1,o<=111?o+=48:o+=112,s-=2),e[e.length]=o&255,e[e.length]=s&255):o===142?e[e.length]=r[++i]&255:e[e.length]=o&255;return e}Le.EUCJPToSJIS=ms;function si(r){qt.init_JIS_TO_UTF8_TABLE();for(var e=[],t=0,i=r&&r.length,o,s,u,g,B,_,m;t<i;t++)o=r[t],o>=161&&o<=223?(u=o-64,g=188|u>>6&3,B=128|u&63,e[e.length]=239,e[e.length]=g&255,e[e.length]=B&255):o>=128?(s=o<<1,u=r[++t],u<159?(s<319?s-=225:s-=97,u>126?u-=32:u-=31):(s<319?s-=224:s-=96,u-=126),s&=255,_=(s<<8)+u,m=lr.JIS_TO_UTF8_TABLE[_],m===void 0?e[e.length]=qt.FALLBACK_CHARACTER:m<65535?(e[e.length]=m>>8&255,e[e.length]=m&255):(e[e.length]=m>>16&255,e[e.length]=m>>8&255,e[e.length]=m&255)):e[e.length]=r[t]&255;return e}Le.SJISToUTF8=si;function xi(r){qt.init_JIS_TO_UTF8_TABLE();for(var e=[],t=0,i=r&&r.length,o,s,u,g,B,_,m,D;t<i;t++)o=r[t],o===142?(s=r[++t]-64,u=188|s>>6&3,g=128|s&63,e[e.length]=239,e[e.length]=u&255,e[e.length]=g&255):o===143?(B=r[++t]-128,_=r[++t]-128,m=(B<<8)+_,D=lr.JISX0212_TO_UTF8_TABLE[m],D===void 0?e[e.length]=qt.FALLBACK_CHARACTER:D<65535?(e[e.length]=D>>8&255,e[e.length]=D&255):(e[e.length]=D>>16&255,e[e.length]=D>>8&255,e[e.length]=D&255)):o>=128?(m=(o-128<<8)+(r[++t]-128),D=lr.JIS_TO_UTF8_TABLE[m],D===void 0?e[e.length]=qt.FALLBACK_CHARACTER:D<65535?(e[e.length]=D>>8&255,e[e.length]=D&255):(e[e.length]=D>>16&255,e[e.length]=D>>8&255,e[e.length]=D&255)):e[e.length]=r[t]&255;return e}Le.EUCJPToUTF8=xi;function li(r){qt.init_JIS_TO_UTF8_TABLE();for(var e=[],t=0,i=0,o=r&&r.length,s,u,g,B,_;i<o;i++){for(;r[i]===27;)if(r[i+1]===36&&r[i+2]===66||r[i+1]===36&&r[i+2]===64?t=1:r[i+1]===40&&r[i+2]===73?t=2:r[i+1]===36&&r[i+2]===40&&r[i+3]===68?(t=3,i++):t=0,i+=3,r[i]===void 0)return e;t===1?(B=(r[i]<<8)+r[++i],_=lr.JIS_TO_UTF8_TABLE[B],_===void 0?e[e.length]=qt.FALLBACK_CHARACTER:_<65535?(e[e.length]=_>>8&255,e[e.length]=_&255):(e[e.length]=_>>16&255,e[e.length]=_>>8&255,e[e.length]=_&255)):t===2?(s=r[i]+64,u=188|s>>6&3,g=128|s&63,e[e.length]=239,e[e.length]=u&255,e[e.length]=g&255):t===3?(B=(r[i]<<8)+r[++i],_=lr.JISX0212_TO_UTF8_TABLE[B],_===void 0?e[e.length]=qt.FALLBACK_CHARACTER:_<65535?(e[e.length]=_>>8&255,e[e.length]=_&255):(e[e.length]=_>>16&255,e[e.length]=_>>8&255,e[e.length]=_&255)):e[e.length]=r[i]&255}return e}Le.JISToUTF8=li;function hi(r,e){for(var t=[],i=0,o=r&&r.length,s,u,g,B,_,m,D=e&&e.fallback;i<o;i++)s=r[i],s>=128?(s<=223?(B=[s,r[i+1]],_=(s<<8)+r[++i]):s<=239?(B=[s,r[i+1],r[i+2]],_=(s<<16)+(r[++i]<<8)+(r[++i]&255)):(B=[s,r[i+1],r[i+2],r[i+3]],_=(s<<24)+(r[++i]<<16)+(r[++i]<<8)+(r[++i]&255)),m=lr.UTF8_TO_JIS_TABLE[_],m==null?D?Ln(t,B,D):t[t.length]=qt.FALLBACK_CHARACTER:m<255?t[t.length]=m+128:(m>65536&&(m-=65536),u=m>>8,g=m&255,u&1?(u>>=1,u<47?u+=113:u-=79,g>95?g+=32:g+=31):(u>>=1,u<=47?u+=112:u-=80,g+=126),t[t.length]=u&255,t[t.length]=g&255)):t[t.length]=r[i]&255;return t}Le.UTF8ToSJIS=hi;function ci(r,e){for(var t=[],i=0,o=r&&r.length,s,u,g,B,_=e&&e.fallback;i<o;i++)s=r[i],s>=128?(s<=223?(u=[s,r[i+1]],g=(s<<8)+r[++i]):s<=239?(u=[s,r[i+1],r[i+2]],g=(s<<16)+(r[++i]<<8)+(r[++i]&255)):(u=[s,r[i+1],r[i+2],r[i+3]],g=(s<<24)+(r[++i]<<16)+(r[++i]<<8)+(r[++i]&255)),B=lr.UTF8_TO_JIS_TABLE[g],B==null?(B=lr.UTF8_TO_JISX0212_TABLE[g],B==null?_?Ln(t,u,_):t[t.length]=qt.FALLBACK_CHARACTER:(t[t.length]=143,t[t.length]=(B>>8)-128&255,t[t.length]=(B&255)-128&255)):(B>65536&&(B-=65536),B<255?(t[t.length]=142,t[t.length]=B-128&255):(t[t.length]=(B>>8)-128&255,t[t.length]=(B&255)-128&255))):t[t.length]=r[i]&255;return t}Le.UTF8ToEUCJP=ci;function ui(r,e){for(var t=[],i=0,o=r&&r.length,s=0,u,g,B,_,m=e&&e.fallback,D=[27,40,66,27,36,66,27,40,73,27,36,40,68];s<o;s++)u=r[s],u<128?(i!==0&&(i=0,t[t.length]=D[0],t[t.length]=D[1],t[t.length]=D[2]),t[t.length]=u&255):(u<=223?(g=[u,r[s+1]],B=(u<<8)+r[++s]):u<=239?(g=[u,r[s+1],r[s+2]],B=(u<<16)+(r[++s]<<8)+(r[++s]&255)):(g=[u,r[s+1],r[s+2],r[s+3]],B=(u<<24)+(r[++s]<<16)+(r[++s]<<8)+(r[++s]&255)),_=lr.UTF8_TO_JIS_TABLE[B],_==null?(_=lr.UTF8_TO_JISX0212_TABLE[B],_==null?(i!==0&&(i=0,t[t.length]=D[0],t[t.length]=D[1],t[t.length]=D[2]),m?Ln(t,g,m):t[t.length]=qt.FALLBACK_CHARACTER):(i!==3&&(i=3,t[t.length]=D[9],t[t.length]=D[10],t[t.length]=D[11],t[t.length]=D[12]),t[t.length]=_>>8&255,t[t.length]=_&255)):(_>65536&&(_-=65536),_<255?(i!==2&&(i=2,t[t.length]=D[6],t[t.length]=D[7],t[t.length]=D[8]),t[t.length]=_&255):(i!==1&&(i=1,t[t.length]=D[3],t[t.length]=D[4],t[t.length]=D[5]),t[t.length]=_>>8&255,t[t.length]=_&255)));return i!==0&&(t[t.length]=D[0],t[t.length]=D[1],t[t.length]=D[2]),t}Le.UTF8ToJIS=ui;function Mr(r){for(var e=[],t=0,i=r&&r.length,o,s;t<i;t++)o=r[t],o>=55296&&o<=56319&&t+1<i&&(s=r[t+1],s>=56320&&s<=57343&&(o=(o-55296)*1024+s-56320+65536,t++)),o<128?e[e.length]=o:o<2048?(e[e.length]=192|o>>6&31,e[e.length]=128|o&63):o<65536?(e[e.length]=224|o>>12&15,e[e.length]=128|o>>6&63,e[e.length]=128|o&63):o<2097152&&(e[e.length]=240|o>>18&15,e[e.length]=128|o>>12&63,e[e.length]=128|o>>6&63,e[e.length]=128|o&63);return e}Le.UNICODEToUTF8=Mr;function mr(r,e){for(var t=[],i=0,o=r&&r.length,s,u,g,B,_,m,D=e&&e.ignoreSurrogatePair;i<o;)u=r[i++],s=u>>4,s>=0&&s<=7?m=u:s===12||s===13?(g=r[i++],m=(u&31)<<6|g&63):s===14?(g=r[i++],B=r[i++],m=(u&15)<<12|(g&63)<<6|B&63):s===15&&(g=r[i++],B=r[i++],_=r[i++],m=(u&7)<<18|(g&63)<<12|(B&63)<<6|_&63),m<=65535||D?t[t.length]=m:(m-=65536,t[t.length]=(m>>10)+55296,t[t.length]=m%1024+56320);return t}Le.UTF8ToUNICODE=mr;function R0(r,e){var t;if(e&&e.bom){var i=e.bom;Rn.isString(i)||(i="BE");var o,s;i.charAt(0).toUpperCase()==="B"?(o=[254,255],s=Li(r)):(o=[255,254],s=Mn(r)),t=[],t[0]=o[0],t[1]=o[1];for(var u=0,g=s.length;u<g;u++)t[t.length]=s[u]}else t=Li(r);return t}Le.UNICODEToUTF16=R0;function Li(r){for(var e=[],t=0,i=r&&r.length,o;t<i;)o=r[t++],o<=255?(e[e.length]=0,e[e.length]=o):o<=65535&&(e[e.length]=o>>8&255,e[e.length]=o&255);return e}Le.UNICODEToUTF16BE=Li;function Mn(r){for(var e=[],t=0,i=r&&r.length,o;t<i;)o=r[t++],o<=255?(e[e.length]=o,e[e.length]=0):o<=65535&&(e[e.length]=o&255,e[e.length]=o>>8&255);return e}Le.UNICODEToUTF16LE=Mn;function P0(r){var e=[],t=0,i=r&&r.length,o,s;for(i>=2&&(r[0]===254&&r[1]===255||r[0]===255&&r[1]===254)&&(t=2);t<i;)o=r[t++],s=r[t++],o===0?e[e.length]=s:e[e.length]=(o&255)<<8|s&255;return e}Le.UTF16BEToUNICODE=P0;function M0(r){var e=[],t=0,i=r&&r.length,o,s;for(i>=2&&(r[0]===254&&r[1]===255||r[0]===255&&r[1]===254)&&(t=2);t<i;)o=r[t++],s=r[t++],s===0?e[e.length]=o:e[e.length]=(s&255)<<8|o&255;return e}Le.UTF16LEToUNICODE=M0;function L0(r){for(var e=[],t=0,i=r&&r.length,o=!1,s=!0,u,g;t<i;){if(u=r[t++],g=r[t++],s&&t===2){s=!1,u===254&&g===255?o=!1:u===255&&g===254?o=!0:(o=Pn.isUTF16LE(r),t=0);continue}o?g===0?e[e.length]=u:e[e.length]=(g&255)<<8|u&255:u===0?e[e.length]=g:e[e.length]=(u&255)<<8|g&255}return e}Le.UTF16ToUNICODE=L0;function ys(r){for(var e=[],t=0,i=r&&r.length,o=!1,s=!0,u,g;t<i;){if(u=r[t++],g=r[t++],s&&t===2){s=!1,u===254&&g===255?o=!1:u===255&&g===254?o=!0:(o=Pn.isUTF16LE(r),t=0);continue}o?(e[e.length]=g,e[e.length]=u):(e[e.length]=u,e[e.length]=g)}return e}Le.UTF16ToUTF16BE=ys;function Ds(r,e){var t=!1,i;if(e&&e.bom){var o=e.bom;Rn.isString(o)||(o="BE"),o.charAt(0).toUpperCase()==="B"?i=[254,255]:(i=[255,254],t=!0)}var s=[],u=r&&r.length,g=0;u>=2&&(r[0]===254&&r[1]===255||r[0]===255&&r[1]===254)&&(g=2),i&&(s[0]=i[0],s[1]=i[1]);for(var B,_;g<u;)B=r[g++],_=r[g++],t?(s[s.length]=_,s[s.length]=B):(s[s.length]=B,s[s.length]=_);return s}Le.UTF16BEToUTF16=Ds;function ws(r){for(var e=[],t=0,i=r&&r.length,o=!1,s=!0,u,g;t<i;){if(u=r[t++],g=r[t++],s&&t===2){s=!1,u===254&&g===255?o=!1:u===255&&g===254?o=!0:(o=Pn.isUTF16LE(r),t=0);continue}o?(e[e.length]=u,e[e.length]=g):(e[e.length]=g,e[e.length]=u)}return e}Le.UTF16ToUTF16LE=ws;function Fs(r,e){var t=!1,i;if(e&&e.bom){var o=e.bom;Rn.isString(o)||(o="BE"),o.charAt(0).toUpperCase()==="B"?i=[254,255]:(i=[255,254],t=!0)}var s=[],u=r&&r.length,g=0;u>=2&&(r[0]===254&&r[1]===255||r[0]===255&&r[1]===254)&&(g=2),i&&(s[0]=i[0],s[1]=i[1]);for(var B,_;g<u;)B=r[g++],_=r[g++],t?(s[s.length]=B,s[s.length]=_):(s[s.length]=_,s[s.length]=B);return s}Le.UTF16LEToUTF16=Fs;function k0(r){var e=[],t=0,i=r&&r.length,o,s;for(i>=2&&(r[0]===254&&r[1]===255||r[0]===255&&r[1]===254)&&(t=2);t<i;)o=r[t++],s=r[t++],e[e.length]=s,e[e.length]=o;return e}Le.UTF16BEToUTF16LE=k0;function Ss(r){return k0(r)}Le.UTF16LEToUTF16BE=Ss;function bs(r,e){return ui(Mr(r),e)}Le.UNICODEToJIS=bs;function Ts(r){return mr(li(r))}Le.JISToUNICODE=Ts;function Os(r,e){return ci(Mr(r),e)}Le.UNICODEToEUCJP=Os;function Is(r){return mr(xi(r))}Le.EUCJPToUNICODE=Is;function Rs(r,e){return hi(Mr(r),e)}Le.UNICODEToSJIS=Rs;function Ps(r){return mr(si(r))}Le.SJISToUNICODE=Ps;function Vi(r,e){return R0(mr(r),e)}Le.UTF8ToUTF16=Vi;function Gi(r){return Mr(L0(r))}Le.UTF16ToUTF8=Gi;function Wi(r){return Li(mr(r))}Le.UTF8ToUTF16BE=Wi;function Hi(r){return Mr(P0(r))}Le.UTF16BEToUTF8=Hi;function Xi(r){return Mn(mr(r))}Le.UTF8ToUTF16LE=Xi;function Yi(r){return Mr(M0(r))}Le.UTF16LEToUTF8=Yi;function Ms(r,e){return Vi(li(r),e)}Le.JISToUTF16=Ms;function Ls(r,e){return ui(Gi(r),e)}Le.UTF16ToJIS=Ls;function ks(r){return Wi(li(r))}Le.JISToUTF16BE=ks;function Ns(r,e){return ui(Hi(r),e)}Le.UTF16BEToJIS=Ns;function js(r){return Xi(li(r))}Le.JISToUTF16LE=js;function Us(r,e){return ui(Yi(r),e)}Le.UTF16LEToJIS=Us;function Vs(r,e){return Vi(xi(r),e)}Le.EUCJPToUTF16=Vs;function Gs(r,e){return ci(Gi(r),e)}Le.UTF16ToEUCJP=Gs;function Ws(r){return Wi(xi(r))}Le.EUCJPToUTF16BE=Ws;function Hs(r,e){return ci(Hi(r),e)}Le.UTF16BEToEUCJP=Hs;function Xs(r){return Xi(xi(r))}Le.EUCJPToUTF16LE=Xs;function Ys(r,e){return ci(Yi(r),e)}Le.UTF16LEToEUCJP=Ys;function zs(r,e){return Vi(si(r),e)}Le.SJISToUTF16=zs;function Ks(r,e){return hi(Gi(r),e)}Le.UTF16ToSJIS=Ks;function Js(r){return Wi(si(r))}Le.SJISToUTF16BE=Js;function qs(r,e){return hi(Hi(r),e)}Le.UTF16BEToSJIS=qs;function Zs(r){return Xi(si(r))}Le.SJISToUTF16LE=Zs;function Qs(r,e){return hi(Yi(r),e)}Le.UTF16LEToSJIS=Qs;function Ln(r,e,t){switch(t){case"html-entity":case"html-entity-hex":var i=mr(e,{ignoreSurrogatePair:!0})[0];if(i){r[r.length]=38,r[r.length]=35;var o=t.slice(-3)==="hex"?16:10;o===16&&(r[r.length]=120);for(var s=i.toString(o),u=0,g=s.length;u<g;u++)r[r.length]=s.charCodeAt(u);r[r.length]=59}}}var fi={};fi.HANKANA_TABLE={12289:65380,12290:65377,12300:65378,12301:65379,12443:65438,12444:65439,12449:65383,12450:65393,12451:65384,12452:65394,12453:65385,12454:65395,12455:65386,12456:65396,12457:65387,12458:65397,12459:65398,12461:65399,12463:65400,12465:65401,12467:65402,12469:65403,12471:65404,12473:65405,12475:65406,12477:65407,12479:65408,12481:65409,12483:65391,12484:65410,12486:65411,12488:65412,12490:65413,12491:65414,12492:65415,12493:65416,12494:65417,12495:65418,12498:65419,12501:65420,12504:65421,12507:65422,12510:65423,12511:65424,12512:65425,12513:65426,12514:65427,12515:65388,12516:65428,12517:65389,12518:65429,12519:65390,12520:65430,12521:65431,12522:65432,12523:65433,12524:65434,12525:65435,12527:65436,12530:65382,12531:65437,12539:65381,12540:65392};fi.HANKANA_SONANTS={12532:65395,12535:65436,12538:65382};fi.HANKANA_MARKS=[65438,65439];fi.ZENKANA_TABLE=[12290,12300,12301,12289,12539,12530,12449,12451,12453,12455,12457,12515,12517,12519,12483,12540,12450,12452,12454,12456,12458,12459,12461,12463,12465,12467,12469,12471,12473,12475,12477,12479,12481,12484,12486,12488,12490,12491,12492,12493,12494,12495,12498,12501,12504,12507,12510,12511,12512,12513,12514,12516,12518,12520,12521,12522,12523,12524,12525,12527,12531,12443,12444];const $s="encoding-japanese",ex="2.0.0",tx="Convert or detect character encoding in JavaScript",rx="src/index.js",ix=["encoding.js","encoding.min.js","encoding.min.js.map","src/*"],nx={build:"npm run compile && npm run minify",compile:"browserify src/index.js -o encoding.js -s Encoding -p [ bannerify --file src/banner.js ] --no-bundle-external --bare",minify:`uglifyjs encoding.js -o encoding.min.js --source-map "url='encoding.min.js.map'" --comments -c -m -b ascii_only=true,beautify=false`,test:"./node_modules/.bin/eslint . && npm run build && mocha tests/test",watch:"watchify src/index.js -o encoding.js -s Encoding -p [ bannerify --file src/banner.js ] --no-bundle-external --bare --poll=300 -v"},ox={node:">=8.10.0"},ax={type:"git",url:"https://github.com/polygonplanet/encoding.js.git"},sx="polygonplanet <polygon.planet.aqua@gmail.com>",xx="MIT",lx={url:"https://github.com/polygonplanet/encoding.js/issues"},hx="https://github.com/polygonplanet/encoding.js",cx=["base64","charset","convert","detect","encoding","euc-jp","eucjp","iconv","iso-2022-jp","japanese","jis","shift_jis","sjis","unicode","urldecode","urlencode","utf-16","utf-32","utf-8"],ux={},fx={bannerify:"^1.0.1",browserify:"^17.0.0",eslint:"^8.12.0",mocha:"^9.2.2","package-json-versionify":"^1.0.4","power-assert":"^1.6.1","uglify-js":"^3.15.3",uglifyify:"^5.0.2",watchify:"^4.0.0"},Ex={transform:["package-json-versionify"]};var dx={name:$s,version:ex,description:tx,main:rx,files:ix,scripts:nx,engines:ox,repository:ax,author:sx,license:xx,bugs:lx,homepage:hx,keywords:cx,dependencies:ux,devDependencies:fx,browserify:Ex},gx=Zt,Ve=wt,To=Qt,Oo=Le,jr=fi,Ax=dx.version,Io=Object.prototype.hasOwnProperty,Si={version:Ax,orders:gx.EncodingOrders,detect:function(r,e){if(r==null||r.length===0)return!1;Ve.isObject(e)&&!Ve.isArray(e)&&(e=e.encoding),Ve.isString(r)&&(r=Ve.stringToBuffer(r)),e==null?e=Si.orders:Ve.isString(e)&&(e=e.toUpperCase(),e==="AUTO"?e=Si.orders:~e.indexOf(",")?e=e.split(/\s*,\s*/):e=[e]);for(var t=e.length,i,o,s,u=0;u<t;u++)if(i=e[u],o=Ve.canonicalizeEncodingName(i),!!o){if(s="is"+o,!Io.call(To,s))throw new Error("Undefined encoding: "+i);if(To[s](r))return o}return!1},convert:function(r,e,t){var i,o,s;Ve.isObject(e)?(s=e,t=s.from,e=s.to,s.type&&(o=s.type)):s={},Ve.isString(r)?(o=o||"string",r=Ve.stringToBuffer(r)):(r==null||r.length===0)&&(r=[]);var u;t!=null&&Ve.isString(t)&&t.toUpperCase()!=="AUTO"&&!~t.indexOf(",")?u=Ve.canonicalizeEncodingName(t):u=Si.detect(r);var g=Ve.canonicalizeEncodingName(e),B=u+"To"+g;switch(Io.call(Oo,B)?i=Oo[B](r,s):i=r,(""+o).toLowerCase()){case"string":return Ve.codeToString_fast(i);case"arraybuffer":return Ve.codeToBuffer(i);default:return Ve.bufferToCode(i)}},urlEncode:function(r){Ve.isString(r)&&(r=Ve.stringToBuffer(r));for(var e=Ve.stringToCode("0123456789ABCDEF"),t=[],i=0,o=r&&r.length,s;i<o;i++){if(s=r[i],s>255)return encodeURIComponent(Ve.codeToString_fast(r));s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===33||s>=39&&s<=42||s===45||s===46||s===95||s===126?t[t.length]=s:(t[t.length]=37,s<16?(t[t.length]=48,t[t.length]=e[s]):(t[t.length]=e[s>>4&15],t[t.length]=e[s&15]))}return Ve.codeToString_fast(t)},urlDecode:function(r){for(var e=[],t=0,i=r&&r.length,o;t<i;)o=r.charCodeAt(t++),o===37?e[e.length]=parseInt(r.charAt(t++)+r.charAt(t++),16):e[e.length]=o;return e},base64Encode:function(r){return Ve.isString(r)&&(r=Ve.stringToBuffer(r)),Ve.base64encode(r)},base64Decode:function(r){return Ve.base64decode(r)},codeToString:Ve.codeToString_fast,stringToCode:Ve.stringToCode,toHankakuCase:function(r){var e=!1;Ve.isString(r)&&(e=!0,r=Ve.stringToBuffer(r));for(var t=[],i=r&&r.length,o=0,s;o<i;)s=r[o++],s>=65281&&s<=65374&&(s-=65248),t[t.length]=s;return e?Ve.codeToString_fast(t):t},toZenkakuCase:function(r){var e=!1;Ve.isString(r)&&(e=!0,r=Ve.stringToBuffer(r));for(var t=[],i=r&&r.length,o=0,s;o<i;)s=r[o++],s>=33&&s<=126&&(s+=65248),t[t.length]=s;return e?Ve.codeToString_fast(t):t},toHiraganaCase:function(r){var e=!1;Ve.isString(r)&&(e=!0,r=Ve.stringToBuffer(r));for(var t=[],i=r&&r.length,o=0,s;o<i;)s=r[o++],s>=12449&&s<=12534?s-=96:s===12535?(t[t.length]=12431,s=12443):s===12538&&(t[t.length]=12434,s=12443),t[t.length]=s;return e?Ve.codeToString_fast(t):t},toKatakanaCase:function(r){var e=!1;Ve.isString(r)&&(e=!0,r=Ve.stringToBuffer(r));for(var t=[],i=r&&r.length,o=0,s;o<i;)s=r[o++],s>=12353&&s<=12438&&((s===12431||s===12434)&&o<i&&r[o]===12443?(s=s===12431?12535:12538,o++):s+=96),t[t.length]=s;return e?Ve.codeToString_fast(t):t},toHankanaCase:function(r){var e=!1;Ve.isString(r)&&(e=!0,r=Ve.stringToBuffer(r));for(var t=[],i=r&&r.length,o=0,s,u,g;o<i;){if(s=r[o++],s>=12289&&s<=12540&&(g=jr.HANKANA_TABLE[s],g!==void 0)){t[t.length]=g;continue}s===12532||s===12535||s===12538?(t[t.length]=jr.HANKANA_SONANTS[s],t[t.length]=65438):s>=12459&&s<=12489?(t[t.length]=jr.HANKANA_TABLE[s-1],t[t.length]=65438):s>=12495&&s<=12509?(u=s%3,t[t.length]=jr.HANKANA_TABLE[s-u],t[t.length]=jr.HANKANA_MARKS[u-1]):t[t.length]=s}return e?Ve.codeToString_fast(t):t},toZenkanaCase:function(r){var e=!1;Ve.isString(r)&&(e=!0,r=Ve.stringToBuffer(r));var t=[],i=r&&r.length,o=0,s,u,g;for(o=0;o<i;o++)s=r[o],s>65376&&s<65440&&(u=jr.ZENKANA_TABLE[s-65377],o+1<i&&(g=r[o+1],g===65438&&s===65395?(u=12532,o++):g===65438&&s===65436?(u=12535,o++):g===65438&&s===65382?(u=12538,o++):g===65438&&(s>65397&&s<65413||s>65417&&s<65423)?(u++,o++):g===65439&&s>65417&&s<65423&&(u+=2,o++)),s=u),t[t.length]=s;return e?Ve.codeToString_fast(t):t},toHankakuSpace:function(r){if(Ve.isString(r))return r.replace(/\u3000/g," ");for(var e=[],t=r&&r.length,i=0,o;i<t;)o=r[i++],o===12288&&(o=32),e[e.length]=o;return e},toZenkakuSpace:function(r){if(Ve.isString(r))return r.replace(/\u0020/g,"\u3000");for(var e=[],t=r&&r.length,i=0,o;i<t;)o=r[i++],o===32&&(o=12288),e[e.length]=o;return e}},Ro=Si;ae.engineResourcePath="https://unpkg.com/dynamsoft-javascript-barcode@9.2.13/dist/";let gr;class px{constructor(){sr(this,"settings")}async init(){gr||(gr=await ae.createInstance(),await gr.updateRuntimeSettings("balance"))}async detect(e){if(!gr)throw new Error("Dynamsoft Barcode Reader has not been initialized.");const t=Date.now(),i=await gr.decode(e);console.log(i);const o=Date.now()-t,s=[];return i.forEach(g=>{const B=this.wrapResult(g);s.push(B)}),{elapsedTime:o,results:s}}wrapResult(e){let t=e.barcodeText;const i=e.results[0].confidence;if(e.barcodeFormat===Sr.BF_QR_CODE&&e.detailedResult.mode===8){const s=e.barcodeBytes,u=Ro.convert(s,{to:"UNICODE",from:"SJIS"});t=Ro.codeToString(u)}return{barcodeFormat:e.barcodeFormatString,barcodeText:t,barcodeBytes:this.getBinary(e.barcodeBytes),confidence:i,x1:e.localizationResult.x1,x2:e.localizationResult.x2,x3:e.localizationResult.x3,x4:e.localizationResult.x4,y1:e.localizationResult.y1,y2:e.localizationResult.y2,y3:e.localizationResult.y3,y4:e.localizationResult.y4}}getBinary(e){let t="";for(let i=0;i<e.length;i++){const o=e[i];t=t+On(o.toString())}return t}async updateRuntimeSettings(e){e?e.indexOf("{")!=-1?(console.log("Using JSON template: "+e),await gr.initRuntimeSettingsWithString(e)):(console.log("Using built-in template: "+e),await gr.updateRuntimeSettings(e)):await gr.resetRuntimeSettings()}getSupportedSettings(){return["template"]}async setSupportedSettings(e){this.settings=e;for(let t=0;t<e.length;t++){const i=e[t];i.name==="template"&&await this.updateRuntimeSettings(i.value)}}}/*! For license information please see fabric.js.LICENSE.txt */var Bx={653:(r,e,t)=>{var i,o,s,u,g,B,_,m,D,F,T,I,k,U,K,X,te,ne,re,ue,Ae,v=v||{version:"5.2.1"};if(e.fabric=v,typeof document!="undefined"&&typeof window!="undefined")document instanceof(typeof HTMLDocument!="undefined"?HTMLDocument:Document)?v.document=document:v.document=document.implementation.createHTMLDocument(""),v.window=window;else{var ye=new(t(192)).JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;v.document=ye.document,v.jsdomImplForWrapper=t(898).implForWrapper,v.nodeCanvas=t(245).Canvas,v.window=ye,DOMParser=v.window.DOMParser}function be(h,x){var l=h.canvas,f=x.targetCanvas,n=f.getContext("2d");n.translate(0,f.height),n.scale(1,-1);var a=l.height-f.height;n.drawImage(l,0,a,f.width,f.height,0,0,f.width,f.height)}function je(h,x){var l=x.targetCanvas.getContext("2d"),f=x.destinationWidth,n=x.destinationHeight,a=f*n*4,c=new Uint8Array(this.imageBuffer,0,a),A=new Uint8ClampedArray(this.imageBuffer,0,a);h.readPixels(0,0,f,n,h.RGBA,h.UNSIGNED_BYTE,c);var E=new ImageData(A,f,n);l.putImageData(E,0,0)}v.isTouchSupported="ontouchstart"in v.window||"ontouchstart"in v.document||v.window&&v.window.navigator&&v.window.navigator.maxTouchPoints>0,v.isLikelyNode=typeof Buffer!="undefined"&&typeof window=="undefined",v.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],v.DPI=96,v.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",v.commaWsp="(?:\\s+,?\\s*|,\\s*)",v.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,v.reNonWord=/[ \n\.,;!\?\-]/,v.fontPaths={},v.iMatrix=[1,0,0,1,0,0],v.svgNS="http://www.w3.org/2000/svg",v.perfLimitSizeTotal=2097152,v.maxCacheSideLimit=4096,v.minCacheSideLimit=256,v.charWidthsCache={},v.textureSize=2048,v.disableStyleCopyPaste=!1,v.enableGLFiltering=!0,v.devicePixelRatio=v.window.devicePixelRatio||v.window.webkitDevicePixelRatio||v.window.mozDevicePixelRatio||1,v.browserShadowBlurConstant=1,v.arcToSegmentsCache={},v.boundsOfCurveCache={},v.cachesBoundsOfCurve=!0,v.forceGLPutImageData=!1,v.initFilterBackend=function(){return v.enableGLFiltering&&v.isWebglSupported&&v.isWebglSupported(v.textureSize)?(console.log("max texture size: "+v.maxTextureSize),new v.WebglFilterBackend({tileSize:v.textureSize})):v.Canvas2dFilterBackend?new v.Canvas2dFilterBackend:void 0},typeof document!="undefined"&&typeof window!="undefined"&&(window.fabric=v),function(){function h(l,f){if(this.__eventListeners[l]){var n=this.__eventListeners[l];f?n[n.indexOf(f)]=!1:v.util.array.fill(n,!1)}}function x(l,f){var n=function(){f.apply(this,arguments),this.off(l,n)}.bind(this);this.on(l,n)}v.Observable={fire:function(l,f){if(!this.__eventListeners)return this;var n=this.__eventListeners[l];if(!n)return this;for(var a=0,c=n.length;a<c;a++)n[a]&&n[a].call(this,f||{});return this.__eventListeners[l]=n.filter(function(A){return A!==!1}),this},on:function(l,f){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var n in l)this.on(n,l[n]);else this.__eventListeners[l]||(this.__eventListeners[l]=[]),this.__eventListeners[l].push(f);return this},once:function(l,f){if(arguments.length===1)for(var n in l)x.call(this,n,l[n]);else x.call(this,l,f);return this},off:function(l,f){if(!this.__eventListeners)return this;if(arguments.length===0)for(l in this.__eventListeners)h.call(this,l);else if(arguments.length===1&&typeof arguments[0]=="object")for(var n in l)h.call(this,n,l[n]);else h.call(this,l,f);return this}}}(),v.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var h=0,x=arguments.length;h<x;h++)this._onObjectAdded(arguments[h]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(h,x,l){var f=this._objects;return l?f[x]=h:f.splice(x,0,h),this._onObjectAdded&&this._onObjectAdded(h),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var h,x=this._objects,l=!1,f=0,n=arguments.length;f<n;f++)(h=x.indexOf(arguments[f]))!==-1&&(l=!0,x.splice(h,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[f]));return this.renderOnAddRemove&&l&&this.requestRenderAll(),this},forEachObject:function(h,x){for(var l=this.getObjects(),f=0,n=l.length;f<n;f++)h.call(x,l[f],f,l);return this},getObjects:function(h){return h===void 0?this._objects.concat():this._objects.filter(function(x){return x.type===h})},item:function(h){return this._objects[h]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(h,x){return this._objects.indexOf(h)>-1||!!x&&this._objects.some(function(l){return typeof l.contains=="function"&&l.contains(h,!0)})},complexity:function(){return this._objects.reduce(function(h,x){return h+(x.complexity?x.complexity():0)},0)}},v.CommonMethods={_setOptions:function(h){for(var x in h)this.set(x,h[x])},_initGradient:function(h,x){!h||!h.colorStops||h instanceof v.Gradient||this.set(x,new v.Gradient(h))},_initPattern:function(h,x,l){!h||!h.source||h instanceof v.Pattern?l&&l():this.set(x,new v.Pattern(h,l))},_setObject:function(h){for(var x in h)this._set(x,h[x])},set:function(h,x){return typeof h=="object"?this._setObject(h):this._set(h,x),this},_set:function(h,x){this[h]=x},toggle:function(h){var x=this.get(h);return typeof x=="boolean"&&this.set(h,!x),this},get:function(h){return this[h]}},i=e,o=Math.sqrt,s=Math.atan2,u=Math.pow,g=Math.PI/180,B=Math.PI/2,v.util={cos:function(h){if(h===0)return 1;switch(h<0&&(h=-h),h/B){case 1:case 3:return 0;case 2:return-1}return Math.cos(h)},sin:function(h){if(h===0)return 0;var x=1;switch(h<0&&(x=-1),h/B){case 1:return x;case 2:return 0;case 3:return-x}return Math.sin(h)},removeFromArray:function(h,x){var l=h.indexOf(x);return l!==-1&&h.splice(l,1),h},getRandomInt:function(h,x){return Math.floor(Math.random()*(x-h+1))+h},degreesToRadians:function(h){return h*g},radiansToDegrees:function(h){return h/g},rotatePoint:function(h,x,l){var f=new v.Point(h.x-x.x,h.y-x.y),n=v.util.rotateVector(f,l);return new v.Point(n.x,n.y).addEquals(x)},rotateVector:function(h,x){var l=v.util.sin(x),f=v.util.cos(x);return{x:h.x*f-h.y*l,y:h.x*l+h.y*f}},createVector:function(h,x){return new v.Point(x.x-h.x,x.y-h.y)},calcAngleBetweenVectors:function(h,x){return Math.acos((h.x*x.x+h.y*x.y)/(Math.hypot(h.x,h.y)*Math.hypot(x.x,x.y)))},getHatVector:function(h){return new v.Point(h.x,h.y).multiply(1/Math.hypot(h.x,h.y))},getBisector:function(h,x,l){var f=v.util.createVector(h,x),n=v.util.createVector(h,l),a=v.util.calcAngleBetweenVectors(f,n),c=a*(v.util.calcAngleBetweenVectors(v.util.rotateVector(f,a),n)===0?1:-1)/2;return{vector:v.util.getHatVector(v.util.rotateVector(f,c)),angle:a}},projectStrokeOnPoints:function(h,x,l){var f=[],n=x.strokeWidth/2,a=x.strokeUniform?new v.Point(1/x.scaleX,1/x.scaleY):new v.Point(1,1),c=function(A){var E=n/Math.hypot(A.x,A.y);return new v.Point(A.x*E*a.x,A.y*E*a.y)};return h.length<=1||h.forEach(function(A,E){var d,p,C=new v.Point(A.x,A.y);E===0?(p=h[E+1],d=l?c(v.util.createVector(p,C)).addEquals(C):h[h.length-1]):E===h.length-1?(d=h[E-1],p=l?c(v.util.createVector(d,C)).addEquals(C):h[0]):(d=h[E-1],p=h[E+1]);var y,S,w=v.util.getBisector(C,d,p),b=w.vector,O=w.angle;if(x.strokeLineJoin==="miter"&&(y=-n/Math.sin(O/2),S=new v.Point(b.x*y*a.x,b.y*y*a.y),Math.hypot(S.x,S.y)/n<=x.strokeMiterLimit))return f.push(C.add(S)),void f.push(C.subtract(S));y=-n*Math.SQRT2,S=new v.Point(b.x*y*a.x,b.y*y*a.y),f.push(C.add(S)),f.push(C.subtract(S))}),f},transformPoint:function(h,x,l){return l?new v.Point(x[0]*h.x+x[2]*h.y,x[1]*h.x+x[3]*h.y):new v.Point(x[0]*h.x+x[2]*h.y+x[4],x[1]*h.x+x[3]*h.y+x[5])},makeBoundingBoxFromPoints:function(h,x){if(x)for(var l=0;l<h.length;l++)h[l]=v.util.transformPoint(h[l],x);var f=[h[0].x,h[1].x,h[2].x,h[3].x],n=v.util.array.min(f),a=v.util.array.max(f)-n,c=[h[0].y,h[1].y,h[2].y,h[3].y],A=v.util.array.min(c);return{left:n,top:A,width:a,height:v.util.array.max(c)-A}},invertTransform:function(h){var x=1/(h[0]*h[3]-h[1]*h[2]),l=[x*h[3],-x*h[1],-x*h[2],x*h[0]],f=v.util.transformPoint({x:h[4],y:h[5]},l,!0);return l[4]=-f.x,l[5]=-f.y,l},toFixed:function(h,x){return parseFloat(Number(h).toFixed(x))},parseUnit:function(h,x){var l=/\D{0,2}$/.exec(h),f=parseFloat(h);switch(x||(x=v.Text.DEFAULT_SVG_FONT_SIZE),l[0]){case"mm":return f*v.DPI/25.4;case"cm":return f*v.DPI/2.54;case"in":return f*v.DPI;case"pt":return f*v.DPI/72;case"pc":return f*v.DPI/72*12;case"em":return f*x;default:return f}},falseFunction:function(){return!1},getKlass:function(h,x){return h=v.util.string.camelize(h.charAt(0).toUpperCase()+h.slice(1)),v.util.resolveNamespace(x)[h]},getSvgAttributes:function(h){var x=["instantiated_by_use","style","id","class"];switch(h){case"linearGradient":x=x.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":x=x.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":x=x.concat(["offset","stop-color","stop-opacity"])}return x},resolveNamespace:function(h){if(!h)return v;var x,l=h.split("."),f=l.length,n=i||v.window;for(x=0;x<f;++x)n=n[l[x]];return n},loadImage:function(h,x,l,f){if(h){var n=v.util.createImage(),a=function(){x&&x.call(l,n,!1),n=n.onload=n.onerror=null};n.onload=a,n.onerror=function(){v.log("Error loading "+n.src),x&&x.call(l,null,!0),n=n.onload=n.onerror=null},h.indexOf("data")!==0&&f!=null&&(n.crossOrigin=f),h.substring(0,14)==="data:image/svg"&&(n.onload=null,v.util.loadImageInDom(n,a)),n.src=h}else x&&x.call(l,h)},loadImageInDom:function(h,x){var l=v.document.createElement("div");l.style.width=l.style.height="1px",l.style.left=l.style.top="-100%",l.style.position="absolute",l.appendChild(h),v.document.querySelector("body").appendChild(l),h.onload=function(){x(),l.parentNode.removeChild(l),l=null}},enlivenObjects:function(h,x,l,f){var n=[],a=0,c=(h=h||[]).length;function A(){++a===c&&x&&x(n.filter(function(E){return E}))}c?h.forEach(function(E,d){E&&E.type?v.util.getKlass(E.type,l).fromObject(E,function(p,C){C||(n[d]=p),f&&f(E,p,C),A()}):A()}):x&&x(n)},enlivenObjectEnlivables:function(h,x,l){var f=v.Object.ENLIVEN_PROPS.filter(function(n){return!!h[n]});v.util.enlivenObjects(f.map(function(n){return h[n]}),function(n){var a={};f.forEach(function(c,A){a[c]=n[A],x&&(x[c]=n[A])}),l&&l(a)})},enlivenPatterns:function(h,x){function l(){++n===a&&x&&x(f)}var f=[],n=0,a=(h=h||[]).length;a?h.forEach(function(c,A){c&&c.source?new v.Pattern(c,function(E){f[A]=E,l()}):(f[A]=c,l())}):x&&x(f)},groupSVGElements:function(h,x,l){var f;return h&&h.length===1?h[0]:(x&&(x.width&&x.height?x.centerPoint={x:x.width/2,y:x.height/2}:(delete x.width,delete x.height)),f=new v.Group(h,x),l!==void 0&&(f.sourcePath=l),f)},populateWithProperties:function(h,x,l){if(l&&Array.isArray(l))for(var f=0,n=l.length;f<n;f++)l[f]in h&&(x[l[f]]=h[l[f]])},createCanvasElement:function(){return v.document.createElement("canvas")},copyCanvasElement:function(h){var x=v.util.createCanvasElement();return x.width=h.width,x.height=h.height,x.getContext("2d").drawImage(h,0,0),x},toDataURL:function(h,x,l){return h.toDataURL("image/"+x,l)},createImage:function(){return v.document.createElement("img")},multiplyTransformMatrices:function(h,x,l){return[h[0]*x[0]+h[2]*x[1],h[1]*x[0]+h[3]*x[1],h[0]*x[2]+h[2]*x[3],h[1]*x[2]+h[3]*x[3],l?0:h[0]*x[4]+h[2]*x[5]+h[4],l?0:h[1]*x[4]+h[3]*x[5]+h[5]]},qrDecompose:function(h){var x=s(h[1],h[0]),l=u(h[0],2)+u(h[1],2),f=o(l),n=(h[0]*h[3]-h[2]*h[1])/f,a=s(h[0]*h[2]+h[1]*h[3],l);return{angle:x/g,scaleX:f,scaleY:n,skewX:a/g,skewY:0,translateX:h[4],translateY:h[5]}},calcRotateMatrix:function(h){if(!h.angle)return v.iMatrix.concat();var x=v.util.degreesToRadians(h.angle),l=v.util.cos(x),f=v.util.sin(x);return[l,f,-f,l,0,0]},calcDimensionsMatrix:function(h){var x=h.scaleX===void 0?1:h.scaleX,l=h.scaleY===void 0?1:h.scaleY,f=[h.flipX?-x:x,0,0,h.flipY?-l:l,0,0],n=v.util.multiplyTransformMatrices,a=v.util.degreesToRadians;return h.skewX&&(f=n(f,[1,0,Math.tan(a(h.skewX)),1],!0)),h.skewY&&(f=n(f,[1,Math.tan(a(h.skewY)),0,1],!0)),f},composeMatrix:function(h){var x=[1,0,0,1,h.translateX||0,h.translateY||0],l=v.util.multiplyTransformMatrices;return h.angle&&(x=l(x,v.util.calcRotateMatrix(h))),(h.scaleX!==1||h.scaleY!==1||h.skewX||h.skewY||h.flipX||h.flipY)&&(x=l(x,v.util.calcDimensionsMatrix(h))),x},resetObjectTransform:function(h){h.scaleX=1,h.scaleY=1,h.skewX=0,h.skewY=0,h.flipX=!1,h.flipY=!1,h.rotate(0)},saveObjectTransform:function(h){return{scaleX:h.scaleX,scaleY:h.scaleY,skewX:h.skewX,skewY:h.skewY,angle:h.angle,left:h.left,flipX:h.flipX,flipY:h.flipY,top:h.top}},isTransparent:function(h,x,l,f){f>0&&(x>f?x-=f:x=0,l>f?l-=f:l=0);var n,a=!0,c=h.getImageData(x,l,2*f||1,2*f||1),A=c.data.length;for(n=3;n<A&&(a=c.data[n]<=0)!=0;n+=4);return c=null,a},parsePreserveAspectRatioAttribute:function(h){var x,l="meet",f=h.split(" ");return f&&f.length&&((l=f.pop())!=="meet"&&l!=="slice"?(x=l,l="meet"):f.length&&(x=f.pop())),{meetOrSlice:l,alignX:x!=="none"?x.slice(1,4):"none",alignY:x!=="none"?x.slice(5,8):"none"}},clearFabricFontCache:function(h){(h=(h||"").toLowerCase())?v.charWidthsCache[h]&&delete v.charWidthsCache[h]:v.charWidthsCache={}},limitDimsByArea:function(h,x){var l=Math.sqrt(x*h),f=Math.floor(x/l);return{x:Math.floor(l),y:f}},capValue:function(h,x,l){return Math.max(h,Math.min(x,l))},findScaleToFit:function(h,x){return Math.min(x.width/h.width,x.height/h.height)},findScaleToCover:function(h,x){return Math.max(x.width/h.width,x.height/h.height)},matrixToSVG:function(h){return"matrix("+h.map(function(x){return v.util.toFixed(x,v.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(h,x){var l=v.util.invertTransform(x),f=v.util.multiplyTransformMatrices(l,h.calcOwnMatrix());v.util.applyTransformToObject(h,f)},addTransformToObject:function(h,x){v.util.applyTransformToObject(h,v.util.multiplyTransformMatrices(x,h.calcOwnMatrix()))},applyTransformToObject:function(h,x){var l=v.util.qrDecompose(x),f=new v.Point(l.translateX,l.translateY);h.flipX=!1,h.flipY=!1,h.set("scaleX",l.scaleX),h.set("scaleY",l.scaleY),h.skewX=l.skewX,h.skewY=l.skewY,h.angle=l.angle,h.setPositionByOrigin(f,"center","center")},sizeAfterTransform:function(h,x,l){var f=h/2,n=x/2,a=[{x:-f,y:-n},{x:f,y:-n},{x:-f,y:n},{x:f,y:n}],c=v.util.calcDimensionsMatrix(l),A=v.util.makeBoundingBoxFromPoints(a,c);return{x:A.width,y:A.height}},mergeClipPaths:function(h,x){var l=h,f=x;l.inverted&&!f.inverted&&(l=x,f=h),v.util.applyTransformToObject(f,v.util.multiplyTransformMatrices(v.util.invertTransform(l.calcTransformMatrix()),f.calcTransformMatrix()));var n=l.inverted&&f.inverted;return n&&(l.inverted=f.inverted=!1),new v.Group([l],{clipPath:f,inverted:n})}},function(){var h=Array.prototype.join,x={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},l={m:"l",M:"L"};function f(S,w,b,O,N,j,Z,Y,W,P,R){var V=v.util.cos(S),J=v.util.sin(S),q=v.util.cos(w),L=v.util.sin(w),M=b*N*q-O*j*L+Z,G=O*N*q+b*j*L+Y;return["C",P+W*(-b*N*J-O*j*V),R+W*(-O*N*J+b*j*V),M+W*(b*N*L+O*j*q),G+W*(O*N*L-b*j*q),M,G]}function n(S,w,b,O){var N=Math.atan2(w,S),j=Math.atan2(O,b);return j>=N?j-N:2*Math.PI-(N-j)}function a(S,w,b){for(var O=b[1],N=b[2],j=b[3],Z=b[4],Y=b[5],W=function(V,J,q,L,M,G,ee){var z=Math.PI,ie=ee*z/180,de=v.util.sin(ie),he=v.util.cos(ie),se=0,Ee=0,ce=-he*V*.5-de*J*.5,pe=-he*J*.5+de*V*.5,_e=(q=Math.abs(q))*q,Be=(L=Math.abs(L))*L,Te=pe*pe,Re=ce*ce,tt=_e*Be-_e*Te-Be*Re,lt=0;if(tt<0){var Ft=Math.sqrt(1-tt/(_e*Be));q*=Ft,L*=Ft}else lt=(M===G?-1:1)*Math.sqrt(tt/(_e*Te+Be*Re));var Ne=lt*q*pe/L,rt=-lt*L*ce/q,ft=he*Ne-de*rt+.5*V,Lt=de*Ne+he*rt+.5*J,St=n(1,0,(ce-Ne)/q,(pe-rt)/L),It=n((ce-Ne)/q,(pe-rt)/L,(-ce-Ne)/q,(-pe-rt)/L);G===0&&It>0?It-=2*z:G===1&&It<0&&(It+=2*z);for(var yr=Math.ceil(Math.abs(It/z*2)),rr=[],Yt=It/yr,zr=8/3*Math.sin(Yt/4)*Math.sin(Yt/4)/Math.sin(Yt/2),hr=St+Yt,zt=0;zt<yr;zt++)rr[zt]=f(St,hr,he,de,q,L,ft,Lt,zr,se,Ee),se=rr[zt][5],Ee=rr[zt][6],St=hr,hr+=Yt;return rr}(b[6]-S,b[7]-w,O,N,Z,Y,j),P=0,R=W.length;P<R;P++)W[P][1]+=S,W[P][2]+=w,W[P][3]+=S,W[P][4]+=w,W[P][5]+=S,W[P][6]+=w;return W}function c(S,w,b,O){return Math.sqrt((b-S)*(b-S)+(O-w)*(O-w))}function A(S,w,b,O,N,j,Z,Y){return function(W){var P,R=(P=W)*P*P,V=function(L){return 3*L*L*(1-L)}(W),J=function(L){return 3*L*(1-L)*(1-L)}(W),q=function(L){return(1-L)*(1-L)*(1-L)}(W);return{x:Z*R+N*V+b*J+S*q,y:Y*R+j*V+O*J+w*q}}}function E(S,w,b,O,N,j,Z,Y){return function(W){var P=1-W,R=3*P*P*(b-S)+6*P*W*(N-b)+3*W*W*(Z-N),V=3*P*P*(O-w)+6*P*W*(j-O)+3*W*W*(Y-j);return Math.atan2(V,R)}}function d(S,w,b,O,N,j){return function(Z){var Y,W=(Y=Z)*Y,P=function(V){return 2*V*(1-V)}(Z),R=function(V){return(1-V)*(1-V)}(Z);return{x:N*W+b*P+S*R,y:j*W+O*P+w*R}}}function p(S,w,b,O,N,j){return function(Z){var Y=1-Z,W=2*Y*(b-S)+2*Z*(N-b),P=2*Y*(O-w)+2*Z*(j-O);return Math.atan2(P,W)}}function C(S,w,b){var O,N,j={x:w,y:b},Z=0;for(N=1;N<=100;N+=1)O=S(N/100),Z+=c(j.x,j.y,O.x,O.y),j=O;return Z}function y(S){for(var w,b,O,N,j=0,Z=S.length,Y=0,W=0,P=0,R=0,V=[],J=0;J<Z;J++){switch(O={x:Y,y:W,command:(w=S[J])[0]},w[0]){case"M":O.length=0,P=Y=w[1],R=W=w[2];break;case"L":O.length=c(Y,W,w[1],w[2]),Y=w[1],W=w[2];break;case"C":b=A(Y,W,w[1],w[2],w[3],w[4],w[5],w[6]),N=E(Y,W,w[1],w[2],w[3],w[4],w[5],w[6]),O.iterator=b,O.angleFinder=N,O.length=C(b,Y,W),Y=w[5],W=w[6];break;case"Q":b=d(Y,W,w[1],w[2],w[3],w[4]),N=p(Y,W,w[1],w[2],w[3],w[4]),O.iterator=b,O.angleFinder=N,O.length=C(b,Y,W),Y=w[3],W=w[4];break;case"Z":case"z":O.destX=P,O.destY=R,O.length=c(Y,W,P,R),Y=P,W=R}j+=O.length,V.push(O)}return V.push({length:j,x:Y,y:W}),V}v.util.joinPath=function(S){return S.map(function(w){return w.join(" ")}).join(" ")},v.util.parsePath=function(S){var w,b,O,N,j,Z=[],Y=[],W=v.rePathCommand,P="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",R="("+P+")"+v.commaWsp,V="([01])"+v.commaWsp+"?",J=new RegExp(R+"?"+R+"?"+R+V+V+R+"?("+P+")","g");if(!S||!S.match)return Z;for(var q,L=0,M=(j=S.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;L<M;L++){N=(w=j[L]).slice(1).trim(),Y.length=0;var G=w.charAt(0);if(q=[G],G.toLowerCase()==="a")for(var ee;ee=J.exec(N);)for(var z=1;z<ee.length;z++)Y.push(ee[z]);else for(;O=W.exec(N);)Y.push(O[0]);z=0;for(var ie=Y.length;z<ie;z++)b=parseFloat(Y[z]),isNaN(b)||q.push(b);var de=x[G.toLowerCase()],he=l[G]||G;if(q.length-1>de)for(var se=1,Ee=q.length;se<Ee;se+=de)Z.push([G].concat(q.slice(se,se+de))),G=he;else Z.push(q)}return Z},v.util.makePathSimpler=function(S){var w,b,O,N,j,Z,Y=0,W=0,P=S.length,R=0,V=0,J=[];for(b=0;b<P;++b){switch(O=!1,(w=S[b].slice(0))[0]){case"l":w[0]="L",w[1]+=Y,w[2]+=W;case"L":Y=w[1],W=w[2];break;case"h":w[1]+=Y;case"H":w[0]="L",w[2]=W,Y=w[1];break;case"v":w[1]+=W;case"V":w[0]="L",W=w[1],w[1]=Y,w[2]=W;break;case"m":w[0]="M",w[1]+=Y,w[2]+=W;case"M":Y=w[1],W=w[2],R=w[1],V=w[2];break;case"c":w[0]="C",w[1]+=Y,w[2]+=W,w[3]+=Y,w[4]+=W,w[5]+=Y,w[6]+=W;case"C":j=w[3],Z=w[4],Y=w[5],W=w[6];break;case"s":w[0]="S",w[1]+=Y,w[2]+=W,w[3]+=Y,w[4]+=W;case"S":N==="C"?(j=2*Y-j,Z=2*W-Z):(j=Y,Z=W),Y=w[3],W=w[4],w[0]="C",w[5]=w[3],w[6]=w[4],w[3]=w[1],w[4]=w[2],w[1]=j,w[2]=Z,j=w[3],Z=w[4];break;case"q":w[0]="Q",w[1]+=Y,w[2]+=W,w[3]+=Y,w[4]+=W;case"Q":j=w[1],Z=w[2],Y=w[3],W=w[4];break;case"t":w[0]="T",w[1]+=Y,w[2]+=W;case"T":N==="Q"?(j=2*Y-j,Z=2*W-Z):(j=Y,Z=W),w[0]="Q",Y=w[1],W=w[2],w[1]=j,w[2]=Z,w[3]=Y,w[4]=W;break;case"a":w[0]="A",w[6]+=Y,w[7]+=W;case"A":O=!0,J=J.concat(a(Y,W,w)),Y=w[6],W=w[7];break;case"z":case"Z":Y=R,W=V}O||J.push(w),N=w[0]}return J},v.util.getSmoothPathFromPoints=function(S,w){var b,O=[],N=new v.Point(S[0].x,S[0].y),j=new v.Point(S[1].x,S[1].y),Z=S.length,Y=1,W=0,P=Z>2;for(w=w||0,P&&(Y=S[2].x<j.x?-1:S[2].x===j.x?0:1,W=S[2].y<j.y?-1:S[2].y===j.y?0:1),O.push(["M",N.x-Y*w,N.y-W*w]),b=1;b<Z;b++){if(!N.eq(j)){var R=N.midPointFrom(j);O.push(["Q",N.x,N.y,R.x,R.y])}N=S[b],b+1<S.length&&(j=S[b+1])}return P&&(Y=N.x>S[b-2].x?1:N.x===S[b-2].x?0:-1,W=N.y>S[b-2].y?1:N.y===S[b-2].y?0:-1),O.push(["L",N.x+Y*w,N.y+W*w]),O},v.util.getPathSegmentsInfo=y,v.util.getBoundsOfCurve=function(S,w,b,O,N,j,Z,Y){var W;if(v.cachesBoundsOfCurve&&(W=h.call(arguments),v.boundsOfCurveCache[W]))return v.boundsOfCurveCache[W];var P,R,V,J,q,L,M,G,ee=Math.sqrt,z=Math.min,ie=Math.max,de=Math.abs,he=[],se=[[],[]];R=6*S-12*b+6*N,P=-3*S+9*b-9*N+3*Z,V=3*b-3*S;for(var Ee=0;Ee<2;++Ee)if(Ee>0&&(R=6*w-12*O+6*j,P=-3*w+9*O-9*j+3*Y,V=3*O-3*w),de(P)<1e-12){if(de(R)<1e-12)continue;0<(J=-V/R)&&J<1&&he.push(J)}else(M=R*R-4*V*P)<0||(0<(q=(-R+(G=ee(M)))/(2*P))&&q<1&&he.push(q),0<(L=(-R-G)/(2*P))&&L<1&&he.push(L));for(var ce,pe,_e,Be=he.length,Te=Be;Be--;)ce=(_e=1-(J=he[Be]))*_e*_e*S+3*_e*_e*J*b+3*_e*J*J*N+J*J*J*Z,se[0][Be]=ce,pe=_e*_e*_e*w+3*_e*_e*J*O+3*_e*J*J*j+J*J*J*Y,se[1][Be]=pe;se[0][Te]=S,se[1][Te]=w,se[0][Te+1]=Z,se[1][Te+1]=Y;var Re=[{x:z.apply(null,se[0]),y:z.apply(null,se[1])},{x:ie.apply(null,se[0]),y:ie.apply(null,se[1])}];return v.cachesBoundsOfCurve&&(v.boundsOfCurveCache[W]=Re),Re},v.util.getPointOnPath=function(S,w,b){b||(b=y(S));for(var O=0;w-b[O].length>0&&O<b.length-2;)w-=b[O].length,O++;var N,j=b[O],Z=w/j.length,Y=j.command,W=S[O];switch(Y){case"M":return{x:j.x,y:j.y,angle:0};case"Z":case"z":return(N=new v.Point(j.x,j.y).lerp(new v.Point(j.destX,j.destY),Z)).angle=Math.atan2(j.destY-j.y,j.destX-j.x),N;case"L":return(N=new v.Point(j.x,j.y).lerp(new v.Point(W[1],W[2]),Z)).angle=Math.atan2(W[2]-j.y,W[1]-j.x),N;case"C":case"Q":return function(P,R){for(var V,J,q,L=0,M=0,G=P.iterator,ee={x:P.x,y:P.y},z=.01,ie=P.angleFinder;M<R&&z>1e-4;)V=G(L),q=L,(J=c(ee.x,ee.y,V.x,V.y))+M>R?(L-=z,z/=2):(ee=V,L+=z,M+=J);return V.angle=ie(q),V}(j,w)}},v.util.transformPath=function(S,w,b){return b&&(w=v.util.multiplyTransformMatrices(w,[1,0,0,1,-b.x,-b.y])),S.map(function(O){for(var N=O.slice(0),j={},Z=1;Z<O.length-1;Z+=2)j.x=O[Z],j.y=O[Z+1],j=v.util.transformPoint(j,w),N[Z]=j.x,N[Z+1]=j.y;return N})}}(),function(){var h=Array.prototype.slice;function x(l,f,n){if(l&&l.length!==0){var a=l.length-1,c=f?l[a][f]:l[a];if(f)for(;a--;)n(l[a][f],c)&&(c=l[a][f]);else for(;a--;)n(l[a],c)&&(c=l[a]);return c}}v.util.array={fill:function(l,f){for(var n=l.length;n--;)l[n]=f;return l},invoke:function(l,f){for(var n=h.call(arguments,2),a=[],c=0,A=l.length;c<A;c++)a[c]=n.length?l[c][f].apply(l[c],n):l[c][f].call(l[c]);return a},min:function(l,f){return x(l,f,function(n,a){return n<a})},max:function(l,f){return x(l,f,function(n,a){return n>=a})}}}(),function(){function h(x,l,f){if(f)if(!v.isLikelyNode&&l instanceof Element)x=l;else if(l instanceof Array){x=[];for(var n=0,a=l.length;n<a;n++)x[n]=h({},l[n],f)}else if(l&&typeof l=="object")for(var c in l)c==="canvas"||c==="group"?x[c]=null:l.hasOwnProperty(c)&&(x[c]=h({},l[c],f));else x=l;else for(var c in l)x[c]=l[c];return x}v.util.object={extend:h,clone:function(x,l){return h({},x,l)}},v.util.object.extend(v.util,v.Observable)}(),function(){function h(x,l){var f=x.charCodeAt(l);if(isNaN(f))return"";if(f<55296||f>57343)return x.charAt(l);if(55296<=f&&f<=56319){if(x.length<=l+1)throw"High surrogate without following low surrogate";var n=x.charCodeAt(l+1);if(56320>n||n>57343)throw"High surrogate without following low surrogate";return x.charAt(l)+x.charAt(l+1)}if(l===0)throw"Low surrogate without preceding high surrogate";var a=x.charCodeAt(l-1);if(55296>a||a>56319)throw"Low surrogate without preceding high surrogate";return!1}v.util.string={camelize:function(x){return x.replace(/-+(.)?/g,function(l,f){return f?f.toUpperCase():""})},capitalize:function(x,l){return x.charAt(0).toUpperCase()+(l?x.slice(1):x.slice(1).toLowerCase())},escapeXml:function(x){return x.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(x){var l,f=0,n=[];for(f=0;f<x.length;f++)(l=h(x,f))!==!1&&n.push(l);return n}}}(),function(){var h=Array.prototype.slice,x=function(){},l=function(){for(var c in{toString:1})if(c==="toString")return!1;return!0}(),f=function(c,A,E){for(var d in A)d in c.prototype&&typeof c.prototype[d]=="function"&&(A[d]+"").indexOf("callSuper")>-1?c.prototype[d]=function(p){return function(){var C=this.constructor.superclass;this.constructor.superclass=E;var y=A[p].apply(this,arguments);if(this.constructor.superclass=C,p!=="initialize")return y}}(d):c.prototype[d]=A[d],l&&(A.toString!==Object.prototype.toString&&(c.prototype.toString=A.toString),A.valueOf!==Object.prototype.valueOf&&(c.prototype.valueOf=A.valueOf))};function n(){}function a(c){for(var A=null,E=this;E.constructor.superclass;){var d=E.constructor.superclass.prototype[c];if(E[c]!==d){A=d;break}E=E.constructor.superclass.prototype}return A?arguments.length>1?A.apply(this,h.call(arguments,1)):A.call(this):console.log("tried to callSuper "+c+", method not found in prototype chain",this)}v.util.createClass=function(){var c=null,A=h.call(arguments,0);function E(){this.initialize.apply(this,arguments)}typeof A[0]=="function"&&(c=A.shift()),E.superclass=c,E.subclasses=[],c&&(n.prototype=c.prototype,E.prototype=new n,c.subclasses.push(E));for(var d=0,p=A.length;d<p;d++)f(E,A[d],c);return E.prototype.initialize||(E.prototype.initialize=x),E.prototype.constructor=E,E.prototype.callSuper=a,E}}(),_=!!v.document.createElement("div").attachEvent,m=["touchstart","touchmove","touchend"],v.util.addListener=function(h,x,l,f){h&&h.addEventListener(x,l,!_&&f)},v.util.removeListener=function(h,x,l,f){h&&h.removeEventListener(x,l,!_&&f)},v.util.getPointer=function(h){var x=h.target,l=v.util.getScrollLeftTop(x),f=function(n){var a=n.changedTouches;return a&&a[0]?a[0]:n}(h);return{x:f.clientX+l.left,y:f.clientY+l.top}},v.util.isTouchEvent=function(h){return m.indexOf(h.type)>-1||h.pointerType==="touch"},F=typeof(D=v.document.createElement("div")).style.opacity=="string",T=typeof D.style.filter=="string",I=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,k=function(h){return h},F?k=function(h,x){return h.style.opacity=x,h}:T&&(k=function(h,x){var l=h.style;return h.currentStyle&&!h.currentStyle.hasLayout&&(l.zoom=1),I.test(l.filter)?(x=x>=.9999?"":"alpha(opacity="+100*x+")",l.filter=l.filter.replace(I,x)):l.filter+=" alpha(opacity="+100*x+")",h}),v.util.setStyle=function(h,x){var l=h.style;if(!l)return h;if(typeof x=="string")return h.style.cssText+=";"+x,x.indexOf("opacity")>-1?k(h,x.match(/opacity:\s*(\d?\.?\d*)/)[1]):h;for(var f in x)f==="opacity"?k(h,x[f]):l[f==="float"||f==="cssFloat"?l.styleFloat===void 0?"cssFloat":"styleFloat":f]=x[f];return h},function(){var h,x,l,f,n=Array.prototype.slice,a=function(E){return n.call(E,0)};try{h=a(v.document.childNodes)instanceof Array}catch{}function c(E,d){var p=v.document.createElement(E);for(var C in d)C==="class"?p.className=d[C]:C==="for"?p.htmlFor=d[C]:p.setAttribute(C,d[C]);return p}function A(E){for(var d=0,p=0,C=v.document.documentElement,y=v.document.body||{scrollLeft:0,scrollTop:0};E&&(E.parentNode||E.host)&&((E=E.parentNode||E.host)===v.document?(d=y.scrollLeft||C.scrollLeft||0,p=y.scrollTop||C.scrollTop||0):(d+=E.scrollLeft||0,p+=E.scrollTop||0),E.nodeType!==1||E.style.position!=="fixed"););return{left:d,top:p}}h||(a=function(E){for(var d=new Array(E.length),p=E.length;p--;)d[p]=E[p];return d}),x=v.document.defaultView&&v.document.defaultView.getComputedStyle?function(E,d){var p=v.document.defaultView.getComputedStyle(E,null);return p?p[d]:void 0}:function(E,d){var p=E.style[d];return!p&&E.currentStyle&&(p=E.currentStyle[d]),p},l=v.document.documentElement.style,f="userSelect"in l?"userSelect":"MozUserSelect"in l?"MozUserSelect":"WebkitUserSelect"in l?"WebkitUserSelect":"KhtmlUserSelect"in l?"KhtmlUserSelect":"",v.util.makeElementUnselectable=function(E){return E.onselectstart!==void 0&&(E.onselectstart=v.util.falseFunction),f?E.style[f]="none":typeof E.unselectable=="string"&&(E.unselectable="on"),E},v.util.makeElementSelectable=function(E){return E.onselectstart!==void 0&&(E.onselectstart=null),f?E.style[f]="":typeof E.unselectable=="string"&&(E.unselectable=""),E},v.util.setImageSmoothing=function(E,d){E.imageSmoothingEnabled=E.imageSmoothingEnabled||E.webkitImageSmoothingEnabled||E.mozImageSmoothingEnabled||E.msImageSmoothingEnabled||E.oImageSmoothingEnabled,E.imageSmoothingEnabled=d},v.util.getById=function(E){return typeof E=="string"?v.document.getElementById(E):E},v.util.toArray=a,v.util.addClass=function(E,d){E&&(" "+E.className+" ").indexOf(" "+d+" ")===-1&&(E.className+=(E.className?" ":"")+d)},v.util.makeElement=c,v.util.wrapElement=function(E,d,p){return typeof d=="string"&&(d=c(d,p)),E.parentNode&&E.parentNode.replaceChild(d,E),d.appendChild(E),d},v.util.getScrollLeftTop=A,v.util.getElementOffset=function(E){var d,p,C=E&&E.ownerDocument,y={left:0,top:0},S={left:0,top:0},w={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!C)return S;for(var b in w)S[w[b]]+=parseInt(x(E,b),10)||0;return d=C.documentElement,E.getBoundingClientRect!==void 0&&(y=E.getBoundingClientRect()),p=A(E),{left:y.left+p.left-(d.clientLeft||0)+S.left,top:y.top+p.top-(d.clientTop||0)+S.top}},v.util.getNodeCanvas=function(E){var d=v.jsdomImplForWrapper(E);return d._canvas||d._image},v.util.cleanUpJsdomNode=function(E){if(v.isLikelyNode){var d=v.jsdomImplForWrapper(E);d&&(d._image=null,d._canvas=null,d._currentSrc=null,d._attributes=null,d._classList=null)}}}(),function(){function h(){}v.util.request=function(x,l){l||(l={});var f=l.method?l.method.toUpperCase():"GET",n=l.onComplete||function(){},a=new v.window.XMLHttpRequest,c=l.body||l.parameters;return a.onreadystatechange=function(){a.readyState===4&&(n(a),a.onreadystatechange=h)},f==="GET"&&(c=null,typeof l.parameters=="string"&&(x=function(A,E){return A+(/\?/.test(A)?"&":"?")+E}(x,l.parameters))),a.open(f,x,!0),f!=="POST"&&f!=="PUT"||a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(c),a}}(),v.log=console.log,v.warn=console.warn,function(){var h=v.util.object.extend,x=v.util.object.clone,l=[];function f(){return!1}function n(E,d,p,C){return-p*Math.cos(E/C*(Math.PI/2))+p+d}v.util.object.extend(l,{cancelAll:function(){var E=this.splice(0);return E.forEach(function(d){d.cancel()}),E},cancelByCanvas:function(E){if(!E)return[];var d=this.filter(function(p){return typeof p.target=="object"&&p.target.canvas===E});return d.forEach(function(p){p.cancel()}),d},cancelByTarget:function(E){var d=this.findAnimationsByTarget(E);return d.forEach(function(p){p.cancel()}),d},findAnimationIndex:function(E){return this.indexOf(this.findAnimation(E))},findAnimation:function(E){return this.find(function(d){return d.cancel===E})},findAnimationsByTarget:function(E){return E?this.filter(function(d){return d.target===E}):[]}});var a=v.window.requestAnimationFrame||v.window.webkitRequestAnimationFrame||v.window.mozRequestAnimationFrame||v.window.oRequestAnimationFrame||v.window.msRequestAnimationFrame||function(E){return v.window.setTimeout(E,1e3/60)},c=v.window.cancelAnimationFrame||v.window.clearTimeout;function A(){return a.apply(v.window,arguments)}v.util.animate=function(E){E||(E={});var d,p=!1,C=function(){var y=v.runningAnimations.indexOf(d);return y>-1&&v.runningAnimations.splice(y,1)[0]};return d=h(x(E),{cancel:function(){return p=!0,C()},currentValue:"startValue"in E?E.startValue:0,completionRate:0,durationRate:0}),v.runningAnimations.push(d),A(function(y){var S,w=y||+new Date,b=E.duration||500,O=w+b,N=E.onChange||f,j=E.abort||f,Z=E.onComplete||f,Y=E.easing||n,W="startValue"in E&&E.startValue.length>0,P="startValue"in E?E.startValue:0,R="endValue"in E?E.endValue:100,V=E.byValue||(W?P.map(function(J,q){return R[q]-P[q]}):R-P);E.onStart&&E.onStart(),function J(q){var L=(S=q||+new Date)>O?b:S-w,M=L/b,G=W?P.map(function(z,ie){return Y(L,P[ie],V[ie],b)}):Y(L,P,V,b),ee=Math.abs(W?(G[0]-P[0])/V[0]:(G-P)/V);if(d.currentValue=W?G.slice():G,d.completionRate=ee,d.durationRate=M,!p){if(!j(G,ee,M))return S>O?(d.currentValue=W?R.slice():R,d.completionRate=1,d.durationRate=1,N(W?R.slice():R,1,1),Z(R,1,1),void C()):(N(G,ee,M),void A(J));C()}}(w)}),d.cancel},v.util.requestAnimFrame=A,v.util.cancelAnimFrame=function(){return c.apply(v.window,arguments)},v.runningAnimations=l}(),function(){function h(x,l,f){var n="rgba("+parseInt(x[0]+f*(l[0]-x[0]),10)+","+parseInt(x[1]+f*(l[1]-x[1]),10)+","+parseInt(x[2]+f*(l[2]-x[2]),10);return(n+=","+(x&&l?parseFloat(x[3]+f*(l[3]-x[3])):1))+")"}v.util.animateColor=function(x,l,f,n){var a=new v.Color(x).getSource(),c=new v.Color(l).getSource(),A=n.onComplete,E=n.onChange;return n=n||{},v.util.animate(v.util.object.extend(n,{duration:f||500,startValue:a,endValue:c,byValue:c,easing:function(d,p,C,y){return h(p,C,n.colorEasing?n.colorEasing(d,y):1-Math.cos(d/y*(Math.PI/2)))},onComplete:function(d,p,C){if(A)return A(h(c,c,0),p,C)},onChange:function(d,p,C){if(E){if(Array.isArray(d))return E(h(d,d,0),p,C);E(d,p,C)}}}))}}(),function(){function h(n,a,c,A){return n<Math.abs(a)?(n=a,A=c/4):A=a===0&&n===0?c/(2*Math.PI)*Math.asin(1):c/(2*Math.PI)*Math.asin(a/n),{a:n,c:a,p:c,s:A}}function x(n,a,c){return n.a*Math.pow(2,10*(a-=1))*Math.sin((a*c-n.s)*(2*Math.PI)/n.p)}function l(n,a,c,A){return c-f(A-n,0,c,A)+a}function f(n,a,c,A){return(n/=A)<1/2.75?c*(7.5625*n*n)+a:n<2/2.75?c*(7.5625*(n-=1.5/2.75)*n+.75)+a:n<2.5/2.75?c*(7.5625*(n-=2.25/2.75)*n+.9375)+a:c*(7.5625*(n-=2.625/2.75)*n+.984375)+a}v.util.ease={easeInQuad:function(n,a,c,A){return c*(n/=A)*n+a},easeOutQuad:function(n,a,c,A){return-c*(n/=A)*(n-2)+a},easeInOutQuad:function(n,a,c,A){return(n/=A/2)<1?c/2*n*n+a:-c/2*(--n*(n-2)-1)+a},easeInCubic:function(n,a,c,A){return c*(n/=A)*n*n+a},easeOutCubic:function(n,a,c,A){return c*((n=n/A-1)*n*n+1)+a},easeInOutCubic:function(n,a,c,A){return(n/=A/2)<1?c/2*n*n*n+a:c/2*((n-=2)*n*n+2)+a},easeInQuart:function(n,a,c,A){return c*(n/=A)*n*n*n+a},easeOutQuart:function(n,a,c,A){return-c*((n=n/A-1)*n*n*n-1)+a},easeInOutQuart:function(n,a,c,A){return(n/=A/2)<1?c/2*n*n*n*n+a:-c/2*((n-=2)*n*n*n-2)+a},easeInQuint:function(n,a,c,A){return c*(n/=A)*n*n*n*n+a},easeOutQuint:function(n,a,c,A){return c*((n=n/A-1)*n*n*n*n+1)+a},easeInOutQuint:function(n,a,c,A){return(n/=A/2)<1?c/2*n*n*n*n*n+a:c/2*((n-=2)*n*n*n*n+2)+a},easeInSine:function(n,a,c,A){return-c*Math.cos(n/A*(Math.PI/2))+c+a},easeOutSine:function(n,a,c,A){return c*Math.sin(n/A*(Math.PI/2))+a},easeInOutSine:function(n,a,c,A){return-c/2*(Math.cos(Math.PI*n/A)-1)+a},easeInExpo:function(n,a,c,A){return n===0?a:c*Math.pow(2,10*(n/A-1))+a},easeOutExpo:function(n,a,c,A){return n===A?a+c:c*(1-Math.pow(2,-10*n/A))+a},easeInOutExpo:function(n,a,c,A){return n===0?a:n===A?a+c:(n/=A/2)<1?c/2*Math.pow(2,10*(n-1))+a:c/2*(2-Math.pow(2,-10*--n))+a},easeInCirc:function(n,a,c,A){return-c*(Math.sqrt(1-(n/=A)*n)-1)+a},easeOutCirc:function(n,a,c,A){return c*Math.sqrt(1-(n=n/A-1)*n)+a},easeInOutCirc:function(n,a,c,A){return(n/=A/2)<1?-c/2*(Math.sqrt(1-n*n)-1)+a:c/2*(Math.sqrt(1-(n-=2)*n)+1)+a},easeInElastic:function(n,a,c,A){var E=0;return n===0?a:(n/=A)==1?a+c:(E||(E=.3*A),-x(h(c,c,E,1.70158),n,A)+a)},easeOutElastic:function(n,a,c,A){var E=0;if(n===0)return a;if((n/=A)==1)return a+c;E||(E=.3*A);var d=h(c,c,E,1.70158);return d.a*Math.pow(2,-10*n)*Math.sin((n*A-d.s)*(2*Math.PI)/d.p)+d.c+a},easeInOutElastic:function(n,a,c,A){var E=0;if(n===0)return a;if((n/=A/2)==2)return a+c;E||(E=A*(.3*1.5));var d=h(c,c,E,1.70158);return n<1?-.5*x(d,n,A)+a:d.a*Math.pow(2,-10*(n-=1))*Math.sin((n*A-d.s)*(2*Math.PI)/d.p)*.5+d.c+a},easeInBack:function(n,a,c,A,E){return E===void 0&&(E=1.70158),c*(n/=A)*n*((E+1)*n-E)+a},easeOutBack:function(n,a,c,A,E){return E===void 0&&(E=1.70158),c*((n=n/A-1)*n*((E+1)*n+E)+1)+a},easeInOutBack:function(n,a,c,A,E){return E===void 0&&(E=1.70158),(n/=A/2)<1?c/2*(n*n*((1+(E*=1.525))*n-E))+a:c/2*((n-=2)*n*((1+(E*=1.525))*n+E)+2)+a},easeInBounce:l,easeOutBounce:f,easeInOutBounce:function(n,a,c,A){return n<A/2?.5*l(2*n,0,c,A)+a:.5*f(2*n-A,0,c,A)+.5*c+a}}}(),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.util.object.clone,n=x.util.toFixed,a=x.util.parseUnit,c=x.util.multiplyTransformMatrices,A={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},E={stroke:"strokeOpacity",fill:"fillOpacity"},d="font-size",p="clip-path";function C(P){return P in A?A[P]:P}function y(P,R,V,J){var q,L=Array.isArray(R);if(P!=="fill"&&P!=="stroke"||R!=="none"){if(P==="strokeUniform")return R==="non-scaling-stroke";if(P==="strokeDashArray")R=R==="none"?null:R.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(P==="transformMatrix")R=V&&V.transformMatrix?c(V.transformMatrix,x.parseTransformAttribute(R)):x.parseTransformAttribute(R);else if(P==="visible")R=R!=="none"&&R!=="hidden",V&&V.visible===!1&&(R=!1);else if(P==="opacity")R=parseFloat(R),V&&V.opacity!==void 0&&(R*=V.opacity);else if(P==="textAnchor")R=R==="start"?"left":R==="end"?"right":"center";else if(P==="charSpacing")q=a(R,J)/J*1e3;else if(P==="paintFirst"){var M=R.indexOf("fill"),G=R.indexOf("stroke");R="fill",(M>-1&&G>-1&&G<M||M===-1&&G>-1)&&(R="stroke")}else{if(P==="href"||P==="xlink:href"||P==="font")return R;if(P==="imageSmoothing")return R==="optimizeQuality";q=L?R.map(a):a(R,J)}}else R="";return!L&&isNaN(q)?R:q}function S(P){return new RegExp("^("+P.join("|")+")\\b","i")}function w(P,R){var V,J,q,L,M=[];for(q=0,L=R.length;q<L;q++)V=R[q],J=P.getElementsByTagName(V),M=M.concat(Array.prototype.slice.call(J));return M}function b(P,R){var V,J=!0;return(V=O(P,R.pop()))&&R.length&&(J=function(q,L){for(var M,G=!0;q.parentNode&&q.parentNode.nodeType===1&&L.length;)G&&(M=L.pop()),G=O(q=q.parentNode,M);return L.length===0}(P,R)),V&&J&&R.length===0}function O(P,R){var V,J,q=P.nodeName,L=P.getAttribute("class"),M=P.getAttribute("id");if(V=new RegExp("^"+q,"i"),R=R.replace(V,""),M&&R.length&&(V=new RegExp("#"+M+"(?![a-zA-Z\\-]+)","i"),R=R.replace(V,"")),L&&R.length)for(J=(L=L.split(" ")).length;J--;)V=new RegExp("\\."+L[J]+"(?![a-zA-Z\\-]+)","i"),R=R.replace(V,"");return R.length===0}function N(P,R){var V;if(P.getElementById&&(V=P.getElementById(R)),V)return V;var J,q,L,M=P.getElementsByTagName("*");for(q=0,L=M.length;q<L;q++)if(R===(J=M[q]).getAttribute("id"))return J}x.svgValidTagNamesRegEx=S(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),x.svgViewBoxElementsRegEx=S(["symbol","image","marker","pattern","view","svg"]),x.svgInvalidAncestorsRegEx=S(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),x.svgValidParentsRegEx=S(["symbol","g","a","svg","clipPath","defs"]),x.cssRules={},x.gradientDefs={},x.clipPaths={},x.parseTransformAttribute=function(){function P(G,ee,z){G[z]=Math.tan(x.util.degreesToRadians(ee[0]))}var R=x.iMatrix,V=x.reNum,J=x.commaWsp,q="(?:(?:(matrix)\\s*\\(\\s*("+V+")"+J+"("+V+")"+J+"("+V+")"+J+"("+V+")"+J+"("+V+")"+J+"("+V+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+V+")(?:"+J+"("+V+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+V+")(?:"+J+"("+V+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+V+")(?:"+J+"("+V+")"+J+"("+V+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+V+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+V+")\\s*\\)))",L=new RegExp("^\\s*(?:(?:"+q+"(?:"+J+"*"+q+")*)?)\\s*$"),M=new RegExp(q,"g");return function(G){var ee=R.concat(),z=[];if(!G||G&&!L.test(G))return ee;G.replace(M,function(de){var he=new RegExp(q).exec(de).filter(function(ce){return!!ce}),se=he[1],Ee=he.slice(2).map(parseFloat);switch(se){case"translate":(function(ce,pe){ce[4]=pe[0],pe.length===2&&(ce[5]=pe[1])})(ee,Ee);break;case"rotate":Ee[0]=x.util.degreesToRadians(Ee[0]),function(ce,pe){var _e=x.util.cos(pe[0]),Be=x.util.sin(pe[0]),Te=0,Re=0;pe.length===3&&(Te=pe[1],Re=pe[2]),ce[0]=_e,ce[1]=Be,ce[2]=-Be,ce[3]=_e,ce[4]=Te-(_e*Te-Be*Re),ce[5]=Re-(Be*Te+_e*Re)}(ee,Ee);break;case"scale":(function(ce,pe){var _e=pe[0],Be=pe.length===2?pe[1]:pe[0];ce[0]=_e,ce[3]=Be})(ee,Ee);break;case"skewX":P(ee,Ee,2);break;case"skewY":P(ee,Ee,1);break;case"matrix":ee=Ee}z.push(ee.concat()),ee=R.concat()});for(var ie=z[0];z.length>1;)z.shift(),ie=x.util.multiplyTransformMatrices(ie,z[0]);return ie}}();var j=new RegExp("^\\s*("+x.reNum+"+)\\s*,?\\s*("+x.reNum+"+)\\s*,?\\s*("+x.reNum+"+)\\s*,?\\s*("+x.reNum+"+)\\s*$");function Z(P){if(!x.svgViewBoxElementsRegEx.test(P.nodeName))return{};var R,V,J,q,L,M,G=P.getAttribute("viewBox"),ee=1,z=1,ie=P.getAttribute("width"),de=P.getAttribute("height"),he=P.getAttribute("x")||0,se=P.getAttribute("y")||0,Ee=P.getAttribute("preserveAspectRatio")||"",ce=!G||!(G=G.match(j)),pe=!ie||!de||ie==="100%"||de==="100%",_e=ce&&pe,Be={},Te="",Re=0,tt=0;if(Be.width=0,Be.height=0,Be.toBeParsed=_e,ce&&(he||se)&&P.parentNode&&P.parentNode.nodeName!=="#document"&&(Te=" translate("+a(he)+" "+a(se)+") ",L=(P.getAttribute("transform")||"")+Te,P.setAttribute("transform",L),P.removeAttribute("x"),P.removeAttribute("y")),_e)return Be;if(ce)return Be.width=a(ie),Be.height=a(de),Be;if(R=-parseFloat(G[1]),V=-parseFloat(G[2]),J=parseFloat(G[3]),q=parseFloat(G[4]),Be.minX=R,Be.minY=V,Be.viewBoxWidth=J,Be.viewBoxHeight=q,pe?(Be.width=J,Be.height=q):(Be.width=a(ie),Be.height=a(de),ee=Be.width/J,z=Be.height/q),(Ee=x.util.parsePreserveAspectRatioAttribute(Ee)).alignX!=="none"&&(Ee.meetOrSlice==="meet"&&(z=ee=ee>z?z:ee),Ee.meetOrSlice==="slice"&&(z=ee=ee>z?ee:z),Re=Be.width-J*ee,tt=Be.height-q*ee,Ee.alignX==="Mid"&&(Re/=2),Ee.alignY==="Mid"&&(tt/=2),Ee.alignX==="Min"&&(Re=0),Ee.alignY==="Min"&&(tt=0)),ee===1&&z===1&&R===0&&V===0&&he===0&&se===0)return Be;if((he||se)&&P.parentNode.nodeName!=="#document"&&(Te=" translate("+a(he)+" "+a(se)+") "),L=Te+" matrix("+ee+" 0 0 "+z+" "+(R*ee+Re)+" "+(V*z+tt)+") ",P.nodeName==="svg"){for(M=P.ownerDocument.createElementNS(x.svgNS,"g");P.firstChild;)M.appendChild(P.firstChild);P.appendChild(M)}else(M=P).removeAttribute("x"),M.removeAttribute("y"),L=M.getAttribute("transform")+L;return M.setAttribute("transform",L),Be}function Y(P,R){var V="xlink:href",J=N(P,R.getAttribute(V).slice(1));if(J&&J.getAttribute(V)&&Y(P,J),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(L){J&&!R.hasAttribute(L)&&J.hasAttribute(L)&&R.setAttribute(L,J.getAttribute(L))}),!R.children.length)for(var q=J.cloneNode(!0);q.firstChild;)R.appendChild(q.firstChild);R.removeAttribute(V)}x.parseSVGDocument=function(P,R,V,J){if(P){(function(he){for(var se=w(he,["use","svg:use"]),Ee=0;se.length&&Ee<se.length;){var ce=se[Ee],pe=ce.getAttribute("xlink:href")||ce.getAttribute("href");if(pe===null)return;var _e,Be,Te,Re,tt=pe.slice(1),lt=ce.getAttribute("x")||0,Ft=ce.getAttribute("y")||0,Ne=N(he,tt).cloneNode(!0),rt=(Ne.getAttribute("transform")||"")+" translate("+lt+", "+Ft+")",ft=se.length,Lt=x.svgNS;if(Z(Ne),/^svg$/i.test(Ne.nodeName)){var St=Ne.ownerDocument.createElementNS(Lt,"g");for(Be=0,Re=(Te=Ne.attributes).length;Be<Re;Be++)_e=Te.item(Be),St.setAttributeNS(Lt,_e.nodeName,_e.nodeValue);for(;Ne.firstChild;)St.appendChild(Ne.firstChild);Ne=St}for(Be=0,Re=(Te=ce.attributes).length;Be<Re;Be++)(_e=Te.item(Be)).nodeName!=="x"&&_e.nodeName!=="y"&&_e.nodeName!=="xlink:href"&&_e.nodeName!=="href"&&(_e.nodeName==="transform"?rt=_e.nodeValue+" "+rt:Ne.setAttribute(_e.nodeName,_e.nodeValue));Ne.setAttribute("transform",rt),Ne.setAttribute("instantiated_by_use","1"),Ne.removeAttribute("id"),ce.parentNode.replaceChild(Ne,ce),se.length===ft&&Ee++}})(P);var q,L,M=x.Object.__uid++,G=Z(P),ee=x.util.toArray(P.getElementsByTagName("*"));if(G.crossOrigin=J&&J.crossOrigin,G.svgUid=M,ee.length===0&&x.isLikelyNode){var z=[];for(q=0,L=(ee=P.selectNodes('//*[name(.)!="svg"]')).length;q<L;q++)z[q]=ee[q];ee=z}var ie=ee.filter(function(he){return Z(he),x.svgValidTagNamesRegEx.test(he.nodeName.replace("svg:",""))&&!function(se,Ee){for(;se&&(se=se.parentNode);)if(se.nodeName&&Ee.test(se.nodeName.replace("svg:",""))&&!se.getAttribute("instantiated_by_use"))return!0;return!1}(he,x.svgInvalidAncestorsRegEx)});if(!ie||ie&&!ie.length)R&&R([],{});else{var de={};ee.filter(function(he){return he.nodeName.replace("svg:","")==="clipPath"}).forEach(function(he){var se=he.getAttribute("id");de[se]=x.util.toArray(he.getElementsByTagName("*")).filter(function(Ee){return x.svgValidTagNamesRegEx.test(Ee.nodeName.replace("svg:",""))})}),x.gradientDefs[M]=x.getGradientDefs(P),x.cssRules[M]=x.getCSSRules(P),x.clipPaths[M]=de,x.parseElements(ie,function(he,se){R&&(R(he,G,se,ee),delete x.gradientDefs[M],delete x.cssRules[M],delete x.clipPaths[M])},f(G),V,J)}}};var W=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+x.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+x.reNum+"))?\\s+(.*)");l(x,{parseFontDeclaration:function(P,R){var V=P.match(W);if(V){var J=V[1],q=V[3],L=V[4],M=V[5],G=V[6];J&&(R.fontStyle=J),q&&(R.fontWeight=isNaN(parseFloat(q))?q:parseFloat(q)),L&&(R.fontSize=a(L)),G&&(R.fontFamily=G),M&&(R.lineHeight=M==="normal"?1:M)}},getGradientDefs:function(P){var R,V=w(P,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),J=0,q={};for(J=V.length;J--;)(R=V[J]).getAttribute("xlink:href")&&Y(P,R),q[R.getAttribute("id")]=R;return q},parseAttributes:function(P,R,V){if(P){var J,q,L,M={};V===void 0&&(V=P.getAttribute("svgUid")),P.parentNode&&x.svgValidParentsRegEx.test(P.parentNode.nodeName)&&(M=x.parseAttributes(P.parentNode,R,V));var G=R.reduce(function(Ee,ce){return(J=P.getAttribute(ce))&&(Ee[ce]=J),Ee},{}),ee=l(function(Ee,ce){var pe={};for(var _e in x.cssRules[ce])if(b(Ee,_e.split(" ")))for(var Be in x.cssRules[ce][_e])pe[Be]=x.cssRules[ce][_e][Be];return pe}(P,V),x.parseStyleAttribute(P));G=l(G,ee),ee[p]&&P.setAttribute(p,ee[p]),q=L=M.fontSize||x.Text.DEFAULT_SVG_FONT_SIZE,G[d]&&(G[d]=q=a(G[d],L));var z,ie,de={};for(var he in G)ie=y(z=C(he),G[he],M,q),de[z]=ie;de&&de.font&&x.parseFontDeclaration(de.font,de);var se=l(M,de);return x.svgValidParentsRegEx.test(P.nodeName)?se:function(Ee){for(var ce in E)if(Ee[E[ce]]!==void 0&&Ee[ce]!==""){if(Ee[ce]===void 0){if(!x.Object.prototype[ce])continue;Ee[ce]=x.Object.prototype[ce]}if(Ee[ce].indexOf("url(")!==0){var pe=new x.Color(Ee[ce]);Ee[ce]=pe.setAlpha(n(pe.getAlpha()*Ee[E[ce]],2)).toRgba()}}return Ee}(se)}},parseElements:function(P,R,V,J,q){new x.ElementsParser(P,R,V,J,q).parse()},parseStyleAttribute:function(P){var R={},V=P.getAttribute("style");return V&&(typeof V=="string"?function(J,q){var L,M;J.replace(/;\s*$/,"").split(";").forEach(function(G){var ee=G.split(":");L=ee[0].trim().toLowerCase(),M=ee[1].trim(),q[L]=M})}(V,R):function(J,q){var L,M;for(var G in J)J[G]!==void 0&&(L=G.toLowerCase(),M=J[G],q[L]=M)}(V,R)),R},parsePointsAttribute:function(P){if(!P)return null;var R,V,J=[];for(R=0,V=(P=(P=P.replace(/,/g," ").trim()).split(/\s+/)).length;R<V;R+=2)J.push({x:parseFloat(P[R]),y:parseFloat(P[R+1])});return J},getCSSRules:function(P){var R,V,J=P.getElementsByTagName("style"),q={};for(R=0,V=J.length;R<V;R++){var L=J[R].textContent;(L=L.replace(/\/\*[\s\S]*?\*\//g,"")).trim()!==""&&L.split("}").filter(function(M){return M.trim()}).forEach(function(M){var G=M.split("{"),ee={},z=G[1].trim().split(";").filter(function(se){return se.trim()});for(R=0,V=z.length;R<V;R++){var ie=z[R].split(":"),de=ie[0].trim(),he=ie[1].trim();ee[de]=he}(M=G[0].trim()).split(",").forEach(function(se){(se=se.replace(/^svg/i,"").trim())!==""&&(q[se]?x.util.object.extend(q[se],ee):q[se]=x.util.object.clone(ee))})})}return q},loadSVGFromURL:function(P,R,V,J){P=P.replace(/^\n\s*/,"").trim(),new x.util.request(P,{method:"get",onComplete:function(q){var L=q.responseXML;if(!L||!L.documentElement)return R&&R(null),!1;x.parseSVGDocument(L.documentElement,function(M,G,ee,z){R&&R(M,G,ee,z)},V,J)}})},loadSVGFromString:function(P,R,V,J){var q=new x.window.DOMParser().parseFromString(P.trim(),"text/xml");x.parseSVGDocument(q.documentElement,function(L,M,G,ee){R(L,M,G,ee)},V,J)}})}(e),v.ElementsParser=function(h,x,l,f,n,a){this.elements=h,this.callback=x,this.options=l,this.reviver=f,this.svgUid=l&&l.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=a},(U=v.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},U.createObjects=function(){var h=this;this.elements.forEach(function(x,l){x.setAttribute("svgUid",h.svgUid),h.createObject(x,l)})},U.findTag=function(h){return v[v.util.string.capitalize(h.tagName.replace("svg:",""))]},U.createObject=function(h,x){var l=this.findTag(h);if(l&&l.fromElement)try{l.fromElement(h,this.createCallback(x,h),this.options)}catch(f){v.log(f)}else this.checkIfDone()},U.createCallback=function(h,x){var l=this;return function(f){var n;l.resolveGradient(f,x,"fill"),l.resolveGradient(f,x,"stroke"),f instanceof v.Image&&f._originalElement&&(n=f.parsePreserveAspectRatioAttribute(x)),f._removeTransformMatrix(n),l.resolveClipPath(f,x),l.reviver&&l.reviver(x,f),l.instances[h]=f,l.checkIfDone()}},U.extractPropertyDefinition=function(h,x,l){var f=h[x],n=this.regexUrl;if(n.test(f)){n.lastIndex=0;var a=n.exec(f)[1];return n.lastIndex=0,v[l][this.svgUid][a]}},U.resolveGradient=function(h,x,l){var f=this.extractPropertyDefinition(h,l,"gradientDefs");if(f){var n=x.getAttribute(l+"-opacity"),a=v.Gradient.fromElement(f,h,n,this.options);h.set(l,a)}},U.createClipPathCallback=function(h,x){return function(l){l._removeTransformMatrix(),l.fillRule=l.clipRule,x.push(l)}},U.resolveClipPath=function(h,x){var l,f,n,a,c=this.extractPropertyDefinition(h,"clipPath","clipPaths");if(c){n=[],f=v.util.invertTransform(h.calcTransformMatrix());for(var A=c[0].parentNode,E=x;E.parentNode&&E.getAttribute("clip-path")!==h.clipPath;)E=E.parentNode;E.parentNode.appendChild(A);for(var d=0;d<c.length;d++)l=c[d],this.findTag(l).fromElement(l,this.createClipPathCallback(h,n),this.options);c=n.length===1?n[0]:new v.Group(n),a=v.util.multiplyTransformMatrices(f,c.calcTransformMatrix()),c.clipPath&&this.resolveClipPath(c,E);var p=v.util.qrDecompose(a);c.flipX=!1,c.flipY=!1,c.set("scaleX",p.scaleX),c.set("scaleY",p.scaleY),c.angle=p.angle,c.skewX=p.skewX,c.skewY=0,c.setPositionByOrigin({x:p.translateX,y:p.translateY},"center","center"),h.clipPath=c}else delete h.clipPath},U.checkIfDone=function(){--this.numElements==0&&(this.instances=this.instances.filter(function(h){return h!=null}),this.callback(this.instances,this.elements))},function(h){var x=h.fabric||(h.fabric={});function l(f,n){this.x=f,this.y=n}x.Point?x.warn("fabric.Point is already defined"):(x.Point=l,l.prototype={type:"point",constructor:l,add:function(f){return new l(this.x+f.x,this.y+f.y)},addEquals:function(f){return this.x+=f.x,this.y+=f.y,this},scalarAdd:function(f){return new l(this.x+f,this.y+f)},scalarAddEquals:function(f){return this.x+=f,this.y+=f,this},subtract:function(f){return new l(this.x-f.x,this.y-f.y)},subtractEquals:function(f){return this.x-=f.x,this.y-=f.y,this},scalarSubtract:function(f){return new l(this.x-f,this.y-f)},scalarSubtractEquals:function(f){return this.x-=f,this.y-=f,this},multiply:function(f){return new l(this.x*f,this.y*f)},multiplyEquals:function(f){return this.x*=f,this.y*=f,this},divide:function(f){return new l(this.x/f,this.y/f)},divideEquals:function(f){return this.x/=f,this.y/=f,this},eq:function(f){return this.x===f.x&&this.y===f.y},lt:function(f){return this.x<f.x&&this.y<f.y},lte:function(f){return this.x<=f.x&&this.y<=f.y},gt:function(f){return this.x>f.x&&this.y>f.y},gte:function(f){return this.x>=f.x&&this.y>=f.y},lerp:function(f,n){return n===void 0&&(n=.5),n=Math.max(Math.min(1,n),0),new l(this.x+(f.x-this.x)*n,this.y+(f.y-this.y)*n)},distanceFrom:function(f){var n=this.x-f.x,a=this.y-f.y;return Math.sqrt(n*n+a*a)},midPointFrom:function(f){return this.lerp(f)},min:function(f){return new l(Math.min(this.x,f.x),Math.min(this.y,f.y))},max:function(f){return new l(Math.max(this.x,f.x),Math.max(this.y,f.y))},toString:function(){return this.x+","+this.y},setXY:function(f,n){return this.x=f,this.y=n,this},setX:function(f){return this.x=f,this},setY:function(f){return this.y=f,this},setFromPoint:function(f){return this.x=f.x,this.y=f.y,this},swap:function(f){var n=this.x,a=this.y;this.x=f.x,this.y=f.y,f.x=n,f.y=a},clone:function(){return new l(this.x,this.y)}})}(e),function(h){var x=h.fabric||(h.fabric={});function l(f){this.status=f,this.points=[]}x.Intersection?x.warn("fabric.Intersection is already defined"):(x.Intersection=l,x.Intersection.prototype={constructor:l,appendPoint:function(f){return this.points.push(f),this},appendPoints:function(f){return this.points=this.points.concat(f),this}},x.Intersection.intersectLineLine=function(f,n,a,c){var A,E=(c.x-a.x)*(f.y-a.y)-(c.y-a.y)*(f.x-a.x),d=(n.x-f.x)*(f.y-a.y)-(n.y-f.y)*(f.x-a.x),p=(c.y-a.y)*(n.x-f.x)-(c.x-a.x)*(n.y-f.y);if(p!==0){var C=E/p,y=d/p;0<=C&&C<=1&&0<=y&&y<=1?(A=new l("Intersection")).appendPoint(new x.Point(f.x+C*(n.x-f.x),f.y+C*(n.y-f.y))):A=new l}else A=new l(E===0||d===0?"Coincident":"Parallel");return A},x.Intersection.intersectLinePolygon=function(f,n,a){var c,A,E,d,p=new l,C=a.length;for(d=0;d<C;d++)c=a[d],A=a[(d+1)%C],E=l.intersectLineLine(f,n,c,A),p.appendPoints(E.points);return p.points.length>0&&(p.status="Intersection"),p},x.Intersection.intersectPolygonPolygon=function(f,n){var a,c=new l,A=f.length;for(a=0;a<A;a++){var E=f[a],d=f[(a+1)%A],p=l.intersectLinePolygon(E,d,n);c.appendPoints(p.points)}return c.points.length>0&&(c.status="Intersection"),c},x.Intersection.intersectPolygonRectangle=function(f,n,a){var c=n.min(a),A=n.max(a),E=new x.Point(A.x,c.y),d=new x.Point(c.x,A.y),p=l.intersectLinePolygon(c,E,f),C=l.intersectLinePolygon(E,A,f),y=l.intersectLinePolygon(A,d,f),S=l.intersectLinePolygon(d,c,f),w=new l;return w.appendPoints(p.points),w.appendPoints(C.points),w.appendPoints(y.points),w.appendPoints(S.points),w.points.length>0&&(w.status="Intersection"),w})}(e),function(h){var x=h.fabric||(h.fabric={});function l(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}function f(n,a,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?n+6*(a-n)*c:c<.5?a:c<2/3?n+(a-n)*(2/3-c)*6:n}x.Color?x.warn("fabric.Color is already defined."):(x.Color=l,x.Color.prototype={_tryParsingColor:function(n){var a;n in l.colorNameMap&&(n=l.colorNameMap[n]),n==="transparent"&&(a=[255,255,255,0]),a||(a=l.sourceFromHex(n)),a||(a=l.sourceFromRgb(n)),a||(a=l.sourceFromHsl(n)),a||(a=[0,0,0,1]),a&&this.setSource(a)},_rgbToHsl:function(n,a,c){n/=255,a/=255,c/=255;var A,E,d,p=x.util.array.max([n,a,c]),C=x.util.array.min([n,a,c]);if(d=(p+C)/2,p===C)A=E=0;else{var y=p-C;switch(E=d>.5?y/(2-p-C):y/(p+C),p){case n:A=(a-c)/y+(a<c?6:0);break;case a:A=(c-n)/y+2;break;case c:A=(n-a)/y+4}A/=6}return[Math.round(360*A),Math.round(100*E),Math.round(100*d)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),a=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+a[0]+","+a[1]+"%,"+a[2]+"%)"},toHsla:function(){var n=this.getSource(),a=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+a[0]+","+a[1]+"%,"+a[2]+"%,"+n[3]+")"},toHex:function(){var n,a,c,A=this.getSource();return n=(n=A[0].toString(16)).length===1?"0"+n:n,a=(a=A[1].toString(16)).length===1?"0"+a:a,c=(c=A[2].toString(16)).length===1?"0"+c:c,n.toUpperCase()+a.toUpperCase()+c.toUpperCase()},toHexa:function(){var n,a=this.getSource();return n=(n=(n=Math.round(255*a[3])).toString(16)).length===1?"0"+n:n,this.toHex()+n.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var a=this.getSource();return a[3]=n,this.setSource(a),this},toGrayscale:function(){var n=this.getSource(),a=parseInt((.3*n[0]+.59*n[1]+.11*n[2]).toFixed(0),10),c=n[3];return this.setSource([a,a,a,c]),this},toBlackWhite:function(n){var a=this.getSource(),c=(.3*a[0]+.59*a[1]+.11*a[2]).toFixed(0),A=a[3];return n=n||127,c=Number(c)<Number(n)?0:255,this.setSource([c,c,c,A]),this},overlayWith:function(n){n instanceof l||(n=new l(n));var a,c=[],A=this.getAlpha(),E=this.getSource(),d=n.getSource();for(a=0;a<3;a++)c.push(Math.round(.5*E[a]+.5*d[a]));return c[3]=A,this.setSource(c),this}},x.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,x.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,x.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,x.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},x.Color.fromRgb=function(n){return l.fromSource(l.sourceFromRgb(n))},x.Color.sourceFromRgb=function(n){var a=n.match(l.reRGBa);if(a){var c=parseInt(a[1],10)/(/%$/.test(a[1])?100:1)*(/%$/.test(a[1])?255:1),A=parseInt(a[2],10)/(/%$/.test(a[2])?100:1)*(/%$/.test(a[2])?255:1),E=parseInt(a[3],10)/(/%$/.test(a[3])?100:1)*(/%$/.test(a[3])?255:1);return[parseInt(c,10),parseInt(A,10),parseInt(E,10),a[4]?parseFloat(a[4]):1]}},x.Color.fromRgba=l.fromRgb,x.Color.fromHsl=function(n){return l.fromSource(l.sourceFromHsl(n))},x.Color.sourceFromHsl=function(n){var a=n.match(l.reHSLa);if(a){var c,A,E,d=(parseFloat(a[1])%360+360)%360/360,p=parseFloat(a[2])/(/%$/.test(a[2])?100:1),C=parseFloat(a[3])/(/%$/.test(a[3])?100:1);if(p===0)c=A=E=C;else{var y=C<=.5?C*(p+1):C+p-C*p,S=2*C-y;c=f(S,y,d+1/3),A=f(S,y,d),E=f(S,y,d-1/3)}return[Math.round(255*c),Math.round(255*A),Math.round(255*E),a[4]?parseFloat(a[4]):1]}},x.Color.fromHsla=l.fromHsl,x.Color.fromHex=function(n){return l.fromSource(l.sourceFromHex(n))},x.Color.sourceFromHex=function(n){if(n.match(l.reHex)){var a=n.slice(n.indexOf("#")+1),c=a.length===3||a.length===4,A=a.length===8||a.length===4,E=c?a.charAt(0)+a.charAt(0):a.substring(0,2),d=c?a.charAt(1)+a.charAt(1):a.substring(2,4),p=c?a.charAt(2)+a.charAt(2):a.substring(4,6),C=A?c?a.charAt(3)+a.charAt(3):a.substring(6,8):"FF";return[parseInt(E,16),parseInt(d,16),parseInt(p,16),parseFloat((parseInt(C,16)/255).toFixed(2))]}},x.Color.fromSource=function(n){var a=new l;return a.setSource(n),a})}(e),function(h){var x=h.fabric||(h.fabric={}),l=["e","se","s","sw","w","nw","n","ne","e"],f=["ns","nesw","ew","nwse"],n={},a="left",c="top",A="right",E="bottom",d="center",p={top:E,bottom:c,left:A,right:a,center:d},C=x.util.radiansToDegrees,y=Math.sign||function(L){return(L>0)-(L<0)||+L};function S(L,M){var G=L.angle+C(Math.atan2(M.y,M.x))+360;return Math.round(G%360/45)}function w(L,M){var G=M.transform.target,ee=G.canvas,z=x.util.object.clone(M);z.target=G,ee&&ee.fire("object:"+L,z),G.fire(L,M)}function b(L,M){var G=M.canvas,ee=L[G.uniScaleKey];return G.uniformScaling&&!ee||!G.uniformScaling&&ee}function O(L){return L.originX===d&&L.originY===d}function N(L,M,G){var ee=L.lockScalingX,z=L.lockScalingY;return!((!ee||!z)&&(M||!ee&&!z||!G)&&(!ee||M!=="x")&&(!z||M!=="y"))}function j(L,M,G,ee){return{e:L,transform:M,pointer:{x:G,y:ee}}}function Z(L){return function(M,G,ee,z){var ie=G.target,de=ie.getCenterPoint(),he=ie.translateToOriginPoint(de,G.originX,G.originY),se=L(M,G,ee,z);return ie.setPositionByOrigin(he,G.originX,G.originY),se}}function Y(L,M){return function(G,ee,z,ie){var de=M(G,ee,z,ie);return de&&w(L,j(G,ee,z,ie)),de}}function W(L,M,G,ee,z){var ie=L.target,de=ie.controls[L.corner],he=ie.canvas.getZoom(),se=ie.padding/he,Ee=ie.toLocalPoint(new x.Point(ee,z),M,G);return Ee.x>=se&&(Ee.x-=se),Ee.x<=-se&&(Ee.x+=se),Ee.y>=se&&(Ee.y-=se),Ee.y<=se&&(Ee.y+=se),Ee.x-=de.offsetX,Ee.y-=de.offsetY,Ee}function P(L){return L.flipX!==L.flipY}function R(L,M,G,ee,z){if(L[M]!==0){var ie=z/L._getTransformedDimensions()[ee]*L[G];L.set(G,ie)}}function V(L,M,G,ee){var z,ie=M.target,de=ie._getTransformedDimensions(0,ie.skewY),he=W(M,M.originX,M.originY,G,ee),se=Math.abs(2*he.x)-de.x,Ee=ie.skewX;se<2?z=0:(z=C(Math.atan2(se/ie.scaleX,de.y/ie.scaleY)),M.originX===a&&M.originY===E&&(z=-z),M.originX===A&&M.originY===c&&(z=-z),P(ie)&&(z=-z));var ce=Ee!==z;if(ce){var pe=ie._getTransformedDimensions().y;ie.set("skewX",z),R(ie,"skewY","scaleY","y",pe)}return ce}function J(L,M,G,ee){var z,ie=M.target,de=ie._getTransformedDimensions(ie.skewX,0),he=W(M,M.originX,M.originY,G,ee),se=Math.abs(2*he.y)-de.y,Ee=ie.skewY;se<2?z=0:(z=C(Math.atan2(se/ie.scaleY,de.x/ie.scaleX)),M.originX===a&&M.originY===E&&(z=-z),M.originX===A&&M.originY===c&&(z=-z),P(ie)&&(z=-z));var ce=Ee!==z;if(ce){var pe=ie._getTransformedDimensions().x;ie.set("skewY",z),R(ie,"skewX","scaleX","x",pe)}return ce}function q(L,M,G,ee,z){z=z||{};var ie,de,he,se,Ee,ce,pe=M.target,_e=pe.lockScalingX,Be=pe.lockScalingY,Te=z.by,Re=b(L,pe),tt=N(pe,Te,Re),lt=M.gestureScale;if(tt)return!1;if(lt)de=M.scaleX*lt,he=M.scaleY*lt;else{if(ie=W(M,M.originX,M.originY,G,ee),Ee=Te!=="y"?y(ie.x):1,ce=Te!=="x"?y(ie.y):1,M.signX||(M.signX=Ee),M.signY||(M.signY=ce),pe.lockScalingFlip&&(M.signX!==Ee||M.signY!==ce))return!1;if(se=pe._getTransformedDimensions(),Re&&!Te){var Ft=Math.abs(ie.x)+Math.abs(ie.y),Ne=M.original,rt=Ft/(Math.abs(se.x*Ne.scaleX/pe.scaleX)+Math.abs(se.y*Ne.scaleY/pe.scaleY));de=Ne.scaleX*rt,he=Ne.scaleY*rt}else de=Math.abs(ie.x*pe.scaleX/se.x),he=Math.abs(ie.y*pe.scaleY/se.y);O(M)&&(de*=2,he*=2),M.signX!==Ee&&Te!=="y"&&(M.originX=p[M.originX],de*=-1,M.signX=Ee),M.signY!==ce&&Te!=="x"&&(M.originY=p[M.originY],he*=-1,M.signY=ce)}var ft=pe.scaleX,Lt=pe.scaleY;return Te?(Te==="x"&&pe.set("scaleX",de),Te==="y"&&pe.set("scaleY",he)):(!_e&&pe.set("scaleX",de),!Be&&pe.set("scaleY",he)),ft!==pe.scaleX||Lt!==pe.scaleY}n.scaleCursorStyleHandler=function(L,M,G){var ee=b(L,G),z="";if(M.x!==0&&M.y===0?z="x":M.x===0&&M.y!==0&&(z="y"),N(G,z,ee))return"not-allowed";var ie=S(G,M);return l[ie]+"-resize"},n.skewCursorStyleHandler=function(L,M,G){var ee="not-allowed";if(M.x!==0&&G.lockSkewingY||M.y!==0&&G.lockSkewingX)return ee;var z=S(G,M)%4;return f[z]+"-resize"},n.scaleSkewCursorStyleHandler=function(L,M,G){return L[G.canvas.altActionKey]?n.skewCursorStyleHandler(L,M,G):n.scaleCursorStyleHandler(L,M,G)},n.rotationWithSnapping=Y("rotating",Z(function(L,M,G,ee){var z=M,ie=z.target,de=ie.translateToOriginPoint(ie.getCenterPoint(),z.originX,z.originY);if(ie.lockRotation)return!1;var he,se=Math.atan2(z.ey-de.y,z.ex-de.x),Ee=Math.atan2(ee-de.y,G-de.x),ce=C(Ee-se+z.theta);if(ie.snapAngle>0){var pe=ie.snapAngle,_e=ie.snapThreshold||pe,Be=Math.ceil(ce/pe)*pe,Te=Math.floor(ce/pe)*pe;Math.abs(ce-Te)<_e?ce=Te:Math.abs(ce-Be)<_e&&(ce=Be)}return ce<0&&(ce=360+ce),ce%=360,he=ie.angle!==ce,ie.angle=ce,he})),n.scalingEqually=Y("scaling",Z(function(L,M,G,ee){return q(L,M,G,ee)})),n.scalingX=Y("scaling",Z(function(L,M,G,ee){return q(L,M,G,ee,{by:"x"})})),n.scalingY=Y("scaling",Z(function(L,M,G,ee){return q(L,M,G,ee,{by:"y"})})),n.scalingYOrSkewingX=function(L,M,G,ee){return L[M.target.canvas.altActionKey]?n.skewHandlerX(L,M,G,ee):n.scalingY(L,M,G,ee)},n.scalingXOrSkewingY=function(L,M,G,ee){return L[M.target.canvas.altActionKey]?n.skewHandlerY(L,M,G,ee):n.scalingX(L,M,G,ee)},n.changeWidth=Y("resizing",Z(function(L,M,G,ee){var z=M.target,ie=W(M,M.originX,M.originY,G,ee),de=z.strokeWidth/(z.strokeUniform?z.scaleX:1),he=O(M)?2:1,se=z.width,Ee=Math.abs(ie.x*he/z.scaleX)-de;return z.set("width",Math.max(Ee,0)),se!==Ee})),n.skewHandlerX=function(L,M,G,ee){var z,ie=M.target,de=ie.skewX,he=M.originY;return!ie.lockSkewingX&&(de===0?z=W(M,d,d,G,ee).x>0?a:A:(de>0&&(z=he===c?a:A),de<0&&(z=he===c?A:a),P(ie)&&(z=z===a?A:a)),M.originX=z,Y("skewing",Z(V))(L,M,G,ee))},n.skewHandlerY=function(L,M,G,ee){var z,ie=M.target,de=ie.skewY,he=M.originX;return!ie.lockSkewingY&&(de===0?z=W(M,d,d,G,ee).y>0?c:E:(de>0&&(z=he===a?c:E),de<0&&(z=he===a?E:c),P(ie)&&(z=z===c?E:c)),M.originY=z,Y("skewing",Z(J))(L,M,G,ee))},n.dragHandler=function(L,M,G,ee){var z=M.target,ie=G-M.offsetX,de=ee-M.offsetY,he=!z.get("lockMovementX")&&z.left!==ie,se=!z.get("lockMovementY")&&z.top!==de;return he&&z.set("left",ie),se&&z.set("top",de),(he||se)&&w("moving",j(L,M,G,ee)),he||se},n.scaleOrSkewActionName=function(L,M,G){var ee=L[G.canvas.altActionKey];return M.x===0?ee?"skewX":"scaleY":M.y===0?ee?"skewY":"scaleX":void 0},n.rotationStyleHandler=function(L,M,G){return G.lockRotation?"not-allowed":M.cursorStyle},n.fireEvent=w,n.wrapWithFixedAnchor=Z,n.wrapWithFireEvent=Y,n.getLocalPoint=W,x.controlsUtils=n}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.degreesToRadians,f=x.controlsUtils;f.renderCircleControl=function(n,a,c,A,E){A=A||{};var d,p=this.sizeX||A.cornerSize||E.cornerSize,C=this.sizeY||A.cornerSize||E.cornerSize,y=A.transparentCorners!==void 0?A.transparentCorners:E.transparentCorners,S=y?"stroke":"fill",w=!y&&(A.cornerStrokeColor||E.cornerStrokeColor),b=a,O=c;n.save(),n.fillStyle=A.cornerColor||E.cornerColor,n.strokeStyle=A.cornerStrokeColor||E.cornerStrokeColor,p>C?(d=p,n.scale(1,C/p),O=c*p/C):C>p?(d=C,n.scale(p/C,1),b=a*C/p):d=p,n.lineWidth=1,n.beginPath(),n.arc(b,O,d/2,0,2*Math.PI,!1),n[S](),w&&n.stroke(),n.restore()},f.renderSquareControl=function(n,a,c,A,E){A=A||{};var d=this.sizeX||A.cornerSize||E.cornerSize,p=this.sizeY||A.cornerSize||E.cornerSize,C=A.transparentCorners!==void 0?A.transparentCorners:E.transparentCorners,y=C?"stroke":"fill",S=!C&&(A.cornerStrokeColor||E.cornerStrokeColor),w=d/2,b=p/2;n.save(),n.fillStyle=A.cornerColor||E.cornerColor,n.strokeStyle=A.cornerStrokeColor||E.cornerStrokeColor,n.lineWidth=1,n.translate(a,c),n.rotate(l(E.angle)),n[y+"Rect"](-w,-b,d,p),S&&n.strokeRect(-w,-b,d,p),n.restore()}}(e),function(h){var x=h.fabric||(h.fabric={});x.Control=function(l){for(var f in l)this[f]=l[f]},x.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(l,f){return f.cursorStyle},getActionName:function(l,f){return f.actionName},getVisibility:function(l,f){var n=l._controlsVisibility;return n&&n[f]!==void 0?n[f]:this.visible},setVisibility:function(l){this.visible=l},positionHandler:function(l,f){return x.util.transformPoint({x:this.x*l.x+this.offsetX,y:this.y*l.y+this.offsetY},f)},calcCornerCoords:function(l,f,n,a,c){var A,E,d,p,C=c?this.touchSizeX:this.sizeX,y=c?this.touchSizeY:this.sizeY;if(C&&y&&C!==y){var S=Math.atan2(y,C),w=Math.sqrt(C*C+y*y)/2,b=S-x.util.degreesToRadians(l),O=Math.PI/2-S-x.util.degreesToRadians(l);A=w*x.util.cos(b),E=w*x.util.sin(b),d=w*x.util.cos(O),p=w*x.util.sin(O)}else w=.7071067812*(C&&y?C:f),b=x.util.degreesToRadians(45-l),A=d=w*x.util.cos(b),E=p=w*x.util.sin(b);return{tl:{x:n-p,y:a-d},tr:{x:n+A,y:a-E},bl:{x:n-A,y:a+E},br:{x:n+p,y:a+d}}},render:function(l,f,n,a,c){((a=a||{}).cornerStyle||c.cornerStyle)==="circle"?x.controlsUtils.renderCircleControl.call(this,l,f,n,a,c):x.controlsUtils.renderSquareControl.call(this,l,f,n,a,c)}}}(e),function(){function h(l,f){var n,a,c,A,E=l.getAttribute("style"),d=l.getAttribute("offset")||0;if(d=(d=parseFloat(d)/(/%$/.test(d)?100:1))<0?0:d>1?1:d,E){var p=E.split(/\s*;\s*/);for(p[p.length-1]===""&&p.pop(),A=p.length;A--;){var C=p[A].split(/\s*:\s*/),y=C[0].trim(),S=C[1].trim();y==="stop-color"?n=S:y==="stop-opacity"&&(c=S)}}return n||(n=l.getAttribute("stop-color")||"rgb(0,0,0)"),c||(c=l.getAttribute("stop-opacity")),a=(n=new v.Color(n)).getAlpha(),c=isNaN(parseFloat(c))?1:parseFloat(c),c*=a*f,{offset:d,color:n.toRgb(),opacity:c}}var x=v.util.object.clone;v.Gradient=v.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(l){l||(l={}),l.coords||(l.coords={});var f,n=this;Object.keys(l).forEach(function(a){n[a]=l[a]}),this.id?this.id+="_"+v.Object.__uid++:this.id=v.Object.__uid++,f={x1:l.coords.x1||0,y1:l.coords.y1||0,x2:l.coords.x2||0,y2:l.coords.y2||0},this.type==="radial"&&(f.r1=l.coords.r1||0,f.r2=l.coords.r2||0),this.coords=f,this.colorStops=l.colorStops.slice()},addColorStop:function(l){for(var f in l){var n=new v.Color(l[f]);this.colorStops.push({offset:parseFloat(f),color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(l){var f={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return v.util.populateWithProperties(this,f,l),f},toSVG:function(l,f){var n,a,c,A,E=x(this.coords,!0),d=(f=f||{},x(this.colorStops,!0)),p=E.r1>E.r2,C=this.gradientTransform?this.gradientTransform.concat():v.iMatrix.concat(),y=-this.offsetX,S=-this.offsetY,w=!!f.additionalTransform,b=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(d.sort(function(Z,Y){return Z.offset-Y.offset}),b==="objectBoundingBox"?(y/=l.width,S/=l.height):(y+=l.width/2,S+=l.height/2),l.type==="path"&&this.gradientUnits!=="percentage"&&(y-=l.pathOffset.x,S-=l.pathOffset.y),C[4]-=y,C[5]-=S,A='id="SVGID_'+this.id+'" gradientUnits="'+b+'"',A+=' gradientTransform="'+(w?f.additionalTransform+" ":"")+v.util.matrixToSVG(C)+'" ',this.type==="linear"?c=["<linearGradient ",A,' x1="',E.x1,'" y1="',E.y1,'" x2="',E.x2,'" y2="',E.y2,`">
`]:this.type==="radial"&&(c=["<radialGradient ",A,' cx="',p?E.x1:E.x2,'" cy="',p?E.y1:E.y2,'" r="',p?E.r1:E.r2,'" fx="',p?E.x2:E.x1,'" fy="',p?E.y2:E.y1,`">
`]),this.type==="radial"){if(p)for((d=d.concat()).reverse(),n=0,a=d.length;n<a;n++)d[n].offset=1-d[n].offset;var O=Math.min(E.r1,E.r2);if(O>0){var N=O/Math.max(E.r1,E.r2);for(n=0,a=d.length;n<a;n++)d[n].offset+=N*(1-d[n].offset)}}for(n=0,a=d.length;n<a;n++){var j=d[n];c.push("<stop ",'offset="',100*j.offset+"%",'" style="stop-color:',j.color,j.opacity!==void 0?";stop-opacity: "+j.opacity:";",`"/>
`)}return c.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),c.join("")},toLive:function(l){var f,n,a,c=v.util.object.clone(this.coords);if(this.type){for(this.type==="linear"?f=l.createLinearGradient(c.x1,c.y1,c.x2,c.y2):this.type==="radial"&&(f=l.createRadialGradient(c.x1,c.y1,c.r1,c.x2,c.y2,c.r2)),n=0,a=this.colorStops.length;n<a;n++){var A=this.colorStops[n].color,E=this.colorStops[n].opacity,d=this.colorStops[n].offset;E!==void 0&&(A=new v.Color(A).setAlpha(E).toRgba()),f.addColorStop(d,A)}return f}}}),v.util.object.extend(v.Gradient,{fromElement:function(l,f,n,a){var c=parseFloat(n)/(/%$/.test(n)?100:1);c=c<0?0:c>1?1:c,isNaN(c)&&(c=1);var A,E,d,p,C=l.getElementsByTagName("stop"),y=l.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",S=l.getAttribute("gradientTransform")||"",w=[],b=0,O=0;for(l.nodeName==="linearGradient"||l.nodeName==="LINEARGRADIENT"?(A="linear",E=function(N){return{x1:N.getAttribute("x1")||0,y1:N.getAttribute("y1")||0,x2:N.getAttribute("x2")||"100%",y2:N.getAttribute("y2")||0}}(l)):(A="radial",E=function(N){return{x1:N.getAttribute("fx")||N.getAttribute("cx")||"50%",y1:N.getAttribute("fy")||N.getAttribute("cy")||"50%",r1:0,x2:N.getAttribute("cx")||"50%",y2:N.getAttribute("cy")||"50%",r2:N.getAttribute("r")||"50%"}}(l)),d=C.length;d--;)w.push(h(C[d],c));return p=v.parseTransformAttribute(S),function(N,j,Z,Y){var W,P;Object.keys(j).forEach(function(R){(W=j[R])==="Infinity"?P=1:W==="-Infinity"?P=0:(P=parseFloat(j[R],10),typeof W=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(W)&&(P*=.01,Y==="pixels"&&(R!=="x1"&&R!=="x2"&&R!=="r2"||(P*=Z.viewBoxWidth||Z.width),R!=="y1"&&R!=="y2"||(P*=Z.viewBoxHeight||Z.height)))),j[R]=P})}(0,E,a,y),y==="pixels"&&(b=-f.left,O=-f.top),new v.Gradient({id:l.getAttribute("id"),type:A,coords:E,colorStops:w,gradientUnits:y,gradientTransform:p,offsetX:b,offsetY:O})}})}(),K=v.util.toFixed,v.Pattern=v.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(h,x){if(h||(h={}),this.id=v.Object.__uid++,this.setOptions(h),!h.source||h.source&&typeof h.source!="string")x&&x(this);else{var l=this;this.source=v.util.createImage(),v.util.loadImage(h.source,function(f,n){l.source=f,x&&x(l,n)},null,this.crossOrigin)}},toObject:function(h){var x,l,f=v.Object.NUM_FRACTION_DIGITS;return typeof this.source.src=="string"?x=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(x=this.source.toDataURL()),l={type:"pattern",source:x,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:K(this.offsetX,f),offsetY:K(this.offsetY,f),patternTransform:this.patternTransform?this.patternTransform.concat():null},v.util.populateWithProperties(this,l,h),l},toSVG:function(h){var x=typeof this.source=="function"?this.source():this.source,l=x.width/h.width,f=x.height/h.height,n=this.offsetX/h.width,a=this.offsetY/h.height,c="";return this.repeat!=="repeat-x"&&this.repeat!=="no-repeat"||(f=1,a&&(f+=Math.abs(a))),this.repeat!=="repeat-y"&&this.repeat!=="no-repeat"||(l=1,n&&(l+=Math.abs(n))),x.src?c=x.src:x.toDataURL&&(c=x.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+a+'" width="'+l+'" height="'+f+`">
<image x="0" y="0" width="`+x.width+'" height="'+x.height+'" xlink:href="'+c+`"></image>
</pattern>
`},setOptions:function(h){for(var x in h)this[x]=h[x]},toLive:function(h){var x=this.source;return!x||x.src!==void 0&&(!x.complete||x.naturalWidth===0||x.naturalHeight===0)?"":h.createPattern(x,this.repeat)}}),function(h){var x=h.fabric||(h.fabric={}),l=x.util.toFixed;x.Shadow?x.warn("fabric.Shadow is already defined."):(x.Shadow=x.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(f){for(var n in typeof f=="string"&&(f=this._parseShadow(f)),f)this[n]=f[n];this.id=x.Object.__uid++},_parseShadow:function(f){var n=f.trim(),a=x.Shadow.reOffsetsAndBlur.exec(n)||[];return{color:(n.replace(x.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(a[1],10)||0,offsetY:parseFloat(a[2],10)||0,blur:parseFloat(a[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(f){var n=40,a=40,c=x.Object.NUM_FRACTION_DIGITS,A=x.util.rotateVector({x:this.offsetX,y:this.offsetY},x.util.degreesToRadians(-f.angle)),E=new x.Color(this.color);return f.width&&f.height&&(n=100*l((Math.abs(A.x)+this.blur)/f.width,c)+20,a=100*l((Math.abs(A.y)+this.blur)/f.height,c)+20),f.flipX&&(A.x*=-1),f.flipY&&(A.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+a+'%" height="'+(100+2*a)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+l(this.blur?this.blur/2:0,c)+`"></feGaussianBlur>
	<feOffset dx="`+l(A.x,c)+'" dy="'+l(A.y,c)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+E.toRgb()+'" flood-opacity="'+E.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var f={},n=x.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(a){this[a]!==n[a]&&(f[a]=this[a])},this),f}}),x.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(e),function(){if(v.StaticCanvas)v.warn("fabric.StaticCanvas is already defined.");else{var h=v.util.object.extend,x=v.util.getElementOffset,l=v.util.removeFromArray,f=v.util.toFixed,n=v.util.transformPoint,a=v.util.invertTransform,c=v.util.getNodeCanvas,A=v.util.createCanvasElement,E=new Error("Could not initialize `canvas` element");v.StaticCanvas=v.util.createClass(v.CommonMethods,{initialize:function(d,p){p||(p={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(d,p)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:v.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(d,p){var C=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(d),this._initOptions(p),this.interactive||this._initRetinaScaling(),p.overlayImage&&this.setOverlayImage(p.overlayImage,C),p.backgroundImage&&this.setBackgroundImage(p.backgroundImage,C),p.backgroundColor&&this.setBackgroundColor(p.backgroundColor,C),p.overlayColor&&this.setOverlayColor(p.overlayColor,C),this.calcOffset()},_isRetinaScaling:function(){return v.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,v.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var d=v.devicePixelRatio;this.__initRetinaScaling(d,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(d,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(d,p,C){p.setAttribute("width",this.width*d),p.setAttribute("height",this.height*d),C.scale(d,d)},calcOffset:function(){return this._offset=x(this.lowerCanvasEl),this},setOverlayImage:function(d,p,C){return this.__setBgOverlayImage("overlayImage",d,p,C)},setBackgroundImage:function(d,p,C){return this.__setBgOverlayImage("backgroundImage",d,p,C)},setOverlayColor:function(d,p){return this.__setBgOverlayColor("overlayColor",d,p)},setBackgroundColor:function(d,p){return this.__setBgOverlayColor("backgroundColor",d,p)},__setBgOverlayImage:function(d,p,C,y){return typeof p=="string"?v.util.loadImage(p,function(S,w){if(S){var b=new v.Image(S,y);this[d]=b,b.canvas=this}C&&C(S,w)},this,y&&y.crossOrigin):(y&&p.setOptions(y),this[d]=p,p&&(p.canvas=this),C&&C(p,!1)),this},__setBgOverlayColor:function(d,p,C){return this[d]=p,this._initGradient(p,d),this._initPattern(p,d,C),this},_createCanvasElement:function(){var d=A();if(!d||(d.style||(d.style={}),d.getContext===void 0))throw E;return d},_initOptions:function(d){var p=this.lowerCanvasEl;this._setOptions(d),this.width=this.width||parseInt(p.width,10)||0,this.height=this.height||parseInt(p.height,10)||0,this.lowerCanvasEl.style&&(p.width=this.width,p.height=this.height,p.style.width=this.width+"px",p.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(d){d&&d.getContext?this.lowerCanvasEl=d:this.lowerCanvasEl=v.util.getById(d)||this._createCanvasElement(),v.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(d,p){return this.setDimensions({width:d},p)},setHeight:function(d,p){return this.setDimensions({height:d},p)},setDimensions:function(d,p){var C;for(var y in p=p||{},d)C=d[y],p.cssOnly||(this._setBackstoreDimension(y,d[y]),C+="px",this.hasLostContext=!0),p.backstoreOnly||this._setCssDimension(y,C);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),p.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(d,p){return this.lowerCanvasEl[d]=p,this.upperCanvasEl&&(this.upperCanvasEl[d]=p),this.cacheCanvasEl&&(this.cacheCanvasEl[d]=p),this[d]=p,this},_setCssDimension:function(d,p){return this.lowerCanvasEl.style[d]=p,this.upperCanvasEl&&(this.upperCanvasEl.style[d]=p),this.wrapperEl&&(this.wrapperEl.style[d]=p),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(d){var p,C,y,S=this._activeObject,w=this.backgroundImage,b=this.overlayImage;for(this.viewportTransform=d,C=0,y=this._objects.length;C<y;C++)(p=this._objects[C]).group||p.setCoords(!0);return S&&S.setCoords(),w&&w.setCoords(!0),b&&b.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(d,p){var C=d,y=this.viewportTransform.slice(0);d=n(d,a(this.viewportTransform)),y[0]=p,y[3]=p;var S=n(d,y);return y[4]+=C.x-S.x,y[5]+=C.y-S.y,this.setViewportTransform(y)},setZoom:function(d){return this.zoomToPoint(new v.Point(0,0),d),this},absolutePan:function(d){var p=this.viewportTransform.slice(0);return p[4]=-d.x,p[5]=-d.y,this.setViewportTransform(p)},relativePan:function(d){return this.absolutePan(new v.Point(-d.x-this.viewportTransform[4],-d.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(d){this.stateful&&d.setupState(),d._set("canvas",this),d.setCoords(),this.fire("object:added",{target:d}),d.fire("added")},_onObjectRemoved:function(d){this.fire("object:removed",{target:d}),d.fire("removed"),delete d.canvas},clearContext:function(d){return d.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var d=this.contextContainer;return this.renderCanvas(d,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=v.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var d={},p=this.width,C=this.height,y=a(this.viewportTransform);return d.tl=n({x:0,y:0},y),d.br=n({x:p,y:C},y),d.tr=new v.Point(d.br.x,d.tl.y),d.bl=new v.Point(d.tl.x,d.br.y),this.vptCoords=d,d},cancelRequestedRender:function(){this.isRendering&&(v.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(d,p){var C=this.viewportTransform,y=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(d),v.util.setImageSmoothing(d,this.imageSmoothingEnabled),this.fire("before:render",{ctx:d}),this._renderBackground(d),d.save(),d.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._renderObjects(d,p),d.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(d),y&&(y.canvas=this,y.shouldCache(),y._transformDone=!0,y.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(d)),this._renderOverlay(d),this.controlsAboveOverlay&&this.interactive&&this.drawControls(d),this.fire("after:render",{ctx:d})},drawClipPathOnCanvas:function(d){var p=this.viewportTransform,C=this.clipPath;d.save(),d.transform(p[0],p[1],p[2],p[3],p[4],p[5]),d.globalCompositeOperation="destination-in",C.transform(d),d.scale(1/C.zoomX,1/C.zoomY),d.drawImage(C._cacheCanvas,-C.cacheTranslationX,-C.cacheTranslationY),d.restore()},_renderObjects:function(d,p){var C,y;for(C=0,y=p.length;C<y;++C)p[C]&&p[C].render(d)},_renderBackgroundOrOverlay:function(d,p){var C=this[p+"Color"],y=this[p+"Image"],S=this.viewportTransform,w=this[p+"Vpt"];if(C||y){if(C){d.save(),d.beginPath(),d.moveTo(0,0),d.lineTo(this.width,0),d.lineTo(this.width,this.height),d.lineTo(0,this.height),d.closePath(),d.fillStyle=C.toLive?C.toLive(d,this):C,w&&d.transform(S[0],S[1],S[2],S[3],S[4],S[5]),d.transform(1,0,0,1,C.offsetX||0,C.offsetY||0);var b=C.gradientTransform||C.patternTransform;b&&d.transform(b[0],b[1],b[2],b[3],b[4],b[5]),d.fill(),d.restore()}y&&(d.save(),w&&d.transform(S[0],S[1],S[2],S[3],S[4],S[5]),y.render(d),d.restore())}},_renderBackground:function(d){this._renderBackgroundOrOverlay(d,"background")},_renderOverlay:function(d){this._renderBackgroundOrOverlay(d,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new v.Point(this.width/2,this.height/2)},centerObjectH:function(d){return this._centerObject(d,new v.Point(this.getCenterPoint().x,d.getCenterPoint().y))},centerObjectV:function(d){return this._centerObject(d,new v.Point(d.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(d){var p=this.getCenterPoint();return this._centerObject(d,p)},viewportCenterObject:function(d){var p=this.getVpCenter();return this._centerObject(d,p)},viewportCenterObjectH:function(d){var p=this.getVpCenter();return this._centerObject(d,new v.Point(p.x,d.getCenterPoint().y)),this},viewportCenterObjectV:function(d){var p=this.getVpCenter();return this._centerObject(d,new v.Point(d.getCenterPoint().x,p.y))},getVpCenter:function(){var d=this.getCenterPoint(),p=a(this.viewportTransform);return n(d,p)},_centerObject:function(d,p){return d.setPositionByOrigin(p,"center","center"),d.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(d){return this.toDatalessObject(d)},toObject:function(d){return this._toObjectMethod("toObject",d)},toDatalessObject:function(d){return this._toObjectMethod("toDatalessObject",d)},_toObjectMethod:function(d,p){var C=this.clipPath,y={version:v.version,objects:this._toObjects(d,p)};return C&&!C.excludeFromExport&&(y.clipPath=this._toObject(this.clipPath,d,p)),h(y,this.__serializeBgOverlay(d,p)),v.util.populateWithProperties(this,y,p),y},_toObjects:function(d,p){return this._objects.filter(function(C){return!C.excludeFromExport}).map(function(C){return this._toObject(C,d,p)},this)},_toObject:function(d,p,C){var y;this.includeDefaultValues||(y=d.includeDefaultValues,d.includeDefaultValues=!1);var S=d[p](C);return this.includeDefaultValues||(d.includeDefaultValues=y),S},__serializeBgOverlay:function(d,p){var C={},y=this.backgroundImage,S=this.overlayImage,w=this.backgroundColor,b=this.overlayColor;return w&&w.toObject?w.excludeFromExport||(C.background=w.toObject(p)):w&&(C.background=w),b&&b.toObject?b.excludeFromExport||(C.overlay=b.toObject(p)):b&&(C.overlay=b),y&&!y.excludeFromExport&&(C.backgroundImage=this._toObject(y,d,p)),S&&!S.excludeFromExport&&(C.overlayImage=this._toObject(S,d,p)),C},svgViewportTransformation:!0,toSVG:function(d,p){d||(d={}),d.reviver=p;var C=[];return this._setSVGPreamble(C,d),this._setSVGHeader(C,d),this.clipPath&&C.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(C,"background"),this._setSVGBgOverlayImage(C,"backgroundImage",p),this._setSVGObjects(C,p),this.clipPath&&C.push(`</g>
`),this._setSVGBgOverlayColor(C,"overlay"),this._setSVGBgOverlayImage(C,"overlayImage",p),C.push("</svg>"),C.join("")},_setSVGPreamble:function(d,p){p.suppressPreamble||d.push('<?xml version="1.0" encoding="',p.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(d,p){var C,y=p.width||this.width,S=p.height||this.height,w='viewBox="0 0 '+this.width+" "+this.height+'" ',b=v.Object.NUM_FRACTION_DIGITS;p.viewBox?w='viewBox="'+p.viewBox.x+" "+p.viewBox.y+" "+p.viewBox.width+" "+p.viewBox.height+'" ':this.svgViewportTransformation&&(C=this.viewportTransform,w='viewBox="'+f(-C[4]/C[0],b)+" "+f(-C[5]/C[3],b)+" "+f(this.width/C[0],b)+" "+f(this.height/C[3],b)+'" '),d.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',y,'" ','height="',S,'" ',w,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",v.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(p),`</defs>
`)},createSVGClipPathMarkup:function(d){var p=this.clipPath;return p?(p.clipPathId="CLIPPATH_"+v.Object.__uid++,'<clipPath id="'+p.clipPathId+`" >
`+this.clipPath.toClipPathSVG(d.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var d=this;return["background","overlay"].map(function(p){var C=d[p+"Color"];if(C&&C.toLive){var y=d[p+"Vpt"],S=d.viewportTransform,w={width:d.width/(y?S[0]:1),height:d.height/(y?S[3]:1)};return C.toSVG(w,{additionalTransform:y?v.util.matrixToSVG(S):""})}}).join("")},createSVGFontFacesMarkup:function(){var d,p,C,y,S,w,b,O,N="",j={},Z=v.fontPaths,Y=[];for(this._objects.forEach(function P(R){Y.push(R),R._objects&&R._objects.forEach(P)}),b=0,O=Y.length;b<O;b++)if(p=(d=Y[b]).fontFamily,d.type.indexOf("text")!==-1&&!j[p]&&Z[p]&&(j[p]=!0,d.styles))for(S in C=d.styles)for(w in y=C[S])!j[p=y[w].fontFamily]&&Z[p]&&(j[p]=!0);for(var W in j)N+=[`		@font-face {
`,"			font-family: '",W,`';
`,"			src: url('",Z[W],`');
`,`		}
`].join("");return N&&(N=['	<style type="text/css">',`<![CDATA[
`,N,"]]>",`</style>
`].join("")),N},_setSVGObjects:function(d,p){var C,y,S,w=this._objects;for(y=0,S=w.length;y<S;y++)(C=w[y]).excludeFromExport||this._setSVGObject(d,C,p)},_setSVGObject:function(d,p,C){d.push(p.toSVG(C))},_setSVGBgOverlayImage:function(d,p,C){this[p]&&!this[p].excludeFromExport&&this[p].toSVG&&d.push(this[p].toSVG(C))},_setSVGBgOverlayColor:function(d,p){var C=this[p+"Color"],y=this.viewportTransform,S=this.width,w=this.height;if(C)if(C.toLive){var b=C.repeat,O=v.util.invertTransform(y),N=this[p+"Vpt"]?v.util.matrixToSVG(O):"";d.push('<rect transform="'+N+" translate(",S/2,",",w/2,')"',' x="',C.offsetX-S/2,'" y="',C.offsetY-w/2,'" ','width="',b==="repeat-y"||b==="no-repeat"?C.source.width:S,'" height="',b==="repeat-x"||b==="no-repeat"?C.source.height:w,'" fill="url(#SVGID_'+C.id+')"',`></rect>
`)}else d.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',C,'"',`></rect>
`)},sendToBack:function(d){if(!d)return this;var p,C,y,S=this._activeObject;if(d===S&&d.type==="activeSelection")for(p=(y=S._objects).length;p--;)C=y[p],l(this._objects,C),this._objects.unshift(C);else l(this._objects,d),this._objects.unshift(d);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(d){if(!d)return this;var p,C,y,S=this._activeObject;if(d===S&&d.type==="activeSelection")for(y=S._objects,p=0;p<y.length;p++)C=y[p],l(this._objects,C),this._objects.push(C);else l(this._objects,d),this._objects.push(d);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(d,p){if(!d)return this;var C,y,S,w,b,O=this._activeObject,N=0;if(d===O&&d.type==="activeSelection")for(b=O._objects,C=0;C<b.length;C++)y=b[C],(S=this._objects.indexOf(y))>0+N&&(w=S-1,l(this._objects,y),this._objects.splice(w,0,y)),N++;else(S=this._objects.indexOf(d))!==0&&(w=this._findNewLowerIndex(d,S,p),l(this._objects,d),this._objects.splice(w,0,d));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(d,p,C){var y,S;if(C){for(y=p,S=p-1;S>=0;--S)if(d.intersectsWithObject(this._objects[S])||d.isContainedWithinObject(this._objects[S])||this._objects[S].isContainedWithinObject(d)){y=S;break}}else y=p-1;return y},bringForward:function(d,p){if(!d)return this;var C,y,S,w,b,O=this._activeObject,N=0;if(d===O&&d.type==="activeSelection")for(C=(b=O._objects).length;C--;)y=b[C],(S=this._objects.indexOf(y))<this._objects.length-1-N&&(w=S+1,l(this._objects,y),this._objects.splice(w,0,y)),N++;else(S=this._objects.indexOf(d))!==this._objects.length-1&&(w=this._findNewUpperIndex(d,S,p),l(this._objects,d),this._objects.splice(w,0,d));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(d,p,C){var y,S,w;if(C){for(y=p,S=p+1,w=this._objects.length;S<w;++S)if(d.intersectsWithObject(this._objects[S])||d.isContainedWithinObject(this._objects[S])||this._objects[S].isContainedWithinObject(d)){y=S;break}}else y=p+1;return y},moveTo:function(d,p){return l(this._objects,d),this._objects.splice(p,0,d),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(v.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(d){d.dispose&&d.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),v.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),v.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),h(v.StaticCanvas.prototype,v.Observable),h(v.StaticCanvas.prototype,v.Collection),h(v.StaticCanvas.prototype,v.DataURLExporter),h(v.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(d){var p=A();if(!p||!p.getContext)return null;var C=p.getContext("2d");return C&&d==="setLineDash"?C.setLineDash!==void 0:null}}),v.StaticCanvas.prototype.toJSON=v.StaticCanvas.prototype.toObject,v.isLikelyNode&&(v.StaticCanvas.prototype.createPNGStream=function(){var d=c(this.lowerCanvasEl);return d&&d.createPNGStream()},v.StaticCanvas.prototype.createJPEGStream=function(d){var p=c(this.lowerCanvasEl);return p&&p.createJPEGStream(d)})}}(),v.BaseBrush=v.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(h){h.strokeStyle=this.color,h.lineWidth=this.width,h.lineCap=this.strokeLineCap,h.miterLimit=this.strokeMiterLimit,h.lineJoin=this.strokeLineJoin,h.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(h){var x=this.canvas.viewportTransform;h.save(),h.transform(x[0],x[1],x[2],x[3],x[4],x[5])},_setShadow:function(){if(this.shadow){var h=this.canvas,x=this.shadow,l=h.contextTop,f=h.getZoom();h&&h._isRetinaScaling()&&(f*=v.devicePixelRatio),l.shadowColor=x.color,l.shadowBlur=x.blur*f,l.shadowOffsetX=x.offsetX*f,l.shadowOffsetY=x.offsetY*f}},needsFullRender:function(){return new v.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var h=this.canvas.contextTop;h.shadowColor="",h.shadowBlur=h.shadowOffsetX=h.shadowOffsetY=0},_isOutSideCanvas:function(h){return h.x<0||h.x>this.canvas.getWidth()||h.y<0||h.y>this.canvas.getHeight()}}),v.PencilBrush=v.util.createClass(v.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(h){this.canvas=h,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(h,x,l){var f=x.midPointFrom(l);return h.quadraticCurveTo(x.x,x.y,f.x,f.y),f},onMouseDown:function(h,x){this.canvas._isMainEvent(x.e)&&(this.drawStraightLine=x.e[this.straightLineKey],this._prepareForDrawing(h),this._captureDrawingPath(h),this._render())},onMouseMove:function(h,x){if(this.canvas._isMainEvent(x.e)&&(this.drawStraightLine=x.e[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(h))&&this._captureDrawingPath(h)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var l=this._points,f=l.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,l[f-2],l[f-1],!0),n.stroke(),n.restore()}},onMouseUp:function(h){return!this.canvas._isMainEvent(h.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(h){var x=new v.Point(h.x,h.y);this._reset(),this._addPoint(x),this.canvas.contextTop.moveTo(x.x,x.y)},_addPoint:function(h){return!(this._points.length>1&&h.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(h),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(h){var x=new v.Point(h.x,h.y);return this._addPoint(x)},_render:function(h){var x,l,f=this._points[0],n=this._points[1];if(h=h||this.canvas.contextTop,this._saveAndTransform(h),h.beginPath(),this._points.length===2&&f.x===n.x&&f.y===n.y){var a=this.width/1e3;f=new v.Point(f.x,f.y),n=new v.Point(n.x,n.y),f.x-=a,n.x+=a}for(h.moveTo(f.x,f.y),x=1,l=this._points.length;x<l;x++)this._drawSegment(h,f,n),f=this._points[x],n=this._points[x+1];h.lineTo(f.x,f.y),h.stroke(),h.restore()},convertPointsToSVGPath:function(h){var x=this.width/1e3;return v.util.getSmoothPathFromPoints(h,x)},_isEmptySVGPath:function(h){return v.util.joinPath(h)==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(h){var x=new v.Path(h,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,x.shadow=new v.Shadow(this.shadow)),x},decimatePoints:function(h,x){if(h.length<=2)return h;var l,f=this.canvas.getZoom(),n=Math.pow(x/f,2),a=h.length-1,c=h[0],A=[c];for(l=1;l<a-1;l++)Math.pow(c.x-h[l].x,2)+Math.pow(c.y-h[l].y,2)>=n&&(c=h[l],A.push(c));return A.push(h[a]),A},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var h=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(h))this.canvas.requestRenderAll();else{var x=this.createPath(h);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:x}),this.canvas.add(x),this.canvas.requestRenderAll(),x.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:x})}}}),v.CircleBrush=v.util.createClass(v.BaseBrush,{width:10,initialize:function(h){this.canvas=h,this.points=[]},drawDot:function(h){var x=this.addPoint(h),l=this.canvas.contextTop;this._saveAndTransform(l),this.dot(l,x),l.restore()},dot:function(h,x){h.fillStyle=x.fill,h.beginPath(),h.arc(x.x,x.y,x.radius,0,2*Math.PI,!1),h.closePath(),h.fill()},onMouseDown:function(h){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(h)},_render:function(){var h,x,l=this.canvas.contextTop,f=this.points;for(this._saveAndTransform(l),h=0,x=f.length;h<x;h++)this.dot(l,f[h]);l.restore()},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(h),this._render()):this.drawDot(h))},onMouseUp:function(){var h,x,l=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var f=[];for(h=0,x=this.points.length;h<x;h++){var n=this.points[h],a=new v.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(a.shadow=new v.Shadow(this.shadow)),f.push(a)}var c=new v.Group(f);c.canvas=this.canvas,this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=l,this.canvas.requestRenderAll()},addPoint:function(h){var x=new v.Point(h.x,h.y),l=v.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,f=new v.Color(this.color).setAlpha(v.util.getRandomInt(0,100)/100).toRgba();return x.radius=l,x.fill=f,this.points.push(x),x}}),v.SprayBrush=v.util.createClass(v.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(h){this.canvas=h,this.sprayChunks=[]},onMouseDown:function(h){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(h),this.render(this.sprayChunkPoints)},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.addSprayChunk(h),this.render(this.sprayChunkPoints))},onMouseUp:function(){var h=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var x=[],l=0,f=this.sprayChunks.length;l<f;l++)for(var n=this.sprayChunks[l],a=0,c=n.length;a<c;a++){var A=new v.Rect({width:n[a].width,height:n[a].width,left:n[a].x+1,top:n[a].y+1,originX:"center",originY:"center",fill:this.color});x.push(A)}this.optimizeOverlapping&&(x=this._getOptimizedRects(x));var E=new v.Group(x);this.shadow&&E.set("shadow",new v.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:E}),this.canvas.add(E),this.canvas.fire("path:created",{path:E}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=h,this.canvas.requestRenderAll()},_getOptimizedRects:function(h){var x,l,f,n={};for(l=0,f=h.length;l<f;l++)n[x=h[l].left+""+h[l].top]||(n[x]=h[l]);var a=[];for(x in n)a.push(n[x]);return a},render:function(h){var x,l,f=this.canvas.contextTop;for(f.fillStyle=this.color,this._saveAndTransform(f),x=0,l=h.length;x<l;x++){var n=h[x];n.opacity!==void 0&&(f.globalAlpha=n.opacity),f.fillRect(n.x,n.y,n.width,n.width)}f.restore()},_render:function(){var h,x,l=this.canvas.contextTop;for(l.fillStyle=this.color,this._saveAndTransform(l),h=0,x=this.sprayChunks.length;h<x;h++)this.render(this.sprayChunks[h]);l.restore()},addSprayChunk:function(h){this.sprayChunkPoints=[];var x,l,f,n,a=this.width/2;for(n=0;n<this.density;n++){x=v.util.getRandomInt(h.x-a,h.x+a),l=v.util.getRandomInt(h.y-a,h.y+a),f=this.dotWidthVariance?v.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var c=new v.Point(x,l);c.width=f,this.randomOpacity&&(c.opacity=v.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(c)}this.sprayChunks.push(this.sprayChunkPoints)}}),v.PatternBrush=v.util.createClass(v.PencilBrush,{getPatternSrc:function(){var h=v.util.createCanvasElement(),x=h.getContext("2d");return h.width=h.height=25,x.fillStyle=this.color,x.beginPath(),x.arc(10,10,10,0,2*Math.PI,!1),x.closePath(),x.fill(),h},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(h){return h.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(h){this.callSuper("_setBrushStyles",h),h.strokeStyle=this.getPattern(h)},createPath:function(h){var x=this.callSuper("createPath",h),l=x._getLeftTopCoords().scalarAdd(x.strokeWidth/2);return x.stroke=new v.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-l.x,offsetY:-l.y}),x}}),function(){var h=v.util.getPointer,x=v.util.degreesToRadians,l=v.util.isTouchEvent;for(var f in v.Canvas=v.util.createClass(v.StaticCanvas,{initialize:function(n,a){a||(a={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,a),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=v.PencilBrush&&new v.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n,a,c,A=this.getActiveObjects();if(A.length>0&&!this.preserveObjectStacking){a=[],c=[];for(var E=0,d=this._objects.length;E<d;E++)n=this._objects[E],A.indexOf(n)===-1?a.push(n):c.push(n);A.length>1&&(this._activeObject._objects=c),a.push.apply(a,c)}else a=this._objects;return a},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,a){var c=n.calcTransformMatrix(),A=v.util.invertTransform(c),E=this.restorePointerVpt(a);return v.util.transformPoint(E,A)},isTargetTransparent:function(n,a,c){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var A=this._normalizePointer(n,{x:a,y:c}),E=Math.max(n.cacheTranslationX+A.x*n.zoomX,0),d=Math.max(n.cacheTranslationY+A.y*n.zoomY,0);return v.util.isTransparent(n._cacheContext,Math.round(E),Math.round(d),this.targetFindTolerance)}var p=this.contextCache,C=n.selectionBackgroundColor,y=this.viewportTransform;return n.selectionBackgroundColor="",this.clearContext(p),p.save(),p.transform(y[0],y[1],y[2],y[3],y[4],y[5]),n.render(p),p.restore(),n.selectionBackgroundColor=C,v.util.isTransparent(p,a,c,this.targetFindTolerance)},_isSelectionKeyPressed:function(n){return Array.isArray(this.selectionKey)?!!this.selectionKey.find(function(a){return n[a]===!0}):n[this.selectionKey]},_shouldClearSelection:function(n,a){var c=this.getActiveObjects(),A=this._activeObject;return!a||a&&A&&c.length>1&&c.indexOf(a)===-1&&A!==a&&!this._isSelectionKeyPressed(n)||a&&!a.evented||a&&!a.selectable&&A&&A!==a},_shouldCenterTransform:function(n,a,c){var A;if(n)return a==="scale"||a==="scaleX"||a==="scaleY"||a==="resizing"?A=this.centeredScaling||n.centeredScaling:a==="rotate"&&(A=this.centeredRotation||n.centeredRotation),A?!c:c},_getOriginFromCorner:function(n,a){var c={x:n.originX,y:n.originY};return a==="ml"||a==="tl"||a==="bl"?c.x="right":a!=="mr"&&a!=="tr"&&a!=="br"||(c.x="left"),a==="tl"||a==="mt"||a==="tr"?c.y="bottom":a!=="bl"&&a!=="mb"&&a!=="br"||(c.y="top"),c},_getActionFromCorner:function(n,a,c,A){if(!a||!n)return"drag";var E=A.controls[a];return E.getActionName(c,E,A)},_setupCurrentTransform:function(n,a,c){if(a){var A=this.getPointer(n),E=a.__corner,d=a.controls[E],p=c&&E?d.getActionHandler(n,a,d):v.controlsUtils.dragHandler,C=this._getActionFromCorner(c,E,n,a),y=this._getOriginFromCorner(a,E),S=n[this.centeredKey],w={target:a,action:C,actionHandler:p,corner:E,scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,offsetX:A.x-a.left,offsetY:A.y-a.top,originX:y.x,originY:y.y,ex:A.x,ey:A.y,lastX:A.x,lastY:A.y,theta:x(a.angle),width:a.width*a.scaleX,shiftKey:n.shiftKey,altKey:S,original:v.util.saveObjectTransform(a)};this._shouldCenterTransform(a,C,S)&&(w.originX="center",w.originY="center"),w.original.originX=y.x,w.original.originY=y.y,this._currentTransform=w,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var a=this._groupSelector,c=new v.Point(a.ex,a.ey),A=v.util.transformPoint(c,this.viewportTransform),E=new v.Point(a.ex+a.left,a.ey+a.top),d=v.util.transformPoint(E,this.viewportTransform),p=Math.min(A.x,d.x),C=Math.min(A.y,d.y),y=Math.max(A.x,d.x),S=Math.max(A.y,d.y),w=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(p,C,y-p,S-C)),this.selectionLineWidth&&this.selectionBorderColor&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,p+=w,C+=w,y-=w,S-=w,v.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(p,C,y-p,S-C))},findTarget:function(n,a){if(!this.skipTargetFind){var c,A,E=this.getPointer(n,!0),d=this._activeObject,p=this.getActiveObjects(),C=l(n),y=p.length>1&&!a||p.length===1;if(this.targets=[],y&&d._findTargetCorner(E,C)||p.length>1&&!a&&d===this._searchPossibleTargets([d],E))return d;if(p.length===1&&d===this._searchPossibleTargets([d],E)){if(!this.preserveObjectStacking)return d;c=d,A=this.targets,this.targets=[]}var S=this._searchPossibleTargets(this._objects,E);return n[this.altSelectionKey]&&S&&c&&S!==c&&(S=c,this.targets=A),S}},_checkTarget:function(n,a,c){if(a&&a.visible&&a.evented&&a.containsPoint(n)&&(!this.perPixelTargetFind&&!a.perPixelTargetFind||a.isEditing||!this.isTargetTransparent(a,c.x,c.y)))return!0},_searchPossibleTargets:function(n,a){for(var c,A,E=n.length;E--;){var d=n[E],p=d.group?this._normalizePointer(d.group,a):a;if(this._checkTarget(p,d,a)){(c=n[E]).subTargetCheck&&c instanceof v.Group&&(A=this._searchPossibleTargets(c._objects,a))&&this.targets.push(A);break}}return c},restorePointerVpt:function(n){return v.util.transformPoint(n,v.util.invertTransform(this.viewportTransform))},getPointer:function(n,a){if(this._absolutePointer&&!a)return this._absolutePointer;if(this._pointer&&a)return this._pointer;var c,A=h(n),E=this.upperCanvasEl,d=E.getBoundingClientRect(),p=d.width||0,C=d.height||0;p&&C||("top"in d&&"bottom"in d&&(C=Math.abs(d.top-d.bottom)),"right"in d&&"left"in d&&(p=Math.abs(d.right-d.left))),this.calcOffset(),A.x=A.x-this._offset.left,A.y=A.y-this._offset.top,a||(A=this.restorePointerVpt(A));var y=this.getRetinaScaling();return y!==1&&(A.x/=y,A.y/=y),c=p===0||C===0?{width:1,height:1}:{width:E.width/p,height:E.height/C},{x:A.x*c.width,y:A.y*c.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),a=this.lowerCanvasEl,c=this.upperCanvasEl;c?c.className="":(c=this._createCanvasElement(),this.upperCanvasEl=c),v.util.addClass(c,"upper-canvas "+n),this.wrapperEl.appendChild(c),this._copyCanvasStyle(a,c),this._applyCanvasStyle(c),this.contextTop=c.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=v.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),v.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),v.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var a=this.width||n.width,c=this.height||n.height;v.util.setStyle(n,{position:"absolute",width:a+"px",height:c+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=a,n.height=c,v.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,a){a.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,a){var c=!1,A=this.getActiveObjects(),E=[],d=[];n.forEach(function(p){A.indexOf(p)===-1&&(c=!0,p.fire("deselected",{e:a,target:p}),d.push(p))}),A.forEach(function(p){n.indexOf(p)===-1&&(c=!0,p.fire("selected",{e:a,target:p}),E.push(p))}),n.length>0&&A.length>0?c&&this.fire("selection:updated",{e:a,selected:E,deselected:d}):A.length>0?this.fire("selection:created",{e:a,selected:E}):n.length>0&&this.fire("selection:cleared",{e:a,deselected:d})},setActiveObject:function(n,a){var c=this.getActiveObjects();return this._setActiveObject(n,a),this._fireSelectionEvents(c,a),this},_setActiveObject:function(n,a){return this._activeObject!==n&&!!this._discardActiveObject(a,n)&&!n.onSelect({e:a})&&(this._activeObject=n,!0)},_discardActiveObject:function(n,a){var c=this._activeObject;if(c){if(c.onDeselect({e:n,object:a}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var a=this.getActiveObjects(),c=this.getActiveObject();return a.length&&this.fire("before:selection:cleared",{target:c,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(a,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(a){v.util.cleanUpJsdomNode(this[a]),this[a]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,v.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var a=this._activeObject;a&&a._renderControls(n)},_toObject:function(n,a,c){var A=this._realizeGroupTransformOnObject(n),E=this.callSuper("_toObject",n,a,c);return this._unwindGroupTransformOnObject(n,A),E},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var a={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(c){a[c]=n[c]}),v.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),a}return null},_unwindGroupTransformOnObject:function(n,a){a&&n.set(a)},_setSVGObject:function(n,a,c){var A=this._realizeGroupTransformOnObject(a);this.callSuper("_setSVGObject",n,a,c),this._unwindGroupTransformOnObject(a,A)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),v.StaticCanvas.prototype.setViewportTransform.call(this,n)}}),v.StaticCanvas)f!=="prototype"&&(v.Canvas[f]=v.StaticCanvas[f])}(),function(){var h=v.util.addListener,x=v.util.removeListener,l={passive:!1};function f(n,a){return n.button&&n.button===a-1}v.util.object.extend(v.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(h,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(n,a){var c=this.upperCanvasEl,A=this._getEventPrefix();n(v.window,"resize",this._onResize),n(c,A+"down",this._onMouseDown),n(c,A+"move",this._onMouseMove,l),n(c,A+"out",this._onMouseOut),n(c,A+"enter",this._onMouseEnter),n(c,"wheel",this._onMouseWheel),n(c,"contextmenu",this._onContextMenu),n(c,"dblclick",this._onDoubleClick),n(c,"dragover",this._onDragOver),n(c,"dragenter",this._onDragEnter),n(c,"dragleave",this._onDragLeave),n(c,"drop",this._onDrop),this.enablePointerEvents||n(c,"touchstart",this._onTouchStart,l),typeof eventjs!="undefined"&&a in eventjs&&(eventjs[a](c,"gesture",this._onGesture),eventjs[a](c,"drag",this._onDrag),eventjs[a](c,"orientation",this._onOrientationChange),eventjs[a](c,"shake",this._onShake),eventjs[a](c,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(x,"remove");var n=this._getEventPrefix();x(v.document,n+"up",this._onMouseUp),x(v.document,"touchend",this._onTouchEnd,l),x(v.document,n+"move",this._onMouseMove,l),x(v.document,"touchmove",this._onMouseMove,l)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(n,a){this.__onTransformGesture&&this.__onTransformGesture(n,a)},_onDrag:function(n,a){this.__onDrag&&this.__onDrag(n,a)},_onMouseWheel:function(n){this.__onMouseWheel(n)},_onMouseOut:function(n){var a=this._hoveredTarget;this.fire("mouse:out",{target:a,e:n}),this._hoveredTarget=null,a&&a.fire("mouseout",{e:n});var c=this;this._hoveredTargets.forEach(function(A){c.fire("mouse:out",{target:a,e:n}),A&&a.fire("mouseout",{e:n})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(A){A.isEditing&&A.hiddenTextarea.focus()})},_onMouseEnter:function(n){this._currentTransform||this.findTarget(n)||(this.fire("mouse:over",{target:null,e:n}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(n,a){this.__onOrientationChange&&this.__onOrientationChange(n,a)},_onShake:function(n,a){this.__onShake&&this.__onShake(n,a)},_onLongPress:function(n,a){this.__onLongPress&&this.__onLongPress(n,a)},_onDragOver:function(n){n.preventDefault();var a=this._simpleEventHandler("dragover",n);this._fireEnterLeaveEvents(a,n)},_onDrop:function(n){return this._simpleEventHandler("drop:before",n),this._simpleEventHandler("drop",n)},_onContextMenu:function(n){return this.stopContextMenu&&(n.stopPropagation(),n.preventDefault()),!1},_onDoubleClick:function(n){this._cacheTransformEventData(n),this._handleEvent(n,"dblclick"),this._resetTransformEventData(n)},getPointerId:function(n){var a=n.changedTouches;return a?a[0]&&a[0].identifier:this.enablePointerEvents?n.pointerId:-1},_isMainEvent:function(n){return n.isPrimary===!0||n.isPrimary!==!1&&(n.type==="touchend"&&n.touches.length===0||!n.changedTouches||n.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(n){n.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(n)),this.__onMouseDown(n),this._resetTransformEventData();var a=this.upperCanvasEl,c=this._getEventPrefix();h(v.document,"touchend",this._onTouchEnd,l),h(v.document,"touchmove",this._onMouseMove,l),x(a,c+"down",this._onMouseDown)},_onMouseDown:function(n){this.__onMouseDown(n),this._resetTransformEventData();var a=this.upperCanvasEl,c=this._getEventPrefix();x(a,c+"move",this._onMouseMove,l),h(v.document,c+"up",this._onMouseUp),h(v.document,c+"move",this._onMouseMove,l)},_onTouchEnd:function(n){if(!(n.touches.length>0)){this.__onMouseUp(n),this._resetTransformEventData(),this.mainTouchId=null;var a=this._getEventPrefix();x(v.document,"touchend",this._onTouchEnd,l),x(v.document,"touchmove",this._onMouseMove,l);var c=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){h(c.upperCanvasEl,a+"down",c._onMouseDown),c._willAddMouseDown=0},400)}},_onMouseUp:function(n){this.__onMouseUp(n),this._resetTransformEventData();var a=this.upperCanvasEl,c=this._getEventPrefix();this._isMainEvent(n)&&(x(v.document,c+"up",this._onMouseUp),x(v.document,c+"move",this._onMouseMove,l),h(a,c+"move",this._onMouseMove,l))},_onMouseMove:function(n){!this.allowTouchScrolling&&n.preventDefault&&n.preventDefault(),this.__onMouseMove(n)},_onResize:function(){this.calcOffset()},_shouldRender:function(n){var a=this._activeObject;return!!(!!a!=!!n||a&&n&&a!==n)||(a&&a.isEditing,!1)},__onMouseUp:function(n){var a,c=this._currentTransform,A=this._groupSelector,E=!1,d=!A||A.left===0&&A.top===0;if(this._cacheTransformEventData(n),a=this._target,this._handleEvent(n,"up:before"),f(n,3))this.fireRightClick&&this._handleEvent(n,"up",3,d);else{if(f(n,2))return this.fireMiddleClick&&this._handleEvent(n,"up",2,d),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(n);else if(this._isMainEvent(n)){if(c&&(this._finalizeCurrentTransform(n),E=c.actionPerformed),!d){var p=a===this._activeObject;this._maybeGroupObjects(n),E||(E=this._shouldRender(a)||!p&&a===this._activeObject)}var C,y;if(a){if(C=a._findTargetCorner(this.getPointer(n,!0),v.util.isTouchEvent(n)),a.selectable&&a!==this._activeObject&&a.activeOn==="up")this.setActiveObject(a,n),E=!0;else{var S=a.controls[C],w=S&&S.getMouseUpHandler(n,a,S);w&&w(n,c,(y=this.getPointer(n)).x,y.y)}a.isMoving=!1}if(c&&(c.target!==a||c.corner!==C)){var b=c.target&&c.target.controls[c.corner],O=b&&b.getMouseUpHandler(n,a,S);y=y||this.getPointer(n),O&&O(n,c,y.x,y.y)}this._setCursorFromEvent(n,a),this._handleEvent(n,"up",1,d),this._groupSelector=null,this._currentTransform=null,a&&(a.__corner=0),E?this.requestRenderAll():d||this.renderTop()}}},_simpleEventHandler:function(n,a){var c=this.findTarget(a),A=this.targets,E={e:a,target:c,subTargets:A};if(this.fire(n,E),c&&c.fire(n,E),!A)return c;for(var d=0;d<A.length;d++)A[d].fire(n,E);return c},_handleEvent:function(n,a,c,A){var E=this._target,d=this.targets||[],p={e:n,target:E,subTargets:d,button:c||1,isClick:A||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};a==="up"&&(p.currentTarget=this.findTarget(n),p.currentSubTargets=this.targets),this.fire("mouse:"+a,p),E&&E.fire("mouse"+a,p);for(var C=0;C<d.length;C++)d[C].fire("mouse"+a,p)},_finalizeCurrentTransform:function(n){var a=this._currentTransform,c=a.target,A={e:n,target:c,transform:a,action:a.action};c._scaling&&(c._scaling=!1),c.setCoords(),(a.actionPerformed||this.stateful&&c.hasStateChanged())&&this._fire("modified",A)},_onMouseDownInDrawingMode:function(n){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(n).requestRenderAll();var a=this.getPointer(n);this.freeDrawingBrush.onMouseDown(a,{e:n,pointer:a}),this._handleEvent(n,"down")},_onMouseMoveInDrawingMode:function(n){if(this._isCurrentlyDrawing){var a=this.getPointer(n);this.freeDrawingBrush.onMouseMove(a,{e:n,pointer:a})}this.setCursor(this.freeDrawingCursor),this._handleEvent(n,"move")},_onMouseUpInDrawingMode:function(n){var a=this.getPointer(n);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:n,pointer:a}),this._handleEvent(n,"up")},__onMouseDown:function(n){this._cacheTransformEventData(n),this._handleEvent(n,"down:before");var a=this._target;if(f(n,3))this.fireRightClick&&this._handleEvent(n,"down",3);else if(f(n,2))this.fireMiddleClick&&this._handleEvent(n,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(n);else if(this._isMainEvent(n)&&!this._currentTransform){var c=this._pointer;this._previousPointer=c;var A=this._shouldRender(a),E=this._shouldGroup(n,a);if(this._shouldClearSelection(n,a)?this.discardActiveObject(n):E&&(this._handleGrouping(n,a),a=this._activeObject),!this.selection||a&&(a.selectable||a.isEditing||a===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),a){var d=a===this._activeObject;a.selectable&&a.activeOn==="down"&&this.setActiveObject(a,n);var p=a._findTargetCorner(this.getPointer(n,!0),v.util.isTouchEvent(n));if(a.__corner=p,a===this._activeObject&&(p||!E)){this._setupCurrentTransform(n,a,d);var C=a.controls[p],y=(c=this.getPointer(n),C&&C.getMouseDownHandler(n,a,C));y&&y(n,this._currentTransform,c.x,c.y)}}this._handleEvent(n,"down"),(A||E)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(n){this._resetTransformEventData(),this._pointer=this.getPointer(n,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(n)||null},_beforeTransform:function(n){var a=this._currentTransform;this.stateful&&a.target.saveState(),this.fire("before:transform",{e:n,transform:a})},__onMouseMove:function(n){var a,c;if(this._handleEvent(n,"move:before"),this._cacheTransformEventData(n),this.isDrawingMode)this._onMouseMoveInDrawingMode(n);else if(this._isMainEvent(n)){var A=this._groupSelector;A?(c=this._absolutePointer,A.left=c.x-A.ex,A.top=c.y-A.ey,this.renderTop()):this._currentTransform?this._transformObject(n):(a=this.findTarget(n)||null,this._setCursorFromEvent(n,a),this._fireOverOutEvents(a,n)),this._handleEvent(n,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(n,a){var c=this._hoveredTarget,A=this._hoveredTargets,E=this.targets,d=Math.max(A.length,E.length);this.fireSyntheticInOutEvents(n,a,{oldTarget:c,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var p=0;p<d;p++)this.fireSyntheticInOutEvents(E[p],a,{oldTarget:A[p],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(n,a){var c=this._draggedoverTarget,A=this._hoveredTargets,E=this.targets,d=Math.max(A.length,E.length);this.fireSyntheticInOutEvents(n,a,{oldTarget:c,evtOut:"dragleave",evtIn:"dragenter"});for(var p=0;p<d;p++)this.fireSyntheticInOutEvents(E[p],a,{oldTarget:A[p],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=n},fireSyntheticInOutEvents:function(n,a,c){var A,E,d,p=c.oldTarget,C=p!==n,y=c.canvasEvtIn,S=c.canvasEvtOut;C&&(A={e:a,target:n,previousTarget:p},E={e:a,target:p,nextTarget:n}),d=n&&C,p&&C&&(S&&this.fire(S,E),p.fire(c.evtOut,E)),d&&(y&&this.fire(y,A),n.fire(c.evtIn,A))},__onMouseWheel:function(n){this._cacheTransformEventData(n),this._handleEvent(n,"wheel"),this._resetTransformEventData()},_transformObject:function(n){var a=this.getPointer(n),c=this._currentTransform;c.reset=!1,c.shiftKey=n.shiftKey,c.altKey=n[this.centeredKey],this._performTransformAction(n,c,a),c.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(n,a,c){var A=c.x,E=c.y,d=a.action,p=!1,C=a.actionHandler;C&&(p=C(n,a,A,E)),d==="drag"&&p&&(a.target.isMoving=!0,this.setCursor(a.target.moveCursor||this.moveCursor)),a.actionPerformed=a.actionPerformed||p},_fire:v.controlsUtils.fireEvent,_setCursorFromEvent:function(n,a){if(!a)return this.setCursor(this.defaultCursor),!1;var c=a.hoverCursor||this.hoverCursor,A=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,E=(!A||!A.contains(a))&&a._findTargetCorner(this.getPointer(n,!0));E?this.setCursor(this.getCornerCursor(E,a,n)):(a.subTargetCheck&&this.targets.concat().reverse().map(function(d){c=d.hoverCursor||c}),this.setCursor(c))},getCornerCursor:function(n,a,c){var A=a.controls[n];return A.cursorStyleHandler(c,A,a)}})}(),X=Math.min,te=Math.max,v.util.object.extend(v.Canvas.prototype,{_shouldGroup:function(h,x){var l=this._activeObject;return l&&this._isSelectionKeyPressed(h)&&x&&x.selectable&&this.selection&&(l!==x||l.type==="activeSelection")&&!x.onSelect({e:h})},_handleGrouping:function(h,x){var l=this._activeObject;l.__corner||(x!==l||(x=this.findTarget(h,!0))&&x.selectable)&&(l&&l.type==="activeSelection"?this._updateActiveSelection(x,h):this._createActiveSelection(x,h))},_updateActiveSelection:function(h,x){var l=this._activeObject,f=l._objects.slice(0);l.contains(h)?(l.removeWithUpdate(h),this._hoveredTarget=h,this._hoveredTargets=this.targets.concat(),l.size()===1&&this._setActiveObject(l.item(0),x)):(l.addWithUpdate(h),this._hoveredTarget=l,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(f,x)},_createActiveSelection:function(h,x){var l=this.getActiveObjects(),f=this._createGroup(h);this._hoveredTarget=f,this._setActiveObject(f,x),this._fireSelectionEvents(l,x)},_createGroup:function(h){var x=this._objects,l=x.indexOf(this._activeObject)<x.indexOf(h)?[this._activeObject,h]:[h,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new v.ActiveSelection(l,{canvas:this})},_groupSelectedObjects:function(h){var x,l=this._collectObjects(h);l.length===1?this.setActiveObject(l[0],h):l.length>1&&(x=new v.ActiveSelection(l.reverse(),{canvas:this}),this.setActiveObject(x,h))},_collectObjects:function(h){for(var x,l=[],f=this._groupSelector.ex,n=this._groupSelector.ey,a=f+this._groupSelector.left,c=n+this._groupSelector.top,A=new v.Point(X(f,a),X(n,c)),E=new v.Point(te(f,a),te(n,c)),d=!this.selectionFullyContained,p=f===a&&n===c,C=this._objects.length;C--&&!((x=this._objects[C])&&x.selectable&&x.visible&&(d&&x.intersectsWithRect(A,E,!0)||x.isContainedWithinRect(A,E,!0)||d&&x.containsPoint(A,null,!0)||d&&x.containsPoint(E,null,!0))&&(l.push(x),p)););return l.length>1&&(l=l.filter(function(y){return!y.onSelect({e:h})})),l},_maybeGroupObjects:function(h){this.selection&&this._groupSelector&&this._groupSelectedObjects(h),this.setCursor(this.defaultCursor),this._groupSelector=null}}),v.util.object.extend(v.StaticCanvas.prototype,{toDataURL:function(h){h||(h={});var x=h.format||"png",l=h.quality||1,f=(h.multiplier||1)*(h.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(f,h);return v.util.toDataURL(n,x,l)},toCanvasElement:function(h,x){h=h||1;var l=((x=x||{}).width||this.width)*h,f=(x.height||this.height)*h,n=this.getZoom(),a=this.width,c=this.height,A=n*h,E=this.viewportTransform,d=(E[4]-(x.left||0))*h,p=(E[5]-(x.top||0))*h,C=this.interactive,y=[A,0,0,A,d,p],S=this.enableRetinaScaling,w=v.util.createCanvasElement(),b=this.contextTop;return w.width=l,w.height=f,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=y,this.width=l,this.height=f,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),this._objects),this.viewportTransform=E,this.width=a,this.height=c,this.calcViewportBoundaries(),this.interactive=C,this.enableRetinaScaling=S,this.contextTop=b,w}}),v.util.object.extend(v.StaticCanvas.prototype,{loadFromJSON:function(h,x,l){if(h){var f=typeof h=="string"?JSON.parse(h):v.util.object.clone(h),n=this,a=f.clipPath,c=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete f.clipPath,this._enlivenObjects(f.objects,function(A){n.clear(),n._setBgOverlay(f,function(){a?n._enlivenObjects([a],function(E){n.clipPath=E[0],n.__setupCanvas.call(n,f,A,c,x)}):n.__setupCanvas.call(n,f,A,c,x)})},l),this}},__setupCanvas:function(h,x,l,f){var n=this;x.forEach(function(a,c){n.insertAt(a,c)}),this.renderOnAddRemove=l,delete h.objects,delete h.backgroundImage,delete h.overlayImage,delete h.background,delete h.overlay,this._setOptions(h),this.renderAll(),f&&f()},_setBgOverlay:function(h,x){var l={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(h.backgroundImage||h.overlayImage||h.background||h.overlay){var f=function(){l.backgroundImage&&l.overlayImage&&l.backgroundColor&&l.overlayColor&&x&&x()};this.__setBgOverlay("backgroundImage",h.backgroundImage,l,f),this.__setBgOverlay("overlayImage",h.overlayImage,l,f),this.__setBgOverlay("backgroundColor",h.background,l,f),this.__setBgOverlay("overlayColor",h.overlay,l,f)}else x&&x()},__setBgOverlay:function(h,x,l,f){var n=this;if(!x)return l[h]=!0,void(f&&f());h==="backgroundImage"||h==="overlayImage"?v.util.enlivenObjects([x],function(a){n[h]=a[0],l[h]=!0,f&&f()}):this["set"+v.util.string.capitalize(h,!0)](x,function(){l[h]=!0,f&&f()})},_enlivenObjects:function(h,x,l){h&&h.length!==0?v.util.enlivenObjects(h,function(f){x&&x(f)},null,l):x&&x([])},_toDataURL:function(h,x){this.clone(function(l){x(l.toDataURL(h))})},_toDataURLWithMultiplier:function(h,x,l){this.clone(function(f){l(f.toDataURLWithMultiplier(h,x))})},clone:function(h,x){var l=JSON.stringify(this.toJSON(x));this.cloneWithoutData(function(f){f.loadFromJSON(l,function(){h&&h(f)})})},cloneWithoutData:function(h){var x=v.util.createCanvasElement();x.width=this.width,x.height=this.height;var l=new v.Canvas(x);this.backgroundImage?(l.setBackgroundImage(this.backgroundImage.src,function(){l.renderAll(),h&&h(l)}),l.backgroundImageOpacity=this.backgroundImageOpacity,l.backgroundImageStretch=this.backgroundImageStretch):h&&h(l)}}),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.util.object.clone,n=x.util.toFixed,a=x.util.string.capitalize,c=x.util.degreesToRadians,A=!x.isLikelyNode;x.Object||(x.Object=x.util.createClass(x.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:A,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(E){E&&this.setOptions(E)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=x.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(E){var d=x.perfLimitSizeTotal,p=E.width,C=E.height,y=x.maxCacheSideLimit,S=x.minCacheSideLimit;if(p<=y&&C<=y&&p*C<=d)return p<S&&(E.width=S),C<S&&(E.height=S),E;var w=p/C,b=x.util.limitDimsByArea(w,d),O=x.util.capValue,N=O(S,b.x,y),j=O(S,b.y,y);return p>N&&(E.zoomX/=p/N,E.width=N,E.capped=!0),C>j&&(E.zoomY/=C/j,E.height=j,E.capped=!0),E},_getCacheCanvasDimensions:function(){var E=this.getTotalObjectScaling(),d=this._getTransformedDimensions(0,0),p=d.x*E.scaleX/this.scaleX,C=d.y*E.scaleY/this.scaleY;return{width:p+2,height:C+2,zoomX:E.scaleX,zoomY:E.scaleY,x:p,y:C}},_updateCacheCanvas:function(){var E=this.canvas;if(this.noScaleCache&&E&&E._currentTransform){var d=E._currentTransform.target,p=E._currentTransform.action;if(this===d&&p.slice&&p.slice(0,5)==="scale")return!1}var C,y,S=this._cacheCanvas,w=this._limitCacheSize(this._getCacheCanvasDimensions()),b=x.minCacheSideLimit,O=w.width,N=w.height,j=w.zoomX,Z=w.zoomY,Y=O!==this.cacheWidth||N!==this.cacheHeight,W=this.zoomX!==j||this.zoomY!==Z,P=Y||W,R=0,V=0,J=!1;if(Y){var q=this._cacheCanvas.width,L=this._cacheCanvas.height,M=O>q||N>L;J=M||(O<.9*q||N<.9*L)&&q>b&&L>b,M&&!w.capped&&(O>b||N>b)&&(R=.1*O,V=.1*N)}return this instanceof x.Text&&this.path&&(P=!0,J=!0,R+=this.getHeightOfLine(0)*this.zoomX,V+=this.getHeightOfLine(0)*this.zoomY),!!P&&(J?(S.width=Math.ceil(O+R),S.height=Math.ceil(N+V)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,S.width,S.height)),C=w.x/2,y=w.y/2,this.cacheTranslationX=Math.round(S.width/2-C)+C,this.cacheTranslationY=Math.round(S.height/2-y)+y,this.cacheWidth=O,this.cacheHeight=N,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(j,Z),this.zoomX=j,this.zoomY=Z,!0)},setOptions:function(E){this._setOptions(E),this._initGradient(E.fill,"fill"),this._initGradient(E.stroke,"stroke"),this._initPattern(E.fill,"fill"),this._initPattern(E.stroke,"stroke")},transform:function(E){var d=this.group&&!this.group._transformDone||this.group&&this.canvas&&E===this.canvas.contextTop,p=this.calcTransformMatrix(!d);E.transform(p[0],p[1],p[2],p[3],p[4],p[5])},toObject:function(E){var d=x.Object.NUM_FRACTION_DIGITS,p={type:this.type,version:x.version,originX:this.originX,originY:this.originY,left:n(this.left,d),top:n(this.top,d),width:n(this.width,d),height:n(this.height,d),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,d),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,d),scaleX:n(this.scaleX,d),scaleY:n(this.scaleY,d),angle:n(this.angle,d),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,d),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,d),skewY:n(this.skewY,d)};return this.clipPath&&!this.clipPath.excludeFromExport&&(p.clipPath=this.clipPath.toObject(E),p.clipPath.inverted=this.clipPath.inverted,p.clipPath.absolutePositioned=this.clipPath.absolutePositioned),x.util.populateWithProperties(this,p,E),this.includeDefaultValues||(p=this._removeDefaultValues(p)),p},toDatalessObject:function(E){return this.toObject(E)},_removeDefaultValues:function(E){var d=x.util.getKlass(E.type).prototype;return d.stateProperties.forEach(function(p){p!=="left"&&p!=="top"&&(E[p]===d[p]&&delete E[p],Array.isArray(E[p])&&Array.isArray(d[p])&&E[p].length===0&&d[p].length===0&&delete E[p])}),E},toString:function(){return"#<fabric."+a(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var E=x.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(E.scaleX),scaleY:Math.abs(E.scaleY)}},getTotalObjectScaling:function(){var E=this.getObjectScaling(),d=E.scaleX,p=E.scaleY;if(this.canvas){var C=this.canvas.getZoom(),y=this.canvas.getRetinaScaling();d*=C*y,p*=C*y}return{scaleX:d,scaleY:p}},getObjectOpacity:function(){var E=this.opacity;return this.group&&(E*=this.group.getObjectOpacity()),E},_set:function(E,d){var p=E==="scaleX"||E==="scaleY",C=this[E]!==d,y=!1;return p&&(d=this._constrainScale(d)),E==="scaleX"&&d<0?(this.flipX=!this.flipX,d*=-1):E==="scaleY"&&d<0?(this.flipY=!this.flipY,d*=-1):E!=="shadow"||!d||d instanceof x.Shadow?E==="dirty"&&this.group&&this.group.set("dirty",d):d=new x.Shadow(d),this[E]=d,C&&(y=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(E)>-1?(this.dirty=!0,y&&this.group.set("dirty",!0)):y&&this.stateProperties.indexOf(E)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:x.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(E){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(E.save(),this._setupCompositeOperation(E),this.drawSelectionBackground(E),this.transform(E),this._setOpacity(E),this._setShadow(E,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(E)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(E),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),E.restore())},renderCache:function(E){E=E||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,E.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!(this.paintFirst!=="stroke"||!this.hasFill()||!this.hasStroke()||typeof this.shadow!="object")||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(E,d){if(E.save(),d.inverted?E.globalCompositeOperation="destination-out":E.globalCompositeOperation="destination-in",d.absolutePositioned){var p=x.util.invertTransform(this.calcTransformMatrix());E.transform(p[0],p[1],p[2],p[3],p[4],p[5])}d.transform(E),E.scale(1/d.zoomX,1/d.zoomY),E.drawImage(d._cacheCanvas,-d.cacheTranslationX,-d.cacheTranslationY),E.restore()},drawObject:function(E,d){var p=this.fill,C=this.stroke;d?(this.fill="black",this.stroke="",this._setClippingProperties(E)):this._renderBackground(E),this._render(E),this._drawClipPath(E,this.clipPath),this.fill=p,this.stroke=C},_drawClipPath:function(E,d){d&&(d.canvas=this.canvas,d.shouldCache(),d._transformDone=!0,d.renderCache({forClipping:!0}),this.drawClipPathOnCache(E,d))},drawCacheOnCanvas:function(E){E.scale(1/this.zoomX,1/this.zoomY),E.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(E){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!E&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!E){var d=this.cacheWidth/this.zoomX,p=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-d/2,-p/2,d,p)}return!0}return!1},_renderBackground:function(E){if(this.backgroundColor){var d=this._getNonTransformedDimensions();E.fillStyle=this.backgroundColor,E.fillRect(-d.x/2,-d.y/2,d.x,d.y),this._removeShadow(E)}},_setOpacity:function(E){this.group&&!this.group._transformDone?E.globalAlpha=this.getObjectOpacity():E.globalAlpha*=this.opacity},_setStrokeStyles:function(E,d){var p=d.stroke;p&&(E.lineWidth=d.strokeWidth,E.lineCap=d.strokeLineCap,E.lineDashOffset=d.strokeDashOffset,E.lineJoin=d.strokeLineJoin,E.miterLimit=d.strokeMiterLimit,p.toLive?p.gradientUnits==="percentage"||p.gradientTransform||p.patternTransform?this._applyPatternForTransformedGradient(E,p):(E.strokeStyle=p.toLive(E,this),this._applyPatternGradientTransform(E,p)):E.strokeStyle=d.stroke)},_setFillStyles:function(E,d){var p=d.fill;p&&(p.toLive?(E.fillStyle=p.toLive(E,this),this._applyPatternGradientTransform(E,d.fill)):E.fillStyle=p)},_setClippingProperties:function(E){E.globalAlpha=1,E.strokeStyle="transparent",E.fillStyle="#000000"},_setLineDash:function(E,d){d&&d.length!==0&&(1&d.length&&d.push.apply(d,d),E.setLineDash(d))},_renderControls:function(E,d){var p,C,y,S=this.getViewportTransform(),w=this.calcTransformMatrix();C=(d=d||{}).hasBorders!==void 0?d.hasBorders:this.hasBorders,y=d.hasControls!==void 0?d.hasControls:this.hasControls,w=x.util.multiplyTransformMatrices(S,w),p=x.util.qrDecompose(w),E.save(),E.translate(p.translateX,p.translateY),E.lineWidth=1*this.borderScaleFactor,this.group||(E.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(p.angle-=180),E.rotate(c(this.group?p.angle:this.angle)),d.forActiveSelection||this.group?C&&this.drawBordersInGroup(E,p,d):C&&this.drawBorders(E,d),y&&this.drawControls(E,d),E.restore()},_setShadow:function(E){if(this.shadow){var d,p=this.shadow,C=this.canvas,y=C&&C.viewportTransform[0]||1,S=C&&C.viewportTransform[3]||1;d=p.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),C&&C._isRetinaScaling()&&(y*=x.devicePixelRatio,S*=x.devicePixelRatio),E.shadowColor=p.color,E.shadowBlur=p.blur*x.browserShadowBlurConstant*(y+S)*(d.scaleX+d.scaleY)/4,E.shadowOffsetX=p.offsetX*y*d.scaleX,E.shadowOffsetY=p.offsetY*S*d.scaleY}},_removeShadow:function(E){this.shadow&&(E.shadowColor="",E.shadowBlur=E.shadowOffsetX=E.shadowOffsetY=0)},_applyPatternGradientTransform:function(E,d){if(!d||!d.toLive)return{offsetX:0,offsetY:0};var p=d.gradientTransform||d.patternTransform,C=-this.width/2+d.offsetX||0,y=-this.height/2+d.offsetY||0;return d.gradientUnits==="percentage"?E.transform(this.width,0,0,this.height,C,y):E.transform(1,0,0,1,C,y),p&&E.transform(p[0],p[1],p[2],p[3],p[4],p[5]),{offsetX:C,offsetY:y}},_renderPaintInOrder:function(E){this.paintFirst==="stroke"?(this._renderStroke(E),this._renderFill(E)):(this._renderFill(E),this._renderStroke(E))},_render:function(){},_renderFill:function(E){this.fill&&(E.save(),this._setFillStyles(E,this),this.fillRule==="evenodd"?E.fill("evenodd"):E.fill(),E.restore())},_renderStroke:function(E){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(E),E.save(),this.strokeUniform&&this.group){var d=this.getObjectScaling();E.scale(1/d.scaleX,1/d.scaleY)}else this.strokeUniform&&E.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(E,this.strokeDashArray),this._setStrokeStyles(E,this),E.stroke(),E.restore()}},_applyPatternForTransformedGradient:function(E,d){var p,C=this._limitCacheSize(this._getCacheCanvasDimensions()),y=x.util.createCanvasElement(),S=this.canvas.getRetinaScaling(),w=C.x/this.scaleX/S,b=C.y/this.scaleY/S;y.width=w,y.height=b,(p=y.getContext("2d")).beginPath(),p.moveTo(0,0),p.lineTo(w,0),p.lineTo(w,b),p.lineTo(0,b),p.closePath(),p.translate(w/2,b/2),p.scale(C.zoomX/this.scaleX/S,C.zoomY/this.scaleY/S),this._applyPatternGradientTransform(p,d),p.fillStyle=d.toLive(E),p.fill(),E.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),E.scale(S*this.scaleX/C.zoomX,S*this.scaleY/C.zoomY),E.strokeStyle=p.createPattern(y,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var E=x.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",E.scaleX),this.set("scaleY",E.scaleY),this.angle=E.angle,this.skewX=E.skewX,this.skewY=0}},_removeTransformMatrix:function(E){var d=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),d=x.util.transformPoint(d,this.transformMatrix)),this.transformMatrix=null,E&&(this.scaleX*=E.scaleX,this.scaleY*=E.scaleY,this.cropX=E.cropX,this.cropY=E.cropY,d.x+=E.offsetLeft,d.y+=E.offsetTop,this.width=E.width,this.height=E.height),this.setPositionByOrigin(d,"center","center")},clone:function(E,d){var p=this.toObject(d);this.constructor.fromObject?this.constructor.fromObject(p,E):x.Object._fromObject("Object",p,E)},cloneAsImage:function(E,d){var p=this.toCanvasElement(d);return E&&E(new x.Image(p)),this},toCanvasElement:function(E){E||(E={});var d=x.util,p=d.saveObjectTransform(this),C=this.group,y=this.shadow,S=Math.abs,w=(E.multiplier||1)*(E.enableRetinaScaling?x.devicePixelRatio:1);delete this.group,E.withoutTransform&&d.resetObjectTransform(this),E.withoutShadow&&(this.shadow=null);var b,O,N,j,Z=x.util.createCanvasElement(),Y=this.getBoundingRect(!0,!0),W=this.shadow,P={x:0,y:0};W&&(O=W.blur,b=W.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),P.x=2*Math.round(S(W.offsetX)+O)*S(b.scaleX),P.y=2*Math.round(S(W.offsetY)+O)*S(b.scaleY)),N=Y.width+P.x,j=Y.height+P.y,Z.width=Math.ceil(N),Z.height=Math.ceil(j);var R=new x.StaticCanvas(Z,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});E.format==="jpeg"&&(R.backgroundColor="#fff"),this.setPositionByOrigin(new x.Point(R.width/2,R.height/2),"center","center");var V=this.canvas;R.add(this);var J=R.toCanvasElement(w||1,E);return this.shadow=y,this.set("canvas",V),C&&(this.group=C),this.set(p).setCoords(),R._objects=[],R.dispose(),R=null,J},toDataURL:function(E){return E||(E={}),x.util.toDataURL(this.toCanvasElement(E),E.format||"png",E.quality||1)},isType:function(E){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===E},complexity:function(){return 1},toJSON:function(E){return this.toObject(E)},rotate:function(E){var d=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return d&&this._setOriginToCenter(),this.set("angle",E),d&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(E,d){d=d||this.canvas.getPointer(E);var p=new x.Point(d.x,d.y),C=this._getLeftTopCoords();return this.angle&&(p=x.util.rotatePoint(p,C,c(-this.angle))),{x:p.x-C.x,y:p.y-C.y}},_setupCompositeOperation:function(E){this.globalCompositeOperation&&(E.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){x.runningAnimations&&x.runningAnimations.cancelByTarget(this)}}),x.util.createAccessors&&x.util.createAccessors(x.Object),l(x.Object.prototype,x.Observable),x.Object.NUM_FRACTION_DIGITS=2,x.Object.ENLIVEN_PROPS=["clipPath"],x.Object._fromObject=function(E,d,p,C){var y=x[E];d=f(d,!0),x.util.enlivenPatterns([d.fill,d.stroke],function(S){S[0]!==void 0&&(d.fill=S[0]),S[1]!==void 0&&(d.stroke=S[1]),x.util.enlivenObjectEnlivables(d,d,function(){var w=C?new y(d[C],d):new y(d);p&&p(w)})})},x.Object.__uid=0)}(e),ne=v.util.degreesToRadians,re={left:-.5,center:0,right:.5},ue={top:-.5,center:0,bottom:.5},v.util.object.extend(v.Object.prototype,{translateToGivenOrigin:function(h,x,l,f,n){var a,c,A,E=h.x,d=h.y;return typeof x=="string"?x=re[x]:x-=.5,typeof f=="string"?f=re[f]:f-=.5,typeof l=="string"?l=ue[l]:l-=.5,typeof n=="string"?n=ue[n]:n-=.5,c=n-l,((a=f-x)||c)&&(A=this._getTransformedDimensions(),E=h.x+a*A.x,d=h.y+c*A.y),new v.Point(E,d)},translateToCenterPoint:function(h,x,l){var f=this.translateToGivenOrigin(h,x,l,"center","center");return this.angle?v.util.rotatePoint(f,h,ne(this.angle)):f},translateToOriginPoint:function(h,x,l){var f=this.translateToGivenOrigin(h,"center","center",x,l);return this.angle?v.util.rotatePoint(f,h,ne(this.angle)):f},getCenterPoint:function(){var h=new v.Point(this.left,this.top);return this.translateToCenterPoint(h,this.originX,this.originY)},getPointByOrigin:function(h,x){var l=this.getCenterPoint();return this.translateToOriginPoint(l,h,x)},toLocalPoint:function(h,x,l){var f,n,a=this.getCenterPoint();return f=x!==void 0&&l!==void 0?this.translateToGivenOrigin(a,"center","center",x,l):new v.Point(this.left,this.top),n=new v.Point(h.x,h.y),this.angle&&(n=v.util.rotatePoint(n,a,-ne(this.angle))),n.subtractEquals(f)},setPositionByOrigin:function(h,x,l){var f=this.translateToCenterPoint(h,x,l),n=this.translateToOriginPoint(f,this.originX,this.originY);this.set("left",n.x),this.set("top",n.y)},adjustPosition:function(h){var x,l,f=ne(this.angle),n=this.getScaledWidth(),a=v.util.cos(f)*n,c=v.util.sin(f)*n;x=typeof this.originX=="string"?re[this.originX]:this.originX-.5,l=typeof h=="string"?re[h]:h-.5,this.left+=a*(l-x),this.top+=c*(l-x),this.setCoords(),this.originX=h},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var h=this.getCenterPoint();this.originX="center",this.originY="center",this.left=h.x,this.top=h.y},_resetOrigin:function(){var h=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=h.x,this.top=h.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var h=v.util,x=h.degreesToRadians,l=h.multiplyTransformMatrices,f=h.transformPoint;h.object.extend(v.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(n,a){return a?n?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),n?this.aCoords:this.lineCoords)},getCoords:function(n,a){return c=this._getCoords(n,a),[new v.Point(c.tl.x,c.tl.y),new v.Point(c.tr.x,c.tr.y),new v.Point(c.br.x,c.br.y),new v.Point(c.bl.x,c.bl.y)];var c},intersectsWithRect:function(n,a,c,A){var E=this.getCoords(c,A);return v.Intersection.intersectPolygonRectangle(E,n,a).status==="Intersection"},intersectsWithObject:function(n,a,c){return v.Intersection.intersectPolygonPolygon(this.getCoords(a,c),n.getCoords(a,c)).status==="Intersection"||n.isContainedWithinObject(this,a,c)||this.isContainedWithinObject(n,a,c)},isContainedWithinObject:function(n,a,c){for(var A=this.getCoords(a,c),E=a?n.aCoords:n.lineCoords,d=0,p=n._getImageLines(E);d<4;d++)if(!n.containsPoint(A[d],p))return!1;return!0},isContainedWithinRect:function(n,a,c,A){var E=this.getBoundingRect(c,A);return E.left>=n.x&&E.left+E.width<=a.x&&E.top>=n.y&&E.top+E.height<=a.y},containsPoint:function(n,a,c,A){var E=this._getCoords(c,A),d=(a=a||this._getImageLines(E),this._findCrossPoints(n,a));return d!==0&&d%2==1},isOnScreen:function(n){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,c=this.canvas.vptCoords.br;return!!this.getCoords(!0,n).some(function(A){return A.x<=c.x&&A.x>=a.x&&A.y<=c.y&&A.y>=a.y})||!!this.intersectsWithRect(a,c,!0,n)||this._containsCenterOfCanvas(a,c,n)},_containsCenterOfCanvas:function(n,a,c){var A={x:(n.x+a.x)/2,y:(n.y+a.y)/2};return!!this.containsPoint(A,null,!0,c)},isPartiallyOnScreen:function(n){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,c=this.canvas.vptCoords.br;return!!this.intersectsWithRect(a,c,!0,n)||this.getCoords(!0,n).every(function(A){return(A.x>=c.x||A.x<=a.x)&&(A.y>=c.y||A.y<=a.y)})&&this._containsCenterOfCanvas(a,c,n)},_getImageLines:function(n){return{topline:{o:n.tl,d:n.tr},rightline:{o:n.tr,d:n.br},bottomline:{o:n.br,d:n.bl},leftline:{o:n.bl,d:n.tl}}},_findCrossPoints:function(n,a){var c,A,E,d=0;for(var p in a)if(!((E=a[p]).o.y<n.y&&E.d.y<n.y||E.o.y>=n.y&&E.d.y>=n.y||(E.o.x===E.d.x&&E.o.x>=n.x?A=E.o.x:(c=(E.d.y-E.o.y)/(E.d.x-E.o.x),A=-(n.y-0*n.x-(E.o.y-c*E.o.x))/(0-c)),A>=n.x&&(d+=1),d!==2)))break;return d},getBoundingRect:function(n,a){var c=this.getCoords(n,a);return h.makeBoundingBoxFromPoints(c)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(n){return Math.abs(n)<this.minScaleLimit?n<0?-this.minScaleLimit:this.minScaleLimit:n===0?1e-4:n},scale:function(n){return this._set("scaleX",n),this._set("scaleY",n),this.setCoords()},scaleToWidth:function(n,a){var c=this.getBoundingRect(a).width/this.getScaledWidth();return this.scale(n/this.width/c)},scaleToHeight:function(n,a){var c=this.getBoundingRect(a).height/this.getScaledHeight();return this.scale(n/this.height/c)},calcLineCoords:function(){var n=this.getViewportTransform(),a=this.padding,c=x(this.angle),A=h.cos(c)*a,E=h.sin(c)*a,d=A+E,p=A-E,C=this.calcACoords(),y={tl:f(C.tl,n),tr:f(C.tr,n),bl:f(C.bl,n),br:f(C.br,n)};return a&&(y.tl.x-=p,y.tl.y-=d,y.tr.x+=d,y.tr.y-=p,y.bl.x-=d,y.bl.y+=p,y.br.x+=p,y.br.y+=d),y},calcOCoords:function(){var n=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),c=this.getViewportTransform(),A=l(c,a),E=l(A,n),d=(E=l(E,[1/c[0],0,0,1/c[3],0,0]),this._calculateCurrentDimensions()),p={};return this.forEachControl(function(C,y,S){p[y]=C.positionHandler(d,E,S)}),p},calcACoords:function(){var n=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),c=l(a,n),A=this._getTransformedDimensions(),E=A.x/2,d=A.y/2;return{tl:f({x:-E,y:-d},c),tr:f({x:E,y:-d},c),bl:f({x:-E,y:d},c),br:f({x:E,y:d},c)}},setCoords:function(n){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),n||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return h.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var n=this.getCenterPoint();return[1,0,0,1,n.x,n.y]},transformMatrixKey:function(n){var a="_",c="";return!n&&this.group&&(c=this.group.transformMatrixKey(n)+a),c+this.top+a+this.left+a+this.scaleX+a+this.scaleY+a+this.skewX+a+this.skewY+a+this.angle+a+this.originX+a+this.originY+a+this.width+a+this.height+a+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(n){var a=this.calcOwnMatrix();if(n||!this.group)return a;var c=this.transformMatrixKey(n),A=this.matrixCache||(this.matrixCache={});return A.key===c?A.value:(this.group&&(a=l(this.group.calcTransformMatrix(!1),a)),A.key=c,A.value=a,a)},calcOwnMatrix:function(){var n=this.transformMatrixKey(!0),a=this.ownMatrixCache||(this.ownMatrixCache={});if(a.key===n)return a.value;var c=this._calcTranslateMatrix(),A={angle:this.angle,translateX:c[4],translateY:c[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return a.key=n,a.value=h.composeMatrix(A),a.value},_getNonTransformedDimensions:function(){var n=this.strokeWidth;return{x:this.width+n,y:this.height+n}},_getTransformedDimensions:function(n,a){n===void 0&&(n=this.skewX),a===void 0&&(a=this.skewY);var c,A,E,d=n===0&&a===0;if(this.strokeUniform?(A=this.width,E=this.height):(A=(c=this._getNonTransformedDimensions()).x,E=c.y),d)return this._finalizeDimensions(A*this.scaleX,E*this.scaleY);var p=h.sizeAfterTransform(A,E,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:n,skewY:a});return this._finalizeDimensions(p.x,p.y)},_finalizeDimensions:function(n,a){return this.strokeUniform?{x:n+this.strokeWidth,y:a+this.strokeWidth}:{x:n,y:a}},_calculateCurrentDimensions:function(){var n=this.getViewportTransform(),a=this._getTransformedDimensions();return f(a,n,!0).scalarAdd(2*this.padding)}})}(),v.util.object.extend(v.Object.prototype,{sendToBack:function(){return this.group?v.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?v.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(h){return this.group?v.StaticCanvas.prototype.sendBackwards.call(this.group,this,h):this.canvas&&this.canvas.sendBackwards(this,h),this},bringForward:function(h){return this.group?v.StaticCanvas.prototype.bringForward.call(this.group,this,h):this.canvas&&this.canvas.bringForward(this,h),this},moveTo:function(h){return this.group&&this.group.type!=="activeSelection"?v.StaticCanvas.prototype.moveTo.call(this.group,this,h):this.canvas&&this.canvas.moveTo(this,h),this}}),function(){function h(l,f){if(f){if(f.toLive)return l+": url(#SVGID_"+f.id+"); ";var n=new v.Color(f),a=l+": "+n.toRgb()+"; ",c=n.getAlpha();return c!==1&&(a+=l+"-opacity: "+c.toString()+"; "),a}return l+": none; "}var x=v.util.toFixed;v.util.object.extend(v.Object.prototype,{getSvgStyles:function(l){var f=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",a=this.strokeDashArray?this.strokeDashArray.join(" "):"none",c=this.strokeDashOffset?this.strokeDashOffset:"0",A=this.strokeLineCap?this.strokeLineCap:"butt",E=this.strokeLineJoin?this.strokeLineJoin:"miter",d=this.strokeMiterLimit?this.strokeMiterLimit:"4",p=this.opacity!==void 0?this.opacity:"1",C=this.visible?"":" visibility: hidden;",y=l?"":this.getSvgFilter(),S=h("fill",this.fill);return[h("stroke",this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",a,"; ","stroke-linecap: ",A,"; ","stroke-dashoffset: ",c,"; ","stroke-linejoin: ",E,"; ","stroke-miterlimit: ",d,"; ",S,"fill-rule: ",f,"; ","opacity: ",p,";",y,C].join("")},getSvgSpanStyles:function(l,f){var n="; ",a=l.fontFamily?"font-family: "+(l.fontFamily.indexOf("'")===-1&&l.fontFamily.indexOf('"')===-1?"'"+l.fontFamily+"'":l.fontFamily)+n:"",c=l.strokeWidth?"stroke-width: "+l.strokeWidth+n:"",A=l.fontSize?"font-size: "+l.fontSize+"px"+n:"",E=l.fontStyle?"font-style: "+l.fontStyle+n:"",d=l.fontWeight?"font-weight: "+l.fontWeight+n:"",p=l.fill?h("fill",l.fill):"",C=l.stroke?h("stroke",l.stroke):"",y=this.getSvgTextDecoration(l);return y&&(y="text-decoration: "+y+n),[C,c,a,A,E,d,y,p,l.deltaY?"baseline-shift: "+-l.deltaY+"; ":"",f?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(l){return["overline","underline","line-through"].filter(function(f){return l[f.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(l,f){var n=l?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+v.util.matrixToSVG(n)+(f||"")+'" '},_setSVGBg:function(l){if(this.backgroundColor){var f=v.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',x(-this.width/2,f),'" y="',x(-this.height/2,f),'" width="',x(this.width,f),'" height="',x(this.height,f),`"></rect>
`)}},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(l),{reviver:l})},toClipPathSVG:function(l){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(l),{reviver:l})},_createBaseClipPathSVGMarkup:function(l,f){var n=(f=f||{}).reviver,a=f.additionalTransform||"",c=[this.getSvgTransform(!0,a),this.getSvgCommons()].join(""),A=l.indexOf("COMMON_PARTS");return l[A]=c,n?n(l.join("")):l.join("")},_createBaseSVGMarkup:function(l,f){var n,a,c=(f=f||{}).noStyle,A=f.reviver,E=c?"":'style="'+this.getSvgStyles()+'" ',d=f.withShadow?'style="'+this.getSvgFilter()+'" ':"",p=this.clipPath,C=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",y=p&&p.absolutePositioned,S=this.stroke,w=this.fill,b=this.shadow,O=[],N=l.indexOf("COMMON_PARTS"),j=f.additionalTransform;return p&&(p.clipPathId="CLIPPATH_"+v.Object.__uid++,a='<clipPath id="'+p.clipPathId+`" >
`+p.toClipPathSVG(A)+`</clipPath>
`),y&&O.push("<g ",d,this.getSvgCommons(),` >
`),O.push("<g ",this.getSvgTransform(!1),y?"":d+this.getSvgCommons(),` >
`),n=[E,C,c?"":this.addPaintOrder()," ",j?'transform="'+j+'" ':""].join(""),l[N]=n,w&&w.toLive&&O.push(w.toSVG(this)),S&&S.toLive&&O.push(S.toSVG(this)),b&&O.push(b.toSVG(this)),p&&O.push(a),O.push(l.join("")),O.push(`</g>
`),y&&O.push(`</g>
`),A?A(O.join("")):O.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var h=v.util.object.extend,x="stateProperties";function l(n,a,c){var A={};c.forEach(function(E){A[E]=n[E]}),h(n[a],A,!0)}function f(n,a,c){if(n===a)return!0;if(Array.isArray(n)){if(!Array.isArray(a)||n.length!==a.length)return!1;for(var A=0,E=n.length;A<E;A++)if(!f(n[A],a[A]))return!1;return!0}if(n&&typeof n=="object"){var d,p=Object.keys(n);if(!a||typeof a!="object"||!c&&p.length!==Object.keys(a).length)return!1;for(A=0,E=p.length;A<E;A++)if((d=p[A])!=="canvas"&&d!=="group"&&!f(n[d],a[d]))return!1;return!0}}v.util.object.extend(v.Object.prototype,{hasStateChanged:function(n){var a="_"+(n=n||x);return Object.keys(this[a]).length<this[n].length||!f(this[a],this,!0)},saveState:function(n){var a=n&&n.propertySet||x,c="_"+a;return this[c]?(l(this,c,this[a]),n&&n.stateProperties&&l(this,c,n.stateProperties),this):this.setupState(n)},setupState:function(n){var a=(n=n||{}).propertySet||x;return n.propertySet=a,this["_"+a]={},this.saveState(n),this}})}(),function(){var h=v.util.degreesToRadians;v.util.object.extend(v.Object.prototype,{_findTargetCorner:function(x,l){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var f,n,a,c=x.x,A=x.y,E=Object.keys(this.oCoords),d=E.length-1;for(this.__corner=0;d>=0;d--)if(a=E[d],this.isControlVisible(a)&&(n=this._getImageLines(l?this.oCoords[a].touchCorner:this.oCoords[a].corner),(f=this._findCrossPoints({x:c,y:A},n))!==0&&f%2==1))return this.__corner=a,a;return!1},forEachControl:function(x){for(var l in this.controls)x(this.controls[l],l,this)},_setCornerCoords:function(){var x=this.oCoords;for(var l in x){var f=this.controls[l];x[l].corner=f.calcCornerCoords(this.angle,this.cornerSize,x[l].x,x[l].y,!1),x[l].touchCorner=f.calcCornerCoords(this.angle,this.touchCornerSize,x[l].x,x[l].y,!0)}},drawSelectionBackground:function(x){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;x.save();var l=this.getCenterPoint(),f=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return x.translate(l.x,l.y),x.scale(1/n[0],1/n[3]),x.rotate(h(this.angle)),x.fillStyle=this.selectionBackgroundColor,x.fillRect(-f.x/2,-f.y/2,f.x,f.y),x.restore(),this},drawBorders:function(x,l){l=l||{};var f=this._calculateCurrentDimensions(),n=this.borderScaleFactor,a=f.x+n,c=f.y+n,A=l.hasControls!==void 0?l.hasControls:this.hasControls,E=!1;return x.save(),x.strokeStyle=l.borderColor||this.borderColor,this._setLineDash(x,l.borderDashArray||this.borderDashArray),x.strokeRect(-a/2,-c/2,a,c),A&&(x.beginPath(),this.forEachControl(function(d,p,C){d.withConnection&&d.getVisibility(C,p)&&(E=!0,x.moveTo(d.x*a,d.y*c),x.lineTo(d.x*a+d.offsetX,d.y*c+d.offsetY))}),E&&x.stroke()),x.restore(),this},drawBordersInGroup:function(x,l,f){f=f||{};var n=v.util.sizeAfterTransform(this.width,this.height,l),a=this.strokeWidth,c=this.strokeUniform,A=this.borderScaleFactor,E=n.x+a*(c?this.canvas.getZoom():l.scaleX)+A,d=n.y+a*(c?this.canvas.getZoom():l.scaleY)+A;return x.save(),this._setLineDash(x,f.borderDashArray||this.borderDashArray),x.strokeStyle=f.borderColor||this.borderColor,x.strokeRect(-E/2,-d/2,E,d),x.restore(),this},drawControls:function(x,l){l=l||{},x.save();var f,n,a=this.canvas.getRetinaScaling();return x.setTransform(a,0,0,a,0,0),x.strokeStyle=x.fillStyle=l.cornerColor||this.cornerColor,this.transparentCorners||(x.strokeStyle=l.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(x,l.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(f=this.group.calcTransformMatrix()),this.forEachControl(function(c,A,E){n=E.oCoords[A],c.getVisibility(E,A)&&(f&&(n=v.util.transformPoint(n,f)),c.render(x,n.x,n.y,l,E))}),x.restore(),this},isControlVisible:function(x){return this.controls[x]&&this.controls[x].getVisibility(this,x)},setControlVisible:function(x,l){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[x]=l,this},setControlsVisibility:function(x){for(var l in x||(x={}),x)this.setControlVisible(l,x[l]);return this},onDeselect:function(){},onSelect:function(){}})}(),v.util.object.extend(v.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(h,x){var l=function(){},f=(x=x||{}).onComplete||l,n=x.onChange||l,a=this;return v.util.animate({target:this,startValue:h.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(c){h.set("left",c),a.requestRenderAll(),n()},onComplete:function(){h.setCoords(),f()}})},fxCenterObjectV:function(h,x){var l=function(){},f=(x=x||{}).onComplete||l,n=x.onChange||l,a=this;return v.util.animate({target:this,startValue:h.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(c){h.set("top",c),a.requestRenderAll(),n()},onComplete:function(){h.setCoords(),f()}})},fxRemove:function(h,x){var l=function(){},f=(x=x||{}).onComplete||l,n=x.onChange||l,a=this;return v.util.animate({target:this,startValue:h.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(c){h.set("opacity",c),a.requestRenderAll(),n()},onComplete:function(){a.remove(h),f()}})}}),v.util.object.extend(v.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var h,x,l=[],f=[];for(h in arguments[0])l.push(h);for(var n=0,a=l.length;n<a;n++)h=l[n],x=n!==a-1,f.push(this._animate(h,arguments[0][h],arguments[1],x));return f}return this._animate.apply(this,arguments)},_animate:function(h,x,l,f){var n,a=this;x=x.toString(),l=l?v.util.object.clone(l):{},~h.indexOf(".")&&(n=h.split("."));var c=a.colorProperties.indexOf(h)>-1||n&&a.colorProperties.indexOf(n[1])>-1,A=n?this.get(n[0])[n[1]]:this.get(h);"from"in l||(l.from=A),c||(x=~x.indexOf("=")?A+parseFloat(x.replace("=","")):parseFloat(x));var E={target:this,startValue:l.from,endValue:x,byValue:l.by,easing:l.easing,duration:l.duration,abort:l.abort&&function(d,p,C){return l.abort.call(a,d,p,C)},onChange:function(d,p,C){n?a[n[0]][n[1]]=d:a.set(h,d),f||l.onChange&&l.onChange(d,p,C)},onComplete:function(d,p,C){f||(a.setCoords(),l.onComplete&&l.onComplete(d,p,C))}};return c?v.util.animateColor(E.startValue,E.endValue,E.duration,E):v.util.animate(E)}}),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};function a(c,A){var E=c.origin,d=c.axis1,p=c.axis2,C=c.dimension,y=A.nearest,S=A.center,w=A.farthest;return function(){switch(this.get(E)){case y:return Math.min(this.get(d),this.get(p));case S:return Math.min(this.get(d),this.get(p))+.5*this.get(C);case w:return Math.max(this.get(d),this.get(p))}}}x.Line?x.warn("fabric.Line is already defined"):(x.Line=x.util.createClass(x.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:x.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(c,A){c||(c=[0,0,0,0]),this.callSuper("initialize",A),this.set("x1",c[0]),this.set("y1",c[1]),this.set("x2",c[2]),this.set("y2",c[3]),this._setWidthHeight(A)},_setWidthHeight:function(c){c||(c={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in c?c.left:this._getLeftToOriginX(),this.top="top"in c?c.top:this._getTopToOriginY()},_set:function(c,A){return this.callSuper("_set",c,A),n[c]!==void 0&&this._setWidthHeight(),this},_getLeftToOriginX:a({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:a({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(c){c.beginPath();var A=this.calcLinePoints();c.moveTo(A.x1,A.y1),c.lineTo(A.x2,A.y2),c.lineWidth=this.strokeWidth;var E=c.strokeStyle;c.strokeStyle=this.stroke||c.fillStyle,this.stroke&&this._renderStroke(c),c.strokeStyle=E},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(c){return l(this.callSuper("toObject",c),this.calcLinePoints())},_getNonTransformedDimensions:function(){var c=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(c.y-=this.strokeWidth),this.height===0&&(c.x-=this.strokeWidth)),c},calcLinePoints:function(){var c=this.x1<=this.x2?-1:1,A=this.y1<=this.y2?-1:1,E=c*this.width*.5,d=A*this.height*.5;return{x1:E,x2:c*this.width*-.5,y1:d,y2:A*this.height*-.5}},_toSVG:function(){var c=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',c.x1,'" y1="',c.y1,'" x2="',c.x2,'" y2="',c.y2,`" />
`]}}),x.Line.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),x.Line.fromElement=function(c,A,E){E=E||{};var d=x.parseAttributes(c,x.Line.ATTRIBUTE_NAMES),p=[d.x1||0,d.y1||0,d.x2||0,d.y2||0];A(new x.Line(p,l(d,E)))},x.Line.fromObject=function(c,A){var E=f(c,!0);E.points=[c.x1,c.y1,c.x2,c.y2],x.Object._fromObject("Line",E,function(d){delete d.points,A&&A(d)},"points")})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.degreesToRadians;x.Circle?x.warn("fabric.Circle is already defined."):(x.Circle=x.util.createClass(x.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:x.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(f,n){return this.callSuper("_set",f,n),f==="radius"&&this.setRadius(n),this},toObject:function(f){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(f))},_toSVG:function(){var f,n=(this.endAngle-this.startAngle)%360;if(n===0)f=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,`" />
`];else{var a=l(this.startAngle),c=l(this.endAngle),A=this.radius;f=['<path d="M '+x.util.cos(a)*A+" "+x.util.sin(a)*A," A "+A+" "+A," 0 ",+(n>180?"1":"0")+" 1"," "+x.util.cos(c)*A+" "+x.util.sin(c)*A,'" ',"COMMON_PARTS",` />
`]}return f},_render:function(f){f.beginPath(),f.arc(0,0,this.radius,l(this.startAngle),l(this.endAngle),!1),this._renderPaintInOrder(f)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(f){return this.radius=f,this.set("width",2*f).set("height",2*f)}}),x.Circle.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),x.Circle.fromElement=function(f,n){var a,c=x.parseAttributes(f,x.Circle.ATTRIBUTE_NAMES);if(!("radius"in(a=c)&&a.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");c.left=(c.left||0)-c.radius,c.top=(c.top||0)-c.radius,n(new x.Circle(c))},x.Circle.fromObject=function(f,n){x.Object._fromObject("Circle",f,n)})}(e),function(h){var x=h.fabric||(h.fabric={});x.Triangle?x.warn("fabric.Triangle is already defined"):(x.Triangle=x.util.createClass(x.Object,{type:"triangle",width:100,height:100,_render:function(l){var f=this.width/2,n=this.height/2;l.beginPath(),l.moveTo(-f,n),l.lineTo(0,-n),l.lineTo(f,n),l.closePath(),this._renderPaintInOrder(l)},_toSVG:function(){var l=this.width/2,f=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-l+" "+f,"0 "+-f,l+" "+f].join(","),'" />']}}),x.Triangle.fromObject=function(l,f){return x.Object._fromObject("Triangle",l,f)})}(e),function(h){var x=h.fabric||(h.fabric={}),l=2*Math.PI;x.Ellipse?x.warn("fabric.Ellipse is already defined."):(x.Ellipse=x.util.createClass(x.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:x.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this.set("rx",f&&f.rx||0),this.set("ry",f&&f.ry||0)},_set:function(f,n){switch(this.callSuper("_set",f,n),f){case"rx":this.rx=n,this.set("width",2*n);break;case"ry":this.ry=n,this.set("height",2*n)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(f){f.beginPath(),f.save(),f.transform(1,0,0,this.ry/this.rx,0,0),f.arc(0,0,this.rx,0,l,!1),f.restore(),this._renderPaintInOrder(f)}}),x.Ellipse.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),x.Ellipse.fromElement=function(f,n){var a=x.parseAttributes(f,x.Ellipse.ATTRIBUTE_NAMES);a.left=(a.left||0)-a.rx,a.top=(a.top||0)-a.ry,n(new x.Ellipse(a))},x.Ellipse.fromObject=function(f,n){x.Object._fromObject("Ellipse",f,n)})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend;x.Rect?x.warn("fabric.Rect is already defined"):(x.Rect=x.util.createClass(x.Object,{stateProperties:x.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:x.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(f){var n=this.rx?Math.min(this.rx,this.width/2):0,a=this.ry?Math.min(this.ry,this.height/2):0,c=this.width,A=this.height,E=-this.width/2,d=-this.height/2,p=n!==0||a!==0,C=.4477152502;f.beginPath(),f.moveTo(E+n,d),f.lineTo(E+c-n,d),p&&f.bezierCurveTo(E+c-C*n,d,E+c,d+C*a,E+c,d+a),f.lineTo(E+c,d+A-a),p&&f.bezierCurveTo(E+c,d+A-C*a,E+c-C*n,d+A,E+c-n,d+A),f.lineTo(E+n,d+A),p&&f.bezierCurveTo(E+C*n,d+A,E,d+A-C*a,E,d+A-a),f.lineTo(E,d+a),p&&f.bezierCurveTo(E,d+C*a,E+C*n,d,E+n,d),f.closePath(),this._renderPaintInOrder(f)},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),x.Rect.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),x.Rect.fromElement=function(f,n,a){if(!f)return n(null);a=a||{};var c=x.parseAttributes(f,x.Rect.ATTRIBUTE_NAMES);c.left=c.left||0,c.top=c.top||0,c.height=c.height||0,c.width=c.width||0;var A=new x.Rect(l(a?x.util.object.clone(a):{},c));A.visible=A.visible&&A.width>0&&A.height>0,n(A)},x.Rect.fromObject=function(f,n){return x.Object._fromObject("Rect",f,n)})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.util.array.min,n=x.util.array.max,a=x.util.toFixed,c=x.util.projectStrokeOnPoints;x.Polyline?x.warn("fabric.Polyline is already defined"):(x.Polyline=x.util.createClass(x.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:x.Object.prototype.cacheProperties.concat("points"),initialize:function(A,E){E=E||{},this.points=A||[],this.callSuper("initialize",E),this._setPositionDimensions(E)},_projectStrokeOnPoints:function(){return c(this.points,this,!0)},_setPositionDimensions:function(A){var E,d=this._calcDimensions(A),p=this.exactBoundingBox?this.strokeWidth:0;this.width=d.width-p,this.height=d.height-p,A.fromSVG||(E=this.translateToGivenOrigin({x:d.left-this.strokeWidth/2+p/2,y:d.top-this.strokeWidth/2+p/2},"left","top",this.originX,this.originY)),A.left===void 0&&(this.left=A.fromSVG?d.left:E.x),A.top===void 0&&(this.top=A.fromSVG?d.top:E.y),this.pathOffset={x:d.left+this.width/2+p/2,y:d.top+this.height/2+p/2}},_calcDimensions:function(){var A=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,E=f(A,"x")||0,d=f(A,"y")||0;return{left:E,top:d,width:(n(A,"x")||0)-E,height:(n(A,"y")||0)-d}},toObject:function(A){return l(this.callSuper("toObject",A),{points:this.points.concat()})},_toSVG:function(){for(var A=[],E=this.pathOffset.x,d=this.pathOffset.y,p=x.Object.NUM_FRACTION_DIGITS,C=0,y=this.points.length;C<y;C++)A.push(a(this.points[C].x-E,p),",",a(this.points[C].y-d,p)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',A.join(""),`" />
`]},commonRender:function(A){var E,d=this.points.length,p=this.pathOffset.x,C=this.pathOffset.y;if(!d||isNaN(this.points[d-1].y))return!1;A.beginPath(),A.moveTo(this.points[0].x-p,this.points[0].y-C);for(var y=0;y<d;y++)E=this.points[y],A.lineTo(E.x-p,E.y-C);return!0},_render:function(A){this.commonRender(A)&&this._renderPaintInOrder(A)},complexity:function(){return this.get("points").length}}),x.Polyline.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat(),x.Polyline.fromElementGenerator=function(A){return function(E,d,p){if(!E)return d(null);p||(p={});var C=x.parsePointsAttribute(E.getAttribute("points")),y=x.parseAttributes(E,x[A].ATTRIBUTE_NAMES);y.fromSVG=!0,d(new x[A](C,l(y,p)))}},x.Polyline.fromElement=x.Polyline.fromElementGenerator("Polyline"),x.Polyline.fromObject=function(A,E){return x.Object._fromObject("Polyline",A,E,"points")})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.projectStrokeOnPoints;x.Polygon?x.warn("fabric.Polygon is already defined"):(x.Polygon=x.util.createClass(x.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return l(this.points,this)},_render:function(f){this.commonRender(f)&&(f.closePath(),this._renderPaintInOrder(f))}}),x.Polygon.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat(),x.Polygon.fromElement=x.Polyline.fromElementGenerator("Polygon"),x.Polygon.fromObject=function(f,n){x.Object._fromObject("Polygon",f,n,"points")})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.array.min,f=x.util.array.max,n=x.util.object.extend,a=x.util.object.clone,c=x.util.toFixed;x.Path?x.warn("fabric.Path is already defined"):(x.Path=x.util.createClass(x.Object,{type:"path",path:null,cacheProperties:x.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:x.Object.prototype.stateProperties.concat("path"),initialize:function(A,E){delete(E=a(E||{})).path,this.callSuper("initialize",E),this._setPath(A||[],E)},_setPath:function(A,E){this.path=x.util.makePathSimpler(Array.isArray(A)?A:x.util.parsePath(A)),x.Polyline.prototype._setPositionDimensions.call(this,E||{})},_renderPathCommands:function(A){var E,d=0,p=0,C=0,y=0,S=0,w=0,b=-this.pathOffset.x,O=-this.pathOffset.y;A.beginPath();for(var N=0,j=this.path.length;N<j;++N)switch((E=this.path[N])[0]){case"L":C=E[1],y=E[2],A.lineTo(C+b,y+O);break;case"M":d=C=E[1],p=y=E[2],A.moveTo(C+b,y+O);break;case"C":C=E[5],y=E[6],S=E[3],w=E[4],A.bezierCurveTo(E[1]+b,E[2]+O,S+b,w+O,C+b,y+O);break;case"Q":A.quadraticCurveTo(E[1]+b,E[2]+O,E[3]+b,E[4]+O),C=E[3],y=E[4],S=E[1],w=E[2];break;case"z":case"Z":C=d,y=p,A.closePath()}},_render:function(A){this._renderPathCommands(A),this._renderPaintInOrder(A)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(A){return n(this.callSuper("toObject",A),{path:this.path.map(function(E){return E.slice()})})},toDatalessObject:function(A){var E=this.toObject(["sourcePath"].concat(A));return E.sourcePath&&delete E.path,E},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',x.util.joinPath(this.path),'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var A=x.Object.NUM_FRACTION_DIGITS;return" translate("+c(-this.pathOffset.x,A)+", "+c(-this.pathOffset.y,A)+")"},toClipPathSVG:function(A){var E=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:A,additionalTransform:E})},toSVG:function(A){var E=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:A,additionalTransform:E})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var A,E,d=[],p=[],C=0,y=0,S=0,w=0,b=0,O=this.path.length;b<O;++b){switch((A=this.path[b])[0]){case"L":S=A[1],w=A[2],E=[];break;case"M":C=S=A[1],y=w=A[2],E=[];break;case"C":E=x.util.getBoundsOfCurve(S,w,A[1],A[2],A[3],A[4],A[5],A[6]),S=A[5],w=A[6];break;case"Q":E=x.util.getBoundsOfCurve(S,w,A[1],A[2],A[1],A[2],A[3],A[4]),S=A[3],w=A[4];break;case"z":case"Z":S=C,w=y}E.forEach(function(Z){d.push(Z.x),p.push(Z.y)}),d.push(S),p.push(w)}var N=l(d)||0,j=l(p)||0;return{left:N,top:j,width:(f(d)||0)-N,height:(f(p)||0)-j}}}),x.Path.fromObject=function(A,E){if(typeof A.sourcePath=="string"){var d=A.sourcePath;x.loadSVGFromURL(d,function(p){var C=p[0];C.setOptions(A),E&&E(C)})}else x.Object._fromObject("Path",A,E,"path")},x.Path.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat(["d"]),x.Path.fromElement=function(A,E,d){var p=x.parseAttributes(A,x.Path.ATTRIBUTE_NAMES);p.fromSVG=!0,E(new x.Path(p.d,n(p,d)))})}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.array.min,f=x.util.array.max;x.Group||(x.Group=x.util.createClass(x.Object,x.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,a,c){a=a||{},this._objects=[],c&&this.callSuper("initialize",a),this._objects=n||[];for(var A=this._objects.length;A--;)this._objects[A].group=this;if(c)this._updateObjectsACoords();else{var E=a&&a.centerPoint;a.originX!==void 0&&(this.originX=a.originX),a.originY!==void 0&&(this.originY=a.originY),E||this._calcBounds(),this._updateObjectsCoords(E),delete a.centerPoint,this.callSuper("initialize",a)}this.setCoords()},_updateObjectsACoords:function(){for(var n=this._objects.length;n--;)this._objects[n].setCoords(!0)},_updateObjectsCoords:function(n){n=n||this.getCenterPoint();for(var a=this._objects.length;a--;)this._updateObjectCoords(this._objects[a],n)},_updateObjectCoords:function(n,a){var c=n.left,A=n.top;n.set({left:c-a.x,top:A-a.y}),n.group=this,n.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var a=!!this.group;return this._restoreObjectsState(),x.util.resetObjectTransform(this),n&&(a&&x.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,a?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),x.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,a){var c=this._objects.length;if(this.useSetOnGroup)for(;c--;)this._objects[c].setOnGroup(n,a);if(n==="canvas")for(;c--;)this._objects[c]._set(n,a);x.Object.prototype._set.call(this,n,a)},toObject:function(n){var a=this.includeDefaultValues,c=this._objects.filter(function(E){return!E.excludeFromExport}).map(function(E){var d=E.includeDefaultValues;E.includeDefaultValues=a;var p=E.toObject(n);return E.includeDefaultValues=d,p}),A=x.Object.prototype.toObject.call(this,n);return A.objects=c,A},toDatalessObject:function(n){var a,c=this.sourcePath;if(c)a=c;else{var A=this.includeDefaultValues;a=this._objects.map(function(d){var p=d.includeDefaultValues;d.includeDefaultValues=A;var C=d.toDatalessObject(n);return d.includeDefaultValues=p,C})}var E=x.Object.prototype.toDatalessObject.call(this,n);return E.objects=a,E},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=x.Object.prototype.shouldCache.call(this);if(n){for(var a=0,c=this._objects.length;a<c;a++)if(this._objects[a].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(x.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,a=this._objects.length;n<a;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var a=0,c=this._objects.length;a<c;a++)this._objects[a].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var a=0,c=this._objects.length;a<c;a++)if(this._objects[a].isCacheDirty(!0)){if(this._cacheCanvas){var A=this.cacheWidth/this.zoomX,E=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-A/2,-E/2,A,E)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(a){x.util.addTransformToObject(a,n),delete a.group,a.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,a=this.canvas;this._objects=[];var c=this.toObject();delete c.objects;var A=new x.ActiveSelection([]);return A.set(c),A.type="activeSelection",a.remove(this),n.forEach(function(E){E.group=A,E.dirty=!0,a.add(E)}),A.canvas=a,A._objects=n,a._activeObject=A,A.setCoords(),A}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(n){n.setCoords(!0)}),this},_calcBounds:function(n){for(var a,c,A,E,d=[],p=[],C=["tr","br","bl","tl"],y=0,S=this._objects.length,w=C.length;y<S;++y){for(A=(a=this._objects[y]).calcACoords(),E=0;E<w;E++)c=C[E],d.push(A[c].x),p.push(A[c].y);a.aCoords=A}this._getBounds(d,p,n)},_getBounds:function(n,a,c){var A=new x.Point(l(n),l(a)),E=new x.Point(f(n),f(a)),d=A.y||0,p=A.x||0,C=E.x-A.x||0,y=E.y-A.y||0;this.width=C,this.height=y,c||this.setPositionByOrigin({x:p,y:d},"left","top")},_toSVG:function(n){for(var a=["<g ","COMMON_PARTS",` >
`],c=0,A=this._objects.length;c<A;c++)a.push("		",this._objects[c].toSVG(n));return a.push(`</g>
`),a},getSvgStyles:function(){var n=this.opacity!==void 0&&this.opacity!==1?"opacity: "+this.opacity+";":"",a=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),a].join("")},toClipPathSVG:function(n){for(var a=[],c=0,A=this._objects.length;c<A;c++)a.push("	",this._objects[c].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(a,{reviver:n})}}),x.Group.fromObject=function(n,a){var c=n.objects,A=x.util.object.clone(n,!0);delete A.objects,typeof c!="string"?x.util.enlivenObjects(c,function(E){var d=x.util.object.clone(n,!0);delete d.objects,x.util.enlivenObjectEnlivables(n,d,function(){a&&a(new x.Group(E,d,!0))})}):x.loadSVGFromURL(c,function(E){var d=x.util.groupSVGElements(E,n,c);d.set(A),a&&a(d)})})}(e),function(h){var x=h.fabric||(h.fabric={});x.ActiveSelection||(x.ActiveSelection=x.util.createClass(x.Group,{type:"activeSelection",initialize:function(l,f){f=f||{},this._objects=l||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;f.originX&&(this.originX=f.originX),f.originY&&(this.originY=f.originY),this._calcBounds(),this._updateObjectsCoords(),x.Object.prototype.initialize.call(this,f),this.setCoords()},toGroup:function(){var l=this._objects.concat();this._objects=[];var f=x.Object.prototype.toObject.call(this),n=new x.Group([]);if(delete f.type,n.set(f),l.forEach(function(c){c.canvas.remove(c),c.group=n}),n._objects=l,!this.canvas)return n;var a=this.canvas;return a.add(n),a._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(l,f,n){l.save(),l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",l,f),(n=n||{}).hasControls===void 0&&(n.hasControls=!1),n.forActiveSelection=!0;for(var a=0,c=this._objects.length;a<c;a++)this._objects[a]._renderControls(l,n);l.restore()}}),x.ActiveSelection.fromObject=function(l,f){x.util.enlivenObjects(l.objects,function(n){delete l.objects,f&&f(new x.ActiveSelection(n,l,!0))})})}(e),function(h){var x=v.util.object.extend;h.fabric||(h.fabric={}),h.fabric.Image?v.warn("fabric.Image is already defined."):(v.Image=v.util.createClass(v.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:v.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:v.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(l,f){f||(f={}),this.filters=[],this.cacheKey="texture"+v.Object.__uid++,this.callSuper("initialize",f),this._initElement(l,f)},getElement:function(){return this._element||{}},setElement:function(l,f){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=l,this._originalElement=l,this._initConfig(f),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(l){var f=v.filterBackend;f&&f.evictCachesForKey&&f.evictCachesForKey(l)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(l){v.util.cleanUpJsdomNode(this[l]),this[l]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var l=this.getElement();return{width:l.naturalWidth||l.width,height:l.naturalHeight||l.height}},_stroke:function(l){if(this.stroke&&this.strokeWidth!==0){var f=this.width/2,n=this.height/2;l.beginPath(),l.moveTo(-f,-n),l.lineTo(f,-n),l.lineTo(f,n),l.lineTo(-f,n),l.lineTo(-f,-n),l.closePath()}},toObject:function(l){var f=[];this.filters.forEach(function(a){a&&f.push(a.toObject())});var n=x(this.callSuper("toObject",["cropX","cropY"].concat(l)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:f});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var l,f=[],n=[],a=this._element,c=-this.width/2,A=-this.height/2,E="",d="";if(!a)return[];if(this.hasCrop()){var p=v.Object.__uid++;f.push('<clipPath id="imageCrop_'+p+`">
`,'	<rect x="'+c+'" y="'+A+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),E=' clip-path="url(#imageCrop_'+p+')" '}if(this.imageSmoothing||(d='" image-rendering="optimizeSpeed'),n.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',c-this.cropX,'" y="',A-this.cropY,'" width="',a.width||a.naturalWidth,'" height="',a.height||a.height,d,'"',E,`></image>
`),this.stroke||this.strokeDashArray){var C=this.fill;this.fill=null,l=["	<rect ",'x="',c,'" y="',A,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=C}return this.paintFirst!=="fill"?f.concat(l,n):f.concat(n,l)},getSrc:function(l){var f=l?this._element:this._originalElement;return f?f.toDataURL?f.toDataURL():this.srcFromAttribute?f.getAttribute("src"):f.src:this.src||""},setSrc:function(l,f,n){return v.util.loadImage(l,function(a,c){this.setElement(a,n),this._setWidthHeight(),f&&f(this,c)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var l=this.resizeFilter,f=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),a=n.scaleX,c=n.scaleY,A=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!l||a>f&&c>f)return this._element=A,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=a,void(this._lastScaleY=c);v.filterBackend||(v.filterBackend=v.initFilterBackend());var E=v.util.createCanvasElement(),d=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,p=A.width,C=A.height;E.width=p,E.height=C,this._element=E,this._lastScaleX=l.scaleX=a,this._lastScaleY=l.scaleY=c,v.filterBackend.applyFilters([l],A,p,C,this._element,d),this._filterScalingX=E.width/this._originalElement.width,this._filterScalingY=E.height/this._originalElement.height},applyFilters:function(l){if(l=(l=l||this.filters||[]).filter(function(A){return A&&!A.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),l.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var f=this._originalElement,n=f.naturalWidth||f.width,a=f.naturalHeight||f.height;if(this._element===this._originalElement){var c=v.util.createCanvasElement();c.width=n,c.height=a,this._element=c,this._filteredEl=c}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,a),this._lastScaleX=1,this._lastScaleY=1;return v.filterBackend||(v.filterBackend=v.initFilterBackend()),v.filterBackend.applyFilters(l,this._originalElement,n,a,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(l){v.util.setImageSmoothing(l,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(l),this._renderPaintInOrder(l)},drawCacheOnCanvas:function(l){v.util.setImageSmoothing(l,this.imageSmoothing),v.Object.prototype.drawCacheOnCanvas.call(this,l)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(l){var f=this._element;if(f){var n=this._filterScalingX,a=this._filterScalingY,c=this.width,A=this.height,E=Math.min,d=Math.max,p=d(this.cropX,0),C=d(this.cropY,0),y=f.naturalWidth||f.width,S=f.naturalHeight||f.height,w=p*n,b=C*a,O=E(c*n,y-w),N=E(A*a,S-b),j=-c/2,Z=-A/2,Y=E(c,y/n-p),W=E(A,S/a-C);f&&l.drawImage(f,w,b,O,N,j,Z,Y,W)}},_needsResize:function(){var l=this.getTotalObjectScaling();return l.scaleX!==this._lastScaleX||l.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(l,f){this.setElement(v.util.getById(l),f),v.util.addClass(this.getElement(),v.Image.CSS_CANVAS)},_initConfig:function(l){l||(l={}),this.setOptions(l),this._setWidthHeight(l)},_initFilters:function(l,f){l&&l.length?v.util.enlivenObjects(l,function(n){f&&f(n)},"fabric.Image.filters"):f&&f()},_setWidthHeight:function(l){l||(l={});var f=this.getElement();this.width=l.width||f.naturalWidth||f.width||0,this.height=l.height||f.naturalHeight||f.height||0},parsePreserveAspectRatioAttribute:function(){var l,f=v.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),n=this._element.width,a=this._element.height,c=1,A=1,E=0,d=0,p=0,C=0,y=this.width,S=this.height,w={width:y,height:S};return!f||f.alignX==="none"&&f.alignY==="none"?(c=y/n,A=S/a):(f.meetOrSlice==="meet"&&(l=(y-n*(c=A=v.util.findScaleToFit(this._element,w)))/2,f.alignX==="Min"&&(E=-l),f.alignX==="Max"&&(E=l),l=(S-a*A)/2,f.alignY==="Min"&&(d=-l),f.alignY==="Max"&&(d=l)),f.meetOrSlice==="slice"&&(l=n-y/(c=A=v.util.findScaleToCover(this._element,w)),f.alignX==="Mid"&&(p=l/2),f.alignX==="Max"&&(p=l),l=a-S/A,f.alignY==="Mid"&&(C=l/2),f.alignY==="Max"&&(C=l),n=y/c,a=S/A)),{width:n,height:a,scaleX:c,scaleY:A,offsetLeft:E,offsetTop:d,cropX:p,cropY:C}}}),v.Image.CSS_CANVAS="canvas-img",v.Image.prototype.getSvgSrc=v.Image.prototype.getSrc,v.Image.fromObject=function(l,f){var n=v.util.object.clone(l);v.util.loadImage(n.src,function(a,c){c?f&&f(null,!0):v.Image.prototype._initFilters.call(n,n.filters,function(A){n.filters=A||[],v.Image.prototype._initFilters.call(n,[n.resizeFilter],function(E){n.resizeFilter=E[0],v.util.enlivenObjectEnlivables(n,n,function(){var d=new v.Image(a,n);f(d,!1)})})})},null,n.crossOrigin)},v.Image.fromURL=function(l,f,n){v.util.loadImage(l,function(a,c){f&&f(new v.Image(a,n),c)},null,n&&n.crossOrigin)},v.Image.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),v.Image.fromElement=function(l,f,n){var a=v.parseAttributes(l,v.Image.ATTRIBUTE_NAMES);v.Image.fromURL(a["xlink:href"],f,x(n?v.util.object.clone(n):{},a))})}(e),v.util.object.extend(v.Object.prototype,{_getAngleValueForStraighten:function(){var h=this.angle%360;return h>0?90*Math.round((h-1)/90):90*Math.round(h/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(h){var x=function(){},l=(h=h||{}).onComplete||x,f=h.onChange||x,n=this;return v.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(a){n.rotate(a),f()},onComplete:function(){n.setCoords(),l()}})}}),v.util.object.extend(v.StaticCanvas.prototype,{straightenObject:function(h){return h.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(h){return h.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function h(l,f){var n="precision "+f+` float;
void main(){}`,a=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(a,n),l.compileShader(a),!!l.getShaderParameter(a,l.COMPILE_STATUS)}function x(l){l&&l.tileSize&&(this.tileSize=l.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}v.isWebglSupported=function(l){if(v.isLikelyNode)return!1;l=l||v.WebglFilterBackend.prototype.tileSize;var f=document.createElement("canvas"),n=f.getContext("webgl")||f.getContext("experimental-webgl"),a=!1;if(n){v.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),a=v.maxTextureSize>=l;for(var c=["highp","mediump","lowp"],A=0;A<3;A++)if(h(n,c[A])){v.webGlPrecision=c[A];break}}return this.isSupported=a,a},v.WebglFilterBackend=x,x.prototype={tileSize:2048,resources:{},setupGLContext:function(l,f){this.dispose(),this.createWebGLCanvas(l,f),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(l,f)},chooseFastestCopyGLTo2DMethod:function(l,f){var n,a=window.performance!==void 0;try{new ImageData(1,1),n=!0}catch{n=!1}var c=typeof ArrayBuffer!="undefined",A=typeof Uint8ClampedArray!="undefined";if(a&&n&&c&&A){var E=v.util.createCanvasElement(),d=new ArrayBuffer(l*f*4);if(v.forceGLPutImageData)return this.imageBuffer=d,void(this.copyGLTo2D=je);var p,C,y={imageBuffer:d,destinationWidth:l,destinationHeight:f,targetCanvas:E};E.width=l,E.height=f,p=window.performance.now(),be.call(y,this.gl,y),C=window.performance.now()-p,p=window.performance.now(),je.call(y,this.gl,y),C>window.performance.now()-p?(this.imageBuffer=d,this.copyGLTo2D=je):this.copyGLTo2D=be}},createWebGLCanvas:function(l,f){var n=v.util.createCanvasElement();n.width=l,n.height=f;var a={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},c=n.getContext("webgl",a);c||(c=n.getContext("experimental-webgl",a)),c&&(c.clearColor(0,0,0,0),this.canvas=n,this.gl=c)},applyFilters:function(l,f,n,a,c,A){var E,d=this.gl;A&&(E=this.getCachedTexture(A,f));var p={originalWidth:f.width||f.originalWidth,originalHeight:f.height||f.originalHeight,sourceWidth:n,sourceHeight:a,destinationWidth:n,destinationHeight:a,context:d,sourceTexture:this.createTexture(d,n,a,!E&&f),targetTexture:this.createTexture(d,n,a),originalTexture:E||this.createTexture(d,n,a,!E&&f),passes:l.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:c},C=d.createFramebuffer();return d.bindFramebuffer(d.FRAMEBUFFER,C),l.forEach(function(y){y&&y.applyTo(p)}),function(y){var S=y.targetCanvas,w=S.width,b=S.height,O=y.destinationWidth,N=y.destinationHeight;w===O&&b===N||(S.width=O,S.height=N)}(p),this.copyGLTo2D(d,p),d.bindTexture(d.TEXTURE_2D,null),d.deleteTexture(p.sourceTexture),d.deleteTexture(p.targetTexture),d.deleteFramebuffer(C),c.getContext("2d").setTransform(1,0,0,1,0,0),p},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(l,f,n,a){var c=l.createTexture();return l.bindTexture(l.TEXTURE_2D,c),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),a?l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,a):l.texImage2D(l.TEXTURE_2D,0,l.RGBA,f,n,0,l.RGBA,l.UNSIGNED_BYTE,null),c},getCachedTexture:function(l,f){if(this.textureCache[l])return this.textureCache[l];var n=this.createTexture(this.gl,f.width,f.height,f);return this.textureCache[l]=n,n},evictCachesForKey:function(l){this.textureCache[l]&&(this.gl.deleteTexture(this.textureCache[l]),delete this.textureCache[l])},copyGLTo2D:be,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var l=this.gl,f={renderer:"",vendor:""};if(!l)return f;var n=l.getExtension("WEBGL_debug_renderer_info");if(n){var a=l.getParameter(n.UNMASKED_RENDERER_WEBGL),c=l.getParameter(n.UNMASKED_VENDOR_WEBGL);a&&(f.renderer=a.toLowerCase()),c&&(f.vendor=c.toLowerCase())}return this.gpuInfo=f,f}}}(),function(){var h=function(){};function x(){}v.Canvas2dFilterBackend=x,x.prototype={evictCachesForKey:h,dispose:h,clearWebGLCaches:h,resources:{},applyFilters:function(l,f,n,a,c){var A=c.getContext("2d");A.drawImage(f,0,0,n,a);var E={sourceWidth:n,sourceHeight:a,imageData:A.getImageData(0,0,n,a),originalEl:f,originalImageData:A.getImageData(0,0,n,a),canvasEl:c,ctx:A,filterBackend:this};return l.forEach(function(d){d.applyTo(E)}),E.imageData.width===n&&E.imageData.height===a||(c.width=E.imageData.width,c.height=E.imageData.height),A.putImageData(E.imageData,0,0),E}}}(),v.Image=v.Image||{},v.Image.filters=v.Image.filters||{},v.Image.filters.BaseFilter=v.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(h){h&&this.setOptions(h)},setOptions:function(h){for(var x in h)this[x]=h[x]},createProgram:function(h,x,l){x=x||this.fragmentSource,l=l||this.vertexSource,v.webGlPrecision!=="highp"&&(x=x.replace(/precision highp float/g,"precision "+v.webGlPrecision+" float"));var f=h.createShader(h.VERTEX_SHADER);if(h.shaderSource(f,l),h.compileShader(f),!h.getShaderParameter(f,h.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+h.getShaderInfoLog(f));var n=h.createShader(h.FRAGMENT_SHADER);if(h.shaderSource(n,x),h.compileShader(n),!h.getShaderParameter(n,h.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+h.getShaderInfoLog(n));var a=h.createProgram();if(h.attachShader(a,f),h.attachShader(a,n),h.linkProgram(a),!h.getProgramParameter(a,h.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+h.getProgramInfoLog(a));var c=this.getAttributeLocations(h,a),A=this.getUniformLocations(h,a)||{};return A.uStepW=h.getUniformLocation(a,"uStepW"),A.uStepH=h.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:c,uniformLocations:A}},getAttributeLocations:function(h,x){return{aPosition:h.getAttribLocation(x,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(h,x,l){var f=x.aPosition,n=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,n),h.enableVertexAttribArray(f),h.vertexAttribPointer(f,2,h.FLOAT,!1,0,0),h.bufferData(h.ARRAY_BUFFER,l,h.STATIC_DRAW)},_setupFrameBuffer:function(h){var x,l,f=h.context;h.passes>1?(x=h.destinationWidth,l=h.destinationHeight,h.sourceWidth===x&&h.sourceHeight===l||(f.deleteTexture(h.targetTexture),h.targetTexture=h.filterBackend.createTexture(f,x,l)),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,h.targetTexture,0)):(f.bindFramebuffer(f.FRAMEBUFFER,null),f.finish())},_swapTextures:function(h){h.passes--,h.pass++;var x=h.targetTexture;h.targetTexture=h.sourceTexture,h.sourceTexture=x},isNeutralState:function(){var h=this.mainParameter,x=v.Image.filters[this.type].prototype;if(h){if(Array.isArray(x[h])){for(var l=x[h].length;l--;)if(this[h][l]!==x[h][l])return!1;return!0}return x[h]===this[h]}return!1},applyTo:function(h){h.webgl?(this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h)):this.applyTo2d(h)},retrieveShader:function(h){return h.programCache.hasOwnProperty(this.type)||(h.programCache[this.type]=this.createProgram(h.context)),h.programCache[this.type]},applyToWebGL:function(h){var x=h.context,l=this.retrieveShader(h);h.pass===0&&h.originalTexture?x.bindTexture(x.TEXTURE_2D,h.originalTexture):x.bindTexture(x.TEXTURE_2D,h.sourceTexture),x.useProgram(l.program),this.sendAttributeData(x,l.attributeLocations,h.aPosition),x.uniform1f(l.uniformLocations.uStepW,1/h.sourceWidth),x.uniform1f(l.uniformLocations.uStepH,1/h.sourceHeight),this.sendUniformData(x,l.uniformLocations),x.viewport(0,0,h.destinationWidth,h.destinationHeight),x.drawArrays(x.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(h,x,l){h.activeTexture(l),h.bindTexture(h.TEXTURE_2D,x),h.activeTexture(h.TEXTURE0)},unbindAdditionalTexture:function(h,x){h.activeTexture(x),h.bindTexture(h.TEXTURE_2D,null),h.activeTexture(h.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(h){this[this.mainParameter]=h},sendUniformData:function(){},createHelpLayer:function(h){if(!h.helpLayer){var x=document.createElement("canvas");x.width=h.sourceWidth,x.height=h.sourceHeight,h.helpLayer=x}},toObject:function(){var h={type:this.type},x=this.mainParameter;return x&&(h[x]=this[x]),h},toJSON:function(){return this.toObject()}}),v.Image.filters.BaseFilter.fromObject=function(h,x){var l=new v.Image.filters[h.type](h);return x&&x(l),l},function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.ColorMatrix=f(l.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var a,c,A,E,d,p=n.imageData.data,C=p.length,y=this.matrix,S=this.colorsOnly;for(d=0;d<C;d+=4)a=p[d],c=p[d+1],A=p[d+2],S?(p[d]=a*y[0]+c*y[1]+A*y[2]+255*y[4],p[d+1]=a*y[5]+c*y[6]+A*y[7]+255*y[9],p[d+2]=a*y[10]+c*y[11]+A*y[12]+255*y[14]):(E=p[d+3],p[d]=a*y[0]+c*y[1]+A*y[2]+E*y[3]+255*y[4],p[d+1]=a*y[5]+c*y[6]+A*y[7]+E*y[8]+255*y[9],p[d+2]=a*y[10]+c*y[11]+A*y[12]+E*y[13]+255*y[14],p[d+3]=a*y[15]+c*y[16]+A*y[17]+E*y[18]+255*y[19])},getUniformLocations:function(n,a){return{uColorMatrix:n.getUniformLocation(a,"uColorMatrix"),uConstants:n.getUniformLocation(a,"uConstants")}},sendUniformData:function(n,a){var c=this.matrix,A=[c[0],c[1],c[2],c[3],c[5],c[6],c[7],c[8],c[10],c[11],c[12],c[13],c[15],c[16],c[17],c[18]],E=[c[4],c[9],c[14],c[19]];n.uniformMatrix4fv(a.uColorMatrix,!1,A),n.uniform4fv(a.uConstants,E)}}),x.Image.filters.ColorMatrix.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Brightness=f(l.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var a,c=n.imageData.data,A=c.length,E=Math.round(255*this.brightness);for(a=0;a<A;a+=4)c[a]=c[a]+E,c[a+1]=c[a+1]+E,c[a+2]=c[a+2]+E}},getUniformLocations:function(n,a){return{uBrightness:n.getUniformLocation(a,"uBrightness")}},sendUniformData:function(n,a){n.uniform1f(a.uBrightness,this.brightness)}}),x.Image.filters.Brightness.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.Image.filters,n=x.util.createClass;f.Convolute=n(f.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(a){var c=Math.sqrt(this.matrix.length),A=this.type+"_"+c+"_"+(this.opaque?1:0),E=this.fragmentSource[A];return a.programCache.hasOwnProperty(A)||(a.programCache[A]=this.createProgram(a.context,E)),a.programCache[A]},applyTo2d:function(a){var c,A,E,d,p,C,y,S,w,b,O,N,j,Z=a.imageData,Y=Z.data,W=this.matrix,P=Math.round(Math.sqrt(W.length)),R=Math.floor(P/2),V=Z.width,J=Z.height,q=a.ctx.createImageData(V,J),L=q.data,M=this.opaque?1:0;for(O=0;O<J;O++)for(b=0;b<V;b++){for(p=4*(O*V+b),c=0,A=0,E=0,d=0,j=0;j<P;j++)for(N=0;N<P;N++)C=b+N-R,(y=O+j-R)<0||y>=J||C<0||C>=V||(S=4*(y*V+C),w=W[j*P+N],c+=Y[S]*w,A+=Y[S+1]*w,E+=Y[S+2]*w,M||(d+=Y[S+3]*w));L[p]=c,L[p+1]=A,L[p+2]=E,L[p+3]=M?Y[p+3]:d}a.imageData=q},getUniformLocations:function(a,c){return{uMatrix:a.getUniformLocation(c,"uMatrix"),uOpaque:a.getUniformLocation(c,"uOpaque"),uHalfSize:a.getUniformLocation(c,"uHalfSize"),uSize:a.getUniformLocation(c,"uSize")}},sendUniformData:function(a,c){a.uniform1fv(c.uMatrix,this.matrix)},toObject:function(){return l(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),x.Image.filters.Convolute.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Grayscale=f(l.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var a,c,A=n.imageData.data,E=A.length,d=this.mode;for(a=0;a<E;a+=4)d==="average"?c=(A[a]+A[a+1]+A[a+2])/3:d==="lightness"?c=(Math.min(A[a],A[a+1],A[a+2])+Math.max(A[a],A[a+1],A[a+2]))/2:d==="luminosity"&&(c=.21*A[a]+.72*A[a+1]+.07*A[a+2]),A[a]=c,A[a+1]=c,A[a+2]=c},retrieveShader:function(n){var a=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(a)){var c=this.fragmentSource[this.mode];n.programCache[a]=this.createProgram(n.context,c)}return n.programCache[a]},getUniformLocations:function(n,a){return{uMode:n.getUniformLocation(a,"uMode")}},sendUniformData:function(n,a){n.uniform1i(a.uMode,1)},isNeutralState:function(){return!1}}),x.Image.filters.Grayscale.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Invert=f(l.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var a,c=n.imageData.data,A=c.length;for(a=0;a<A;a+=4)c[a]=255-c[a],c[a+1]=255-c[a+1],c[a+2]=255-c[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,a){return{uInvert:n.getUniformLocation(a,"uInvert")}},sendUniformData:function(n,a){n.uniform1i(a.uInvert,this.invert)}}),x.Image.filters.Invert.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.Image.filters,n=x.util.createClass;f.Noise=n(f.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(a){if(this.noise!==0){var c,A,E=a.imageData.data,d=E.length,p=this.noise;for(c=0,d=E.length;c<d;c+=4)A=(.5-Math.random())*p,E[c]+=A,E[c+1]+=A,E[c+2]+=A}},getUniformLocations:function(a,c){return{uNoise:a.getUniformLocation(c,"uNoise"),uSeed:a.getUniformLocation(c,"uSeed")}},sendUniformData:function(a,c){a.uniform1f(c.uNoise,this.noise/255),a.uniform1f(c.uSeed,Math.random())},toObject:function(){return l(this.callSuper("toObject"),{noise:this.noise})}}),x.Image.filters.Noise.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Pixelate=f(l.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var a,c,A,E,d,p,C,y,S,w,b,O=n.imageData,N=O.data,j=O.height,Z=O.width;for(c=0;c<j;c+=this.blocksize)for(A=0;A<Z;A+=this.blocksize)for(E=N[a=4*c*Z+4*A],d=N[a+1],p=N[a+2],C=N[a+3],w=Math.min(c+this.blocksize,j),b=Math.min(A+this.blocksize,Z),y=c;y<w;y++)for(S=A;S<b;S++)N[a=4*y*Z+4*S]=E,N[a+1]=d,N[a+2]=p,N[a+3]=C},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,a){return{uBlocksize:n.getUniformLocation(a,"uBlocksize"),uStepW:n.getUniformLocation(a,"uStepW"),uStepH:n.getUniformLocation(a,"uStepH")}},sendUniformData:function(n,a){n.uniform1f(a.uBlocksize,this.blocksize)}}),x.Image.filters.Pixelate.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.extend,f=x.Image.filters,n=x.util.createClass;f.RemoveColor=n(f.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(a){var c,A,E,d,p=a.imageData.data,C=255*this.distance,y=new x.Color(this.color).getSource(),S=[y[0]-C,y[1]-C,y[2]-C],w=[y[0]+C,y[1]+C,y[2]+C];for(c=0;c<p.length;c+=4)A=p[c],E=p[c+1],d=p[c+2],A>S[0]&&E>S[1]&&d>S[2]&&A<w[0]&&E<w[1]&&d<w[2]&&(p[c+3]=0)},getUniformLocations:function(a,c){return{uLow:a.getUniformLocation(c,"uLow"),uHigh:a.getUniformLocation(c,"uHigh")}},sendUniformData:function(a,c){var A=new x.Color(this.color).getSource(),E=parseFloat(this.distance),d=[0+A[0]/255-E,0+A[1]/255-E,0+A[2]/255-E,1],p=[A[0]/255+E,A[1]/255+E,A[2]/255+E,1];a.uniform4fv(c.uLow,d),a.uniform4fv(c.uHigh,p)},toObject:function(){return l(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),x.Image.filters.RemoveColor.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var a in n)l[a]=f(l.ColorMatrix,{type:a,matrix:n[a],mainParameter:!1,colorsOnly:!0}),x.Image.filters[a].fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric,l=x.Image.filters,f=x.util.createClass;l.BlendColor=f(l.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var a,c=this.type+"_"+this.mode;return n.programCache.hasOwnProperty(c)||(a=this.buildSource(this.mode),n.programCache[c]=this.createProgram(n.context,a)),n.programCache[c]},applyTo2d:function(n){var a,c,A,E,d,p,C,y=n.imageData.data,S=y.length,w=1-this.alpha;a=(C=new x.Color(this.color).getSource())[0]*this.alpha,c=C[1]*this.alpha,A=C[2]*this.alpha;for(var b=0;b<S;b+=4)switch(E=y[b],d=y[b+1],p=y[b+2],this.mode){case"multiply":y[b]=E*a/255,y[b+1]=d*c/255,y[b+2]=p*A/255;break;case"screen":y[b]=255-(255-E)*(255-a)/255,y[b+1]=255-(255-d)*(255-c)/255,y[b+2]=255-(255-p)*(255-A)/255;break;case"add":y[b]=E+a,y[b+1]=d+c,y[b+2]=p+A;break;case"diff":case"difference":y[b]=Math.abs(E-a),y[b+1]=Math.abs(d-c),y[b+2]=Math.abs(p-A);break;case"subtract":y[b]=E-a,y[b+1]=d-c,y[b+2]=p-A;break;case"darken":y[b]=Math.min(E,a),y[b+1]=Math.min(d,c),y[b+2]=Math.min(p,A);break;case"lighten":y[b]=Math.max(E,a),y[b+1]=Math.max(d,c),y[b+2]=Math.max(p,A);break;case"overlay":y[b]=a<128?2*E*a/255:255-2*(255-E)*(255-a)/255,y[b+1]=c<128?2*d*c/255:255-2*(255-d)*(255-c)/255,y[b+2]=A<128?2*p*A/255:255-2*(255-p)*(255-A)/255;break;case"exclusion":y[b]=a+E-2*a*E/255,y[b+1]=c+d-2*c*d/255,y[b+2]=A+p-2*A*p/255;break;case"tint":y[b]=a+E*w,y[b+1]=c+d*w,y[b+2]=A+p*w}},getUniformLocations:function(n,a){return{uColor:n.getUniformLocation(a,"uColor")}},sendUniformData:function(n,a){var c=new x.Color(this.color).getSource();c[0]=this.alpha*c[0]/255,c[1]=this.alpha*c[1]/255,c[2]=this.alpha*c[2]/255,c[3]=this.alpha,n.uniform4fv(a.uColor,c)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),x.Image.filters.BlendColor.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric,l=x.Image.filters,f=x.util.createClass;l.BlendImage=f(l.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var a=this.type+"_"+this.mode,c=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(a)||(n.programCache[a]=this.createProgram(n.context,c)),n.programCache[a]},applyToWebGL:function(n){var a=n.context,c=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(a,c,a.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(a,a.TEXTURE1)},createTexture:function(n,a){return n.getCachedTexture(a.cacheKey,a._element)},calculateMatrix:function(){var n=this.image,a=n._element.width,c=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/a,-n.top/c,1]},applyTo2d:function(n){var a,c,A,E,d,p,C,y,S,w,b,O=n.imageData,N=n.filterBackend.resources,j=O.data,Z=j.length,Y=O.width,W=O.height,P=this.image;N.blendImage||(N.blendImage=x.util.createCanvasElement()),w=(S=N.blendImage).getContext("2d"),S.width!==Y||S.height!==W?(S.width=Y,S.height=W):w.clearRect(0,0,Y,W),w.setTransform(P.scaleX,0,0,P.scaleY,P.left,P.top),w.drawImage(P._element,0,0,Y,W),b=w.getImageData(0,0,Y,W).data;for(var R=0;R<Z;R+=4)switch(d=j[R],p=j[R+1],C=j[R+2],y=j[R+3],a=b[R],c=b[R+1],A=b[R+2],E=b[R+3],this.mode){case"multiply":j[R]=d*a/255,j[R+1]=p*c/255,j[R+2]=C*A/255,j[R+3]=y*E/255;break;case"mask":j[R+3]=E}},getUniformLocations:function(n,a){return{uTransformMatrix:n.getUniformLocation(a,"uTransformMatrix"),uImage:n.getUniformLocation(a,"uImage")}},sendUniformData:function(n,a){var c=this.calculateMatrix();n.uniform1i(a.uImage,1),n.uniformMatrix3fv(a.uTransformMatrix,!1,c)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),x.Image.filters.BlendImage.fromObject=function(n,a){x.Image.fromObject(n.image,function(c){var A=x.util.object.clone(n);A.image=c,a(new x.Image.filters.BlendImage(A))})}}(e),function(h){var x=h.fabric||(h.fabric={}),l=Math.pow,f=Math.floor,n=Math.sqrt,a=Math.abs,c=Math.round,A=Math.sin,E=Math.ceil,d=x.Image.filters,p=x.util.createClass;d.Resize=p(d.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(C,y){return{uDelta:C.getUniformLocation(y,"uDelta"),uTaps:C.getUniformLocation(y,"uTaps")}},sendUniformData:function(C,y){C.uniform2fv(y.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),C.uniform1fv(y.uTaps,this.taps)},retrieveShader:function(C){var y=this.getFilterWindow(),S=this.type+"_"+y;if(!C.programCache.hasOwnProperty(S)){var w=this.generateShader(y);C.programCache[S]=this.createProgram(C.context,w)}return C.programCache[S]},getFilterWindow:function(){var C=this.tempScale;return Math.ceil(this.lanczosLobes/C)},getTaps:function(){for(var C=this.lanczosCreate(this.lanczosLobes),y=this.tempScale,S=this.getFilterWindow(),w=new Array(S),b=1;b<=S;b++)w[b-1]=C(b*y);return w},generateShader:function(C){for(var y=new Array(C),S=this.fragmentSourceTOP,w=1;w<=C;w++)y[w-1]=w+".0 * uDelta";return S+="uniform float uTaps["+C+`];
`,S+=`void main() {
`,S+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,S+=`  float sum = 1.0;
`,y.forEach(function(b,O){S+="  color += texture2D(uTexture, vTexCoord + "+b+") * uTaps["+O+`];
`,S+="  color += texture2D(uTexture, vTexCoord - "+b+") * uTaps["+O+`];
`,S+="  sum += 2.0 * uTaps["+O+`];
`}),S+=`  gl_FragColor = color / sum;
`,S+="}"},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(C){C.webgl?(C.passes++,this.width=C.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=C.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),C.destinationWidth=this.dW,this._setupFrameBuffer(C),this.applyToWebGL(C),this._swapTextures(C),C.sourceWidth=C.destinationWidth,this.height=C.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),C.destinationHeight=this.dH,this._setupFrameBuffer(C),this.applyToWebGL(C),this._swapTextures(C),C.sourceHeight=C.destinationHeight):this.applyTo2d(C)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(C){return function(y){if(y>=C||y<=-C)return 0;if(y<11920929e-14&&y>-11920929e-14)return 1;var S=(y*=Math.PI)/C;return A(y)/y*A(S)/S}},applyTo2d:function(C){var y=C.imageData,S=this.scaleX,w=this.scaleY;this.rcpScaleX=1/S,this.rcpScaleY=1/w;var b,O=y.width,N=y.height,j=c(O*S),Z=c(N*w);this.resizeType==="sliceHack"?b=this.sliceByTwo(C,O,N,j,Z):this.resizeType==="hermite"?b=this.hermiteFastResize(C,O,N,j,Z):this.resizeType==="bilinear"?b=this.bilinearFiltering(C,O,N,j,Z):this.resizeType==="lanczos"&&(b=this.lanczosResize(C,O,N,j,Z)),C.imageData=b},sliceByTwo:function(C,y,S,w,b){var O,N,j=C.imageData,Z=.5,Y=!1,W=!1,P=y*Z,R=S*Z,V=x.filterBackend.resources,J=0,q=0,L=y,M=0;for(V.sliceByTwo||(V.sliceByTwo=document.createElement("canvas")),((O=V.sliceByTwo).width<1.5*y||O.height<S)&&(O.width=1.5*y,O.height=S),(N=O.getContext("2d")).clearRect(0,0,1.5*y,S),N.putImageData(j,0,0),w=f(w),b=f(b);!Y||!W;)y=P,S=R,w<f(P*Z)?P=f(P*Z):(P=w,Y=!0),b<f(R*Z)?R=f(R*Z):(R=b,W=!0),N.drawImage(O,J,q,y,S,L,M,P,R),J=L,q=M,M+=R;return N.getImageData(J,q,w,b)},lanczosResize:function(C,y,S,w,b){var O=C.imageData.data,N=C.ctx.createImageData(w,b),j=N.data,Z=this.lanczosCreate(this.lanczosLobes),Y=this.rcpScaleX,W=this.rcpScaleY,P=2/this.rcpScaleX,R=2/this.rcpScaleY,V=E(Y*this.lanczosLobes/2),J=E(W*this.lanczosLobes/2),q={},L={},M={};return function G(ee){var z,ie,de,he,se,Ee,ce,pe,_e,Be,Te;for(L.x=(ee+.5)*Y,M.x=f(L.x),z=0;z<b;z++){for(L.y=(z+.5)*W,M.y=f(L.y),se=0,Ee=0,ce=0,pe=0,_e=0,ie=M.x-V;ie<=M.x+V;ie++)if(!(ie<0||ie>=y)){Be=f(1e3*a(ie-L.x)),q[Be]||(q[Be]={});for(var Re=M.y-J;Re<=M.y+J;Re++)Re<0||Re>=S||(Te=f(1e3*a(Re-L.y)),q[Be][Te]||(q[Be][Te]=Z(n(l(Be*P,2)+l(Te*R,2))/1e3)),(de=q[Be][Te])>0&&(se+=de,Ee+=de*O[he=4*(Re*y+ie)],ce+=de*O[he+1],pe+=de*O[he+2],_e+=de*O[he+3]))}j[he=4*(z*w+ee)]=Ee/se,j[he+1]=ce/se,j[he+2]=pe/se,j[he+3]=_e/se}return++ee<w?G(ee):N}(0)},bilinearFiltering:function(C,y,S,w,b){var O,N,j,Z,Y,W,P,R,V,J=0,q=this.rcpScaleX,L=this.rcpScaleY,M=4*(y-1),G=C.imageData.data,ee=C.ctx.createImageData(w,b),z=ee.data;for(j=0;j<b;j++)for(Z=0;Z<w;Z++)for(Y=q*Z-(O=f(q*Z)),W=L*j-(N=f(L*j)),V=4*(N*y+O),P=0;P<4;P++)R=G[V+P]*(1-Y)*(1-W)+G[V+4+P]*Y*(1-W)+G[V+M+P]*W*(1-Y)+G[V+M+4+P]*Y*W,z[J++]=R;return ee},hermiteFastResize:function(C,y,S,w,b){for(var O=this.rcpScaleX,N=this.rcpScaleY,j=E(O/2),Z=E(N/2),Y=C.imageData.data,W=C.ctx.createImageData(w,b),P=W.data,R=0;R<b;R++)for(var V=0;V<w;V++){for(var J=4*(V+R*w),q=0,L=0,M=0,G=0,ee=0,z=0,ie=0,de=(R+.5)*N,he=f(R*N);he<(R+1)*N;he++)for(var se=a(de-(he+.5))/Z,Ee=(V+.5)*O,ce=se*se,pe=f(V*O);pe<(V+1)*O;pe++){var _e=a(Ee-(pe+.5))/j,Be=n(ce+_e*_e);Be>1&&Be<-1||(q=2*Be*Be*Be-3*Be*Be+1)>0&&(ie+=q*Y[3+(_e=4*(pe+he*y))],M+=q,Y[_e+3]<255&&(q=q*Y[_e+3]/250),G+=q*Y[_e],ee+=q*Y[_e+1],z+=q*Y[_e+2],L+=q)}P[J]=G/L,P[J+1]=ee/L,P[J+2]=z/L,P[J+3]=ie/M}return W},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),x.Image.filters.Resize.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Contrast=f(l.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var a,c=n.imageData.data,A=c.length,E=Math.floor(255*this.contrast),d=259*(E+255)/(255*(259-E));for(a=0;a<A;a+=4)c[a]=d*(c[a]-128)+128,c[a+1]=d*(c[a+1]-128)+128,c[a+2]=d*(c[a+2]-128)+128}},getUniformLocations:function(n,a){return{uContrast:n.getUniformLocation(a,"uContrast")}},sendUniformData:function(n,a){n.uniform1f(a.uContrast,this.contrast)}}),x.Image.filters.Contrast.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Saturation=f(l.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var a,c,A=n.imageData.data,E=A.length,d=-this.saturation;for(a=0;a<E;a+=4)c=Math.max(A[a],A[a+1],A[a+2]),A[a]+=c!==A[a]?(c-A[a])*d:0,A[a+1]+=c!==A[a+1]?(c-A[a+1])*d:0,A[a+2]+=c!==A[a+2]?(c-A[a+2])*d:0}},getUniformLocations:function(n,a){return{uSaturation:n.getUniformLocation(a,"uSaturation")}},sendUniformData:function(n,a){n.uniform1f(a.uSaturation,-this.saturation)}}),x.Image.filters.Saturation.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Vibrance=f(l.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var a,c,A,E,d=n.imageData.data,p=d.length,C=-this.vibrance;for(a=0;a<p;a+=4)c=Math.max(d[a],d[a+1],d[a+2]),A=(d[a]+d[a+1]+d[a+2])/3,E=2*Math.abs(c-A)/255*C,d[a]+=c!==d[a]?(c-d[a])*E:0,d[a+1]+=c!==d[a+1]?(c-d[a+1])*E:0,d[a+2]+=c!==d[a+2]?(c-d[a+2])*E:0}},getUniformLocations:function(n,a){return{uVibrance:n.getUniformLocation(a,"uVibrance")}},sendUniformData:function(n,a){n.uniform1f(a.uVibrance,-this.vibrance)}}),x.Image.filters.Vibrance.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Blur=f(l.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var a,c,A=n.filterBackend.resources,E=n.imageData.width,d=n.imageData.height;A.blurLayer1||(A.blurLayer1=x.util.createCanvasElement(),A.blurLayer2=x.util.createCanvasElement()),a=A.blurLayer1,c=A.blurLayer2,a.width===E&&a.height===d||(c.width=a.width=E,c.height=a.height=d);var p,C,y,S,w=a.getContext("2d"),b=c.getContext("2d"),O=.06*this.blur*.5;for(w.putImageData(n.imageData,0,0),b.clearRect(0,0,E,d),S=-15;S<=15;S++)y=O*(C=S/15)*E+(p=(Math.random()-.5)/4),b.globalAlpha=1-Math.abs(C),b.drawImage(a,y,p),w.drawImage(c,0,0),b.globalAlpha=1,b.clearRect(0,0,c.width,c.height);for(S=-15;S<=15;S++)y=O*(C=S/15)*d+(p=(Math.random()-.5)/4),b.globalAlpha=1-Math.abs(C),b.drawImage(a,p,y),w.drawImage(c,0,0),b.globalAlpha=1,b.clearRect(0,0,c.width,c.height);n.ctx.drawImage(a,0,0);var N=n.ctx.getImageData(0,0,a.width,a.height);return w.globalAlpha=1,w.clearRect(0,0,a.width,a.height),N},getUniformLocations:function(n,a){return{delta:n.getUniformLocation(a,"uDelta")}},sendUniformData:function(n,a){var c=this.chooseRightDelta();n.uniform2fv(a.delta,c)},chooseRightDelta:function(){var n,a=1,c=[0,0];return this.horizontal?this.aspectRatio>1&&(a=1/this.aspectRatio):this.aspectRatio<1&&(a=this.aspectRatio),n=a*this.blur*.12,this.horizontal?c[0]=n:c[1]=n,c}}),l.Blur.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Gamma=f(l.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],l.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var a,c=n.imageData.data,A=this.gamma,E=c.length,d=1/A[0],p=1/A[1],C=1/A[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),a=0,E=256;a<E;a++)this.rVals[a]=255*Math.pow(a/255,d),this.gVals[a]=255*Math.pow(a/255,p),this.bVals[a]=255*Math.pow(a/255,C);for(a=0,E=c.length;a<E;a+=4)c[a]=this.rVals[c[a]],c[a+1]=this.gVals[c[a+1]],c[a+2]=this.bVals[c[a+2]]},getUniformLocations:function(n,a){return{uGamma:n.getUniformLocation(a,"uGamma")}},sendUniformData:function(n,a){n.uniform3fv(a.uGamma,this.gamma)}}),x.Image.filters.Gamma.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.Composed=f(l.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(a){a.applyTo(n)})},toObject:function(){return x.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),x.Image.filters.Composed.fromObject=function(n,a){var c=(n.subFilters||[]).map(function(E){return new x.Image.filters[E.type](E)}),A=new x.Image.filters.Composed({subFilters:c});return a&&a(A),A}}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.Image.filters,f=x.util.createClass;l.HueRotation=f(l.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,a=x.util.cos(n),c=x.util.sin(n),A=1/3,E=Math.sqrt(A)*c,d=1-a;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=a+d/3,this.matrix[1]=A*d-E,this.matrix[2]=A*d+E,this.matrix[5]=A*d+E,this.matrix[6]=a+A*d,this.matrix[7]=A*d-E,this.matrix[10]=A*d-E,this.matrix[11]=A*d+E,this.matrix[12]=a+A*d},isNeutralState:function(n){return this.calculateMatrix(),l.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),l.BaseFilter.prototype.applyTo.call(this,n)}}),x.Image.filters.HueRotation.fromObject=x.Image.filters.BaseFilter.fromObject}(e),function(h){var x=h.fabric||(h.fabric={}),l=x.util.object.clone;if(x.Text)x.warn("fabric.Text is already defined");else{var f="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");x.Text=x.util.createClass(x.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:x.Object.prototype.stateProperties.concat(f),cacheProperties:x.Object.prototype.cacheProperties.concat(f),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,a){this.styles=a&&a.styles||{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",a),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=x.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return x._measuringContext||(x._measuringContext=this.canvas&&this.canvas.contextCache||x.util.createCanvasElement().getContext("2d")),x._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,a,c,A,E,d,p,C=0,y=this._textLines.length;C<y;C++)if((this.textAlign==="justify"||C!==y-1&&!this.isEndOfWrapping(C))&&(A=0,E=this._textLines[C],(a=this.getLineWidth(C))<this.width&&(p=this.textLines[C].match(this._reSpacesAndTabs)))){c=p.length,n=(this.width-a)/c;for(var S=0,w=E.length;S<=w;S++)d=this.__charBounds[C][S],this._reSpaceAndTab.test(E[S])?(d.width+=n,d.kernedWidth+=n,d.left+=A,A+=n):d.left+=A}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),a=this.fontSize;return n.width+=a*n.zoomX,n.height+=a*n.zoomY,n},_render:function(n){var a=this.path;a&&!a.isNotVisible()&&a._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,a,c){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom"}n.font=this._getFontDeclaration(a,c)},calcTextWidth:function(){for(var n=this.getLineWidth(0),a=1,c=this._textLines.length;a<c;a++){var A=this.getLineWidth(a);A>n&&(n=A)}return n},_renderTextLine:function(n,a,c,A,E,d){this._renderChars(n,a,c,A,E,d)},_renderTextLinesBackground:function(n){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var a,c,A,E,d,p,C,y=n.fillStyle,S=this._getLeftOffset(),w=this._getTopOffset(),b=0,O=0,N=this.path,j=0,Z=this._textLines.length;j<Z;j++)if(a=this.getHeightOfLine(j),this.textBackgroundColor||this.styleHas("textBackgroundColor",j)){A=this._textLines[j],c=this._getLineLeftOffset(j),O=0,b=0,E=this.getValueOfPropertyAt(j,0,"textBackgroundColor");for(var Y=0,W=A.length;Y<W;Y++)d=this.__charBounds[j][Y],p=this.getValueOfPropertyAt(j,Y,"textBackgroundColor"),N?(n.save(),n.translate(d.renderLeft,d.renderTop),n.rotate(d.angle),n.fillStyle=p,p&&n.fillRect(-d.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),d.width,a/this.lineHeight),n.restore()):p!==E?(C=S+c+b,this.direction==="rtl"&&(C=this.width-C-O),n.fillStyle=E,E&&n.fillRect(C,w,O,a/this.lineHeight),b=d.left,O=d.width,E=p):O+=d.kernedWidth;p&&!N&&(C=S+c+b,this.direction==="rtl"&&(C=this.width-C-O),n.fillStyle=p,n.fillRect(C,w,O,a/this.lineHeight)),w+=a}else w+=a;n.fillStyle=y,this._removeShadow(n)}},getFontCache:function(n){var a=n.fontFamily.toLowerCase();x.charWidthsCache[a]||(x.charWidthsCache[a]={});var c=x.charWidthsCache[a],A=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return c[A]||(c[A]={}),c[A]},_measureChar:function(n,a,c,A){var E,d,p,C,y=this.getFontCache(a),S=c+n,w=this._getFontDeclaration(a)===this._getFontDeclaration(A),b=a.fontSize/this.CACHE_FONT_SIZE;if(c&&y[c]!==void 0&&(p=y[c]),y[n]!==void 0&&(C=E=y[n]),w&&y[S]!==void 0&&(C=(d=y[S])-p),E===void 0||p===void 0||d===void 0){var O=this.getMeasuringContext();this._setTextStyles(O,a,!0)}return E===void 0&&(C=E=O.measureText(n).width,y[n]=E),p===void 0&&w&&c&&(p=O.measureText(c).width,y[c]=p),w&&d===void 0&&(d=O.measureText(S).width,y[S]=d,C=d-p),{width:E*b,kernedWidth:C*b}},getHeightOfChar:function(n,a){return this.getValueOfPropertyAt(n,a,"fontSize")},measureLine:function(n){var a=this._measureLine(n);return this.charSpacing!==0&&(a.width-=this._getWidthOfCharSpacing()),a.width<0&&(a.width=0),a},_measureLine:function(n){var a,c,A,E,d,p,C=0,y=this._textLines[n],S=new Array(y.length),w=0,b=this.path,O=this.pathSide==="right";for(this.__charBounds[n]=S,a=0;a<y.length;a++)c=y[a],E=this._getGraphemeBox(c,n,a,A),S[a]=E,C+=E.kernedWidth,A=c;if(S[a]={left:E?E.left+E.width:0,width:0,kernedWidth:0,height:this.fontSize},b){switch(p=b.segmentsInfo[b.segmentsInfo.length-1].length,(d=x.util.getPointOnPath(b.path,0,b.segmentsInfo)).x+=b.pathOffset.x,d.y+=b.pathOffset.y,this.textAlign){case"left":w=O?p-C:0;break;case"center":w=(p-C)/2;break;case"right":w=O?0:p-C}for(w+=this.pathStartOffset*(O?-1:1),a=O?y.length-1:0;O?a>=0:a<y.length;O?a--:a++)E=S[a],w>p?w%=p:w<0&&(w+=p),this._setGraphemeOnPath(w,E,d),w+=E.kernedWidth}return{width:C,numOfSpaces:0}},_setGraphemeOnPath:function(n,a,c){var A=n+a.kernedWidth/2,E=this.path,d=x.util.getPointOnPath(E.path,A,E.segmentsInfo);a.renderLeft=d.x-c.x,a.renderTop=d.y-c.y,a.angle=d.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,a,c,A,E){var d,p=this.getCompleteStyleDeclaration(a,c),C=A?this.getCompleteStyleDeclaration(a,c-1):{},y=this._measureChar(n,p,A,C),S=y.kernedWidth,w=y.width;this.charSpacing!==0&&(w+=d=this._getWidthOfCharSpacing(),S+=d);var b={width:w,left:0,height:p.fontSize,kernedWidth:S,deltaY:p.deltaY};if(c>0&&!E){var O=this.__charBounds[a][c-1];b.left=O.left+O.width+y.kernedWidth-y.width}return b},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var a=this._textLines[n],c=this.getHeightOfChar(n,0),A=1,E=a.length;A<E;A++)c=Math.max(this.getHeightOfChar(n,A),c);return this.__lineHeights[n]=c*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,a=0,c=0,A=this._textLines.length;c<A;c++)n=this.getHeightOfLine(c),a+=c===A-1?n/this.lineHeight:n;return a},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,a){n.save();for(var c=0,A=this._getLeftOffset(),E=this._getTopOffset(),d=0,p=this._textLines.length;d<p;d++){var C=this.getHeightOfLine(d),y=C/this.lineHeight,S=this._getLineLeftOffset(d);this._renderTextLine(a,n,this._textLines[d],A+S,E+c+y,d),c+=C}n.restore()},_renderTextFill:function(n){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,a,c,A,E,d){var p,C,y,S,w,b=this.getHeightOfLine(d),O=this.textAlign.indexOf("justify")!==-1,N="",j=0,Z=this.path,Y=!O&&this.charSpacing===0&&this.isEmptyStyles(d)&&!Z,W=this.direction==="ltr",P=this.direction==="ltr"?1:-1,R=a.canvas.getAttribute("dir");if(a.save(),R!==this.direction&&(a.canvas.setAttribute("dir",W?"ltr":"rtl"),a.direction=W?"ltr":"rtl",a.textAlign=W?"left":"right"),E-=b*this._fontSizeFraction/this.lineHeight,Y)return this._renderChar(n,a,d,0,c.join(""),A,E,b),void a.restore();for(var V=0,J=c.length-1;V<=J;V++)S=V===J||this.charSpacing||Z,N+=c[V],y=this.__charBounds[d][V],j===0?(A+=P*(y.kernedWidth-y.width),j+=y.width):j+=y.kernedWidth,O&&!S&&this._reSpaceAndTab.test(c[V])&&(S=!0),S||(p=p||this.getCompleteStyleDeclaration(d,V),C=this.getCompleteStyleDeclaration(d,V+1),S=this._hasStyleChanged(p,C)),S&&(Z?(a.save(),a.translate(y.renderLeft,y.renderTop),a.rotate(y.angle),this._renderChar(n,a,d,V,N,-j/2,0,b),a.restore()):(w=A,this._renderChar(n,a,d,V,N,w,E,b)),N="",p=C,A+=P*j,j=0);a.restore()},_applyPatternGradientTransformText:function(n){var a,c=x.util.createCanvasElement(),A=this.width+this.strokeWidth,E=this.height+this.strokeWidth;return c.width=A,c.height=E,(a=c.getContext("2d")).beginPath(),a.moveTo(0,0),a.lineTo(A,0),a.lineTo(A,E),a.lineTo(0,E),a.closePath(),a.translate(A/2,E/2),a.fillStyle=n.toLive(a),this._applyPatternGradientTransform(a,n),a.fill(),a.createPattern(c,"no-repeat")},handleFiller:function(n,a,c){var A,E;return c.toLive?c.gradientUnits==="percentage"||c.gradientTransform||c.patternTransform?(A=-this.width/2,E=-this.height/2,n.translate(A,E),n[a]=this._applyPatternGradientTransformText(c),{offsetX:A,offsetY:E}):(n[a]=c.toLive(n,this),this._applyPatternGradientTransform(n,c)):(n[a]=c,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,a){return n.lineWidth=a.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",a.stroke)},_setFillStyles:function(n,a){return this.handleFiller(n,"fillStyle",a.fill)},_renderChar:function(n,a,c,A,E,d,p){var C,y,S=this._getStyleDeclaration(c,A),w=this.getCompleteStyleDeclaration(c,A),b=n==="fillText"&&w.fill,O=n==="strokeText"&&w.stroke&&w.strokeWidth;(O||b)&&(a.save(),b&&(C=this._setFillStyles(a,w)),O&&(y=this._setStrokeStyles(a,w)),a.font=this._getFontDeclaration(w),S&&S.textBackgroundColor&&this._removeShadow(a),S&&S.deltaY&&(p+=S.deltaY),b&&a.fillText(E,d-C.offsetX,p-C.offsetY),O&&a.strokeText(E,d-y.offsetX,p-y.offsetY),a.restore())},setSuperscript:function(n,a){return this._setScript(n,a,this.superscript)},setSubscript:function(n,a){return this._setScript(n,a,this.subscript)},_setScript:function(n,a,c){var A=this.get2DCursorLocation(n,!0),E=this.getValueOfPropertyAt(A.lineIndex,A.charIndex,"fontSize"),d=this.getValueOfPropertyAt(A.lineIndex,A.charIndex,"deltaY"),p={fontSize:E*c.size,deltaY:d+E*c.baseline};return this.setSelectionStyles(p,n,a),this},_hasStyleChanged:function(n,a){return n.fill!==a.fill||n.stroke!==a.stroke||n.strokeWidth!==a.strokeWidth||n.fontSize!==a.fontSize||n.fontFamily!==a.fontFamily||n.fontWeight!==a.fontWeight||n.fontStyle!==a.fontStyle||n.deltaY!==a.deltaY},_hasStyleChangedForSvg:function(n,a){return this._hasStyleChanged(n,a)||n.overline!==a.overline||n.underline!==a.underline||n.linethrough!==a.linethrough},_getLineLeftOffset:function(n){var a=this.getLineWidth(n),c=this.width-a,A=this.textAlign,E=this.direction,d=0,p=this.isEndOfWrapping(n);return A==="justify"||A==="justify-center"&&!p||A==="justify-right"&&!p||A==="justify-left"&&!p?0:(A==="center"&&(d=c/2),A==="right"&&(d=c),A==="justify-center"&&(d=c/2),A==="justify-right"&&(d=c),E==="rtl"&&(d-=c),d)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var a=this.measureLine(n).width;return this.__lineWidths[n]=a,a},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,a,c){var A=this._getStyleDeclaration(n,a);return A&&A[c]!==void 0?A[c]:this[c]},_renderTextDecoration:function(n,a){if(this[a]||this.styleHas(a)){for(var c,A,E,d,p,C,y,S,w,b,O,N,j,Z,Y,W,P=this._getLeftOffset(),R=this._getTopOffset(),V=this.path,J=this._getWidthOfCharSpacing(),q=this.offsets[a],L=0,M=this._textLines.length;L<M;L++)if(c=this.getHeightOfLine(L),this[a]||this.styleHas(a,L)){y=this._textLines[L],Z=c/this.lineHeight,d=this._getLineLeftOffset(L),b=0,O=0,S=this.getValueOfPropertyAt(L,0,a),W=this.getValueOfPropertyAt(L,0,"fill"),w=R+Z*(1-this._fontSizeFraction),A=this.getHeightOfChar(L,0),p=this.getValueOfPropertyAt(L,0,"deltaY");for(var G=0,ee=y.length;G<ee;G++)if(N=this.__charBounds[L][G],j=this.getValueOfPropertyAt(L,G,a),Y=this.getValueOfPropertyAt(L,G,"fill"),E=this.getHeightOfChar(L,G),C=this.getValueOfPropertyAt(L,G,"deltaY"),V&&j&&Y)n.save(),n.fillStyle=W,n.translate(N.renderLeft,N.renderTop),n.rotate(N.angle),n.fillRect(-N.kernedWidth/2,q*E+C,N.kernedWidth,this.fontSize/15),n.restore();else if((j!==S||Y!==W||E!==A||C!==p)&&O>0){var z=P+d+b;this.direction==="rtl"&&(z=this.width-z-O),S&&W&&(n.fillStyle=W,n.fillRect(z,w+q*A+p,O,this.fontSize/15)),b=N.left,O=N.width,S=j,W=Y,A=E,p=C}else O+=N.kernedWidth;z=P+d+b,this.direction==="rtl"&&(z=this.width-z-O),n.fillStyle=Y,j&&Y&&n.fillRect(z,w+q*A+p,O-J,this.fontSize/15),R+=c}else R+=c;this._removeShadow(n)}},_getFontDeclaration:function(n,a){var c=n||this,A=this.fontFamily,E=x.Text.genericFonts.indexOf(A.toLowerCase())>-1,d=A===void 0||A.indexOf("'")>-1||A.indexOf(",")>-1||A.indexOf('"')>-1||E?c.fontFamily:'"'+c.fontFamily+'"';return[x.isLikelyNode?c.fontWeight:c.fontStyle,x.isLikelyNode?c.fontStyle:c.fontWeight,a?this.CACHE_FONT_SIZE+"px":c.fontSize+"px",d].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var a=n.split(this._reNewline),c=new Array(a.length),A=[`
`],E=[],d=0;d<a.length;d++)c[d]=x.util.string.graphemeSplit(a[d]),E=E.concat(c[d],A);return E.pop(),{_unwrappedLines:c,lines:a,graphemeText:E,graphemeLines:c}},toObject:function(n){var a=f.concat(n),c=this.callSuper("toObject",a);return c.styles=l(this.styles,!0),c.path&&(c.path=this.path.toObject()),c},set:function(n,a){this.callSuper("set",n,a);var c=!1,A=!1;if(typeof n=="object")for(var E in n)E==="path"&&this.setPathInfo(),c=c||this._dimensionAffectingProps.indexOf(E)!==-1,A=A||E==="path";else c=this._dimensionAffectingProps.indexOf(n)!==-1,A=n==="path";return A&&this.setPathInfo(),c&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),x.Text.ATTRIBUTE_NAMES=x.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),x.Text.DEFAULT_SVG_FONT_SIZE=16,x.Text.fromElement=function(n,a,c){if(!n)return a(null);var A=x.parseAttributes(n,x.Text.ATTRIBUTE_NAMES),E=A.textAnchor||"left";if((c=x.util.object.extend(c?l(c):{},A)).top=c.top||0,c.left=c.left||0,A.textDecoration){var d=A.textDecoration;d.indexOf("underline")!==-1&&(c.underline=!0),d.indexOf("overline")!==-1&&(c.overline=!0),d.indexOf("line-through")!==-1&&(c.linethrough=!0),delete c.textDecoration}"dx"in A&&(c.left+=A.dx),"dy"in A&&(c.top+=A.dy),"fontSize"in c||(c.fontSize=x.Text.DEFAULT_SVG_FONT_SIZE);var p="";"textContent"in n?p=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(p=n.firstChild.data),p=p.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var C=c.strokeWidth;c.strokeWidth=0;var y=new x.Text(p,c),S=y.getScaledHeight()/y.height,w=((y.height+y.strokeWidth)*y.lineHeight-y.height)*S,b=y.getScaledHeight()+w,O=0;E==="center"&&(O=y.getScaledWidth()/2),E==="right"&&(O=y.getScaledWidth()),y.set({left:y.left-O,top:y.top-(b-y.fontSize*(.07+y._fontSizeFraction))/y.lineHeight,strokeWidth:C!==void 0?C:1}),a(y)},x.Text.fromObject=function(n,a){var c=l(n),A=n.path;return delete c.path,x.Object._fromObject("Text",c,function(E){A?x.Object._fromObject("Path",A,function(d){E.set("path",d),a(E)},"path"):a(E)},"text")},x.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],x.util.createAccessors&&x.util.createAccessors(x.Text)}}(e),v.util.object.extend(v.Text.prototype,{isEmptyStyles:function(h){if(!this.styles||h!==void 0&&!this.styles[h])return!0;var x=h===void 0?this.styles:{line:this.styles[h]};for(var l in x)for(var f in x[l])for(var n in x[l][f])return!1;return!0},styleHas:function(h,x){if(!this.styles||!h||h===""||x!==void 0&&!this.styles[x])return!1;var l=x===void 0?this.styles:{0:this.styles[x]};for(var f in l)for(var n in l[f])if(l[f][n][h]!==void 0)return!0;return!1},cleanStyle:function(h){if(!this.styles||!h||h==="")return!1;var x,l,f=this.styles,n=0,a=!0,c=0;for(var A in f){for(var E in x=0,f[A]){var d;n++,(d=f[A][E]).hasOwnProperty(h)?(l?d[h]!==l&&(a=!1):l=d[h],d[h]===this[h]&&delete d[h]):a=!1,Object.keys(d).length!==0?x++:delete f[A][E]}x===0&&delete f[A]}for(var p=0;p<this._textLines.length;p++)c+=this._textLines[p].length;a&&n===c&&(this[h]=l,this.removeStyle(h))},removeStyle:function(h){if(this.styles&&h&&h!==""){var x,l,f,n=this.styles;for(l in n){for(f in x=n[l])delete x[f][h],Object.keys(x[f]).length===0&&delete x[f];Object.keys(x).length===0&&delete n[l]}}},_extendStyles:function(h,x){var l=this.get2DCursorLocation(h);this._getLineStyle(l.lineIndex)||this._setLineStyle(l.lineIndex),this._getStyleDeclaration(l.lineIndex,l.charIndex)||this._setStyleDeclaration(l.lineIndex,l.charIndex,{}),v.util.object.extend(this._getStyleDeclaration(l.lineIndex,l.charIndex),x)},get2DCursorLocation:function(h,x){h===void 0&&(h=this.selectionStart);for(var l=x?this._unwrappedTextLines:this._textLines,f=l.length,n=0;n<f;n++){if(h<=l[n].length)return{lineIndex:n,charIndex:h};h-=l[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:l[n-1].length<h?l[n-1].length:h}},getSelectionStyles:function(h,x,l){h===void 0&&(h=this.selectionStart||0),x===void 0&&(x=this.selectionEnd||h);for(var f=[],n=h;n<x;n++)f.push(this.getStyleAtPosition(n,l));return f},getStyleAtPosition:function(h,x){var l=this.get2DCursorLocation(h);return(x?this.getCompleteStyleDeclaration(l.lineIndex,l.charIndex):this._getStyleDeclaration(l.lineIndex,l.charIndex))||{}},setSelectionStyles:function(h,x,l){x===void 0&&(x=this.selectionStart||0),l===void 0&&(l=this.selectionEnd||x);for(var f=x;f<l;f++)this._extendStyles(f,h);return this._forceClearCache=!0,this},_getStyleDeclaration:function(h,x){var l=this.styles&&this.styles[h];return l?l[x]:null},getCompleteStyleDeclaration:function(h,x){for(var l,f=this._getStyleDeclaration(h,x)||{},n={},a=0;a<this._styleProperties.length;a++)n[l=this._styleProperties[a]]=f[l]===void 0?this[l]:f[l];return n},_setStyleDeclaration:function(h,x,l){this.styles[h][x]=l},_deleteStyleDeclaration:function(h,x){delete this.styles[h][x]},_getLineStyle:function(h){return!!this.styles[h]},_setLineStyle:function(h){this.styles[h]={}},_deleteLineStyle:function(h){delete this.styles[h]}}),function(){function h(x){x.textDecoration&&(x.textDecoration.indexOf("underline")>-1&&(x.underline=!0),x.textDecoration.indexOf("line-through")>-1&&(x.linethrough=!0),x.textDecoration.indexOf("overline")>-1&&(x.overline=!0),delete x.textDecoration)}v.IText=v.util.createClass(v.Text,v.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(x,l){this.callSuper("initialize",x,l),this.initBehavior()},setSelectionStart:function(x){x=Math.max(x,0),this._updateAndFire("selectionStart",x)},setSelectionEnd:function(x){x=Math.min(x,this.text.length),this._updateAndFire("selectionEnd",x)},_updateAndFire:function(x,l){this[x]!==l&&(this._fireSelectionChanged(),this[x]=l),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(x){this.clearContextTop(),this.callSuper("render",x),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(x){this.callSuper("_render",x)},clearContextTop:function(x){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var l=this.canvas.contextTop,f=this.canvas.viewportTransform;l.save(),l.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this.transform(l),this._clearTextArea(l),x||l.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var x=this._getCursorBoundaries(),l=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(x,l):this.renderSelection(x,l),l.restore()}},_clearTextArea:function(x){var l=this.width+4,f=this.height+4;x.clearRect(-l/2,-f/2,l,f)},_getCursorBoundaries:function(x){x===void 0&&(x=this.selectionStart);var l=this._getLeftOffset(),f=this._getTopOffset(),n=this._getCursorBoundariesOffsets(x);return{left:l,top:f,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(x){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var l,f,n,a,c=0,A=0,E=this.get2DCursorLocation(x);n=E.charIndex,f=E.lineIndex;for(var d=0;d<f;d++)c+=this.getHeightOfLine(d);l=this._getLineLeftOffset(f);var p=this.__charBounds[f][n];return p&&(A=p.left),this.charSpacing!==0&&n===this._textLines[f].length&&(A-=this._getWidthOfCharSpacing()),a={top:c,left:l+(A>0?A:0)},this.direction==="rtl"&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(x,l){var f=this.get2DCursorLocation(),n=f.lineIndex,a=f.charIndex>0?f.charIndex-1:0,c=this.getValueOfPropertyAt(n,a,"fontSize"),A=this.scaleX*this.canvas.getZoom(),E=this.cursorWidth/A,d=x.topOffset,p=this.getValueOfPropertyAt(n,a,"deltaY");d+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-c*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(x,l),l.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,a,"fill"),l.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,l.fillRect(x.left+x.leftOffset-E/2,d+x.top+p,E,c)},renderSelection:function(x,l){for(var f=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,a=this.textAlign.indexOf("justify")!==-1,c=this.get2DCursorLocation(f),A=this.get2DCursorLocation(n),E=c.lineIndex,d=A.lineIndex,p=c.charIndex<0?0:c.charIndex,C=A.charIndex<0?0:A.charIndex,y=E;y<=d;y++){var S,w=this._getLineLeftOffset(y)||0,b=this.getHeightOfLine(y),O=0,N=0;if(y===E&&(O=this.__charBounds[E][p].left),y>=E&&y<d)N=a&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===d)if(C===0)N=this.__charBounds[d][C].left;else{var j=this._getWidthOfCharSpacing();N=this.__charBounds[d][C-1].left+this.__charBounds[d][C-1].width-j}S=b,(this.lineHeight<1||y===d&&this.lineHeight>1)&&(b/=this.lineHeight);var Z=x.left+w+O,Y=N-O,W=b,P=0;this.inCompositionMode?(l.fillStyle=this.compositionColor||"black",W=1,P=b):l.fillStyle=this.selectionColor,this.direction==="rtl"&&(Z=this.width-Z-Y),l.fillRect(Z,x.top+x.topOffset+P,Y,W),x.topOffset+=S}},getCurrentCharFontSize:function(){var x=this._getCurrentCharIndex();return this.getValueOfPropertyAt(x.l,x.c,"fontSize")},getCurrentCharColor:function(){var x=this._getCurrentCharIndex();return this.getValueOfPropertyAt(x.l,x.c,"fill")},_getCurrentCharIndex:function(){var x=this.get2DCursorLocation(this.selectionStart,!0),l=x.charIndex>0?x.charIndex-1:0;return{l:x.lineIndex,c:l}}}),v.IText.fromObject=function(x,l){if(h(x),x.styles)for(var f in x.styles)for(var n in x.styles[f])h(x.styles[f][n]);v.Object._fromObject("IText",x,l,"text")}}(),Ae=v.util.object.clone,v.util.object.extend(v.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var h=this;this.on("added",function(){var x=h.canvas;x&&(x._hasITextHandlers||(x._hasITextHandlers=!0,h._initCanvasHandlers(x)),x._iTextInstances=x._iTextInstances||[],x._iTextInstances.push(h))})},initRemovedHandler:function(){var h=this;this.on("removed",function(){var x=h.canvas;x&&(x._iTextInstances=x._iTextInstances||[],v.util.removeFromArray(x._iTextInstances,h),x._iTextInstances.length===0&&(x._hasITextHandlers=!1,h._removeCanvasHandlers(x)))})},_initCanvasHandlers:function(h){h._mouseUpITextHandler=function(){h._iTextInstances&&h._iTextInstances.forEach(function(x){x.__isMousedown=!1})},h.on("mouse:up",h._mouseUpITextHandler)},_removeCanvasHandlers:function(h){h.off("mouse:up",h._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(h,x,l,f){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},h.animate("_currentCursorOpacity",x,{duration:l,onComplete:function(){n.isAborted||h[f]()},onChange:function(){h.canvas&&h.selectionStart===h.selectionEnd&&h.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var h=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){h._currentTickCompleteState=h._animateCursor(h,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(h){var x=this,l=h?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){x._tick()},l)},abortCursorAnimation:function(){var h=this._currentTickState||this._currentTickCompleteState,x=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,h&&x&&x.clearContext(x.contextTop||x.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(h){var x=0,l=h-1;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)x++,l--;for(;/\S/.test(this._text[l])&&l>-1;)x++,l--;return h-x},findWordBoundaryRight:function(h){var x=0,l=h;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)x++,l++;for(;/\S/.test(this._text[l])&&l<this._text.length;)x++,l++;return h+x},findLineBoundaryLeft:function(h){for(var x=0,l=h-1;!/\n/.test(this._text[l])&&l>-1;)x++,l--;return h-x},findLineBoundaryRight:function(h){for(var x=0,l=h;!/\n/.test(this._text[l])&&l<this._text.length;)x++,l++;return h+x},searchWordBoundary:function(h,x){for(var l=this._text,f=this._reSpace.test(l[h])?h-1:h,n=l[f],a=v.reNonWord;!a.test(n)&&f>0&&f<l.length;)n=l[f+=x];return a.test(n)&&(f+=x===1?0:1),f},selectWord:function(h){h=h||this.selectionStart;var x=this.searchWordBoundary(h,-1),l=this.searchWordBoundary(h,1);this.selectionStart=x,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(h){h=h||this.selectionStart;var x=this.findLineBoundaryLeft(h),l=this.findLineBoundaryRight(h);return this.selectionStart=x,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(h){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(h),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(h){h._iTextInstances&&h._iTextInstances.forEach(function(x){x.selected=!1,x.isEditing&&x.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(h){if(this.__isMousedown&&this.isEditing){var x=this.getSelectionStartFromPointer(h.e),l=this.selectionStart,f=this.selectionEnd;(x===this.__selectionStartOnMouseDown&&l!==f||l!==x&&f!==x)&&(x>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=x):(this.selectionStart=x,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===l&&this.selectionEnd===f||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(h,x,l){var f=l.slice(0,h),n=v.util.string.graphemeSplit(f).length;if(h===x)return{selectionStart:n,selectionEnd:n};var a=l.slice(h,x);return{selectionStart:n,selectionEnd:n+v.util.string.graphemeSplit(a).length}},fromGraphemeToStringSelection:function(h,x,l){var f=l.slice(0,h).join("").length;return h===x?{selectionStart:f,selectionEnd:f}:{selectionStart:f,selectionEnd:f+l.slice(h,x).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var h=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=h.selectionStart,this.hiddenTextarea.selectionEnd=h.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var h=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=h.selectionEnd,this.inCompositionMode||(this.selectionStart=h.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var h=this._calcTextareaPosition();this.hiddenTextarea.style.left=h.left,this.hiddenTextarea.style.top=h.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var h=this.inCompositionMode?this.compositionStart:this.selectionStart,x=this._getCursorBoundaries(h),l=this.get2DCursorLocation(h),f=l.lineIndex,n=l.charIndex,a=this.getValueOfPropertyAt(f,n,"fontSize")*this.lineHeight,c=x.leftOffset,A=this.calcTransformMatrix(),E={x:x.left+c,y:x.top+x.topOffset+a},d=this.canvas.getRetinaScaling(),p=this.canvas.upperCanvasEl,C=p.width/d,y=p.height/d,S=C-a,w=y-a,b=p.clientWidth/C,O=p.clientHeight/y;return E=v.util.transformPoint(E,A),(E=v.util.transformPoint(E,this.canvas.viewportTransform)).x*=b,E.y*=O,E.x<0&&(E.x=0),E.x>S&&(E.x=S),E.y<0&&(E.y=0),E.y>w&&(E.y=w),E.x+=this.canvas._offset.left,E.y+=this.canvas._offset.top,{left:E.x+"px",top:E.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var h=this._textBeforeEdit!==this.text,x=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,x&&(x.blur&&x.blur(),x.parentNode&&x.parentNode.removeChild(x)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),h&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),h&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var h in this.styles)this._textLines[h]||delete this.styles[h]},removeStyleFromTo:function(h,x){var l,f,n=this.get2DCursorLocation(h,!0),a=this.get2DCursorLocation(x,!0),c=n.lineIndex,A=n.charIndex,E=a.lineIndex,d=a.charIndex;if(c!==E){if(this.styles[c])for(l=A;l<this._unwrappedTextLines[c].length;l++)delete this.styles[c][l];if(this.styles[E])for(l=d;l<this._unwrappedTextLines[E].length;l++)(f=this.styles[E][l])&&(this.styles[c]||(this.styles[c]={}),this.styles[c][A+l-d]=f);for(l=c+1;l<=E;l++)delete this.styles[l];this.shiftLineStyles(E,c-E)}else if(this.styles[c]){f=this.styles[c];var p,C,y=d-A;for(l=A;l<d;l++)delete f[l];for(C in this.styles[c])(p=parseInt(C,10))>=d&&(f[p-y]=f[C],delete f[C])}},shiftLineStyles:function(h,x){var l=Ae(this.styles);for(var f in this.styles){var n=parseInt(f,10);n>h&&(this.styles[n+x]=l[n],l[n-x]||delete this.styles[n])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(h,x,l,f){var n,a={},c=!1,A=this._unwrappedTextLines[h].length===x;for(var E in l||(l=1),this.shiftLineStyles(h,l),this.styles[h]&&(n=this.styles[h][x===0?x:x-1]),this.styles[h]){var d=parseInt(E,10);d>=x&&(c=!0,a[d-x]=this.styles[h][E],A&&x===0||delete this.styles[h][E])}var p=!1;for(c&&!A&&(this.styles[h+l]=a,p=!0),p&&l--;l>0;)f&&f[l-1]?this.styles[h+l]={0:Ae(f[l-1])}:n?this.styles[h+l]={0:Ae(n)}:delete this.styles[h+l],l--;this._forceClearCache=!0},insertCharStyleObject:function(h,x,l,f){this.styles||(this.styles={});var n=this.styles[h],a=n?Ae(n):{};for(var c in l||(l=1),a){var A=parseInt(c,10);A>=x&&(n[A+l]=a[A],a[A-l]||delete n[A])}if(this._forceClearCache=!0,f)for(;l--;)Object.keys(f[l]).length&&(this.styles[h]||(this.styles[h]={}),this.styles[h][x+l]=Ae(f[l]));else if(n)for(var E=n[x?x-1:1];E&&l--;)this.styles[h][x+l]=Ae(E)},insertNewStyleBlock:function(h,x,l){for(var f=this.get2DCursorLocation(x,!0),n=[0],a=0,c=0;c<h.length;c++)h[c]===`
`?n[++a]=0:n[a]++;for(n[0]>0&&(this.insertCharStyleObject(f.lineIndex,f.charIndex,n[0],l),l=l&&l.slice(n[0]+1)),a&&this.insertNewlineStyleObject(f.lineIndex,f.charIndex+n[0],a),c=1;c<a;c++)n[c]>0?this.insertCharStyleObject(f.lineIndex+c,0,n[c],l):l&&this.styles[f.lineIndex+c]&&l[0]&&(this.styles[f.lineIndex+c][0]=l[0]),l=l&&l.slice(n[c]+1);n[c]>0&&this.insertCharStyleObject(f.lineIndex+c,0,n[c],l)},setSelectionStartEndWithShift:function(h,x,l){l<=h?(x===h?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=h),this.selectionStart=l):l>h&&l<x?this._selectionDirection==="right"?this.selectionEnd=l:this.selectionStart=l:(x===h?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=x),this.selectionEnd=l)},setSelectionInBoundaries:function(){var h=this.text.length;this.selectionStart>h?this.selectionStart=h:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>h?this.selectionEnd=h:this.selectionEnd<0&&(this.selectionEnd=0)}}),v.util.object.extend(v.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(h){if(this.canvas){this.__newClickTime=+new Date;var x=h.pointer;this.isTripleClick(x)&&(this.fire("tripleclick",h),this._stopEvent(h.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=x,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(h){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===h.x&&this.__lastPointer.y===h.y},_stopEvent:function(h){h.preventDefault&&h.preventDefault(),h.stopPropagation&&h.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(h){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(h.e))},tripleClickHandler:function(h){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(h.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(h.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(h){if(this.__isMousedown=!1,!(!this.editable||this.group||h.transform&&h.transform.actionPerformed||h.e.button&&h.e.button!==1)){if(this.canvas){var x=this.canvas._activeObject;if(x&&x!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(h.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(h){var x=this.getSelectionStartFromPointer(h),l=this.selectionStart,f=this.selectionEnd;h.shiftKey?this.setSelectionStartEndWithShift(l,f,x):(this.selectionStart=x,this.selectionEnd=x),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(h){for(var x,l=this.getLocalPointer(h),f=0,n=0,a=0,c=0,A=0,E=0,d=this._textLines.length;E<d&&a<=l.y;E++)a+=this.getHeightOfLine(E)*this.scaleY,A=E,E>0&&(c+=this._textLines[E-1].length+this.missingNewlineOffset(E-1));n=this._getLineLeftOffset(A)*this.scaleX,x=this._textLines[A],this.direction==="rtl"&&(l.x=this.width*this.scaleX-l.x+n);for(var p=0,C=x.length;p<C&&(f=n,(n+=this.__charBounds[A][p].kernedWidth*this.scaleX)<=l.x);p++)c++;return this._getNewSelectionStartFromOffset(l,f,n,c,C)},_getNewSelectionStartFromOffset:function(h,x,l,f,n){var a=h.x-x,c=l-h.x,A=f+(c>a||c<0?0:1);return this.flipX&&(A=n-A),A>this._text.length&&(A=this._text.length),A}}),v.util.object.extend(v.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=v.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var h=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+h.top+"; left: "+h.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+h.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):v.document.body.appendChild(this.hiddenTextarea),v.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),v.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),v.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),v.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),v.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),v.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),v.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),v.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),v.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(v.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(h){if(this.isEditing){var x=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(h.keyCode in x)this[x[h.keyCode]](h);else{if(!(h.keyCode in this.ctrlKeysMapDown)||!h.ctrlKey&&!h.metaKey)return;this[this.ctrlKeysMapDown[h.keyCode]](h)}h.stopImmediatePropagation(),h.preventDefault(),h.keyCode>=33&&h.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(h){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:h.keyCode in this.ctrlKeysMapUp&&(h.ctrlKey||h.metaKey)&&(this[this.ctrlKeysMapUp[h.keyCode]](h),h.stopImmediatePropagation(),h.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(h){var x=this.fromPaste;if(this.fromPaste=!1,h&&h.stopPropagation(),this.isEditing){var l,f,n,a,c,A=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,E=this._text.length,d=A.length,p=d-E,C=this.selectionStart,y=this.selectionEnd,S=C!==y;if(this.hiddenTextarea.value==="")return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var w=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),b=C>w.selectionStart;S?(l=this._text.slice(C,y),p+=y-C):d<E&&(l=b?this._text.slice(y+p,y):this._text.slice(C,C-p)),f=A.slice(w.selectionEnd-p,w.selectionEnd),l&&l.length&&(f.length&&(n=this.getSelectionStyles(C,C+1,!1),n=f.map(function(){return n[0]})),S?(a=C,c=y):b?(a=y-l.length,c=y):(a=y,c=y+l.length),this.removeStyleFromTo(a,c)),f.length&&(x&&f.join("")===v.copiedText&&!v.disableStyleCopyPaste&&(n=v.copiedTextStyle),this.insertNewStyleBlock(f,C,n)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(h){this.compositionStart=h.target.selectionStart,this.compositionEnd=h.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(v.copiedText=this.getSelectedText(),v.disableStyleCopyPaste?v.copiedTextStyle=null:v.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(h){return h&&h.clipboardData||v.window.clipboardData},_getWidthBeforeCursor:function(h,x){var l,f=this._getLineLeftOffset(h);return x>0&&(f+=(l=this.__charBounds[h][x-1]).left+l.width),f},getDownCursorOffset:function(h,x){var l=this._getSelectionForOffset(h,x),f=this.get2DCursorLocation(l),n=f.lineIndex;if(n===this._textLines.length-1||h.metaKey||h.keyCode===34)return this._text.length-l;var a=f.charIndex,c=this._getWidthBeforeCursor(n,a),A=this._getIndexOnLine(n+1,c);return this._textLines[n].slice(a).length+A+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(h,x){return h.shiftKey&&this.selectionStart!==this.selectionEnd&&x?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(h,x){var l=this._getSelectionForOffset(h,x),f=this.get2DCursorLocation(l),n=f.lineIndex;if(n===0||h.metaKey||h.keyCode===33)return-l;var a=f.charIndex,c=this._getWidthBeforeCursor(n,a),A=this._getIndexOnLine(n-1,c),E=this._textLines[n].slice(0,a),d=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+A-E.length+(1-d)},_getIndexOnLine:function(h,x){for(var l,f,n=this._textLines[h],a=this._getLineLeftOffset(h),c=0,A=0,E=n.length;A<E;A++)if((a+=l=this.__charBounds[h][A].width)>x){f=!0;var d=a-l,p=a,C=Math.abs(d-x);c=Math.abs(p-x)<C?A:A-1;break}return f||(c=n.length-1),c},moveCursorDown:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",h)},moveCursorUp:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",h)},_moveCursorUpOrDown:function(h,x){var l=this["get"+h+"CursorOffset"](x,this._selectionDirection==="right");x.shiftKey?this.moveCursorWithShift(l):this.moveCursorWithoutShift(l),l!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(h){var x=this._selectionDirection==="left"?this.selectionStart+h:this.selectionEnd+h;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,x),h!==0},moveCursorWithoutShift:function(h){return h<0?(this.selectionStart+=h,this.selectionEnd=this.selectionStart):(this.selectionEnd+=h,this.selectionStart=this.selectionEnd),h!==0},moveCursorLeft:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",h)},_move:function(h,x,l){var f;if(h.altKey)f=this["findWordBoundary"+l](this[x]);else{if(!h.metaKey&&h.keyCode!==35&&h.keyCode!==36)return this[x]+=l==="Left"?-1:1,!0;f=this["findLineBoundary"+l](this[x])}if(typeof f!==void 0&&this[x]!==f)return this[x]=f,!0},_moveLeft:function(h,x){return this._move(h,x,"Left")},_moveRight:function(h,x){return this._move(h,x,"Right")},moveCursorLeftWithoutShift:function(h){var x=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(x=this._moveLeft(h,"selectionStart")),this.selectionEnd=this.selectionStart,x},moveCursorLeftWithShift:function(h){return this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd?this._moveLeft(h,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection="left",this._moveLeft(h,"selectionStart")):void 0},moveCursorRight:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",h)},_moveCursorLeftOrRight:function(h,x){var l="moveCursor"+h+"With";this._currentCursorOpacity=1,x.shiftKey?l+="Shift":l+="outShift",this[l](x)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(h){return this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd?this._moveRight(h,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(h,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(h){var x=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(x=this._moveRight(h,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,x},removeChars:function(h,x){x===void 0&&(x=h+1),this.removeStyleFromTo(h,x),this._text.splice(h,x-h),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(h,x,l,f){f===void 0&&(f=l),f>l&&this.removeStyleFromTo(l,f);var n=v.util.string.graphemeSplit(h);this.insertNewStyleBlock(n,l,x),this._text=[].concat(this._text.slice(0,l),n,this._text.slice(f)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var h=v.util.toFixed,x=/  +/g;v.util.object.extend(v.Text.prototype,{_toSVG:function(){var l=this._getSVGLeftTopOffsets(),f=this._getSVGTextAndBg(l.textTop,l.textLeft);return this._wrapSVGTextAndBg(f)},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(),{reviver:l,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(l){var f=this.getSvgTextDecoration(this);return[l.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",f?'text-decoration="'+f+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",l.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(l,f){var n,a=[],c=[],A=l;this._setSVGBg(c);for(var E=0,d=this._textLines.length;E<d;E++)n=this._getLineLeftOffset(E),(this.textBackgroundColor||this.styleHas("textBackgroundColor",E))&&this._setSVGTextLineBg(c,E,f+n,A),this._setSVGTextLineText(a,E,f+n,A),A+=this.getHeightOfLine(E);return{textSpans:a,textBgRects:c}},_createTextCharSpan:function(l,f,n,a){var c=l!==l.trim()||l.match(x),A=this.getSvgSpanStyles(f,c),E=A?'style="'+A+'"':"",d=f.deltaY,p="",C=v.Object.NUM_FRACTION_DIGITS;return d&&(p=' dy="'+h(d,C)+'" '),['<tspan x="',h(n,C),'" y="',h(a,C),'" ',p,E,">",v.util.string.escapeXml(l),"</tspan>"].join("")},_setSVGTextLineText:function(l,f,n,a){var c,A,E,d,p,C=this.getHeightOfLine(f),y=this.textAlign.indexOf("justify")!==-1,S="",w=0,b=this._textLines[f];a+=C*(1-this._fontSizeFraction)/this.lineHeight;for(var O=0,N=b.length-1;O<=N;O++)p=O===N||this.charSpacing,S+=b[O],E=this.__charBounds[f][O],w===0?(n+=E.kernedWidth-E.width,w+=E.width):w+=E.kernedWidth,y&&!p&&this._reSpaceAndTab.test(b[O])&&(p=!0),p||(c=c||this.getCompleteStyleDeclaration(f,O),A=this.getCompleteStyleDeclaration(f,O+1),p=this._hasStyleChangedForSvg(c,A)),p&&(d=this._getStyleDeclaration(f,O)||{},l.push(this._createTextCharSpan(S,d,n,a)),S="",c=A,n+=w,w=0)},_pushTextBgRect:function(l,f,n,a,c,A){var E=v.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(f),' x="',h(n,E),'" y="',h(a,E),'" width="',h(c,E),'" height="',h(A,E),`"></rect>
`)},_setSVGTextLineBg:function(l,f,n,a){for(var c,A,E=this._textLines[f],d=this.getHeightOfLine(f)/this.lineHeight,p=0,C=0,y=this.getValueOfPropertyAt(f,0,"textBackgroundColor"),S=0,w=E.length;S<w;S++)c=this.__charBounds[f][S],(A=this.getValueOfPropertyAt(f,S,"textBackgroundColor"))!==y?(y&&this._pushTextBgRect(l,y,n+C,a,p,d),C=c.left,p=c.width,y=A):p+=c.kernedWidth;A&&this._pushTextBgRect(l,A,n+C,a,p,d)},_getFillAttributes:function(l){var f=l&&typeof l=="string"?new v.Color(l):"";return f&&f.getSource()&&f.getAlpha()!==1?'opacity="'+f.getAlpha()+'" fill="'+f.setAlpha(1).toRgb()+'"':'fill="'+l+'"'},_getSVGLineTopOffset:function(l){for(var f,n=0,a=0;a<l;a++)n+=this.getHeightOfLine(a);return f=this.getHeightOfLine(a),{lineTop:n,offset:(this._fontSizeMult-this._fontSizeFraction)*f/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(l){return v.Object.prototype.getSvgStyles.call(this,l)+" white-space: pre;"}})}(),function(h){var x=h.fabric||(h.fabric={});x.Textbox=x.util.createClass(x.IText,x.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:x.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(l){for(var f=0,n=0,a=0,c={},A=0;A<l.graphemeLines.length;A++)l.graphemeText[a]===`
`&&A>0?(n=0,a++,f++):!this.splitByGrapheme&&this._reSpaceAndTab.test(l.graphemeText[a])&&A>0&&(n++,a++),c[A]={line:f,offset:n},a+=l.graphemeLines[A].length,n+=l.graphemeLines[A].length;return c},styleHas:function(l,f){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[f];n&&(f=n.line)}return x.Text.prototype.styleHas.call(this,l,f)},isEmptyStyles:function(l){if(!this.styles)return!0;var f,n,a=0,c=!1,A=this._styleMap[l],E=this._styleMap[l+1];for(var d in A&&(l=A.line,a=A.offset),E&&(c=E.line===l,f=E.offset),n=l===void 0?this.styles:{line:this.styles[l]})for(var p in n[d])if(p>=a&&(!c||p<f))for(var C in n[d][p])return!1;return!0},_getStyleDeclaration:function(l,f){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[l];if(!n)return null;l=n.line,f=n.offset+f}return this.callSuper("_getStyleDeclaration",l,f)},_setStyleDeclaration:function(l,f,n){var a=this._styleMap[l];l=a.line,f=a.offset+f,this.styles[l][f]=n},_deleteStyleDeclaration:function(l,f){var n=this._styleMap[l];l=n.line,f=n.offset+f,delete this.styles[l][f]},_getLineStyle:function(l){var f=this._styleMap[l];return!!this.styles[f.line]},_setLineStyle:function(l){var f=this._styleMap[l];this.styles[f.line]={}},_wrapText:function(l,f){var n,a=[];for(this.isWrapping=!0,n=0;n<l.length;n++)a=a.concat(this._wrapLine(l[n],n,f));return this.isWrapping=!1,a},_measureWord:function(l,f,n){var a,c=0;n=n||0;for(var A=0,E=l.length;A<E;A++)c+=this._getGraphemeBox(l[A],f,A+n,a,!0).kernedWidth,a=l[A];return c},_wrapLine:function(l,f,n,a){var c=0,A=this.splitByGrapheme,E=[],d=[],p=A?x.util.string.graphemeSplit(l):l.split(this._wordJoiners),C="",y=0,S=A?"":" ",w=0,b=0,O=0,N=!0,j=this._getWidthOfCharSpacing();a=a||0,p.length===0&&p.push([]),n-=a;for(var Z=0;Z<p.length;Z++)C=A?p[Z]:x.util.string.graphemeSplit(p[Z]),w=this._measureWord(C,f,y),y+=C.length,(c+=b+w-j)>n&&!N?(E.push(d),d=[],c=w,N=!0):c+=j,N||A||d.push(S),d=d.concat(C),b=A?0:this._measureWord([S],f,y),y++,N=!1,w>O&&(O=w);return Z&&E.push(d),O+a>this.dynamicMinWidth&&(this.dynamicMinWidth=O-j+a),E},isEndOfWrapping:function(l){return!this._styleMap[l+1]||this._styleMap[l+1].line!==this._styleMap[l].line},missingNewlineOffset:function(l){return this.splitByGrapheme?this.isEndOfWrapping(l)?1:0:1},_splitTextIntoLines:function(l){for(var f=x.Text.prototype._splitTextIntoLines.call(this,l),n=this._wrapText(f.lines,this.width),a=new Array(n.length),c=0;c<n.length;c++)a[c]=n[c].join("");return f.lines=a,f.graphemeLines=n,f},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var l={};for(var f in this._styleMap)this._textLines[f]&&(l[this._styleMap[f].line]=1);for(var f in this.styles)l[f]||delete this.styles[f]},toObject:function(l){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(l))}}),x.Textbox.fromObject=function(l,f){return x.Object._fromObject("Textbox",l,f,"text")}}(e),function(){var h=v.controlsUtils,x=h.scaleSkewCursorStyleHandler,l=h.scaleCursorStyleHandler,f=h.scalingEqually,n=h.scalingYOrSkewingX,a=h.scalingXOrSkewingY,c=h.scaleOrSkewActionName,A=v.Object.prototype.controls;if(A.ml=new v.Control({x:-.5,y:0,cursorStyleHandler:x,actionHandler:a,getActionName:c}),A.mr=new v.Control({x:.5,y:0,cursorStyleHandler:x,actionHandler:a,getActionName:c}),A.mb=new v.Control({x:0,y:.5,cursorStyleHandler:x,actionHandler:n,getActionName:c}),A.mt=new v.Control({x:0,y:-.5,cursorStyleHandler:x,actionHandler:n,getActionName:c}),A.tl=new v.Control({x:-.5,y:-.5,cursorStyleHandler:l,actionHandler:f}),A.tr=new v.Control({x:.5,y:-.5,cursorStyleHandler:l,actionHandler:f}),A.bl=new v.Control({x:-.5,y:.5,cursorStyleHandler:l,actionHandler:f}),A.br=new v.Control({x:.5,y:.5,cursorStyleHandler:l,actionHandler:f}),A.mtr=new v.Control({x:0,y:-.5,actionHandler:h.rotationWithSnapping,cursorStyleHandler:h.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),v.Textbox){var E=v.Textbox.prototype.controls={};E.mtr=A.mtr,E.tr=A.tr,E.br=A.br,E.tl=A.tl,E.bl=A.bl,E.mt=A.mt,E.mb=A.mb,E.mr=new v.Control({x:.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:x,actionName:"resizing"}),E.ml=new v.Control({x:-.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:x,actionName:"resizing"})}}()},192:()=>{},898:()=>{},245:()=>{}},Po={};function Tr(r){var e=Po[r];if(e!==void 0)return e.exports;var t=Po[r]={exports:{}};return Bx[r](t,t.exports,Tr),t.exports}Tr.d=(r,e)=>{for(var t in e)Tr.o(e,t)&&!Tr.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},Tr.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var N0={};(()=>{let r;Tr.d(N0,{R:()=>r}),r=typeof document!="undefined"&&typeof window!="undefined"?Tr(653).fabric:{version:"5.2.1"}})();var st=N0.R;/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Camera Enhancer JS Edition
 * @website https://www.dynamsoft.com
 * @copyright Copyright 2023, Dynamsoft Corporation
 * @author Dynamsoft
 * @version 3.3.4 (js 20230414)
 * @fileoverview Dynamsoft JavaScript Library for Camera Enhancer
 * More info on DCE JS: https://www.dynamsoft.com/camera-enhancer/docs/programming/javascript/?ver=latest
 */const zi=typeof self=="undefined";let Zr,fr,Ci,ki,At;if(typeof navigator!="undefined"&&(Zr=navigator,fr=Zr.userAgent,Ci=Zr.platform,ki=Zr.mediaDevices),!zi){const r={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:Zr.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},e={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:Ci,search:"Win"},Mac:{str:Ci},Linux:{str:Ci}};let t="unknownBrowser",i=0,o="unknownOS";for(let s in r){const u=r[s]||{};let g=u.str||fr,B=u.search||s,_=u.verStr||fr,m=u.verSearch||s;if(m instanceof Array||(m=[m]),g.indexOf(B)!=-1){t=s;for(let D of m){let F=_.indexOf(D);if(F!=-1){i=parseFloat(_.substring(F+D.length+1));break}}break}}for(let s in e){const u=e[s]||{};let g=u.str||fr,B=u.search||s;if(g.indexOf(B)!=-1){o=s;break}}o=="Linux"&&fr.indexOf("Windows NT")!=-1&&(o="HarmonyOS"),At={browser:t,version:i,OS:o}}zi&&(At={browser:"ssr",version:0,OS:"ssr"});const vx=typeof WebAssembly!="undefined"&&fr&&!(/Safari/.test(fr)&&!/Chrome/.test(fr)&&/\(.+\s11_2_([2-6]).*\)/.test(fr)),_x=typeof Worker!="undefined",j0=!(!ki||!ki.getUserMedia),Cx=async()=>{let r=!1;if(j0)try{(await ki.getUserMedia({video:!0})).getTracks().forEach(e=>{e.stop()}),r=!0}catch{}return r};At.browser==="Chrome"&&At.version>66||At.browser==="Safari"&&At.version>13||At.browser==="OPR"&&At.version>43||At.browser==="Edge"&&At.version;const mx=(()=>{if(!zi&&document.currentScript){let r=document.currentScript.src,e=r.indexOf("?");if(e!=-1)r=r.substring(0,e);else{let t=r.indexOf("#");t!=-1&&(r=r.substring(0,t))}return r.substring(0,r.lastIndexOf("/")+1)}return"./"})();class _r{constructor(e,t){this._zIndex=null,this._drawingLayer=null,this._drawingLayerId=null,this._mapStyle=new Map,this.mapEvent_Callbacks=new Map([["selected",new Map],["deselected",new Map],["mousedown",new Map],["mouseup",new Map],["dblclick",new Map],["mouseover",new Map],["mouseout",new Map]]),this.mapNoteName_Content=new Map([]),this.isDrawingItem=!0,this._setFabricObject(e),this._mediaType=e.type,this.styleSelector="default",this.styleId=t}get mediaType(){return this._mediaType}get drawingLayerId(){return this._drawingLayerId}_setFabricObject(e){this._fabricObject=e,this._fabricObject.on("selected",()=>{this.styleSelector="selected"}),this._fabricObject.on("deselected",()=>{this._fabricObject.canvas&&this._fabricObject.canvas.getActiveObjects().includes(this._fabricObject)?this.styleSelector="selected":this.styleSelector="default",this._fabricObject.type==="textbox"&&(this._fabricObject.isEditing&&this._fabricObject.exitEditing(),this._fabricObject.selected=!1)}),e.getDrawingItem=()=>this}_getFabricObject(){return this._fabricObject}_on(e,t){if(!t)return;const i=e.toLowerCase(),o=this.mapEvent_Callbacks.get(i);if(!o)throw new Error(`Event '${e}' does not exist.`);let s=o.get(t);s||(s=u=>{const g=u.e;if(!g)return void(t&&t.apply(this,[{targetItem:this,itemClientX:null,itemClientY:null,itemPageX:null,itemPageY:null}]));const B={targetItem:this,itemClientX:null,itemClientY:null,itemPageX:null,itemPageY:null};if(this._drawingLayer){let _,m,D,F;const T=g.target.getBoundingClientRect();_=T.left,m=T.top,D=_+window.scrollX,F=m+window.scrollY;const I=this._drawingLayer.fabricCanvas.lowerCanvasEl.width,k=this._drawingLayer.fabricCanvas.lowerCanvasEl.height,U=parseFloat(window.getComputedStyle(this._drawingLayer.fabricCanvas.lowerCanvasEl).width),K=parseFloat(window.getComputedStyle(this._drawingLayer.fabricCanvas.lowerCanvasEl).height),X=U/K,te=I/k,ne=this._drawingLayer._getObjectFit();let re,ue,Ae,v,ye=1;if(ne==="contain")X<te?(ye=U/I,re=_+this.get("x")*ye,ue=m+this.get("y")*ye+(K-k*ye)/2,Ae=D+this.get("x")*ye,v=F+this.get("y")*ye+(K-k*ye)/2):(ye=K/k,re=_+this.get("x")*ye+(U-I*ye)/2,ue=m+this.get("y")*ye,Ae=D+this.get("x")*ye+(U-I*ye)/2,v=F+this.get("y")*ye);else if(ne==="cover")if(X<te){ye=K/k;let be=this.get("x")*ye-(I*ye-U)/2;be=Math.max(be,0),be=Math.min(be,U),re=_+be,ue=m+this.get("y")*ye,Ae=D+be,v=F+this.get("y")*ye}else{ye=U/I;let be=this.get("y")*ye-(k*ye-K)/2;be=Math.max(be,0),be=Math.min(be,K),re=_+this.get("x")*ye,ue=m+be,Ae=D+this.get("x")*ye,v=F+be}B.itemClientX=Math.round(re),B.itemClientY=Math.round(ue),B.itemPageX=Math.round(Ae),B.itemPageY=Math.round(v)}for(let _ of Object.getOwnPropertyNames(B))Object.defineProperty(g,_,{value:B[_],writable:!0});t&&t.apply(this,[g])},o.set(t,s),this._fabricObject.on(i==="dblclick"?"mousedblclick":i,s))}on(e,t){this._on(e,t)}_off(e,t){const i=e.toLowerCase(),o=this.mapEvent_Callbacks.get(i);if(!o)throw new Error(`Event '${e}' does not exist.`);let s=o.get(t);s&&(o.delete(t),this._fabricObject.off(i==="dblclick"?"mousedblclick":i,s))}off(e,t){this._off(e,t)}_setEditable(e){const t=this._fabricObject;e?(t.selectable=!0,t.hasControls=!0,t.hoverCursor=null):(t.selectable=!1,t.hasControls=!1,t.hoverCursor="default")}hasNote(e){return this.mapNoteName_Content.has(e)}addNote(e,t){if(this.hasNote(e.name)&&!t)throw new Error("A note with the same name already exists, please use a different name.");const i=e.content?JSON.parse(JSON.stringify(e.content)):e.content;this.mapNoteName_Content.set(e.name,[i])}getNote(e){const t=this.mapNoteName_Content.get(e);return t?t.length===1?{name:e,content:t[0]?JSON.parse(JSON.stringify(t[0])):t[0]}:{name:e,content:JSON.parse(JSON.stringify(t))}:null}getNotes(){const e=[];for(let t of this.mapNoteName_Content){let i=t[1].length===1?t[1][0]:t[1];i=i&&JSON.parse(JSON.stringify(i)),e.push({name:t[0],content:i})}return e}updateNote(e,t,i){const o=this.mapNoteName_Content.get(e);if(!o)throw new Error("The note name does not exist.");i||(o.length=0),t=t&&JSON.parse(JSON.stringify(t)),o.push(t)}deleteNote(e){this.mapNoteName_Content.delete(e)}clearNotes(){this.mapNoteName_Content.clear()}_extendSet(e,t){return!1}_extendGet(e){}set(e,t){if(!this._extendSet(e,t))if(e==="x"){const i=this._fabricObject.group;i?(this._fabricObject.set("left",t-i.left-i.width/2),i.addWithUpdate()):this._fabricObject.set("left",t)}else if(e==="y"){const i=this._fabricObject.group;i?(this._fabricObject.set("top",t-i.top-i.height/2),i.addWithUpdate()):this._fabricObject.set("top",t)}else e==="styleId"?this.styleId=t:this._fabricObject.set(e,t);["vertices","startPoint","endPoint","x","y","left","top","width","height","scaleX","scaleY","skewX","skewY","padding","angle","strokeWidth"].includes(e)&&this._fabricObject.setCoords()}get(e){let t=this._extendGet(e);if(t===void 0)if(e==="x"){const i=this._fabricObject.group;t=i?this._fabricObject.get("left")+i.left+i.width/2:this._fabricObject.get("left")}else if(e==="y"){const i=this._fabricObject.group;t=i?this._fabricObject.get("top")+i.top+i.height/2:this._fabricObject.get("top")}else t=["type","mediaType"].includes(e)?this.mediaType:e==="styleSelector"?this.styleSelector:e==="styleId"?this.styleId:e==="drawingLayerId"?this.drawingLayerId:this._fabricObject.get(e);return t}setAttribute(e,t){this.set(e,t)}getAttribute(e){return this.get(e)}}_r.arrMediaTypes=["rect","arc","polygon","image","text","line","path"],_r.arrStyleSelectors=["default","selected"];const Mo=r=>{let e=(t=>t.split(`
`).map(i=>i.split("	")))(r);return(t=>{for(let i=0;;i++){let o=-1;for(let s=0;s<t.length;s++){let u=t[s][i];u!==void 0&&u.length>o&&(o=u.length)}if(o===-1)break;for(let s=0;s<t.length;s++){if(i>=t[s].length-1)continue;let u=" ".repeat(o+2-t[s][i].length);t[s][i]=t[s][i].concat(u)}}})(e),(t=>{let i="";for(let o=0;o<t.length;o++)i=i.concat(...t[o],o===t.length-1?"":`
`);return i})(e)};class yx extends _r{constructor(e,t,i,o,s){if(typeof o!="number"||o<=0)throw new RangeError("Invalid width.");super(new st.Textbox(Mo(e),{left:t,top:i,width:o}),s),this._mediaType="text",this._text=e}_extendSet(e,t){if(e==="text")return this._text=t,this._fabricObject.set("text",Mo(t)),!0}_extendGet(e){if(e==="text")return this._text}}typeof document!="undefined"&&typeof window!="undefined"&&(st.StaticCanvas.prototype.dispose=function(){return this.isRendering&&(st.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(r){r.dispose&&r.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),st.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},st.Object.prototype.transparentCorners=!1,st.Object.prototype.cornerSize=20,st.Object.prototype.touchCornerSize=100,st.Object.prototype.cornerColor="rgb(254,142,20)",st.Object.prototype.cornerStyle="circle",st.Object.prototype.strokeUniform=!0,st.Object.prototype.hasBorders=!1,st.Canvas.prototype.containerClass="",st.Canvas.prototype.getPointer=function(r,e){if(this._absolutePointer&&!e)return this._absolutePointer;if(this._pointer&&e)return this._pointer;var t,i=this.upperCanvasEl,o=st.util.getPointer(r,i),s=i.getBoundingClientRect(),u=s.width||0,g=s.height||0;u&&g||("top"in s&&"bottom"in s&&(g=Math.abs(s.top-s.bottom)),"right"in s&&"left"in s&&(u=Math.abs(s.right-s.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,e||(o=this.restorePointerVpt(o));var B=this.getRetinaScaling();if(B!==1&&(o.x/=B,o.y/=B),u!==0&&g!==0){var _=window.getComputedStyle(i).objectFit,m=i.width,D=i.height,F=u,T=g;t={width:m/F,height:D/T};var I,k,U=m/D,K=F/T;return _==="contain"?U>K?(I=F,k=F/U,{x:o.x*t.width,y:(o.y-(T-k)/2)*t.width}):(I=T*U,k=T,{x:(o.x-(F-I)/2)*t.height,y:o.y*t.height}):_==="cover"?U>K?{x:(m-t.height*F)/2+o.x*t.height,y:o.y*t.height}:{x:o.x*t.width,y:(D-t.width*T)/2+o.y*t.width}:{x:o.x*t.width,y:o.y*t.height}}return t={width:1,height:1},{x:o.x*t.width,y:o.y*t.height}},st.Canvas.prototype._onTouchStart=function(r){var e=this.findTarget(r);!this.allowTouchScrolling&&r.cancelable&&r.preventDefault&&r.preventDefault(),e&&r.cancelable&&r.preventDefault&&r.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(r)),this.__onMouseDown(r),this._resetTransformEventData();var t=this.upperCanvasEl,i=this._getEventPrefix();st.util.addListener(st.document,"touchend",this._onTouchEnd,{passive:!1}),st.util.addListener(st.document,"touchmove",this._onMouseMove,{passive:!1}),st.util.removeListener(t,i+"down",this._onMouseDown)},st.Textbox.prototype._wrapLine=function(r,e,t,i){const o=r.match(/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/g),s=!(!o||!o.length);var u=0,g=this.splitByGrapheme||s,B=[],_=[],m=g?st.util.string.graphemeSplit(r):r.split(this._wordJoiners),D="",F=0,T=g?"":" ",I=0,k=0,U=0,K=!0,X=this._getWidthOfCharSpacing();i=i||0,m.length===0&&m.push([]),t-=i;for(var te=0;te<m.length;te++)D=g?m[te]:st.util.string.graphemeSplit(m[te]),I=this._measureWord(D,e,F),F+=D.length,(u+=k+I-X)>t&&!K?(B.push(_),_=[],u=I,K=!0):u+=X,K||g||_.push(T),_=_.concat(D),k=g?0:this._measureWord([T],e,F),F++,K=!1,I>U&&(U=I);return te&&B.push(_),U+i>this.dynamicMinWidth&&(this.dynamicMinWidth=U-X+i),B});class Dx{constructor(e,t,i,o){let s,u;switch(this.mapMediaType_Style=new Map,this.mode="viewer",this.onSelectionChange=null,this._arrDrwaingItem=[],this._arrFabricObject=[],this._visible=!0,e.hasOwnProperty("getFabricCanvas")?this.fabricCanvas=e.getFabricCanvas():(this.fabricCanvas=new st.Canvas(e,Object.assign(o,{allowTouchScrolling:!0})),this.fabricCanvas.setDimensions({width:"100%",height:"100%"},{cssOnly:!0}),this.fabricCanvas.lowerCanvasEl.className="",this.fabricCanvas.upperCanvasEl.className="",this.fabricCanvas.on("selection:created",function(g){const B=g.selected,_=[];for(let m of B){const D=m.getDrawingItem()._drawingLayer;D&&!_.includes(D)&&_.push(D)}for(let m of _){const D=[];for(let F of B){const T=F.getDrawingItem();T._drawingLayer===m&&D.push(T)}setTimeout(()=>{m.onSelectionChange&&m.onSelectionChange(D,[])},0)}}),this.fabricCanvas.on("before:selection:cleared",function(g){const B=this.getActiveObjects(),_=[];for(let m of B){const D=m.getDrawingItem()._drawingLayer;D&&!_.includes(D)&&_.push(D)}for(let m of _){const D=[];for(let F of B){const T=F.getDrawingItem();T._drawingLayer===m&&D.push(T)}setTimeout(()=>{const F=[];for(let T of D)m.hasDrawingItem(T)&&F.push(T);F.length>0&&m.onSelectionChange&&m.onSelectionChange([],F)},0)}}),this.fabricCanvas.on("selection:updated",function(g){const B=g.selected,_=g.deselected,m=[];for(let D of B){const F=D.getDrawingItem()._drawingLayer;F&&!m.includes(F)&&m.push(F)}for(let D of _){const F=D.getDrawingItem()._drawingLayer;F&&!m.includes(F)&&m.push(F)}for(let D of m){const F=[],T=[];for(let I of B){const k=I.getDrawingItem();k._drawingLayer===D&&F.push(k)}for(let I of _){const k=I.getDrawingItem();k._drawingLayer===D&&T.push(k)}setTimeout(()=>{D.onSelectionChange&&D.onSelectionChange(F,T)},0)}}),this.fabricCanvas.wrapperEl.style.position="absolute",e.getFabricCanvas=()=>this.fabricCanvas),this.id=t,this._mapDrawingStyles=i,t){case 1:s=i.get(1),u=i.get(5);break;case 2:s=i.get(2),u=i.get(6);break;case 3:s=i.get(3),u=i.get(7);break;default:s=i.get(4),u=i.get(8)}for(let g of _r.arrMediaTypes)this.mapMediaType_Style.set(g,{default:s,selected:u})}getId(){return this.id}_getDrawingStyle(e,t){if(typeof e!="number")throw new Error("Invalid style id.");const i=this._mapDrawingStyles.get(e);return i?t?JSON.parse(JSON.stringify(i)):i:null}setVisible(e){if(e){for(let t of this._arrFabricObject)t.visible=!0;this._visible=!0}else{for(let t of this._arrFabricObject)t.visible=!1;this._visible=!1}this.fabricCanvas.renderAll()}isVisible(){return this._visible}_getItemCurrentStyleId(e){return e.styleId?e.styleId:this.mapMediaType_Style.get(e._mediaType)[e.styleSelector].styleId}_getItemCurrentStyle(e){return e.styleId?this._getDrawingStyle(e.styleId):e._mapStyle.get(e.styleSelector)||null}_changeMediaTypeCurStyleInStyleSelector(e,t,i,o){let s;switch(e){case"rect":s=this.fabricCanvas.getObjects("rect");break;case"arc":s=this.fabricCanvas.getObjects("circle");break;case"polygon":s=this.fabricCanvas.getObjects("polygon");break;case"image":s=this.fabricCanvas.getObjects("image");break;case"text":s=this.fabricCanvas.getObjects("textbox");break;case"line":s=this.fabricCanvas.getObjects("line");break;case"path":s=this.fabricCanvas.getObjects("path")}for(let u of s){if(!this._arrFabricObject.includes(u))continue;const g=u.getDrawingItem();g.styleSelector===t&&this._changeItemStyle(g,i,!0)}o||this.fabricCanvas.renderAll()}_changeItemStyle(e,t,i){if(!e||!t)return;const o=e._getFabricObject();typeof e.styleId=="number"&&(t=this._getDrawingStyle(e.styleId)),o.strokeWidth=t.lineWidth,t.paintMode==="fill"?(o.fill=t.fillStyle,o.stroke=t.fillStyle):t.paintMode==="stroke"?(o.fill="transparent",o.stroke=t.strokeStyle):t.paintMode==="strokeAndFill"&&(o.fill=t.fillStyle,o.stroke=t.strokeStyle),o.fontFamily&&(o.fontFamily=t.fontFamily),o.fontSize&&(o.fontSize=t.fontSize),o.group||(o.dirty=!0),i||this.fabricCanvas.renderAll()}_updateGroupItem(e,t,i){if(!e||!t)return;const o=e.getChildItems();if(i==="add"){if(o.includes(t))return;const s=t._getFabricObject();if(this.fabricCanvas.getObjects().includes(s)){if(!this._arrFabricObject.includes(s))throw new Error("Existed in other drawing layers.");t._zIndex=null}else{let u;if(t.styleId)u=this._getDrawingStyle(t.styleId);else{u=this.mapMediaType_Style.get(t._mediaType)[e.styleSelector];const g=()=>{this._changeItemStyle(t,this.mapMediaType_Style.get(t._mediaType).selected,!0)},B=()=>{this._changeItemStyle(t,this.mapMediaType_Style.get(t._mediaType).default,!0)};t._on("selected",g),t._on("deselected",B),t._funcChangeStyleToSelected=g,t._funcChangeStyleToDefault=B}t._drawingLayer=this,t._drawingLayerId=this.id,this._changeItemStyle(t,u,!0)}e._fabricObject.addWithUpdate(t._getFabricObject())}else{if(i!=="remove"||!o.includes(t))return;t._zIndex=null,t._drawingLayer=null,t._drawingLayerId=null,t._off("selected",t._funcChangeStyleToSelected),t._off("deselected",t._funcChangeStyleToDefault),t._funcChangeStyleToSelected=null,t._funcChangeStyleToDefault=null,e._fabricObject.removeWithUpdate(t._getFabricObject())}this.fabricCanvas.renderAll()}_addDrawingItem(e,t){let i=e._getFabricObject();const o=this.fabricCanvas.getObjects();let s,u;if(o.includes(i)){if(this._arrFabricObject.includes(i))return;throw new Error("Existed in other drawing layers.")}if(e._mediaType==="group"){s=e.getChildItems();for(let _ of s)if(_._drawingLayer&&_._drawingLayer!==this)throw new Error("The childItems of DT_Group have existed in other drawing layers.")}if(t&&typeof t=="object"&&!Array.isArray(t))for(let _ in t)i.set(_,t[_]);if(s){for(let _ of s){const m=this.mapMediaType_Style.get(_._mediaType);for(let D of _r.arrStyleSelectors)_._mapStyle.set(D,m[D]);if(_.styleId)u=this._getDrawingStyle(_.styleId);else{u=m.default;const D=()=>{this._changeItemStyle(_,this.mapMediaType_Style.get(_._mediaType).selected,!0)},F=()=>{this._changeItemStyle(_,this.mapMediaType_Style.get(_._mediaType).default,!0)};_._on("selected",D),_._on("deselected",F),_._funcChangeStyleToSelected=D,_._funcChangeStyleToDefault=F}_._drawingLayer=this,_._drawingLayerId=this.id,this._changeItemStyle(_,u,!0)}i.dirty=!0,this.fabricCanvas.renderAll()}else{const _=this.mapMediaType_Style.get(e._mediaType);for(let m of _r.arrStyleSelectors)e._mapStyle.set(m,_[m]);if(e.styleId)u=this._getDrawingStyle(e.styleId);else{u=_.default;const m=()=>{this._changeItemStyle(e,this.mapMediaType_Style.get(e._mediaType).selected)},D=()=>{this._changeItemStyle(e,this.mapMediaType_Style.get(e._mediaType).default)};e._on("selected",m),e._on("deselected",D),e._funcChangeStyleToSelected=m,e._funcChangeStyleToDefault=D}this._changeItemStyle(e,u)}e._zIndex=this.id,e._drawingLayer=this,e._drawingLayerId=this.id;const g=this._arrFabricObject.length;let B=o.length;if(g)B=o.indexOf(this._arrFabricObject[g-1])+1;else for(let _=0;_<o.length;_++)if(e._zIndex<o[_].getDrawingItem()._zIndex){B=_;break}this._arrDrwaingItem.push(e),this._arrFabricObject.push(i),this._visible?i.visible=!0:i.visible=!1,this.fabricCanvas.insertAt(i,B,!1)}addDrawingItem(e){if(!e||!e.isDrawingItem)throw TypeError("Illegal drawing item.");if(this.mode==="viewer")e._setEditable(!1);else{if(this.mode!=="editor")throw new Error("Illegal 'mode'.");e._setEditable(!0)}this._addDrawingItem(e)}addDrawingItems(e){for(let t of e)this.addDrawingItem(t)}removeDrawingItem(e){if(!e||!e.isDrawingItem)throw TypeError("Illegal drawing item.");if(!this.hasDrawingItem(e))return;if(e._zIndex=null,e._drawingLayer=null,e._drawingLayerId=null,e._mediaType==="group"){const i=e.getChildItems();for(let o of i)o._zIndex=null,o._drawingLayer=null,o._drawingLayerId=null,o._off("selected",o._funcChangeStyleToSelected),o._off("deselected",o._funcChangeStyleToDefault),o._funcChangeStyleToSelected=null,o._funcChangeStyleToDefault=null,o._mapStyle.clear()}else e._off("selected",e._funcChangeStyleToSelected),e._off("deselected",e._funcChangeStyleToDefault),e._funcChangeStyleToSelected=null,e._funcChangeStyleToDefault=null,e._mapStyle.clear();const t=e._getFabricObject();e.styleSelector==="selected"&&(t.group?t.group.removeWithUpdate(t):this.fabricCanvas._activeObject=null,e.styleSelector="default"),this.fabricCanvas.remove(t),this._arrDrwaingItem.splice(this._arrDrwaingItem.indexOf(e),1),this._arrFabricObject.splice(this._arrFabricObject.indexOf(t),1)}removeDrawingItems(e){for(let t of e)this.removeDrawingItem(t)}setDrawingItems(e){this.clearDrawingItems(),this.addDrawingItems(e)}getDrawingItems(e){return e&&typeof e=="function"?this._arrDrwaingItem.filter(e):Array.from(this._arrDrwaingItem)}getSelectedDrawingItems(){const e=this.fabricCanvas.getActiveObjects(),t=[];for(let i of e)this._arrFabricObject.includes(i)&&t.push(i.getDrawingItem());return t}hasDrawingItem(e){if(!e||!e.isDrawingItem)throw TypeError("Illegal drawing item.");return this._arrDrwaingItem.includes(e)}clearDrawingItems(){this.removeDrawingItems(Array.from(this._arrDrwaingItem))}setDrawingStyle(e,t,i){t=t?t.toLocaleLowerCase():"all",i=i?i.toLocaleLowerCase():"all";let o,s=this._getDrawingStyle(e);if(t==="all"){const u=this.mapMediaType_Style.keys();for(let g of u)if(o=this.mapMediaType_Style.get(g),i==="all")for(let B of _r.arrStyleSelectors){this._changeMediaTypeCurStyleInStyleSelector(g,B,s,!0),o[B]=s;for(let _ of this._arrDrwaingItem)_._mapStyle.set(B,s)}else{this._changeMediaTypeCurStyleInStyleSelector(g,i,s,!0),o[i]=s;for(let B of this._arrDrwaingItem)B._mapStyle.set(i,s)}this.fabricCanvas.renderAll()}else if(o=this.mapMediaType_Style.get(t),i==="all")for(let u of _r.arrStyleSelectors){this._changeMediaTypeCurStyleInStyleSelector(t,u,s,!0),o[u]=s;for(let g of this._arrDrwaingItem)g._mediaType===t&&g._mapStyle.set(u,s)}else{this._changeMediaTypeCurStyleInStyleSelector(t,i,s,!0),o[i]=s;for(let u of this._arrDrwaingItem)u._mediaType===t&&u._mapStyle.set(i,s)}}setMode(e){if((e=e.toLocaleLowerCase())==="viewer"){for(let t of this._arrDrwaingItem)t._setEditable(!1);this.fabricCanvas.discardActiveObject(),this.fabricCanvas.renderAll(),this.mode="viewer"}else{if(e!=="editor")throw new RangeError("Invalid value.");for(let t of this._arrDrwaingItem)t._setEditable(!0);this.mode="editor"}this._manager._switchPointerEvent()}getMode(){return this.mode}_setDimensions(e,t){this.fabricCanvas.setDimensions(e,t)}_setObjectFit(e){if(e=e.toLowerCase(),!["contain","cover"].includes(e))throw new Error(`Unsupported value '${e}'.`);this.fabricCanvas.lowerCanvasEl.style.objectFit=e,this.fabricCanvas.upperCanvasEl.style.objectFit=e}_getObjectFit(){return this.fabricCanvas.lowerCanvasEl.style.objectFit}renderAll(){for(let e of this._arrDrwaingItem){const t=this._getItemCurrentStyle(e);this._changeItemStyle(e,t,!0)}this.fabricCanvas.renderAll()}dispose(){this.clearDrawingItems(),this._manager._arrDrawingLayer.length===1&&(this.fabricCanvas.wrapperEl.style.pointerEvents="none",this.fabricCanvas.dispose(),this._arrDrwaingItem.length=0,this._arrFabricObject.length=0)}}class wx{constructor(){this._arrDrawingLayer=[],this._mapDrawingStyles=new Map([[1,{id:1,lineWidth:4,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"stroke",fontFamily:"consolas",fontSize:40}],[2,{id:2,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[3,{id:3,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 0.9)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[4,{id:4,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"consolas",fontSize:40}],[5,{id:5,lineWidth:4,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[6,{id:6,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[7,{id:7,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 1)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[8,{id:8,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}]]),this._defaultStyleTemplate={lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"consolas",fontSize:40}}createDrawingStyle(e){if(!e)throw new Error("Invalid style definition.");let t;if(e.hasOwnProperty("id")){if(this._mapDrawingStyles.has(e.id))throw new Error("Existing drawing style id.");t=e.id}else{let o=100;for(;this._mapDrawingStyles.has(o);)o++;t=o}const i=JSON.parse(JSON.stringify(e));i.id=t;for(let o in this._defaultStyleTemplate)i.hasOwnProperty(o)||(i[o]=this._defaultStyleTemplate[o]);return this._mapDrawingStyles.set(t,i),i.id}_getDrawingStyle(e,t){if(typeof e!="number")throw new Error("Invalid style id.");const i=this._mapDrawingStyles.get(e);return i?t?JSON.parse(JSON.stringify(i)):i:null}getDrawingStyle(e){return this._getDrawingStyle(e,!0)}getDrawingStyles(){return JSON.parse(JSON.stringify(Array.from(this._mapDrawingStyles.values())))}_updateDrawingStyle(e,t){const i=this._mapDrawingStyles.get(e);if(i)for(let o in t)i.hasOwnProperty(o)&&(i[o]=t[o])}updateDrawingStyle(e,t){this._updateDrawingStyle(e,t);for(let i of this._arrDrawingLayer)i.renderAll()}createDrawingLayer(e,t){const i=s=>{for(let u of this._arrDrawingLayer)if(u.getId()===s)return!0;return!1};if(t===void 0){for(let s=100;;s++)if(!i(s)){t=s;break}}else if(i(t))throw new Error("Existed drawing layer id.");const o=new Dx(e,t,this._mapDrawingStyles,{enableRetinaScaling:!1});return o._manager=this,this._arrDrawingLayer.push(o),this._switchPointerEvent(),o}deleteDrawingLayer(e){const t=this.getDrawingLayer(e);if(!t)return;const i=this._arrDrawingLayer;t.dispose(),i.splice(i.indexOf(t),1),this._switchPointerEvent()}clearDrawingLayers(){for(let e of this._arrDrawingLayer)e.dispose();this._arrDrawingLayer.length=0}getDrawingLayer(e){for(let t of this._arrDrawingLayer)if(t.getId()===e)return t;return null}getDrawingLayers(){return Array.from(this._arrDrawingLayer)}getSelectedDrawingItems(){if(!this._arrDrawingLayer.length)return;const e=this._arrDrawingLayer[0].fabricCanvas.getActiveObjects(),t=[];for(let i of e)t.push(i.getDrawingItem());return t}setDimensions(e,t){this._arrDrawingLayer.length&&this._arrDrawingLayer[0]._setDimensions(e,t)}setObjectFit(e){for(let t of this._arrDrawingLayer)t&&t._setObjectFit(e)}getObjectFit(){return this._arrDrawingLayer.length?this._arrDrawingLayer[0]._getObjectFit():null}setVisible(e){this._arrDrawingLayer.length&&(this._arrDrawingLayer[0].fabricCanvas.wrapperEl.style.display=e?"block":"none")}_switchPointerEvent(){if(this._arrDrawingLayer.length)for(let e of this._arrDrawingLayer)e.getMode()}}class Fx{constructor(e){this._controlTarget=null,this._arrUsers=[],this._mapAction_UserArgs=new Map,this._mapProperty_UserValue=new Map,this._mapAction_Callbacks=new Map,this._controlTarget=e}setControlTarget(e){this._controlTarget=e}getControlTarget(){return this._controlTarget}register(e){this._arrUsers.includes(e)||this._arrUsers.push(e)}logout(e){const t=this._arrUsers.indexOf(e);t!==-1&&(this.clearUserDisiredAction({user:e}),this.clearUserDisiredValue({user:e}),this._arrUsers.splice(t,1))}getRegisteredUsers(){return this._arrUsers}ifUserExisted(e){return this._arrUsers.includes(e)}setDisiredValue(e,t,i,o){if(!this._arrUsers.includes(e))throw new Error("Unregistered user.");o&&(this._controlTarget[t]=i),this._mapProperty_UserValue.get(t)?this._mapProperty_UserValue.get(t).set(e,i):this._mapProperty_UserValue.set(t,new Map([[e,i]]))}clearUserDisiredValue(e){if(e&&(e.user||e.property)){if(e.property&&e.user){const t=this._mapProperty_UserValue.get(e.property);if(!t)return;t.delete(e.user)}else if(e.property)this._mapProperty_UserValue.delete(e.property);else if(e.user)for(let t of this._mapProperty_UserValue.values())t.delete(e.user)}else this._mapProperty_UserValue=new Map}getValue(e){if(!this._controlTarget)throw new Error("Control target is not set.");return this._controlTarget[e]}getPropertyDisiredValue(e){if(this._mapProperty_UserValue.get(e)){const t=[],i=this._mapProperty_UserValue.get(e);for(let o of i.values())t.push(o);return t}return null}setDisiredAction(e,t,i,o){if(!this._arrUsers.includes(e))throw new Error("Unregistered user.");return i||(i=[]),o?this._controlTarget[t](...i):(this._mapAction_UserArgs.get(t)?this._mapAction_UserArgs.get(t).set(e,i):this._mapAction_UserArgs.set(t,new Map([[e,i]])),this._render(t))}clearUserDisiredAction(e){if(e&&(e.user||e.actionName)){if(e.actionName&&e.user){const t=this._mapAction_UserArgs.get(e.actionName);if(!t)return;t.delete(e.user)}else if(e.actionName)this._mapAction_UserArgs.delete(e.actionName);else if(e.user)for(let t of this._mapAction_UserArgs.values())t.delete(e.user);this.render()}else this._mapAction_UserArgs=new Map}addCallback(e,t){const i=this._mapAction_Callbacks.get(e);i?i.push(t):this._mapAction_Callbacks.set(e,[t])}removeCallback(e,t){const i=this._mapAction_Callbacks.get(e);if(!i)return;const o=i.indexOf(t);o!==-1&&i.splice(o,1)}clearCallback(e){e?this._mapAction_Callbacks.delete(e):this._mapAction_Callbacks.clear()}_fireCallback(e){const t=this._mapAction_Callbacks.get(e);if(t)for(let i of t){if(!i)return;setTimeout(i.bind(this._controlTarget),0)}}_render(e){const t=this._mapAction_UserArgs.get(e);if(!t)throw new Error("Unrecorded action.");if(t.size===this._arrUsers.length){let i=[];for(let o of t.values())o.length>0&&(i=o);if(this._controlTarget[e]){const o=this._controlTarget[e](...i);return this._mapAction_UserArgs.delete(e),this._fireCallback(e),o}}}render(e){if(e)return this._render(e);for(let t of this._mapAction_UserArgs.keys())this._render(t)}}class Jt{static multiply(e,t){const i=[];for(let o=0;o<3;o++){const s=t.slice(3*o,3*o+3);for(let u=0;u<3;u++){const g=[e[u],e[u+3],e[u+6]].reduce((B,_,m)=>B+_*s[m],0);i.push(g)}}return i}static identity(){return[1,0,0,0,1,0,0,0,1]}static translate(e,t,i){return Jt.multiply(e,[1,0,0,0,1,0,t,i,1])}static rotate(e,t){var i=Math.cos(t),o=Math.sin(t);return Jt.multiply(e,[i,-o,0,o,i,0,0,0,1])}static scale(e,t,i){return Jt.multiply(e,[t,0,0,0,i,0,0,0,1])}}var He;(function(r){r.GREY="grey",r.GREY32="grey32",r.RGBA="rgba",r.RBGA="rbga",r.GRBA="grba",r.GBRA="gbra",r.BRGA="brga",r.BGRA="bgra"})(He||(He={}));const Kt=(r,e,t,i)=>{let o=e+Math.round((r-e)/t)*t;return i&&(o=Math.min(o,i)),o};class me{constructor(){this._maxCvsSideLength=void 0,this._defaultMaxCvsSideLength=null,this._predefinedResolutions=[{width:160,height:120},{width:320,height:240},{width:480,height:360},{width:640,height:480},{width:800,height:600},{width:960,height:720},{width:1280,height:720},{width:1920,height:1080},{width:2560,height:1440},{width:3840,height:2160}],this._mapCameraResolutions=new Map,this._bWebGLSupported=!0,this.extraBindings=[],this._singleFrameMode=!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),this._cvsSingleFrameMode=null,this._cvsOriginalImage=null,this._imgWidth=0,this._imgHeight=0,this._singleFrameModeIpt=null,this._clickIptSingleFrameMode=()=>{if(this.singleFrameMode&&!this.getDrawingLayers().some(e=>e.getMode()=="editor")){if(!this._singleFrameModeIpt){const e=document.createElement("input");this._singleFrameModeIpt=e,e.setAttribute("type","file"),e.setAttribute("accept",".jpg,.jpeg,.icon,.gif,.svg,.webp,.png,.bmp"),e.setAttribute("capture",""),e.addEventListener("change",async()=>{const t=e.files[0];e.value="";const i=await(async _=>{let m=null,D=null;if(typeof createImageBitmap!="undefined")try{if(m=await createImageBitmap(_),m)return m}catch{}var F;return m||(D=await(F=_,new Promise((T,I)=>{let k=URL.createObjectURL(F),U=new Image;U.dbrObjUrl=k,U.src=k,U.onload=()=>{T(U)},U.onerror=K=>{I(new Error("Can't convert blob to image : "+(K instanceof Event?K.type:K)))}}))),D})(t),o=i instanceof HTMLImageElement?i.naturalWidth:i.width,s=i instanceof HTMLImageElement?i.naturalHeight:i.height;this._imgWidth=o,this._imgHeight=s;const u=_=>{const m=Date.now();if(o===0||s===0)return null;if(_ instanceof HTMLImageElement&&!_.complete)throw new Error("The source is not loaded.");const D=this._scanRegion,F=this.getFrameSize(o,s,D,this.maxCvsSideLength);if(!F)return null;let T=!0;o===F.sWidth&&s===F.sHeight&&(T=!1);const I=this.mapPixelFormatString_Enum.get(this.framePixelFormat.toLowerCase()),k={data:null,region:D?JSON.parse(JSON.stringify(D)):null,sx:F.sx,sy:F.sy,width:F.dWidth,height:F.dHeight,colorMode:null,pixelFormat:null,timeSpent:null,timeStamp:null,isCropped:T,toCanvas:this._toCanvas,_sWidth:F.sWidth,_sHeight:F.sHeight,_bUseWebGL:null},U=this._getImageData(_,o,s,F,null,{pixelFormat:I});if(!U)return null;const K=Date.now();return me._onLog&&me._onLog("DCE: _getVideoData(region?) END: "+K),k.data=U.data,k.pixelFormat=k.colorMode=U.pixelFormat,k._bUseWebGL=U._bUseWebGL,k.timeSpent=K-m,k.timeStamp=K,U.pixelFormat===He.GREY?k.stride=k.width:k.stride=4*k.width,k};(_=>{let m=this._cvsSingleFrameMode;if(!m){if(m=document.createElement("canvas"),!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(m),m.style.position="absolute",m.style.width="100%",m.style.height="100%",m.style.left="0",m.style.top="0",m.style.objectFit="contain",m.style.pointerEvents="none",this._cvsSingleFrameMode=m}m.width==o&&m.height==s||(m.width=o,m.height=s);const D=m.getContext("2d");D.clearRect(0,0,m.width,m.height),D.drawImage(_,0,0)})(i),this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let _ of this._arrScanRegionOverlays)_&&this._updateScanRegionOverlay(_);let g;this._updateDrawingLayersSize();try{g=u(i)}catch(_){throw _}const B=this.mapCameraEvents.get("singleframeacquired");for(let _ of B)if(_)try{const m={data:new Uint8Array(g.data),region:JSON.parse(JSON.stringify(g.region)),sx:g.sx,sy:g.sy,width:g.width,height:g.height,stride:g.stride,colorMode:g.colorMode,pixelFormat:g.pixelFormat,timeSpent:g.timeSpent,timeStamp:g.timeStamp,isCropped:g.isCropped,toCanvas:g.toCanvas,_sWidth:g._sWidth,_sHeight:g._sHeight,_bUseWebGL:g._bUseWebGL};await _.apply(this,[m])}catch(m){console.error(m)}}),e.style.position="fixed",e.style.left="-1px",e.style.top="-1px",e.style.width="1px",e.style.height="1px",e.style.backgroundColor="transparent",e.style.color="transparent",document.body.appendChild(e)}this._singleFrameModeIpt.click()}},this.styleEls=[],this._framePixelFormat=void 0,this._defaultFramePixelFormat="rgba",this.mapPixelFormatString_Enum=new Map([["grey",He.GREY],["grey32",He.GREY32],["rgba",He.RGBA],["rbga",He.RBGA],["grba",He.GRBA],["gbra",He.GBRA],["brga",He.BRGA],["bgra",He.BGRA]]),this.shaderPixelFormat=He.RGBA,this.maxVideoCvsLength=3,this._reusedCvs=null,this._reusedWebGLCvs=null,this._tempDataContainer=null,this._webGLTexture=null,this._webGLProgramInfo=null,this._webGLBuffers=null,this._softwareScale=1,this._scaleCenter={x:0,y:0},this._focusParameters={maxTimeout:400,minTimeout:300,kTimeout:void 0,oldDistance:null,fds:null,isDoingFocus:0,taskBackToContinous:null,curFocusTaskId:0,focusCancelableTime:1500,defaultFocusAreaSizeRatio:6,focusBackToContinousTime:5e3,tapFocusMinDistance:null,tapFocusMaxDistance:null,_focusArea:null},this._tapFocusEnabled=!0,this._focusSupported=!0,this._tapDoFocus=async e=>{if(this._touchMoved)return void(this._touchMoved=!1);if(!this._tapFocusEnabled||!this._bOpen||this.singleFrameMode||!this._video||this._video.paused||!this._videoTrack||!this._focusSupported||this.getDrawingLayers().some(re=>re.getMode()=="editor"))return;if(!this._focusParameters.fds&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,!this._focusParameters.fds))return void(this._focusSupported=!1);if(this._focusParameters.kTimeout==null&&(this._focusParameters.kTimeout=(this._focusParameters.maxTimeout-this._focusParameters.minTimeout)/(1/this._focusParameters.fds.min-1/this._focusParameters.fds.max)),this._focusParameters.isDoingFocus==1)return;let t,i,o,s;if(this._focusParameters.taskBackToContinous&&(clearTimeout(this._focusParameters.taskBackToContinous),this._focusParameters.taskBackToContinous=null),e instanceof MouseEvent)t=e.clientX,i=e.clientY;else{if(!(e instanceof TouchEvent))throw new Error("Unknown event type.");if(!e.changedTouches.length)return;t=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY}const u=this.getVideoFit(),g=this._video.videoWidth,B=this._video.videoHeight,_=this._elContainer.getBoundingClientRect(),m=_.left,D=_.top,F=window.getComputedStyle(this._elContainer),T=parseFloat(F.width),I=parseFloat(F.height),k=T/I,U=g/B;let K=1;if(u==="contain")U>k?(K=T/g,o=(t-m)/K,s=(i-D-(I-T/U)/2)/K):(K=I/B,s=(i-D)/K,o=(t-m-(T-I*U)/2)/K);else{if(u!=="cover")throw new Error("Unsupported object-fit.");U>k?(K=I/B,s=(i-D)/K,o=(t-m+(I*U-T)/2)/K):(K=T/g,o=(t-m)/K,s=(i-D+(T/U-I)/2)/K)}const X={x:o+"px",y:s+"px"},te=2*Math.round(Math.min(g,B)/this._focusParameters.defaultFocusAreaSizeRatio/2)+"px",ne=te;await this._setLocalFocus(X,te,ne,this._focusParameters.tapFocusMinDistance,this._focusParameters.tapFocusMaxDistance),this._focusParameters.taskBackToContinous=setTimeout(()=>{this._videoTrack&&this._videoTrack.applyConstraints({advanced:[{focusMode:"continuous"}]}).catch(()=>{})},this._focusParameters.focusBackToContinousTime)},this._touchMoved=!1,this._touchMoveEvent=()=>{this._touchMoved=!0},this._recordedStates={},this.playCallbackInfo=null,this._toCanvas=function(){const e=document.createElement("canvas");let t;if(e.width=this.width,e.height=this.height,(this.pixelFormat||this.colorMode)==="grey"){t=new Uint8ClampedArray(this.width*this.height*4);for(let o=0;o<t.length;o+=4)t[o]=this.data[o/4],t[o+1]=this.data[o/4],t[o+2]=this.data[o/4],t[o+3]=255}else t=new Uint8ClampedArray(this.data.buffer);const i=new ImageData(t,this.width,this.height);return e.getContext("2d").putImageData(i,0,0),e},this._onCameraSelChange=async()=>{await this.selectCamera(this._selCam.value),this._bOpen||this.stop()},this._onResolutionSelChange=async()=>{let e,t;if(this._selRsl&&this._selRsl.selectedIndex!=-1){let i=this._selRsl.options[this._selRsl.selectedIndex];e=i.getAttribute("data-width"),t=i.getAttribute("data-height")}await this.setResolution(e,t),this._bOpen||this.stop()},this._onCloseBtnClick=()=>{this.close(!0)},this._bOpen=!1,this.isCameraEnhancer=!0,this.isDisposed=!1,this.disposed=!1,this.videoSrc=null,this.videoSettings={video:{width:{ideal:1280},height:{ideal:720},facingMode:{ideal:"environment"}}},this.iPlayRound=0,this.promisePlay=null,this._ifSaveLastUsedCamera=!1,this.ifSkipCameraInspection=!1,this._allCameras=[],this._currentCamera=null,this._videoTrack=null,this._lastDeviceId=void 0,this._vc_bPlayingVideoBeforeHide=!1,this._ev_documentHideEvent=()=>{if(!this.singleFrameMode)if(document.visibilityState==="visible"){if(me._onLog&&me._onLog("DCE: document visible."),this._bOpen&&this._vc_bPlayingVideoBeforeHide){if(this.videoSrc)this._video.play();else if(this._video.srcObject){const e=this._video.srcObject.getTracks()[0];this._video.srcObject.active&&e&&!e.muted?this._video.play():this.play()}}}else document.visibilityState==="hidden"&&(me._onLog&&me._onLog("DCE: document hidden."),["iPhone","iPad"].includes(At.OS)?(this._vc_bPlayingVideoBeforeHide=!0,this._video&&this._video.pause()):this._video&&!this._video.paused?(this._vc_bPlayingVideoBeforeHide=!0,this._video.pause()):this._vc_bPlayingVideoBeforeHide=!1)},this.containerClassName="dce-video-container",this._elContainer=null,this._videoContainer=null,this._video=null,this.videoFit="contain",this._cvsScanRegion=null,this._divScanArea=null,this._divScanLight=null,this._bgLoading=null,this._selCam=null,this._bgCamera=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,this.regionMaskFillStyle="rgba(0,0,0,0.5)",this.regionMaskStrokeStyle="rgb(254,142,20)",this.regionMaskLineWidth=2,this._bShowScanRegionMask=!0,this._bShowScanRegionLaser=void 0,this._defaultBShowScanRegionLaser=!1,this._scanRegion=null,this._arrScanRegionOverlays=[],this._layerBaseCvs=null,this._drawingLayerOfTip=null,this._tipArgs={x:void 0,y:void 0,width:void 0,duration:void 0,autoShowSuggestedTip:void 0},this._hideTipTimeoutId=null,this.onTipSuggested=null,this._cvsViewDecorator=null,this._decoratorType=[],this._decoratorArea=null,this._viewDecoratorInfo={rectangle:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},focus:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},crossline:{lineWidth:2,strokeStyle:"rgb(254,142,20)"},crosshair:{lineWidth:4,strokeStyle:"rgb(254,142,20)"}},this._croppingRegions=void 0,this._defaultCroppingRegions=[null],this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0,this._loopInterval=void 0,this._defaultLoopInterval=0,this._maxNumberOfFramesInBuffer=void 0,this._defaultMaxNumberOfFramesInBuffer=1,this._frameQueue=[],this._bFetchingLoopStarted=!1,this._refreshInterval=void 0,this._defaultRefreshInterval=-1,this._updateLayersTimeout=500,this._updateLayers=()=>{this._cvsScanRegion&&(this._cvsScanRegion.style.display="none"),this._divScanLight&&(this._divScanLight.style.display="none"),this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none");for(let e of this._arrScanRegionOverlays)e&&(e.style.display="none");this._resizeTimeoutId&&clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=setTimeout(()=>{if(!this.isDisposed||!this.disposed){this.ifShowScanRegionMask&&this.showScanRegionMask(),this.ifShowScanRegionLaser&&this.showScanRegionLaser(),this._cvsViewDecorator&&this.showViewDecorator(),this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let e of this._arrScanRegionOverlays)e&&(e.style.display="",this._updateScanRegionOverlay(e));this._updateDrawingLayersSize(),this._updateVideoContainerStyle()}},this._updateLayersTimeout)},this._windowResizeListener=()=>{this._windowWidth!==document.documentElement.clientWidth&&(this._windowWidth=document.documentElement.clientWidth,this._updateLayers())},this.mapCameraEvents=new Map([["cameraopen",[]],["cameraclose",[]],["camerachange",[]],["resolutionchange",[]],["played",[]],["singleframeacquired",[]],["frameaddedtobuffer",[]]]),this._controler=null}static getVersion(){return this._version}static async detectEnvironment(){return await(async()=>({wasm:vx,worker:_x,getUserMedia:j0,camera:await Cx(),browser:At.browser,version:At.version,OS:At.OS}))()}static set engineResourcePath(e){if(this._hasEngineResourceLoaded)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` is called.");me._engineResourcePath=(t=>{if(t==null&&(t="./"),!zi){let i=document.createElement("a");i.href=t,t=i.href}return t.endsWith("/")||(t+="/"),t})(e)}static get engineResourcePath(){return this._engineResourcePath}static isStorageAvailable(e){let t;try{t=window[e];const i="__storage_test__";return t.setItem(i,i),t.removeItem(i),!0}catch(i){return i instanceof DOMException&&(i.code===22||i.code===1014||i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&t.length!==0}}static isDCEFrame(e){return!(!e||typeof e!="object"||Array.isArray(e))&&"data"in e&&"region"in e&&"sx"in e&&"sy"in e&&"width"in e&&"height"in e&&("colorMode"in e||"pixelFormat"in e)&&"timeSpent"in e&&"timeStamp"in e&&"isCropped"in e&&"toCanvas"in e&&"_sWidth"in e&&"_sHeight"in e&&"_bUseWebGL"in e}static async testCameraAccess(){try{if(!navigator||!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return{ok:!1,message:"Insecure context."};(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(e=>{e.stop()})}catch(e){if(e.name==="OverconstrainedError"||e.name==="NotFoundError")return{ok:!1,message:"No camera detected."};if(e.name==="NotAllowedError")return{ok:!1,message:"No permission to access camera."};if(e.name==="AbortError")return{ok:!1,message:"Some problem occurred which prevented the device from being used."};if(e.name==="NotReadableError")return{ok:!1,message:"A hardware error occurred."};if(e.name==="SecurityError")return{ok:!1,message:"User media support is disabled."};throw e}return{ok:!0,message:"Successfully accessed the camera."}}set maxCvsSideLength(e){if(e<=0)throw new Error("Invalid value.");this._maxCvsSideLength=e}get maxCvsSideLength(){if(this._maxCvsSideLength!==void 0)return this._maxCvsSideLength;if(this._controler){const e=this._controler.getPropertyDisiredValue("maxCvsSideLength");if(e&&e.length===1)return e[0]}return this._defaultMaxCvsSideLength}static set defaultUIElementURL(e){me._defaultUIElementURL=e}static get defaultUIElementURL(){var e;return(e=me._defaultUIElementURL)===null||e===void 0?void 0:e.replace("@engineResourcePath/",me.engineResourcePath)}getUIElement(){return this.UIElement}async setUIElement(e){if(this._bOpen)throw new Error("It is not allowed to change the UIElement when the camera is open.");if(typeof e=="string"||e instanceof String){if(!e.trim().startsWith("<")){let i=await fetch(e);if(!i.ok)throw Error("setUIElement(elementOrUrl): Network Error: "+i.statusText);e=await i.text()}if(!e.trim().startsWith("<"))throw Error("setUIElement(elementOrUrl): Can't get valid HTMLElement.");let t=document.createElement("div");t.innerHTML=e;for(let i=0;i<t.childElementCount;++i){let o=t.children[i];o instanceof HTMLStyleElement&&(this.styleEls.push(o),document.head.append(o))}(e=t.childElementCount==1?t.children[0]:t).remove()}this.UIElement=e,this._uiOriginalState={display:e&&e.style.display,inDom:document.body.contains(e)}}appendAndShowUI(){this.UIElement&&(this.UIElement.parentNode||(this.UIElement.style.position="fixed",this.UIElement.style.left="0",this.UIElement.style.top="0",document.body.append(this.UIElement)),this.UIElement.style.display=="none"&&(this.UIElement.style.display=""))}hideUI(){this.UIElement&&(this.UIElement.style.display="none")}get singleFrameMode(){return this._singleFrameMode}set singleFrameMode(e){if(this._bOpen)throw new Error("It is not allowed to change `singleFrameMode` when the camera is open.");this._singleFrameMode=e}set frameColorMode(e){this._framePixelFormat=e}get frameColorMode(){if(this._framePixelFormat!==void 0)return this._framePixelFormat;if(this._controler){const e=this._controler.getPropertyDisiredValue("framePixelFormat")||this._controler.getPropertyDisiredValue("frameColorMode");if(e&&e.length===1)return e[0]}return this._defaultFramePixelFormat}set framePixelFormat(e){this._framePixelFormat=e}get framePixelFormat(){if(this._framePixelFormat!==void 0)return this._framePixelFormat;if(this._controler){const e=this._controler.getPropertyDisiredValue("framePixelFormat")||this._controler.getPropertyDisiredValue("frameColorMode");if(e&&e.length===1)return e[0]}return this._defaultFramePixelFormat}set bOpen(e){if(this._bOpen=e,e){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let t of this._arrScanRegionOverlays)t&&this._updateScanRegionOverlay(t);this._updateDrawingLayersSize(),this.ifShowScanRegionMask?this.showScanRegionMask():this.hideScanRegionMask(),this.ifShowScanRegionLaser?this.showScanRegionLaser():this.hideScanRegionLaser(),this.showViewDecorator(),this.showScanRegionOverlays(),this._drawingLayersManager.setVisible(!0)}else this._softwareScale=1}set ifSaveLastUsedCamera(e){e?me.isStorageAvailable("localStorage")?this._ifSaveLastUsedCamera=!0:(this._ifSaveLastUsedCamera=!1,console.warn("Local storage is unavailable")):this._ifSaveLastUsedCamera=!1}get ifSaveLastUsedCamera(){return this._ifSaveLastUsedCamera}get video(){return this._video}setVideoFit(e){if(e=e.toLowerCase(),!["contain","cover"].includes(e))throw new Error(`Unsupported value '${e}'.`);if(this.videoFit=e,this._video&&(this._video.style.objectFit=e,!this.singleFrameMode)){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let t of this._arrScanRegionOverlays)t&&this._updateScanRegionOverlay(t);this._updateVideoContainerStyle(),this._drawingLayersManager.setObjectFit(e)}}getVideoFit(){return this.videoFit}_showElClassName(){this._cvsScanRegion&&this._cvsScanRegion.classList.add("cvs-scan-region-mask"),this._cvsViewDecorator&&this._cvsViewDecorator.classList.add("cvs-view-decorator"),this._scanRegionOverlayContainer&&this._scanRegionOverlayContainer.classList.add("div-scan-region-overlay-container"),this._layerBaseCvs&&this._layerBaseCvs.classList.add("cvs-drawing-layer-base"),this._layerBaseCvs&&this._layerBaseCvs.parentElement.classList.add("div-drawing-layer-container"),this._cvsOriginalImage&&this._cvsOriginalImage.classList.add("cvs-original-image"),this._cvsSingleFrameMode&&this._cvsSingleFrameMode.classList.add("cvs-single-frame")}_hideElClassName(){this._cvsScanRegion&&this._cvsScanRegion.classList.remove("cvs-scan-region-mask"),this._cvsViewDecorator&&this._cvsViewDecorator.classList.remove("cvs-view-decorator"),this._scanRegionOverlayContainer&&this._scanRegionOverlayContainer.classList.remove("div-scan-region-overlay-container"),this._layerBaseCvs&&this._layerBaseCvs.classList.remove("cvs-drawing-layer-base"),this._layerBaseCvs&&this._layerBaseCvs.parentElement.classList.remove("div-drawing-layer-container"),this._cvsOriginalImage&&this._cvsOriginalImage.classList.remove("cvs-original-image"),this._cvsSingleFrameMode&&this._cvsSingleFrameMode.classList.remove("cvs-single-frame")}set ifShowScanRegionMask(e){this._bShowScanRegionMask=e,e?this.showScanRegionMask():this.hideScanRegionMask()}get ifShowScanRegionMask(){return this._bShowScanRegionMask}showScanRegionMask(){this._cvsScanRegion&&(this._cvsScanRegion.style.display=="none"&&(this._cvsScanRegion.style.display=""),this._recordedStates.maskShow=!0)}hideScanRegionMask(){this._cvsScanRegion&&(this._cvsScanRegion.style.display="none",this._recordedStates.maskShow=!1)}set ifShowScanRegionLaser(e){this._bShowScanRegionLaser=e,e?this.showScanRegionLaser():this.hideScanRegionLaser()}get ifShowScanRegionLaser(){if(this._bShowScanRegionLaser!==void 0)return this._bShowScanRegionLaser;if(this._controler){const e=this._controler.getPropertyDisiredValue("ifShowScanRegionLaser");if(e&&e.length){let t=0;for(let i of e)i||t++;return t!==this._controler.getRegisteredUsers().length}}return this._defaultBShowScanRegionLaser}showScanRegionLaser(){this._divScanLight&&(this._divScanLight.style.display=="none"&&(this._divScanLight.style.display="block"),this._recordedStates.laserShow=!0)}hideScanRegionLaser(){this._divScanLight&&(this._divScanLight.style.display="none",this._recordedStates.laserShow=!1)}_checkValidRegion(e){return e===null||!!e&&!!(e.hasOwnProperty("regionLeft")&&e.hasOwnProperty("regionTop")&&e.hasOwnProperty("regionRight")&&e.hasOwnProperty("regionBottom")&&e.hasOwnProperty("regionMeasuredByPercentage"))&&!(e.regionLeft<0||e.regionTop<0||e.regionRight<0||e.regionBottom<0)&&(!e.regionMeasuredByPercentage||!(e.regionLeft>100||e.regionTop>100||e.regionRight>100||e.regionBottom>100))}set scanRegion(e){if(!this._checkValidRegion(e))throw new Error("Invalid region.");this._scanRegion=JSON.parse(JSON.stringify(e)),this._updateScanRegionCanvas(),this._updateScanAreaDiv();for(let t of this._arrScanRegionOverlays)t&&this._updateScanRegionOverlay(t)}setScanRegion(e){this.scanRegion=e}getScanRegion(){return JSON.parse(JSON.stringify(this._scanRegion))}_calculateCvsSize(){if(!this._bOpen)return null;let e,t,i;if(this.singleFrameMode)e=this._imgWidth,t=this._imgHeight,i="contain";else{if(!this._video)return null;e=this._video.videoWidth,t=this._video.videoHeight,i=this.getVideoFit()}return e<=0||t<=0?null:{width:e,height:t,objectFit:i}}addScanRegionOverlayCanvas(){this._assertOpen();const e=document.createElement("canvas");if(this._updateScanRegionOverlay(e),!this._scanRegionOverlayContainer){const t=document.createElement("div");if(this._scanRegionOverlayContainer=t,t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.width="100%",t.style.height="100%",t.style.overflow="hidden",t.style.pointerEvents="none",this._layerBaseCvs)this._layerBaseCvs.parentElement.after(t);else if(this._cvsScanRegion)this._cvsScanRegion.after(t);else if(this._cvsOriginalImage)this._cvsOriginalImage.after(t);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(t);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(t)}this._recordedStates.overlayShow=!0}return this._scanRegionOverlayContainer.append(e),this._arrScanRegionOverlays.push(e),e}removeScanRegionOverlayCanvas(e){const t=this._arrScanRegionOverlays.indexOf(e);t!==-1&&(e.remove(),this._arrScanRegionOverlays.splice(t,1))}_updateScanRegionOverlay(e){if(!e)return;const t=this._calculateCvsSize();if(!t)return;const{width:i,height:o,objectFit:s}=t;if(i<=0||o<=0)return e.width=0,void(e.height=0);const u=this._getRegionInPixels(i,o,this._scanRegion),g=this.getFrameSize(i,o,this._scanRegion,this.maxCvsSideLength),B=g.dWidth,_=g.dHeight;e.width==B&&e.height==_||(e.width=B,e.height=_);const m=window.getComputedStyle(this._elContainer),D=parseFloat(m.width),F=parseFloat(m.height),T=D/F,I=i/o;let k,U,K,X,te=1;s==="contain"?(I>T?(te=D/i,k=0,U=(F-o*te)/2):(te=F/o,k=(D-i*te)/2,U=0),k+=u.regionLeft*te,U+=u.regionTop*te,K=(u.regionRight-u.regionLeft)*te,X=(u.regionBottom-u.regionTop)*te):s==="cover"?(I>T?(te=F/o,k=u.regionLeft*te-(i*te-D)/2,U=u.regionTop*te):(te=D/i,k=u.regionLeft*te,U=u.regionTop*te-(o*te-F)/2),K=(u.regionRight-u.regionLeft)*te,X=(u.regionBottom-u.regionTop)*te):(k=0,U=0,K=0,X=0),e.style.position="absolute",e.style.left=k+"px",e.style.top=U+"px",e.style.width=K+"px",e.style.height=X+"px"}showScanRegionOverlays(){this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display=="none"&&(this._scanRegionOverlayContainer.style.display=""),this._recordedStates.overlayShow=!0)}hideScanRegionOverlays(){this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display="none",this._recordedStates.overlayShow=!1)}setViewDecorator(e,t){if(!e)return void(this._cvsViewDecorator&&(this._cvsViewDecorator.remove(),this._cvsViewDecorator=null));if(!t)throw new Error("Invalid area.");this._assertOpen();let i=[];if(typeof e=="string"?i.push(e):Array.isArray(e)&&(i=JSON.parse(JSON.stringify(e))),!this._cvsViewDecorator){if(this._cvsViewDecorator=document.createElement("canvas"),this._scanRegionOverlayContainer)this._scanRegionOverlayContainer.after(this._cvsViewDecorator);else if(this._layerBaseCvs)this._layerBaseCvs.parentElement.after(this._cvsViewDecorator);else if(this._cvsScanRegion)this._cvsScanRegion.after(this._cvsViewDecorator);else if(this._cvsOriginalImage)this._cvsOriginalImage.after(this._cvsViewDecorator);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(this._cvsViewDecorator);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(this._cvsViewDecorator)}this._recordedStates.decoratorShow=!0}this._decoratorArea=JSON.parse(JSON.stringify(t)),this._decoratorType.length=0;const o=["rectangle","focus"],s=["crossline","crosshair"];let u=!1,g=!1;for(let B of i)B=B.toLowerCase(),o.includes(B)&&!u&&(u=!0,this._decoratorType.push(B)),s.includes(B)&&!g&&(g=!0,!this._decoratorType.includes(B)&&this._decoratorType.push(B));this._updateViewDecorator()}getViewDecorator(){return{type:JSON.parse(JSON.stringify(this._decoratorType)),area:JSON.parse(JSON.stringify(this._decoratorArea)),canvas:this._cvsViewDecorator}}showViewDecorator(){this._cvsViewDecorator&&(this._cvsViewDecorator.style.display=="none"&&(this._cvsViewDecorator.style.display=""),this._recordedStates.decoratorShow=!0)}hideViewDecorator(){this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none",this._recordedStates.decoratorShow=!1)}setViewDecoratorLineWidth(e,t){if(typeof e!="string")throw new Error("The 'type' should be a string.");if(e=e.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(e))throw new Error(`The type of '${e}' doesn't exist.`);if(!this._viewDecoratorInfo[e].hasOwnProperty("lineWidth"))throw new Error(`It is not allowed to change the property 'lineWidth' when the decorator type is '${e}'.`);this._viewDecoratorInfo[e].lineWidth=t,this._updateViewDecorator()}setViewDecoratorStrokeStyle(e,t){if(typeof e!="string")throw new Error("The 'type' should be a string.");if(e=e.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(e))throw new Error(`The type of '${e}' doesn't exist.`);if(!this._viewDecoratorInfo[e].hasOwnProperty("strokeStyle"))throw new Error(`It is not allowed to change the property 'strokeStyle' when the decorator type is '${e}'.`);this._viewDecoratorInfo[e].strokeStyle=t,this._updateViewDecorator()}setViewDecoratorFillStyle(e,t){if(typeof e!="string")throw new Error("The 'type' should be a string.");if(e=e.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(e))throw new Error(`The type of '${e}' doesn't exist.`);if(!this._viewDecoratorInfo[e].hasOwnProperty("fillStyle"))throw new Error(`It is not allowed to change the property 'fillStyle' when the decorator type is '${e}'.`);this._viewDecoratorInfo[e].fillStyle=t,this._updateViewDecorator()}setViewDecoratorMaskFillStyle(e,t){if(typeof e!="string")throw new Error("The 'type' should be a string.");if(e=e.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(e))throw new Error(`The type of '${e}' doesn't exist.`);if(!this._viewDecoratorInfo[e].hasOwnProperty("maskFillStyle"))throw new Error(`It is not allowed to change the property 'maskFillStyle' when the decorator type is '${e}'.`);this._viewDecoratorInfo[e].maskFillStyle=t,this._updateViewDecorator()}_updateViewDecorator(){if(!this._bOpen||!this._cvsViewDecorator||!this._decoratorArea)return;let e;if(this.singleFrameMode)e="contain";else{if(!this._video)return;e=this.getVideoFit()}const t=this._cvsViewDecorator;t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.left="0",t.style.top="0",t.style.objectFit=e,t.style.pointerEvents="none";const i=this.getVisibleRegion(!0),o=i.regionRight-i.regionLeft,s=i.regionBottom-i.regionTop;if(t.width==o&&t.height==s||(t.width=o,t.height=s),o<=0||s<=0)return;const u=t.getContext("2d");u.clearRect(0,0,t.width,t.height);const g=this._decoratorArea.x/100*o,B=this._decoratorArea.y/100*s,_=this._decoratorArea.width/100*o,m=this._decoratorArea.height/100*s;for(let D of this._decoratorType){if(D==="rectangle"){u.fillStyle=this._viewDecoratorInfo.rectangle.maskFillStyle,u.fillRect(0,0,t.width,t.height),u.clearRect(Math.round(g),Math.round(B),Math.round(_),Math.round(m)),u.fillStyle=this._viewDecoratorInfo.rectangle.fillStyle,u.fillRect(Math.round(g),Math.round(B),Math.round(_),Math.round(m)),u.lineWidth=this._viewDecoratorInfo.rectangle.lineWidth,u.strokeStyle=this._viewDecoratorInfo.rectangle.strokeStyle;const F=u.lineWidth/2;u.strokeRect(Math.round(g-F),Math.round(B-F),Math.round(_+u.lineWidth),Math.round(m+u.lineWidth))}if(D==="focus"){u.fillStyle=this._viewDecoratorInfo.focus.maskFillStyle,u.fillRect(0,0,t.width,t.height),u.clearRect(Math.round(g),Math.round(B),Math.round(_),Math.round(m)),u.fillStyle=this._viewDecoratorInfo.focus.fillStyle,u.fillRect(Math.round(g),Math.round(B),Math.round(_),Math.round(m)),u.lineWidth=this._viewDecoratorInfo.focus.lineWidth,u.strokeStyle=this._viewDecoratorInfo.focus.strokeStyle;const F=u.lineWidth/2,T=[0,.25,.75,1],I=[0,.25,.75,1];u.beginPath();for(let k=0;k<T.length;k++)if(k==0||k==3)for(let U=0;U<I.length;U+=2)u.moveTo(Math.round(g+T[k]*_),Math.round(B+I[U]*m)),u.lineTo(Math.round(g+T[k]*_),Math.round(B+I[U+1]*m));for(let k=0;k<I.length;k++)if(k==0||k==3)for(let U=0;U<T.length;U+=2)u.moveTo(Math.round(g+T[U]*_-F),Math.round(B+I[k]*m)),u.lineTo(Math.round(g+T[U+1]*_+F),Math.round(B+I[k]*m));u.stroke()}if(D==="crossline"&&(u.beginPath(),u.lineWidth=this._viewDecoratorInfo.crossline.lineWidth,u.strokeStyle=this._viewDecoratorInfo.crossline.strokeStyle,u.moveTo(Math.round(g),Math.round(B+m/2)),u.lineTo(Math.round(g+_),Math.round(B+m/2)),u.moveTo(Math.round(g+_/2),Math.round(B)),u.lineTo(Math.round(g+_/2),Math.round(B+m)),u.stroke()),D==="crosshair"){u.beginPath();const F=.05*Math.min(_,m);u.lineWidth=this._viewDecoratorInfo.crosshair.lineWidth,u.strokeStyle=this._viewDecoratorInfo.crosshair.strokeStyle,u.moveTo(Math.round(g+(_-F)/2),Math.round(B+m/2)),u.lineTo(Math.round(g+(_+F)/2),Math.round(B+m/2)),u.moveTo(Math.round(g+_/2),Math.round(B+(m-F)/2)),u.lineTo(Math.round(g+_/2),Math.round(B+(m+F)/2)),u.stroke()}}}getVisibleRegion(e){this._assertOpen();const t=this._calculateCvsSize();if(!t)return null;const{width:i,height:o,objectFit:s}=t;let u=(()=>{const g=parseFloat(window.getComputedStyle(this._elContainer).width),B=parseFloat(window.getComputedStyle(this._elContainer).height);let _,m={regionBottom:o,regionRight:i,regionLeft:0,regionTop:0,regionMeasuredByPercentage:!1};return s==="cover"?g/B<i/o?(_=B/o,m.regionLeft=Math.floor((i-g/_)/2),m.regionRight=Math.ceil(i-m.regionLeft),m.regionTop=0,m.regionBottom=o):(_=g/i,m.regionTop=Math.floor((o-B/_)/2),m.regionBottom=Math.ceil(o-m.regionTop),m.regionLeft=0,m.regionRight=i):s==="none"&&(g<i&&B<o?(m.regionLeft=Math.floor((i-g)/2),m.regionRight=Math.ceil(i-m.regionLeft),m.regionTop=Math.floor((o-B)/2),m.regionBottom=Math.ceil(o-m.regionTop)):g<i?(m.regionLeft=Math.floor((i-g)/2),m.regionRight=Math.ceil(i-m.regionLeft),m.regionTop=0,m.regionBottom=o):B<o&&(m.regionTop=Math.floor((o-B)/2),m.regionBottom=Math.ceil(o-m.regionTop),m.regionLeft=0,m.regionRight=i)),m})();return e?u.regionMeasuredByPercentage=!1:(u.regionBottom=Math.ceil(u.regionBottom/o*100),u.regionRight=Math.ceil(u.regionRight/i*100),u.regionLeft=Math.floor(u.regionLeft/i*100),u.regionTop=Math.floor(u.regionTop/o*100),u.regionMeasuredByPercentage=!0),u}setScanRegionMaskStyle(e){e&&(e.fillStyle&&(this.regionMaskFillStyle=e.fillStyle),e.strokeStyle&&(this.regionMaskStrokeStyle=e.strokeStyle),e.lineWidth&&(this.regionMaskLineWidth=e.lineWidth),this._updateScanRegionCanvas())}_getRegionInPixels(e,t,i){if(!(e<=0||t<=0))return i?i.regionMeasuredByPercentage?{regionLeft:Math.round(i.regionLeft/100*e),regionTop:Math.round(i.regionTop/100*t),regionRight:Math.round(i.regionRight/100*e),regionBottom:Math.round(i.regionBottom/100*t),regionMeasuredByPercentage:!1}:JSON.parse(JSON.stringify(i)):{regionLeft:0,regionTop:0,regionRight:e,regionBottom:t,regionMeasuredByPercentage:!1}}_updateScanRegionCanvas(){if(!this._bOpen)return;const e=this._calculateCvsSize();if(!e)return;const{width:t,height:i,objectFit:o}=e;if(t<=0||i<=0)return void(this._cvsScanRegion&&(this._cvsScanRegion.width=0,this._cvsScanRegion.height=0));const s=this._getRegionInPixels(t,i,this._scanRegion);if(!this._cvsScanRegion){if(this._cvsScanRegion=document.createElement("canvas"),this._cvsOriginalImage)this._cvsOriginalImage.after(this._cvsScanRegion);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(this._cvsScanRegion);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(this._cvsScanRegion)}this._recordedStates.maskShow=!0}const u=this._cvsScanRegion;u.style.position="absolute",u.style.width="100%",u.style.height="100%",u.style.left="0",u.style.top="0",u.style.objectFit=o,u.style.pointerEvents="none",u.width==t&&u.height==i||(u.width=t,u.height=i);const g=u.getContext("2d");if(g.clearRect(0,0,u.width,u.height),s.regionLeft!=0||s.regionRight!=t||s.regionTop!=0||s.regionBottom!=i){const B=s.regionLeft,_=s.regionTop,m=s.regionRight-s.regionLeft,D=s.regionBottom-s.regionTop;g.fillStyle=this.regionMaskFillStyle,g.fillRect(0,0,u.width,u.height),g.clearRect(Math.round(B),Math.round(_),Math.round(m),Math.round(D)),g.strokeStyle=this.regionMaskStrokeStyle,g.lineWidth=this.regionMaskLineWidth;const F=g.lineWidth/2;g.strokeRect(Math.round(B-F),Math.round(_-F),Math.round(m+g.lineWidth),Math.round(D+g.lineWidth))}}_updateScanAreaDiv(){if(!this._bOpen)return;const e=this._calculateCvsSize();if(!e)return;const{width:t,height:i,objectFit:o}=e;if(!this._divScanArea)return;if(t<=0||i<=0)return this._divScanArea.style.width="0",void(this._divScanArea.style.height="0");const s=this._getRegionInPixels(t,i,this._scanRegion),u=window.getComputedStyle(this._elContainer),g=parseFloat(u.width),B=parseFloat(u.height),_=g/B,m=t/i;let D,F,T,I,k=1;if(o==="contain")_<m?(k=g/t,D=0,F=(B-i*k)/2):(k=B/i,D=(g-t*k)/2,F=0),D+=s.regionLeft*k,F+=s.regionTop*k,T=(s.regionRight-s.regionLeft)*k,I=(s.regionBottom-s.regionTop)*k;else if(o==="cover")if(_<m){k=B/i,D=s.regionLeft*k-(t*k-g)/2,D=Math.max(D,0),D=Math.min(D,parseFloat(u.width)),F=s.regionTop*k;let U=s.regionRight*k-(t*k-g)/2;U=Math.max(U,0),U=Math.min(U,parseFloat(u.width)),T=U-D,I=(s.regionBottom-s.regionTop)*k}else{k=g/t,D=s.regionLeft*k,F=s.regionTop*k-(i*k-B)/2,F=Math.max(F,0),F=Math.min(F,parseFloat(u.height));let U=s.regionBottom*k-(i*k-B)/2;U=Math.max(U,0),U=Math.min(U,parseFloat(u.height)),T=(s.regionRight-s.regionLeft)*k,I=U-F}else D=0,F=0,T=0,I=0;this._divScanArea.style.left=D+"px",this._divScanArea.style.top=F+"px",this._divScanArea.style.width=T+"px",this._divScanArea.style.height=I+"px"}set croppingRegions(e){this._croppingRegions=e,this._bFetchingLoopStarted&&(this.bIncreaseRegionIndexAuto&&(this._croppingRegionIndex=0),this._fetchingLoop(!1))}get croppingRegions(){if(this._croppingRegions!==void 0)return this._croppingRegions;if(this._controler){const e=this._controler.getPropertyDisiredValue("croppingRegions");if(e&&e.length===1)return e[0]}return this._defaultCroppingRegions}set croppingRegionIndex(e){e<0?(this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0):(this.bIncreaseRegionIndexAuto=!1,this._croppingRegionIndex=e)}get croppingRegionIndex(){return this._croppingRegionIndex}set loopInterval(e){if(e<0)throw new Error("'Invalid value.");this._loopInterval=e,this._bFetchingLoopStarted&&this._fetchingLoop(!1)}get loopInterval(){if(this._loopInterval!==void 0)return this._loopInterval;if(this._controler){const e=this._controler.getPropertyDisiredValue("loopInterval");if(e&&e.length===1)return e[0]}return this._defaultLoopInterval}set maxNumberOfFramesInBuffer(e){if(e<=0)throw new Error("Invalid value.");for(this._maxNumberOfFramesInBuffer=e;this._frameQueue&&this._frameQueue.length>this.maxNumberOfFramesInBuffer;)this._frameQueue.shift()}get maxNumberOfFramesInBuffer(){if(this._maxNumberOfFramesInBuffer!==void 0)return this._maxNumberOfFramesInBuffer;if(this._controler){const e=this._controler.getPropertyDisiredValue("maxNumberOfFramesInBuffer");if(e&&e.length===1)return e[0]}return this._defaultMaxNumberOfFramesInBuffer}get numberOfFramesInBuffer(){return this._frameQueue.length}set refreshInterval(e){this._refreshInterval=e}get refreshInterval(){if(this._refreshInterval!==void 0)return this._refreshInterval;if(this._controler){const e=this._controler.getPropertyDisiredValue("refreshInterval");if(e&&e.length===1)return e[0]}return this._defaultRefreshInterval}static async createInstance(e){let t=new me;(typeof e=="string"||e instanceof String)&&(e=JSON.parse(e));for(let i in e)t[i]=e[i];return this._hasEngineResourceLoaded=!0,me.onWarning&&(location&&location.protocol==="file:"?setTimeout(()=>{me.onWarning&&me.onWarning({id:1,message:"The page is opened over file:// and Dynamsoft Camera Enhancer may not work properly. Please open the page via https://."})},0):window.isSecureContext!==!1&&navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||setTimeout(()=>{me.onWarning&&me.onWarning({id:2,message:"Dynamsoft Camera Enhancer may not work properly in a non-secure context. Please open the page via https://."})},0)),t._drawingLayersManager=new wx,t}static async playVideo(e,t,i){return new Promise((o,s)=>{e||s(new Error("Invalid video element.")),t||s(new Error("Invalid source.")),e.onloadedmetadata=async()=>{e.onloadedmetadata=null,await e.play(),o(e)},typeof t=="string"||t instanceof String?e.src=t:e.srcObject=t,i!==void 0&&setTimeout(()=>s(new Error("Failed to play video. Timeout.")),i)})}static findBestRearCamera(e){if(!e||!e.length)return null;const t=["rear","back","r\xFCck","arri\xE8re","trasera","tr\xE1s","traseira","posteriore","\u540E\u9762","\u5F8C\u9762","\u80CC\u9762","\u540E\u7F6E","\u5F8C\u7F6E","\u80CC\u7F6E","\u0437\u0430\u0434\u043D\u0435\u0439","\u0627\u0644\u062E\u0644\u0641\u064A\u0629","\uD6C4","arka","achterzijde","\u0E2B\u0E25\u0E31\u0E07","baksidan","bagside","sau","bak","tylny","takakamera","belakang","\u05D0\u05D7\u05D5\u05E8\u05D9\u05EA","\u03C0\u03AF\u03C3\u03C9","spate","h\xE1ts\xF3","zadn\xED","darrere","zadn\xE1","\u0437\u0430\u0434\u043D\u044F","stra\u017Enja","belakang","\u092C\u0948\u0915"];for(let i of e){const o=i.label.toLowerCase();if(o&&t.some(s=>o.includes(s))&&(["iPhone","iPad"].includes(At.OS)||/\b0(\b)?/.test(o)))return i.deviceId}return["Android","HarmonyOS"].includes(At.OS)?e[e.length-1].deviceId:null}async play(e,t,i,o){let s;if(this._video&&this.videoSrc){me._onLog&&(s=Date.now(),me._onLog("DCE: start loading static video: "+s));const B=await me.playVideo(this._video,this.videoSrc,4e3);if(me._onLog&&me._onLog("DCE: finish loading static video. Costs: "+(Date.now()-s)),!this._video)return B.pause(),this.playCallbackInfo={width:0,height:0,deviceId:null},{width:0,height:0,deviceId:null};const _={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};this.playCallbackInfo=JSON.parse(JSON.stringify(_));const m=this.mapCameraEvents.get("played");for(let D of m){if(!D)continue;const F=JSON.parse(JSON.stringify(_));setTimeout(()=>{this.isDisposed&&this.disposed||D.apply(this,[F])},0)}return this._recordedStates.videoPlaying=!0,_}if(this.singleFrameMode)return o&&o.notTriggerSingleFrameClick||this._clickIptSingleFrameMode(),this.playCallbackInfo={width:0,height:0,deviceId:null},{width:0,height:0,deviceId:null};if(!this._video)throw new Error("'video' is null or undefined.");const u=++this.iPlayRound;if(this.promisePlay&&(await this.promisePlay,u<this.iPlayRound))return this.playCallbackInfo={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId},{width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};this.promisePlay=(async()=>{var B;try{this._video&&this._video.srcObject&&this.stop(),me._onLog&&me._onLog("DCE: ======before video========");const _=()=>{if(!this._video)throw F&&F.getTracks().forEach(ne=>{ne.stop()}),this._videoTrack=null,this._currentCamera=null,new Error("'video' is null or undefined.")},m=this.getVideoSettings();let D,F;if(typeof m.video=="boolean"&&(m.video={}),e)delete m.video.facingMode,m.video.deviceId={exact:e};else if(!m.video.deviceId){if(this._lastDeviceId)delete m.video.facingMode,m.video.deviceId={exact:this._lastDeviceId};else if(this.ifSaveLastUsedCamera&&me.isStorageAvailable&&window.localStorage.getItem("dce_last_camera_id")){delete m.video.facingMode,m.video.deviceId={ideal:window.localStorage.getItem("dce_last_camera_id")};const ne=JSON.parse(window.localStorage.getItem("dce_last_apply_width")),re=JSON.parse(window.localStorage.getItem("dce_last_apply_height"));ne&&re&&(m.video.width=ne,m.video.height=re)}else if(!this.ifSkipCameraInspection){if(m.video.facingMode){if(await this.getAllCameras(!1),!this._video)throw new Error("'video' is null or undefined.");let ne=m.video.facingMode;if(ne instanceof Array&&ne.length&&(ne=ne[0]),ne=ne.exact||ne.ideal||ne,ne==="environment"){D=!0;const re=me.findBestRearCamera(this._allCameras);re&&(delete m.video.facingMode,m.video.deviceId={exact:re})}}}}t&&(m.video.width={ideal:t}),i&&(m.video.height={ideal:i}),me._onLog&&me._onLog("DCE: ======try getUserMedia========");let T=[0,500],I=null;const k=async ne=>{for(let re of T){re&&await new Promise(ue=>setTimeout(ue,re)),_();try{me._onLog&&me._onLog("DCE: ask "+JSON.stringify(ne)),F=await navigator.mediaDevices.getUserMedia(ne);break}catch(ue){if(_(),ue.name==="NotFoundError"||ue.name==="NotAllowedError")throw ue;I=ue,me._onLog&&me._onLog("DCE: "+ue.message||ue)}}_()};let U;if(await k(m),!F&&(me._onLog&&me._onLog("DCE: ======try getUserMedia again========"),U=JSON.parse(JSON.stringify(m)),typeof U.video=="object"&&(["iPhone","iPad"].includes(At.OS)?(t>=1280||i>=1280?U.video.width=1280:t>=640||i>=640?U.video.width=640:(t<640||i<640)&&(U.video.width=320),delete U.video.height):D&&!m.video.deviceId?(delete U.video.facingMode,this._allCameras.length&&(U.video.deviceId={ideal:this._allCameras[this._allCameras.length-1].deviceId})):U.video=!0),me._onLog&&me._onLog("DCE: "+U),await k(U)),F||(T=[1e3,2e3],await k(m)),F||await k(U),!F)throw I;const K=()=>{const ne=F.getVideoTracks();let re,ue;if(ne.length&&(re=this._videoTrack=ne[0]),this._video&&re){const Ae=re.getSettings();if(Ae){for(let v of this._allCameras)if(Ae.deviceId===v.deviceId){v._checked=!0,v.label=re.label,ue=v;break}}}this._currentCamera=ue};if(await this.getAllCameras(!1),_(),D&&!this.ifSkipCameraInspection){K();const ne=me.findBestRearCamera(this._allCameras),re=(B=this._currentCamera)===null||B===void 0?void 0:B.deviceId;ne&&ne!=re&&(F.getTracks().forEach(ue=>{ue.stop()}),T=[0,500,1e3,2e3],m.video.deviceId={exact:ne},await k(m))}me._onLog&&me._onLog("DCE: ======play video========"),_(),await me.playVideo(this._video,F,4e3),_(),me._onLog&&me._onLog("DCE: ======played video========"),this._bgLoading&&(this._bgLoading.style.animationPlayState="paused");const X=this._video.videoWidth+"x"+this._video.videoHeight;this._optGotRsl&&(this._optGotRsl.setAttribute("data-width",this._video.videoWidth),this._optGotRsl.setAttribute("data-height",this._video.videoHeight),this._optGotRsl.innerText=X,this._selRsl&&this._optGotRsl.parentNode==this._selRsl&&(this._selRsl.value="got")),me._onLog&&me._onLog("DCE: got "+X),K(),this._renderSelCameraInfo();const te={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};if(te.deviceId&&(this._lastDeviceId=te.deviceId,this.ifSaveLastUsedCamera&&me.isStorageAvailable&&(window.localStorage.setItem("dce_last_camera_id",this._lastDeviceId),m.video.width&&m.video.height&&(window.localStorage.setItem("dce_last_apply_width",JSON.stringify(m.video.width)),window.localStorage.setItem("dce_last_apply_height",JSON.stringify(m.video.height))))),!o||!o.notTriggerPlayedEvent){const ne=this.mapCameraEvents.get("played");for(let re of ne){if(!re)continue;const ue=JSON.parse(JSON.stringify(te));setTimeout(()=>{this.isDisposed&&this.disposed||re.apply(this,[ue])},0)}}return this.promisePlay=null,te}catch(_){throw this.promisePlay=null,this._bgLoading&&(this._bgLoading.style.display="none"),_.name==="NotFoundError"&&(DOMException?_=new DOMException("No camera available, please use a device with an accessible camera.",_.name):(_=new Error("No camera available, please use a device with an accessible camera.")).name="NotFoundError"),_}})(),me._onLog&&(s=Date.now(),me._onLog("DCE: start opening camera: "+s));const g=await this.promisePlay;return me._onLog&&me._onLog("DCE: finish opening camera. Costs: "+(Date.now()-s)),this.playCallbackInfo=JSON.parse(JSON.stringify(g)),this._recordedStates.videoPlaying=!0,g}async resume(){this._assertOpen(),this._video&&(await this._video.play(),this._recordedStates.videoPlaying=!0),this.ifShowScanRegionLaser&&this.showScanRegionLaser()}pause(){this._assertOpen(),this._video&&(this._video.pause(),this._recordedStates.videoPlaying=!1),this.ifShowScanRegionLaser&&this.hideScanRegionLaser()}_bindUI(){if(!this.UIElement)throw new Error("Need to define `UIElement` before opening.");const e=[this.UIElement];for(let t=0;t<e.length;++t)for(let i of e[t].children)e.push(i);for(let t of e){if(!this._video&&t.classList.contains(this.containerClassName)){this._elContainer=t;const i=document.createElement("video");i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.width="100%",i.style.height="100%",i.style.objectFit=this.getVideoFit(),i.setAttribute("playsinline","true"),i.setAttribute("muted","true"),this._video=i;const o=document.createElement("div");o.append(i),o.style.position="absolute",o.style.left="0",o.style.top="0",o.style.width="100%",o.style.height="100%",o.style.overflow="hidden",this._videoContainer=o,t.prepend(o)}else!this._divScanArea&&t.classList.contains("dce-scanarea")?this._divScanArea=t:!this._divScanLight&&t.classList.contains("dce-scanlight")?this._divScanLight=t:!this._bgLoading&&t.classList.contains("dce-bg-loading")?this._bgLoading=t:!this._bgCamera&&t.classList.contains("dce-bg-camera")?this._bgCamera=t:!this._selCam&&t.classList.contains("dce-sel-camera")?this._selCam=t:!this._selRsl&&t.classList.contains("dce-sel-resolution")?(this._selRsl=t,this.videoSrc||this.singleFrameMode||this._selRsl.options.length||(this._selRsl.innerHTML=[this._optGotRsl?"":'<option class="dce-opt-gotResolution" value="got"></option>','<option data-width="1920" data-height="1080">1920x1080</option>','<option data-width="1280" data-height="720">1280x720</option>','<option data-width="640" data-height="480">640x480</option>'].join(""),this._optGotRsl=this._optGotRsl||this._selRsl.options[0])):!this._optGotRsl&&t.classList.contains("dce-opt-gotResolution")?this._optGotRsl=t:!this._btnClose&&t.classList.contains("dce-btn-close")?this._btnClose=t:!this._selMinLtr&&t.classList.contains("dlr-sel-minletter")?(this._selMinLtr=t,this._selMinLtr.options.length||(this._selMinLtr.innerHTML=[this._optGotMinLtr?"":'<option class="dlr-opt-gotMinLtr" value="got"></option>','<option value="0" selected>any letter</option>','<option value="3">3+ letters</option>','<option value="5">5+ letters</option>','<option value="8">8+ letters</option>','<option value="12">12+ letters</option>','<option value="17">17+ letters</option>','<option value="30">30+ letters</option>','<option value="50">50+ letters</option>','<option value="80">80+ letters</option>','<option value="120">120+ letters</option>'].join(""),this._optGotMinLtr=this._optGotMinLtr||this._selMinLtr.options[0])):!this._optGotMinLtr&&t.classList.contains("dlr-opt-gotMinLtr")&&(this._optGotMinLtr=t);if(this.extraBindings&&this.extraBindings.length)for(let i of this.extraBindings)try{i(t)}catch{}}if(!this._video)throw this._unbindUI(),Error(`Can not find the video container element with class '${this.containerClassName}'`);this.singleFrameMode||this.videoSrc?(this.singleFrameMode&&(this._elContainer&&(this._elContainer.addEventListener("click",this._clickIptSingleFrameMode),this._elContainer.setAttribute("title","Take a photo")),this._bgCamera&&(this._bgCamera.style.display="block")),this._selCam&&(this._selCam.style.display="none"),this._selRsl&&(this._selRsl.style.display="none"),this._selMinLtr&&(this._selMinLtr.style.display="none")):(this._elContainer&&(["Android","HarmonyOS"].includes(At.OS)?(this._elContainer.addEventListener("touchend",this._tapDoFocus),this._elContainer.addEventListener("touchmove",this._touchMoveEvent)):this._elContainer.addEventListener("click",this._tapDoFocus)),this._selCam&&(this._selCam.style.display="block",this._selCam.addEventListener("change",this._onCameraSelChange)),this._selRsl&&(this._selRsl.style.display="block",this._selRsl.addEventListener("change",this._onResolutionSelChange)),this._selMinLtr&&(this._selMinLtr.style.display="block"),this._bgLoading&&(this._bgLoading.style.display="block")),this._btnClose&&this._btnClose.addEventListener("click",this._onCloseBtnClick),document.addEventListener("visibilitychange",this._ev_documentHideEvent),window.ResizeObserver&&(this._resizeObserver||(this._resizeObserver=new ResizeObserver(t=>{for(let i of t)i.target===this._elContainer&&this._updateLayers()})),this._elContainer&&this._resizeObserver.observe(this._elContainer)),this._windowWidth=document.documentElement.clientWidth,window.addEventListener("resize",this._windowResizeListener)}_unbindUI(){this.singleFrameMode?(this._elContainer&&(this._elContainer.removeEventListener("click",this._clickIptSingleFrameMode),this._elContainer.removeAttribute("title")),this._bgCamera&&(this._bgCamera.style.display="none")):this._bgLoading&&(this._bgLoading.style.display="none"),this._elContainer&&(this._elContainer.removeEventListener("click",this._tapDoFocus),this._elContainer.removeEventListener("touchend",this._tapDoFocus),this._elContainer.removeEventListener("touchmove",this._touchMoveEvent)),this._selCam&&this._selCam.removeEventListener("change",this._onCameraSelChange),this._selRsl&&this._selRsl.removeEventListener("change",this._onResolutionSelChange),this._btnClose&&this._btnClose.removeEventListener("click",this._onCloseBtnClick),this.hideScanRegionLaser(),this.hideViewDecorator(),this.hideScanRegionOverlays(),this._drawingLayersManager.setVisible(!1),this._hideOriginalImageCvs(),this._videoContainer&&this._videoContainer.remove(),this._video=null,this._videoContainer=null,this._elContainer=null,this._selCam=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,this._divScanArea=null,this._divScanLight=null,this._cvsScanRegion&&(this._cvsScanRegion.remove(),this._cvsScanRegion=null),this._singleFrameModeIpt&&(this._singleFrameModeIpt.remove(),this._singleFrameModeIpt=null),this._cvsSingleFrameMode&&(this._cvsSingleFrameMode.remove(),this._cvsSingleFrameMode=null),document.removeEventListener("visibilitychange",this._ev_documentHideEvent),window.ResizeObserver&&this._resizeObserver&&this._resizeObserver.disconnect(),window.removeEventListener("resize",this._windowResizeListener)}_assertOpen(){if(!this._bOpen)throw Error("The camera is not open.")}async open(e){this.UIElement||await this.setUIElement(me.defaultUIElementURL),this._bindUI(),e&&this.appendAndShowUI();let t=await this.play();this.bOpen=!0,this._focusParameters.fds=null,this._focusParameters.kTimeout=void 0,this._focusSupported=!0,this._tapFocusEnabled&&!this.singleFrameMode&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,this._focusParameters.fds||(this._focusSupported=!1,this._tapFocusEnabled=!1));const i=this.mapCameraEvents.get("cameraopen");for(let o of i){if(!o)continue;const s=JSON.parse(JSON.stringify(t));setTimeout(()=>{this.isDisposed&&this.disposed||o.apply(this,[s])},0)}return t}close(e){if(!this._video)return;this.stop(),this._hideOriginalImage(!1),this.hideTip(),this._unbindUI(),e&&this.hideUI(),this.stopFetchingLoop(),this.bOpen=!1;const t=this.mapCameraEvents.get("cameraclose");for(let i of t){if(!i)continue;const o={width:0,height:0,deviceId:null};setTimeout(()=>{this.isDisposed&&this.disposed||i.apply(this,[o])},0)}}stop(){this._video&&this._video.srcObject&&(me._onLog&&me._onLog("DCE: ======stop video========"),this._video.srcObject.getTracks().forEach(e=>{e.stop()}),this._video.srcObject=null,this._videoTrack=null,this._currentCamera=null),this._video&&this.videoSrc&&(me._onLog&&me._onLog("DCE: ======stop existing video========"),this._video.pause(),this._video.currentTime=0),this._bgLoading&&(this._bgLoading.style.animationPlayState=""),this._frameQueue.length=0,this._reusedCvs&&this._reusedCvs.ctx2d&&this._reusedCvs.ctx2d.clearRect(0,0,this._reusedCvs.width,this._reusedCvs.height),this.forceLoseContext()}async getAllCameras(e=!0){let t=(await navigator.mediaDevices.enumerateDevices()).filter(s=>s.kind==="videoinput");if(e&&t&&t.length&&!t[0].deviceId){let s=await navigator.mediaDevices.getUserMedia({video:!0});t=(await navigator.mediaDevices.enumerateDevices()).filter(u=>u.kind==="videoinput"),s.getTracks().forEach(u=>{u.stop()})}const i=[],o=[];if(this._allCameras)for(let s of this._allCameras)s._checked&&o.push(s);for(let s=0;s<t.length;s++){let u,g=t[s];for(let B of o)if(g.deviceId==B.deviceId){u=B;break}u||(u={deviceId:g.deviceId,label:g.label?g.label:"camera "+s,_checked:!1}),u.deviceId&&i.push(u)}return this._allCameras=i,me._onLog&&me._onLog("DCE: "+JSON.stringify(this._allCameras)),i}_renderSelCameraInfo(){if(!this._selCam)return;let e;this._selCam.textContent="";for(let t of this._allCameras){const i=document.createElement("option");i.value=t.deviceId,i.innerText=t.label,this._selCam.append(i),t.deviceId&&this._currentCamera&&this._currentCamera.deviceId==t.deviceId&&(e=i)}this._selCam.value=e?e.value:""}getSelectedCamera(){if(!this._bOpen){let e="";const t=this.videoSettings.video.deviceId;t&&(e=t.exact||t.ideal||t);for(let i of this._allCameras)if(i.deviceId===e)return JSON.parse(JSON.stringify(i));return{deviceId:e,label:"",_checked:!1}}return this._currentCamera}async selectCamera(e){let t="";if(e&&(t=e.deviceId||e),this.videoSettings.video.deviceId={exact:t},!this._bOpen||this._video.paused)return null;let i=null;this._currentCamera&&(i=this._currentCamera.deviceId);const o=this._video.videoWidth,s=this._video.videoHeight,u=await this.play(e.deviceId||e);if(this._focusParameters.fds=null,this._focusParameters.kTimeout=void 0,this._focusSupported=!0,this._tapFocusEnabled&&!this.singleFrameMode&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,this._focusParameters.fds||(this._focusSupported=!1,this._tapFocusEnabled=!1)),i!==u.deviceId){const g=this.mapCameraEvents.get("camerachange");for(let B of g){if(!B)continue;const _=JSON.parse(JSON.stringify(u));setTimeout(()=>{this.isDisposed&&this.disposed||B.apply(this,[_])},0)}}if(o!==u.width||s!==u.height){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let B of this._arrScanRegionOverlays)B&&this._updateScanRegionOverlay(B);this._updateDrawingLayersSize(),this._updateVideoContainerStyle();const g=this.mapCameraEvents.get("resolutionchange");for(let B of g){if(!B)continue;const _=JSON.parse(JSON.stringify(u));setTimeout(()=>{this.isDisposed&&this.disposed||B.apply(this,[_])},0)}}return u}getResolution(){if(this._bOpen)return[this._video.videoWidth,this._video.videoHeight];{let e=0,t=0;const i=this.videoSettings.video.width,o=this.videoSettings.video.height;return i&&(e=i.exact||i.ideal||i),o&&(t=o.exact||o.ideal||o),[e,t]}}async setResolution(e,t){let i,o;if(e instanceof Array?(i=e[0],o=e[1]):(i=e,o=t),this.videoSettings.video.width={ideal:i},this.videoSettings.video.height={ideal:o},!this._bOpen||this._video.paused)return null;const s=this._video.videoWidth,u=this._video.videoHeight,g=await this.play(null,i,o);if(s!==g.width||u!==g.height){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let _ of this._arrScanRegionOverlays)_&&this._updateScanRegionOverlay(_);this._updateDrawingLayersSize(),this._updateVideoContainerStyle();const B=this.mapCameraEvents.get("resolutionchange");for(let _ of B){if(!_)continue;const m=JSON.parse(JSON.stringify(g));setTimeout(()=>{this.isDisposed&&this.disposed||_.apply(this,[m])},0)}}return g}async getResolutions(e){let t="";const i=(s,u)=>{const g=this._mapCameraResolutions.get(s);if(!g||!g.length)return!1;for(let B of g)if(B[0]===u.width&&B[1]===u.height)return!0;return!1},o=async(s,u,g)=>{const B={video:{deviceId:{exact:s},width:{ideal:u},height:{ideal:g}}};let _=null;try{_=await navigator.mediaDevices.getUserMedia(B)}catch{return null}if(!_)return null;const m=_.getVideoTracks();let D=null;try{const F=m[0].getSettings();D={width:F.width,height:F.height}}catch{const T=document.createElement("video");T.srcObject=_,D={width:T.videoWidth,height:T.videoHeight},T.srcObject=null}return m.forEach(F=>{F.stop()}),D};if(!this._bOpen){const s=this.videoSettings.video.deviceId;if(!s||(t=s.hasOwnProperty("exact")?this.videoSettings.video.deviceId.exact:s.hasOwnProperty("ideal")?this.videoSettings.video.deviceId.ideal:this.videoSettings.video.deviceId,!t))return null;let u=this._mapCameraResolutions.get(t);if(u&&!e)return this._mapCameraResolutions.get(t);this._mapCameraResolutions.set(t,[]),u=this._mapCameraResolutions.get(t);for(let g of this._predefinedResolutions){const B=await o(t,g.width,g.height);B&&!i(t,B)&&u.push([B.width,B.height])}return u}if(this._currentCamera){t=this._currentCamera.deviceId;let s=this._mapCameraResolutions.get(t);if(s&&!e)return this._mapCameraResolutions.get(t);this._mapCameraResolutions.set(t,[]),s=this._mapCameraResolutions.get(t);let u=this._videoTrack;for(let g of this._predefinedResolutions){await u.applyConstraints({width:{ideal:g.width},height:{ideal:g.height}});const B=u.getSettings(),_={width:B.width,height:B.height};i(t,_)||s.push([_.width,_.height])}return this._video.srcObject.getTracks().forEach(g=>{g.stop()}),await this.play(t,null,null,{notTriggerPlayedEvent:!0}),s}return null}on(e,t){if(!t)return;const i=this.mapCameraEvents.get(e.toLowerCase());if(!i)throw new Error(`Event '${e}' does not exist.`);i.includes(t)||i.push(t)}off(e,t){const i=this.mapCameraEvents.get(e.toLowerCase());if(!i)throw new Error(`Event '${e}' does not exist.`);const o=i.indexOf(t);o!==-1&&i.splice(o,1)}offAll(e){if(e){if(typeof e=="string"){const t=this.mapCameraEvents.get(e);t&&(t.length=0)}}else for(let t of this.mapCameraEvents.values())t&&(t.length=0)}getVideoSettings(){return JSON.parse(JSON.stringify(this.videoSettings))}updateVideoSettings(e){if(this.videoSettings=JSON.parse(JSON.stringify(e)),this._lastDeviceId=null,this._bOpen)return this.play()}isOpen(){return this._bOpen}getCapabilities(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getCapabilities()' is unavailable in singleFrameMode.");return this._videoTrack&&this._videoTrack.getCapabilities?this._videoTrack.getCapabilities():{}}getCameraSettings(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getCameraSettings()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings():null}getConstraints(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getConstraints()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getConstraints():null}async applyConstraints(e){if(this._assertOpen(),this.singleFrameMode)throw new Error("'applyConstraints()' is unavailable in singleFrameMode.");if(!this._videoTrack)throw new Error('"_videoTrack" is null.');if(!this._videoTrack.applyConstraints)throw Error("Not supported.");return await this._videoTrack.applyConstraints(e)}async turnOnTorch(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'turnOnTorch()' is unavailable in singleFrameMode.");if(this.getCapabilities().torch)return await this._videoTrack.applyConstraints({advanced:[{torch:!0}]});throw Error("Not supported.")}async turnOffTorch(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'turnOffTorch()' is unavailable in singleFrameMode.");if(this.getCapabilities().torch)return await this._videoTrack.applyConstraints({advanced:[{torch:!1}]});throw Error("Not supported.")}async setColorTemperature(e){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setColorTemperature()' is unavailable in singleFrameMode.");let t=this.getCapabilities().colorTemperature;if(!t)throw Error("Not supported.");return e<t.min?e=t.min:e>t.max&&(e=t.max),await this._videoTrack.applyConstraints({advanced:[{colorTemperature:e,whiteBalanceMode:"manual"}]})}getColorTemperature(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getColorTemperature()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings().colorTemperature||0:null}async setExposureCompensation(e){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setExposureCompensation()' is unavailable in singleFrameMode.");let t=this.getCapabilities().exposureCompensation;if(!t)throw Error("Not supported.");return e<t.min?e=t.min:e>t.max&&(e=t.max),await this._videoTrack.applyConstraints({advanced:[{exposureCompensation:e}]})}getExposureCompensation(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getExposureCompensation()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings().exposureCompensation||0:null}async _setHardwareScale(e){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_setHardwareScale()' is unavailable in singleFrameMode.");if(e<1)throw new RangeError("Invalid value.");if(!this._videoTrack)return;const t=this.getCapabilities().zoom;if(!t)throw new Error("Not supported.");return e<t.min?e=t.min:e>t.max&&(e=t.max),e=Kt(e,t.min,t.step,t.max),await this._videoTrack.applyConstraints({advanced:[{zoom:e}]}),e}_getHardwareScale(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getHardwareScale()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings().zoom||1:null}_setSoftwareScale(e,t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_setSoftwareScale()' is unavailable in singleFrameMode.");if(e<1)throw new RangeError("Invalid value.");t&&this._setScaleCenter(t),this._softwareScale=e,this._scaleVideo(e,t)}_getSoftwareScale(){return this._softwareScale}_setScaleCenter(e){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_setScaleCenter()' is unavailable in singleFrameMode.");if(!e||typeof e.x!="string"||typeof e.y!="string")throw new Error("Invalid center.");const t=this._video.videoWidth,i=this._video.videoHeight;let o=0,s=0;if(e.x.endsWith("px"))o=parseFloat(e.x);else{if(!e.x.endsWith("%"))throw new Error("Invalid scale center.");o=parseFloat(e.x)/100*t}if(e.y.endsWith("px"))s=parseFloat(e.y);else{if(!e.y.endsWith("%"))throw new Error("Invalid scale center.");s=parseFloat(e.y)/100*i}if(o==NaN||s==NaN)throw new Error("Invalid scale center.");this._scaleCenter={x:o,y:s}}_resetScaleCenter(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_resetScaleCenter()' is unavailable in singleFrameMode.");const e=this._video.videoWidth,t=this._video.videoHeight;this._scaleCenter={x:e/2,y:t/2}}_isVideoCenter(e){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_isVideoCenter()' is unavailable in singleFrameMode.");return e&&e.x==this._video.videoWidth/2&&e.y==this._video.videoHeight/2}async _setZoom(e){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setZoom()' is unavailable in singleFrameMode.");if(e<1)throw new RangeError("Invalid value.");this._resetScaleCenter();try{if(this._isVideoCenter(this._scaleCenter)){const t=await this._setHardwareScale(e);let i=this._getHardwareScale();i==1&&t!=1&&(i=t),e>i?this._setSoftwareScale(e/i):this._setSoftwareScale(1)}else await this._setHardwareScale(1),this._setSoftwareScale(e)}catch(t){if((t.message||t)!=="Not supported.")throw t;this._setSoftwareScale(e)}}async setZoom(e){if(typeof e!="number"&&typeof e!="object")throw new TypeError("Illegal type of argument.");if(typeof e=="number")return this._setZoom(e);if(this._assertOpen(),this.singleFrameMode)throw new Error("'setZoom()' is unavailable in singleFrameMode.");if(e){if(typeof e.factor!="number")throw new TypeError("Illegal type of 'factor'.");if(e.factor<1)throw new RangeError("Invalid value.");e.centerPoint?this._setScaleCenter(e.centerPoint):this._resetScaleCenter();try{if(this._isVideoCenter(this._scaleCenter)){const t=await this._setHardwareScale(e.factor);let i=this._getHardwareScale();i==1&&t!=1&&(i=t),e.factor>i?this._setSoftwareScale(e.factor/i):this._setSoftwareScale(1)}else await this._setHardwareScale(1),this._setSoftwareScale(e.factor)}catch(t){if((t.message||t)!=="Not supported.")throw t;this._setSoftwareScale(e.factor)}}}getZoom(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getZoom()' is unavailable in singleFrameMode.");return this._videoTrack?this._getHardwareScale()*this._softwareScale:null}getZoomSettings(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getZoom()' is unavailable in singleFrameMode.");return this._videoTrack?{factor:this._getHardwareScale()*this._softwareScale}:null}async resetZoom(){await this.setZoom({factor:1})}async setFrameRate(e){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFrameRate()' is unavailable in singleFrameMode.");let t=this.getCapabilities().frameRate;if(!t)throw Error("Not supported.");return e<t.min?e=t.min:e>t.max&&(e=t.max),await this._videoTrack.applyConstraints({width:{ideal:Math.max(this._video.videoWidth,this._video.videoHeight)},frameRate:e})}getFrameRate(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getFrameRate()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings().frameRate:null}async _setFocus(e,t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFocus()' is unavailable in singleFrameMode.");if(typeof e!="string")throw Error("Invalid focus mode.");e=e.toLowerCase();const i=this.getCapabilities().focusMode,o=this.getCapabilities().focusDistance;if(!i)throw Error("Not supported.");if(!i.includes(e))throw Error("Unsupported mode.");if(t>=0){if(!o)throw Error("Manual focus unsupported.");return t<o.min?t=o.min:t>o.max&&(t=o.max),t=Kt(t,o.min,o.step,o.max),await this._videoTrack.applyConstraints({advanced:[{focusMode:e,focusDistance:t}]})}return await this._videoTrack.applyConstraints({advanced:[{focusMode:e}]})}async setFocus(e,t){if(typeof e=="string")return this._setFocus(e,t);if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFocus()' is unavailable in singleFrameMode.");if(!e)return;const i=this.getCapabilities(),o=i.focusMode,s=i.focusDistance;if(!o)throw Error("Not supported.");if(typeof e.mode!="string")throw Error("Invalid focus mode.");const u=e.mode.toLowerCase();if(!o.includes(u))throw Error("Unsupported focus mode.");if(u!=="manual")return this._focusParameters._focusArea=null,await this._videoTrack.applyConstraints({advanced:[{focusMode:u}]});if(!s)throw Error("Manual focus unsupported.");if(e.hasOwnProperty("distance")){let g=e.distance;return g<s.min?g=s.min:g>s.max&&(g=s.max),g=Kt(g,s.min,s.step,s.max),this._focusParameters._focusArea=null,await this._videoTrack.applyConstraints({advanced:[{focusMode:u,focusDistance:g}]})}if(!e.area)throw new Error("'distance' or 'area' should be specified in 'manual' mode.");{const g=e.area.centerPoint;let B=e.area.width,_=e.area.height;if(!B||!_){const m=this._video.videoWidth,D=this._video.videoHeight;B||(B=2*Math.round(Math.min(m,D)/this._focusParameters.defaultFocusAreaSizeRatio/2)+"px"),_||(_=2*Math.round(Math.min(m,D)/this._focusParameters.defaultFocusAreaSizeRatio/2)+"px")}this._focusParameters._focusArea={centerPoint:{x:g.x,y:g.y},width:B,height:_},await this._setLocalFocus(g,B,_)}}getFocus(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getHardwareScale()' is unavailable in singleFrameMode.");if(!this._videoTrack)return null;const e=this._videoTrack.getSettings().focusMode;return e?e==="continuous"?{mode:e}:{mode:e,distance:this._videoTrack.getSettings().focusDistance}:null}getFocusSettings(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getHardwareScale()' is unavailable in singleFrameMode.");if(!this._videoTrack)return null;const e=this._videoTrack.getSettings(),t=e.focusMode;return t?t==="manual"?this._focusParameters._focusArea?{mode:"manual",area:JSON.parse(JSON.stringify(this._focusParameters._focusArea))}:{mode:"manual",distance:e.focusDistance}:{mode:t}:null}async _setFocusAndGetContract(e,t){const i=F=>{if(!this._bOpen||!this._videoTrack||this.video.paused||F.focusTaskId!=this._focusParameters.curFocusTaskId){this._bOpen&&this._videoTrack&&!this.video.paused||(this._focusParameters.isDoingFocus=0);const T=new Error(`Focus task ${F.focusTaskId} canceled.`);throw T.name="DeprecatedTaskError",T}this._focusParameters.isDoingFocus===1&&Date.now()-F.timeStart>this._focusParameters.focusCancelableTime&&(this._focusParameters.isDoingFocus=-1)};let o;t=Kt(t,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),await this._videoTrack.applyConstraints({advanced:[{focusMode:"manual",focusDistance:t}]}),i(e),o=this._focusParameters.oldDistance==null?this._focusParameters.kTimeout*Math.max(Math.abs(1/this._focusParameters.fds.min-1/t),Math.abs(1/this._focusParameters.fds.max-1/t))+this._focusParameters.minTimeout:this._focusParameters.kTimeout*Math.abs(1/this._focusParameters.oldDistance-1/t)+this._focusParameters.minTimeout,this._focusParameters.oldDistance=t,await new Promise(F=>{setTimeout(F,o)}),i(e);let s=e.focusL-e.focusW/2,u=e.focusT-e.focusH/2,g=e.focusW,B=e.focusH;if(s>=this.video.videoWidth||u>=this.video.videoHeight)throw new Error("Invalid area.");s+g>this.video.videoWidth&&(g=this.video.videoWidth-s),u+B>this.video.videoHeight&&(B=this.video.videoHeight-u);const _=this._getImageData(this.video,this.video.videoWidth,this.video.videoHeight,{sx:s,sy:u,sWidth:g,sHeight:B,dWidth:g,dHeight:B},null,{pixelFormat:He.RGBA});if(!_)return this._setFocusAndGetContract(e,t);const m=_.data;let D=0;for(let F=0,T=m.length-8;F<T;++F){let I=m[F]-m[F+8];++F;let k=m[F]-m[F+8];++F;let U=m[F]-m[F+8];++F,D+=I*I+k*k+U*U}return-D}async _doFocusDetail(e,t,i,o,s,u,g){let B;if(t=Kt(t,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),o=Kt(o,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),u?u=Kt(u,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max):(u=Kt(Math.sqrt((t||this._focusParameters.fds.step)*(o||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),g=await this._setFocusAndGetContract(e,u)),g<=i&&g<=s?B=3:i<s&&i<g?B=1:s<i&&s<g&&(B=2),(o-t)/2<=this._focusParameters.fds.step)return B===3||(B===1?await this._videoTrack.applyConstraints({advanced:[{focusMode:"manual",focusDistance:t}]}):B===2&&await this._videoTrack.applyConstraints({advanced:[{focusMode:"manual",focusDistance:o}]})),!0;if(B===1)return await this._doFocusDetail(e,t,i,u,g);if(B===2)return await this._doFocusDetail(e,u,g,o,s);if(B!==3)return i=await this._setFocusAndGetContract(e,t),s=await this._setFocusAndGetContract(e,o),await this._doFocusDetail(e,t,i,o,s);let _=Kt(Math.sqrt((t||this._focusParameters.fds.step)*(u||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),m=Kt(Math.sqrt((o||this._focusParameters.fds.step)*(u||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max);if(Math.abs(1/this._focusParameters.oldDistance-1/_)<=Math.abs(1/this._focusParameters.oldDistance-1/m)){let D=await this._setFocusAndGetContract(e,_);if(D<g)return await this._doFocusDetail(e,t,i,u,g,_,D);if(D==g)return await this._doFocusDetail(e,_,D,u,g);let F=await this._setFocusAndGetContract(e,m);if(D>g&&g<F)return await this._doFocusDetail(e,_,D,m,F,u,g);if(g==F)return await this._doFocusDetail(e,u,g,m,F);if(g>F)return await this._doFocusDetail(e,u,g,o,s,m,F)}else{let D=await this._setFocusAndGetContract(e,m);if(g>D)return await this._doFocusDetail(e,u,g,o,s,m,D);if(g==D)return await this._doFocusDetail(e,u,g,m,D);let F=await this._setFocusAndGetContract(e,_);if(F>g&&g<D)return await this._doFocusDetail(e,_,F,m,D,u,g);if(F==g)return await this._doFocusDetail(e,_,F,u,g);if(F<g)return await this._doFocusDetail(e,t,i,u,g,_,F)}return!1}async _setLocalFocus(e,t,i,o,s){if(this._focusParameters.isDoingFocus==1)return!1;if(!e||typeof e.x!="string"||typeof e.y!="string")throw new Error("Invalid centerPoint.");if(!t||typeof t!="string")throw new Error("Invalid width.");if(!i||typeof i!="string")throw new Error("Invalid height.");const u=this._video.videoWidth,g=this._video.videoHeight;let B=0,_=0;if(e.x.endsWith("px"))B=parseFloat(e.x);else{if(!e.x.endsWith("%"))throw new Error("Invalid centerPoint.");B=parseFloat(e.x)/100*u}if(e.y.endsWith("px"))_=parseFloat(e.y);else{if(!e.y.endsWith("%"))throw new Error("Invalid centerPoint.");_=parseFloat(e.y)/100*g}if(B==NaN||_==NaN)throw new Error("Invalid centerPoint.");let m=0;if(t.endsWith("px"))m=parseFloat(t);else{if(!t.endsWith("%"))throw new Error("Invalid width.");m=parseFloat(t)/100*u}if(m==NaN)throw new Error("Invalid width.");let D=0;if(i.endsWith("px"))D=parseFloat(i);else{if(!i.endsWith("%"))throw new Error("Invalid height.");D=parseFloat(i)/100*g}if(D==NaN)throw new Error("Invalid height.");if(this._softwareScale!==1){const I=this._softwareScale,k=this._scaleCenter;m/=I,D/=I,B=(1-1/I)*k.x+B/I,_=(1-1/I)*k.y+_/I}if(!this._focusSupported)throw new Error("Manual focus unsupported.");if(!this._focusParameters.fds&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,!this._focusParameters.fds))throw this._focusSupported=!1,new Error("Manual focus unsupported.");this._focusParameters.kTimeout==null&&(this._focusParameters.kTimeout=(this._focusParameters.maxTimeout-this._focusParameters.minTimeout)/(1/this._focusParameters.fds.min-1/this._focusParameters.fds.max)),this._focusParameters.isDoingFocus=1;const F={focusL:B,focusT:_,focusW:m,focusH:D,focusTaskId:++this._focusParameters.curFocusTaskId,timeStart:Date.now()},T=async(I,k,U)=>{try{(k==null||k<this._focusParameters.fds.min)&&(k=this._focusParameters.fds.min),(U==null||U>this._focusParameters.fds.max)&&(U=this._focusParameters.fds.max),this._focusParameters.oldDistance=null;let K=Kt(Math.sqrt(U*(k||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),X=Kt(Math.sqrt((k||this._focusParameters.fds.step)*K),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),te=Kt(Math.sqrt(K*U),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),ne=await this._setFocusAndGetContract(I,te),re=await this._setFocusAndGetContract(I,X),ue=await this._setFocusAndGetContract(I,K);if(re>ue&&ue<ne){const Ae=await this._doFocusDetail(I,X,re,te,ne,K,ue);return this._focusParameters.isDoingFocus=0,Ae}if(re<ue&&re<ne){let Ae=await this._setFocusAndGetContract(I,k);const v=await this._doFocusDetail(I,k,Ae,K,ue,X,re);return this._focusParameters.isDoingFocus=0,v}if(ue>ne&&re>ne){let Ae=await this._setFocusAndGetContract(I,U);const v=await this._doFocusDetail(I,K,ue,U,Ae,te,ne);return this._focusParameters.isDoingFocus=0,v}if(re==ue&&ue<ne){const Ae=await this._doFocusDetail(I,X,re,K,ue);return this._focusParameters.isDoingFocus=0,Ae}if(ue==ne&&re>ue){const Ae=await this._doFocusDetail(I,K,ue,te,ne);return this._focusParameters.isDoingFocus=0,Ae}return T(I,k,U)}catch(K){if(K.name!=="DeprecatedTaskError")throw K}};return T(F,o,s)}async enableTapToFocus(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'enableTapToFocus()' is unavailable in singleFrameMode.");if(!this._videoTrack)throw new Error("Video is not playing.");if(!this._focusSupported)throw new Error("Tapping to focus unsupported.");if(!this._focusParameters.fds&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,!this._focusParameters.fds))throw this._focusSupported=!1,this._tapFocusEnabled=!1,new Error("Tapping to focus unsupported.");this._tapFocusEnabled=!0}disableTapToFocus(){this._tapFocusEnabled=!1}isTapToFocusEnabled(){return this._tapFocusEnabled}_updateVideoContainerStyle(){if(!this._video||this.singleFrameMode)return;const e=this._getSoftwareScale(),t=this._videoContainer;if(this.videoFit==="contain"&&e>1){const i=this._video.videoWidth,o=this._video.videoHeight,s=window.getComputedStyle(this._elContainer),u=parseFloat(s.width),g=parseFloat(s.height),B=i/o;if(u/g<B){let _=u/B;t.style.left="0",t.style.top=(g-_)/2/g*100+"%",t.style.width="100%",t.style.height=_/g*100+"%"}else{let _=g*B;t.style.left=(u-_)/2/u*100+"%",t.style.top="0",t.style.width=_/u*100+"%",t.style.height="100%"}}else t.style.left="0",t.style.top="0",t.style.width="100%",t.style.height="100%"}_scaleVideo(e,t){if(this._video&&!this.singleFrameMode){if(e<1)throw new RangeError("Invalid scale value.");if(t&&this._setScaleCenter(t),e===1)this._video.style.transform="";else{const i=this.getVideoFit(),o=this._video.videoWidth,s=this._video.videoHeight,u=window.getComputedStyle(this._elContainer),g=parseFloat(u.width),B=parseFloat(u.height),_=g/B,m=o/s;let D=1;i==="contain"?D=_<m?g/(o/e):B/(s/e):i==="cover"&&(D=m>_?B/(o/e):g/(s/e));const F=D*(1-1/e)*(o/2-this._scaleCenter.x),T=D*(1-1/e)*(s/2-this._scaleCenter.y);this._video.style.transform=`translate(${F}px, ${T}px) scale(${e})`}this._updateVideoContainerStyle()}}getFrameSize(e,t,i,o){if(!e||!t)return null;let s,u,g,B,_=e,m=t;const D={regionLeft:0,regionTop:0,regionRight:_,regionBottom:m,regionMeasuredByPercentage:!1};i?(i.regionMeasuredByPercentage?(D.regionLeft=i.regionLeft*_/100,D.regionTop=i.regionTop*m/100,D.regionRight=i.regionRight*_/100,D.regionBottom=i.regionBottom*m/100):(D.regionLeft=i.regionLeft,D.regionTop=i.regionTop,D.regionRight=i.regionRight,D.regionBottom=i.regionBottom),s=Math.round(D.regionLeft),u=Math.round(D.regionTop),_=Math.round(D.regionRight-D.regionLeft),m=Math.round(D.regionBottom-D.regionTop)):(s=0,u=0,_=Math.round(_),m=Math.round(m));const F=Math.max(_,m);if(o&&o>0&&F>o){const T=o/F;_>m?(g=o,B=Math.round(m*T)):(g=Math.round(_*T),B=o)}else g=_,B=m;return g<=0||B<=0?null:{sx:s,sy:u,sWidth:_,sHeight:m,dWidth:g,dHeight:B}}getFrame(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getFrame()' is unavailable in singleFrameMode.");return this._getVideoData()}getImage(){return this.getFrame()}_drawImage(e,t,i,o,s,u,g){if(this.isDisposed&&this.disposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(!i||!o)return null;if(t instanceof HTMLVideoElement&&t.readyState!==4||t instanceof HTMLImageElement&&!t.complete)throw new Error("The source is not loaded.");let B;me._onLog&&(B=Date.now(),me._onLog("DCE: _drawImage(), START: "+B));let _=0,m=0,D=i,F=o,T=0,I=0,k=i,U=o;s&&(s.sx&&(_=Math.round(s.sx)),s.sy&&(m=Math.round(s.sy)),s.sWidth&&(D=Math.round(s.sWidth)),s.sHeight&&(F=Math.round(s.sHeight)),s.dx&&(T=Math.round(s.dx)),s.dy&&(I=Math.round(s.dy)),s.dWidth&&(k=Math.round(s.dWidth)),s.dHeight&&(U=Math.round(s.dHeight)));let K=He.RGBA;g&&g.pixelFormat&&(K=g.pixelFormat);const X=e;if(g&&g.bUseWebGL){me._onLog&&me._onLog("DCE: _drawImage() in WebGL."),(X.width<T+k||X.height<I+U)&&(X.width=T+k,X.height=I+U,X.ctxWebGL&&X.ctxWebGL.viewport(0,0,T+k,I+U));const te=X.ctxWebGL||X.getContext("webgl",{antialias:!1})||X.getContext("experimental-webgl",{antialias:!1});if(!te){me._onLog&&me._onLog("DCE: WebGL unavailable.");const v=new Error("WebGL error: unable to initialize WebGL. Your browser or machine may not support it.");throw v.name="WebGLError",v}if(!X.ctxWebGL||K!==this.shaderPixelFormat){X.ctxWebGL=te;const v=n=>{const a=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,a),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),n.STATIC_DRAW);const c=n.createBuffer();return n.bindBuffer(n.ARRAY_BUFFER,c),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),n.STATIC_DRAW),{positions:a,texCoords:c}},ye=n=>{const a=n.createTexture();return n.bindTexture(n.TEXTURE_2D,a),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),a},be=(n,a)=>{const c=n.createProgram();if(a.forEach(A=>n.attachShader(c,A)),n.linkProgram(c),!n.getProgramParameter(c,n.LINK_STATUS)){const A=new Error(`An error occured linking the program: ${n.getProgramInfoLog(c)}.`);throw A.name="WebGLError",A}return n.useProgram(c),c},je=(n,a,c)=>{const A=n.createShader(a);if(n.shaderSource(A,c),n.compileShader(A),!n.getShaderParameter(A,n.COMPILE_STATUS)){const E=new Error(`An error occured compiling the shader: ${n.getShaderInfoLog(A)}.`);throw E.name="WebGLError",E}return A},h=`
                    attribute vec2 a_position;
                    attribute vec2 a_texCoord;

                    uniform mat3 u_matrix;
                    uniform mat3 u_textureMatrix;

                    varying vec2 v_texCoord;
                    void main(void) {
                    gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1.0);
                    v_texCoord = vec4((u_textureMatrix * vec3(a_texCoord, 1)).xy, 0, 1.0).xy;
                    }
                `;let x="rgb";["rgba","rbga","grba","gbra","brga","bgra"].includes(K)&&(x=K.slice(0,3));const l=`
                    precision mediump float;
                    varying vec2 v_texCoord;
                    uniform sampler2D u_image;
                    uniform float uColorFactor;

                    void main() {
                        vec4 sample = texture2D(u_image, v_texCoord);
                        float grey = 0.21 * sample.r + 0.71 * sample.g + 0.07 * sample.b;
                        gl_FragColor = vec4(sample.${x} * (1.0 - uColorFactor) + (grey * uColorFactor), sample.a);
                    }
                `,f=be(te,[je(te,te.VERTEX_SHADER,h),je(te,te.FRAGMENT_SHADER,l)]);this._webGLProgramInfo={program:f,attribLocations:{vertexPosition:te.getAttribLocation(f,"a_position"),texPosition:te.getAttribLocation(f,"a_texCoord")},uniformLocations:{uSampler:te.getUniformLocation(f,"u_image"),uColorFactor:te.getUniformLocation(f,"uColorFactor"),uMatrix:te.getUniformLocation(f,"u_matrix"),uTextureMatrix:te.getUniformLocation(f,"u_textureMatrix")}},this._webGLBuffers=v(te),this._webGLTexture=ye(te),this.shaderPixelFormat=K}const ne=(v,ye,be)=>{v.bindBuffer(v.ARRAY_BUFFER,ye),v.enableVertexAttribArray(be),v.vertexAttribPointer(be,2,v.FLOAT,!1,0,0)},re=(v,ye,be)=>{const je=v.RGBA,h=v.RGBA,x=v.UNSIGNED_BYTE;v.bindTexture(v.TEXTURE_2D,ye),v.texImage2D(v.TEXTURE_2D,0,je,h,x,be)},ue=(v,ye,be,je)=>{v.clearColor(0,0,0,1),v.clearDepth(1),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL),v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT),ne(v,be.positions,ye.attribLocations.vertexPosition),ne(v,be.texCoords,ye.attribLocations.texPosition),v.activeTexture(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,je),v.uniform1i(ye.uniformLocations.uSampler,0),v.uniform1f(ye.uniformLocations.uColorFactor,[He.GREY,He.GREY32].includes(K)?1:0);let h,x,l=Jt.translate(Jt.identity(),-1,-1);l=Jt.scale(l,2,2),l=Jt.scale(l,1/v.canvas.width,1/v.canvas.height),h=Jt.translate(l,T,I),h=Jt.scale(h,k,U),v.uniformMatrix3fv(ye.uniformLocations.uMatrix,!1,h),x=Jt.translate(Jt.identity(),_/i,m/o),x=Jt.scale(x,D/i,F/o),v.uniformMatrix3fv(ye.uniformLocations.uTextureMatrix,!1,x),v.drawArrays(v.TRIANGLES,0,6)};let Ae;if(re(te,this._webGLTexture,t),ue(te,this._webGLProgramInfo,this._webGLBuffers,this._webGLTexture),u){if(u.length<k*U*4)throw new Error("Unexpected size of the 'bufferContainer'.");Ae=u}else Ae=new Uint8Array(k*U*4);if(te.readPixels(T,I,k,U,te.RGBA,te.UNSIGNED_BYTE,Ae),Ae[3]!==255){me._onLog&&me._onLog("DCE: WebGL drawing incorrect."),this._bWebGLSupported=!1;const v=new Error("WebGL error: incorrect WebGL drawing.");throw v.name="WebGLError",v}return me._onLog&&me._onLog("DCE: _drawImage() in WebGL end. Costs: "+(Date.now()-B)),{context:te,pixelFormat:K===He.GREY?He.GREY32:K,_bUseWebGL:!0}}{me._onLog&&me._onLog("DCE: _drawImage() in context2d."),X.ctx2d||(X.ctx2d=X.getContext("2d",{willReadFrequently:!0}));const te=X.ctx2d;if(!te)throw new Error("Unable to get 'CanvasRenderingContext2D' from canvas.");return(X.width<T+k||X.height<I+U)&&(X.width=T+k,X.height=I+U),te.drawImage(t,_,m,D,F,T,I,k,U),me._onLog&&me._onLog("DCE: _drawImage() in context2d end. Costs: "+(Date.now()-B)),{context:te,pixelFormat:He.RGBA,_bUseWebGL:!1}}}_readCvsData(e,t,i){let o,s=0,u=0,g=e.canvas.width,B=e.canvas.height;if(t&&(t.x&&(s=t.x),t.y&&(u=t.y),t.width&&(g=t.width),t.height&&(B=t.height)),e instanceof WebGLRenderingContext){const _=e;if(i){if(i.length<g*B*4)throw new Error("Unexpected size of the 'bufferContainer'.");_.readPixels(s,u,g,B,_.RGBA,_.UNSIGNED_BYTE,i),o=new Uint8Array(i.buffer,0,g*B*4)}else o=new Uint8Array(g*B*4),_.readPixels(s,u,g,B,_.RGBA,_.UNSIGNED_BYTE,o)}else if(e instanceof CanvasRenderingContext2D){let _;if(_=e.getImageData(s,u,g,B),o=new Uint8Array(_.data.buffer),i){if(i.length<o.length)throw new Error("Unexpected size of the 'bufferContainer'.");i.set(o)}}return o}_transformPixelFormat(e,t,i,o){let s,u;if(me._onLog&&(s=Date.now(),me._onLog("DCE: _transformPixelFormat(), START: "+s)),t===i)return me._onLog&&me._onLog("DCE: _transformPixelFormat() end. Costs: "+(Date.now()-s)),o?new Uint8Array(e):e;const g=[He.RGBA,He.RBGA,He.GRBA,He.GBRA,He.BRGA,He.BGRA];if(g.includes(t))if(i===He.GREY){u=new Uint8Array(e.length/4);for(let B=0;B<e.length;B+=4){const _=.21*e[B]+.71*e[B+1]+.07*e[B+2];u[B/4]=_}}else if(i===He.GREY32){u=o?new Uint8Array(e):e;for(let B=0;B<e.length;B+=4){const _=.21*e[B]+.71*e[B+1]+.07*e[B+2];u[B]=_,u[B+1]=_,u[B+2]=_}}else{if(!g.includes(i))throw new Error("Unable to transform.");if(o){u=new Uint8Array(e);const B=t.indexOf("r"),_=t.indexOf("g"),m=t.indexOf("b"),D=i.indexOf("r"),F=i.indexOf("g"),T=i.indexOf("b");for(let I=0;I<e.length;I+=4)u[I+D]=e[I+B],u[I+F]=e[I+_],u[I+T]=e[I+m]}else{u=e;const B=t.indexOf("r"),_=t.indexOf("g"),m=t.indexOf("b"),D=i.indexOf("r"),F=i.indexOf("g"),T=i.indexOf("b");for(let I=0;I<e.length;I+=4){let k=[e[I],e[I+1],e[I+2]];u[I+D]=k[B],u[I+F]=k[_],u[I+T]=k[m]}}}else if(t===He.GREY){if(i!==He.GREY32)throw new Error("Unable to transform.");u=new Uint8Array(4*e.length);for(let B=0;B<e.length;B++)u[4*B]=e[B],u[4*B+1]=e[B],u[4*B+2]=e[B],u[4*B+3]=255}else{if(t!==He.GREY32)throw new Error("Unable to transform.");if(i!==He.GREY)throw new Error("Unable to transform.");u=new Uint8Array(new Uint32Array(e.buffer))}return me._onLog&&me._onLog("DCE: _transformPixelFormat() end. Costs: "+(Date.now()-s)),u}_getImageData(e,t,i,o,s,u){if(this.isDisposed&&this.disposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(!t||!i)return null;if(o.sx>t||o.sy>i||o.sx+o.sWidth>t||o.sy+o.sHeight>i)throw new Error("Invalid position.");if(e instanceof HTMLVideoElement&&e.readyState!==4||e instanceof HTMLImageElement&&!e.complete)throw new Error("The source is not loaded.");let g;me._onLog&&(g=Date.now(),me._onLog("DCE: _getImageData(), START: "+g));const B=Math.round(o.sx),_=Math.round(o.sy),m=Math.round(o.sWidth),D=Math.round(o.sHeight),F=Math.round(o.dWidth),T=Math.round(o.dHeight);let I=He.RGBA;u&&u.pixelFormat&&(I=u.pixelFormat);let k,U,K,X=this._bWebGLSupported;u&&u.bUseWebGL==0&&(X=!1),X?(this._reusedWebGLCvs||(this._reusedWebGLCvs=document.createElement("canvas")),k=this._reusedWebGLCvs):(this._reusedCvs||(this._reusedCvs=document.createElement("canvas")),k=this._reusedCvs);try{if(X)if(me._onLog&&me._onLog("DCE: _getImageData() in WebGL."),s)if(I===He.GREY){if(K=new Uint8Array(F*T*4),U=this._drawImage(k,e,t,i,{sx:B,sy:_,sWidth:m,sHeight:D,dWidth:F,dHeight:T},K,{pixelFormat:I,bUseWebGL:X}),K=this._transformPixelFormat(K,U.pixelFormat,I),s){if(s.length<K.length)throw new Error("Unexpected size of the 'bufferContainer'.");s.set(K)}}else U=this._drawImage(k,e,t,i,{sx:B,sy:_,sWidth:m,sHeight:D,dWidth:F,dHeight:T},s,{pixelFormat:I,bUseWebGL:X}),K=new Uint8Array(s.buffer,0,F*T*4),K=this._transformPixelFormat(K,U.pixelFormat,I);else I===He.GREY?((!this._tempDataContainer||this._tempDataContainer.length<F*T*4)&&(this._tempDataContainer=new Uint8Array(F*T*4)),K=new Uint8Array(this._tempDataContainer.buffer,0,F*T*4)):K=new Uint8Array(F*T*4),U=this._drawImage(k,e,t,i,{sx:B,sy:_,sWidth:m,sHeight:D,dWidth:F,dHeight:T},K,{pixelFormat:I,bUseWebGL:X}),K=this._transformPixelFormat(K,U.pixelFormat,I);else if(me._onLog&&me._onLog("DCE: _getImageData() in context2d."),U=this._drawImage(k,e,t,i,{sx:B,sy:_,sWidth:m,sHeight:D,dWidth:F,dHeight:T},null,{pixelFormat:He.RGBA,bUseWebGL:X}),K=this._readCvsData(U.context,null,null),K=this._transformPixelFormat(K,U.pixelFormat,I),s){if(s.length<K.length)throw new Error("Unexpected size of the 'bufferContainer'.");s.set(K)}}catch(te){if(te.name==="WebGLError")return me._onLog&&me._onLog("DCE: _getImageData() in WebGL failed, try again in context2d."),this.forceLoseContext(),this._bWebGLSupported=!1,this._getImageData(e,t,i,{sx:B,sy:_,sWidth:m,sHeight:D,dWidth:F,dHeight:T},s,u);throw te}return me._onLog&&me._onLog("DCE: _getImageData() end. Costs: "+(Date.now()-g)),{data:K,pixelFormat:I,_bUseWebGL:U._bUseWebGL}}forceLoseContext(){if(!this._reusedWebGLCvs)return;const e=this._reusedWebGLCvs.ctxWebGL;e&&!e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext(),this._webGLTexture=null,this._webGLProgramInfo=null,this._webGLBuffers=null,this._reusedWebGLCvs=null}_getVideoData(e,t){if(this.isDisposed&&this.disposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getVideoData()' is unavailable in singleFrameMode.");if(!this._video||this._video.readyState!==4)return null;const i=Date.now();me._onLog&&me._onLog("DCE: _getVideoData() START: "+i);let o=this._scanRegion;t&&t.hasOwnProperty("region")&&(o=t.region);let s=this.mapPixelFormatString_Enum.get(this.framePixelFormat.toLowerCase());t&&t.pixelFormat&&(s=this.mapPixelFormatString_Enum.get(t.pixelFormat.toLowerCase()));let u=this._softwareScale;t&&t.scale&&(u=t.scale);const g=this._video.videoWidth,B=this._video.videoHeight;let _=this._scaleCenter;if(t&&t.scaleCenter){if(typeof t.scaleCenter.x!="string"||typeof t.scaleCenter.y!="string")throw new Error("Invalid scale center.");let k=0,U=0;if(t.scaleCenter.x.endsWith("px"))k=parseFloat(t.scaleCenter.x);else{if(!t.scaleCenter.x.endsWith("%"))throw new Error("Invalid scale center.");k=parseFloat(t.scaleCenter.x)/100*g}if(t.scaleCenter.y.endsWith("px"))U=parseFloat(t.scaleCenter.y);else{if(!t.scaleCenter.y.endsWith("%"))throw new Error("Invalid scale center.");U=parseFloat(t.scaleCenter.y)/100*B}if(k==NaN||U==NaN)throw new Error("Invalid scale center.");_.x=Math.round(k),_.y=Math.round(U)}if(g===0||B===0)return null;const m=this.getFrameSize(g,B,o,this.maxCvsSideLength);if(!m)return null;let D=!0;g===m.sWidth&&B===m.sHeight&&(D=!1);const F={data:null,region:o?JSON.parse(JSON.stringify(o)):null,sx:m.sx,sy:m.sy,width:m.dWidth,height:m.dHeight,colorMode:null,pixelFormat:null,timeSpent:null,timeStamp:null,isCropped:D,toCanvas:this._toCanvas,_sWidth:m.sWidth,_sHeight:m.sHeight,_bUseWebGL:null};u!==1&&(m.sWidth=Math.round(m.sWidth/u),m.sHeight=Math.round(m.sHeight/u),m.sx=Math.round((1-1/u)*_.x+m.sx/u),m.sy=Math.round((1-1/u)*_.y+m.sy/u));const T=this._getImageData(this._video,g,B,m,e,{pixelFormat:s});if(!T)return null;const I=Date.now();return me._onLog&&me._onLog("DCE: _getVideoData() END: "+I),F.data=T.data,F.pixelFormat=F.colorMode=T.pixelFormat,F._bUseWebGL=T._bUseWebGL,F.timeSpent=I-i,F.timeStamp=I,T.pixelFormat===He.GREY?F.stride=F.width:F.stride=4*F.width,F}getCurrentRegion(){let e=null;if(this._scanRegion)e=this._scanRegion;else if(this.croppingRegions){if(this._croppingRegionIndex>=this.croppingRegions.length||this._croppingRegionIndex<0)throw new Error("The 'croppingRegionIndex' is out of bounds.");e=this.croppingRegions[this._croppingRegionIndex],this.bIncreaseRegionIndexAuto&&++this._croppingRegionIndex>=this.croppingRegions.length&&(this._croppingRegionIndex=0)}return e}_fetchingLoop(e){if(this.isDisposed&&this.disposed)return;if(!this._bOpen||!this.isFetchingLoopStarted())return void this.stopFetchingLoop();const t=()=>{me._onLog&&me._onLog("DCE: start fetching a frame into buffer: "+Date.now());const o=this.getCurrentRegion();let s=this._getVideoData(null,{region:o});if(!s)return void(me._onLog&&me._onLog("DCE: get a invalid frame, abandon it: "+Date.now()));for(;this._frameQueue&&this._frameQueue.length>=this.maxNumberOfFramesInBuffer;)this._frameQueue.shift();this._frameQueue.push(s),me._onLog&&me._onLog("DCE: finish fetching a frame into buffer: "+Date.now());const u=this.mapCameraEvents.get("frameaddedtobuffer");for(let g of u)g&&setTimeout(()=>{this.isDisposed&&this.disposed||g.apply(this)},0)},i=()=>{this.isDisposed&&this.disposed||(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this.refreshInterval<=0||(this._frameLoopTimeoutId2=setTimeout(()=>{this.isDisposed&&this.disposed||(this._bOpen&&this.isFetchingLoopStarted()?(me._onLog&&me._onLog("DCE: second timeout executes: "+Date.now()),t(),i()):this.stopFetchingLoop())},this.refreshInterval)))};e&&(this._frameQueue.length<this.maxNumberOfFramesInBuffer?(t(),this.refreshInterval>0&&i()):this.refreshInterval>0?(t(),i()):this.refreshInterval===0?t():this.refreshInterval),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameLoopTimeoutId=setTimeout(()=>{this.isDisposed&&this.disposed||this._fetchingLoop(!0)},this.loopInterval)}startFetchingLoop(){if(this.isDisposed&&this.disposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(this._assertOpen(),this.singleFrameMode)throw Error("'startFetchingLoop()' is unavailable in singleFrameMode.");this.isFetchingLoopStarted()||(this._bFetchingLoopStarted=!0,this._recordedStates.fetchingLoopStart=!0,me._onLog&&me._onLog("DCE: start fetching loop: "+Date.now()),this._fetchingLoop(!0))}isFetchingLoopStarted(){return this._bFetchingLoopStarted}stopFetchingLoop(){this._bFetchingLoopStarted&&(me._onLog&&me._onLog("DCE: stop fetching loop: "+Date.now()),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameQueue.length=0,this._bFetchingLoopStarted=!1,this._recordedStates.fetchingLoopStart=!1)}getFrameFromBuffer(e){return this._frameQueue&&this._frameQueue.length?e?e<this._frameQueue.length?(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.splice(e,1)[0]):void 0:(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.pop()):null}clearFrameBuffer(){this._frameQueue&&(this._frameQueue.length=0)}_createDrawingLayerBaseCvs(){this._assertOpen();const e=this._calculateCvsSize();if(!e)throw new Error("Camera is not open.");const{width:t,height:i,objectFit:o}=e;if(t<=0||i<=0)throw new Error("Invalid dimension of video or image.");const s=document.createElement("canvas");if(s.width==t&&s.height==i||(s.width=t,s.height=i),s.style.objectFit=o,this._cvsScanRegion)this._cvsScanRegion.after(s);else if(this._cvsOriginalImage)this._cvsOriginalImage.after(s);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(s);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(s)}return s}_updateDrawingLayersSize(e){let t;if(t=e&&e.width&&e.height&&e.objectFit?{width:e.width,height:e.height,objectFit:e.objectFit}:this._calculateCvsSize(),!t)return;const{width:i,height:o,objectFit:s}=t;this._drawingLayersManager.setDimensions({width:i,height:o},{backstoreOnly:!0}),this._drawingLayersManager.setObjectFit(s)}_createDrawingLayer(e){this._layerBaseCvs||(this._layerBaseCvs=this._createDrawingLayerBaseCvs());const t=this._layerBaseCvs;return this._drawingLayersManager.createDrawingLayer(t,e)}deleteDrawingLayer(e){this._drawingLayersManager.deleteDrawingLayer(e),this._drawingLayersManager.getDrawingLayers().length||this._layerBaseCvs&&(this._layerBaseCvs.remove(),this._layerBaseCvs=null)}createDrawingLayer(){return this._createDrawingLayer()}getDrawingLayer(e){return this._drawingLayersManager.getDrawingLayer(e)||([1,2,3].includes(e)?this._createDrawingLayer(e):null)}getDrawingLayers(){return this._drawingLayersManager.getDrawingLayers().filter(e=>e.getId()>=0)}getSelectedDrawingItems(){return this._drawingLayersManager.getSelectedDrawingItems()}createDrawingStyle(e){return this._drawingLayersManager.createDrawingStyle(e)}getDrawingStyle(e){return this._drawingLayersManager.getDrawingStyle(e)}getDrawingStyles(){return this._drawingLayersManager.getDrawingStyles()}updateDrawingStyle(e,t){return this._drawingLayersManager.updateDrawingStyle(e,t)}clearDrawingLayers(){const e=this.getDrawingLayers();for(let t of e)this.deleteDrawingLayer(t.getId())}showTip(e,t,i,o,s=3e3,u=!0){this._assertOpen(),this._tipArgs.x=e,this._tipArgs.y=t,this._tipArgs.width=i,this._tipArgs.autoShowSuggestedTip=!!u,this._drawingLayerOfTip||(this._drawingLayerOfTip=this._createDrawingLayer(-1)),this._tipStyleId||(this._tipStyleId=this.createDrawingStyle({fillStyle:"#FFFFFF",paintMode:"fill",fontFamily:"Open Sans",fontSize:40})),this._drawingLayerOfTip.clearDrawingItems();const g=new yx(o||"",e,t,i,this._tipStyleId);g._fabricObject.paddingTop=15,g._fabricObject.calcTextHeight=function(){for(var B=0,_=0,m=this._textLines.length;_<m;_++)B+=this.getHeightOfLine(_);return B+=2*this.paddingTop},g._fabricObject._getTopOffset=function(){return-this.height/2+this.getHeightOfLine(0)*(1-1/this.lineHeight)/2+this.paddingTop},g.setAttribute("backgroundColor","rgba(50, 50, 52, .8)"),g.setAttribute("lineHeight",1.3),g.setAttribute("textAlign","center"),this._drawingLayerOfTip.addDrawingItem(g),this._hideTipTimeoutId&&clearTimeout(this._hideTipTimeoutId),this._tipArgs.duration=s===void 0?3e3:s,this._tipArgs.duration>0&&(this._hideTipTimeoutId=setTimeout(()=>{this.isDisposed&&this.disposed||this._hideTip()},this._tipArgs.duration))}_hideTip(){this._drawingLayerOfTip&&(this.deleteDrawingLayer(this._drawingLayerOfTip.getId()),this._drawingLayerOfTip=null,this._hideTipTimeoutId&&clearTimeout(this._hideTipTimeoutId))}hideTip(){this._hideTip(),this._tipArgs.x=null,this._tipArgs.y=null,this._tipArgs.width=null,this._tipArgs.autoShowSuggestedTip=null}updateTipMessage(e){if(!this._drawingLayerOfTip)throw new Error("The Tip is not showing.");this._drawingLayerOfTip.getDrawingItems()[0].setAttribute("text",e),this._drawingLayerOfTip.renderAll(),this._tipArgs.duration>0&&(this._hideTipTimeoutId&&clearTimeout(this._hideTipTimeoutId),this._hideTipTimeoutId=setTimeout(()=>{this.isDisposed&&this.disposed||this._hideTip()},this._tipArgs.duration))}suggestTip(e,t){this._tipArgs.autoShowSuggestedTip&&(this._drawingLayerOfTip?this.updateTipMessage(t):this._tipArgs.x!==void 0&&this.showTip(this._tipArgs.x,this._tipArgs.y,this._tipArgs.width,t,this._tipArgs.duration)),this.onTipSuggested&&setTimeout(()=>{this.isDisposed&&this.disposed||this.onTipSuggested.apply(this,[e,t])},0)}_createControler(){if(this._controler||(this._controler=new Fx(this)),this._controler)return this._controler}_destroyControler(){this._controler=null}setOriginalImage(e,t,i){if(!e||!t||!i)throw new Error("Invalid arguments");this._originalImageData={imageData:e,width:t,height:i};let o=this._cvsOriginalImage;o||(o=document.createElement("canvas"),o.style.position="absolute",o.style.width="100%",o.style.height="100%",o.style.left="0",o.style.top="0",o.style.backgroundColor="white",o.style.objectFit="contain",this._cvsOriginalImage=o),o.width===t&&o.height===i||(o.width=t,o.height=i);const s=o.getContext("2d");s.clearRect(0,0,o.width,o.height),e instanceof Uint8Array||e instanceof Uint8ClampedArray?(e instanceof Uint8Array&&(e=new Uint8ClampedArray(e.buffer)),s.putImageData(new ImageData(e,t,i),0,0)):e instanceof HTMLCanvasElement&&s.drawImage(e,0,0),document.body.contains(o)&&o.style.display===""&&this._updateDrawingLayersSize({width:t,height:i,objectFit:"contain"})}getOriginalImage(){return this._originalImageData?Object.assign({},this._originalImageData):null}async deleteOriginalImage(){await this.hideOriginalImage(),this._cvsOriginalImage&&(this._cvsOriginalImage.remove(),this._cvsOriginalImage=null),this._originalImageData=null}_showOriginalImageCvs(){this._cvsOriginalImage&&this._cvsOriginalImage.style.display=="none"&&(this._cvsOriginalImage.style.display="")}_hideOriginalImageCvs(){this._cvsOriginalImage&&(this._cvsOriginalImage.style.display="none")}showOriginalImage(){if(!this._originalImageData)throw new Error("No original image is set.");const e=this._cvsOriginalImage;if(e.style.display===""&&document.body.contains(e))return;const{width:t,height:i}=this._originalImageData;if(this._updateDrawingLayersSize({width:t,height:i,objectFit:"contain"}),this._bOpen&&(this._video&&!this._video.paused&&this._video.pause(),this._bFetchingLoopStarted&&(this.stopFetchingLoop(),this._recordedStates.fetchingLoopStart=!0),this.ifShowScanRegionMask&&this._cvsScanRegion&&(this._cvsScanRegion.style.display="none"),this.ifShowScanRegionLaser&&this._divScanLight&&(this._divScanLight.style.display="none"),this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none"),this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display="none"),this._selCam&&(this._selCam.parentElement.style.display="none")),!document.body.contains(e))if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(e);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(e)}this._showOriginalImageCvs()}async _hideOriginalImage(e){this._originalImageData&&this._cvsOriginalImage&&this._cvsOriginalImage.style.display!=="none"&&(this._updateDrawingLayersSize(),this._bOpen&&e&&(this._video&&this._recordedStates.videoPlaying&&await this.play(null,null,null,{notTriggerSingleFrameClick:!0}),this._recordedStates.fetchingLoopStart&&!this.singleFrameMode&&this.startFetchingLoop(),this.ifShowScanRegionMask&&this._cvsScanRegion&&this._recordedStates.maskShow&&this.showScanRegionMask(),this.ifShowScanRegionLaser&&this._divScanLight&&this._recordedStates.laserShow&&this.showScanRegionLaser(),this._cvsViewDecorator&&this._recordedStates.decoratorShow&&this.showViewDecorator(),this._scanRegionOverlayContainer&&this._recordedStates.overlayShow&&this.showScanRegionOverlays()),this._selCam&&(this._selCam.parentElement.style.display=""),this._hideOriginalImageCvs())}async hideOriginalImage(){return this._hideOriginalImage(!0)}transformCoord(e){if(!this.isOpen())throw new Error("Unavailable when the camera is not open.");if(this.singleFrameMode&&!this._cvsSingleFrameMode)throw new Error("No image is selected. ");const t=this._elContainer.getBoundingClientRect();let i,o,s,u,g,B=t.left,_=t.top,m=B+window.scrollX,D=_+window.scrollY;this.singleFrameMode?(i=this._cvsSingleFrameMode.width,o=this._cvsSingleFrameMode.height,s=parseFloat(window.getComputedStyle(this._cvsSingleFrameMode).width),u=parseFloat(window.getComputedStyle(this._cvsSingleFrameMode).height),g="contain"):(i=this.video.videoWidth,o=this.video.videoHeight,s=parseFloat(window.getComputedStyle(this._elContainer).width),u=parseFloat(window.getComputedStyle(this._elContainer).height),g=this.videoFit);const F=s/u,T=i/o;let I,k,U,K,X=1;if(g==="contain")F<T?(X=s/i,I=B+e.x*X,k=_+e.y*X+(u-o*X)/2,U=m+e.x*X,K=D+e.y*X+(u-o*X)/2):(X=u/o,I=B+e.x*X+(s-i*X)/2,k=_+e.y*X,U=m+e.x*X+(s-i*X)/2,K=D+e.y*X);else if(g==="cover")if(F<T){X=u/o;let te=e.x*X-(i*X-s)/2;te=Math.max(te,0),te=Math.min(te,s),I=B+te,k=_+e.y*X,U=m+te,K=D+e.y*X}else{X=s/i;let te=e.y*X-(o*X-u)/2;te=Math.max(te,0),te=Math.min(te,u),I=B+e.x*X,k=_+te,U=m+e.x*X,K=D+te}return{clientX:Math.round(I),clientY:Math.round(k),pageX:Math.round(U),pageY:Math.round(K)}}convertToPageCoordinates(e){const t=this.transformCoord(e);return{x:t.pageX,y:t.pageY}}convertToClientCoordinates(e){const t=this.transformCoord(e);return{x:t.clientX,y:t.clientY}}dispose(e){this.UIElement&&(this._uiOriginalState&&this._uiOriginalState.inDom?this.UIElement.style.display=this._uiOriginalState.display:this.UIElement.style.display="none"),this.clearDrawingLayers(),this.close(),this.forceLoseContext(),this.setViewDecorator(null,null),this._scanRegionOverlayContainer&&this._scanRegionOverlayContainer.remove(),this._arrScanRegionOverlays.length=0,e&&this.UIElement&&this.UIElement.remove(),this.__proto__=null;for(let t in this)delete this[t];Object.defineProperty(this,"isCameraEnhancer",{value:!0}),Object.defineProperty(this,"isDisposed",{value:!0}),Object.defineProperty(this,"disposed",{value:!0})}}me._jsVersion="3.3.4",me._jsEditVersion="20230414",me._version="JS "+me._jsVersion+"."+me._jsEditVersion,me.browserInfo=At,me._hasEngineResourceLoaded=!1,me._engineResourcePath=mx,me._defaultUIElementURL="@engineResourcePath/dce.ui.html";class Sx{constructor(){sr(this,"canvas");sr(this,"reader");sr(this,"settings")}async init(){this.canvas||(this.canvas=document.createElement("canvas")),this.reader=window.zbarWasm}async detect(e){const t=Date.now();typeof e=="string"?e=await this.loadImageFromDataURL(e):me.isDCEFrame(e)?e=await this.loadImageFromDataURL(e.toCanvas().toDataURL()):e instanceof HTMLCanvasElement&&(e=await this.loadImageFromDataURL(e.toDataURL()));const i=this.getImageData(e);let o=0;const s=[];if(i){const g=await this.reader.scanImageData(i);o=Date.now()-t;for(let B=0;B<g.length;B++){const _=g[B];s.push(this.wrapResult(_))}}return{elapsedTime:o,results:s}}wrapResult(e){const t=this.getRectFromPoints(e.points),i=this.getBinary(e.data);return{barcodeFormat:e.typeName,barcodeText:e.decode(),barcodeBytes:i,confidence:e.quality,x1:t.left,x2:t.right,x3:t.right,x4:t.left,y1:t.top,y2:t.top,y3:t.bottom,y4:t.bottom}}getRectFromPoints(e){return Ui(this.convertZBarPointsToPoints(e))}convertZBarPointsToPoints(e){const t=[];for(let i=0;i<e.length;i++){const o=e[i],s={x:o.x,y:o.y};t.push(s)}return t}getImageData(e){const t=this.canvas.getContext("2d");let i,o;return e instanceof HTMLVideoElement?(i=e.videoWidth,o=e.videoHeight):(i=e.naturalWidth,o=e.naturalHeight),this.canvas.width=i,this.canvas.height=o,t==null||t.drawImage(e,0,0,i,o),t==null?void 0:t.getImageData(0,0,i,o)}getImageDataFromCanvas(e){const t=this.canvas.getContext("2d");return t==null||t.drawImage(e,0,0,e.width,e.height),t==null?void 0:t.getImageData(0,0,e.width,e.height)}loadImageFromDataURL(e){return new Promise(async function(t,i){try{const o=new Image;o.src=e,o.onload=function(){t(o)}}catch(o){i(o)}})}getBinary(e){let t="";for(let i=0;i<e.length;i++){const o=e[i];t=t+On(o.toString())}return t}getSupportedSettings(){return[]}async setSupportedSettings(e){this.settings=e}}function bx(r,e){var t=Object.setPrototypeOf;t?t(r,e):r.__proto__=e}function Tx(r,e){e===void 0&&(e=r.constructor);var t=Error.captureStackTrace;t&&t(r,e)}var Ox=function(){var r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(o[u]=s[u])},r(t,i)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ix=function(r){Ox(e,r);function e(t,i){var o=this.constructor,s=r.call(this,t,i)||this;return Object.defineProperty(s,"name",{value:o.name,enumerable:!1,configurable:!0}),bx(s,o.prototype),Tx(s),s}return e}(Error),Rx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Xt=function(r){Rx(e,r);function e(t){t===void 0&&(t=void 0);var i=r.call(this,t)||this;return i.message=t,i}return e.prototype.getKind=function(){var t=this.constructor;return t.kind},e.kind="Exception",e}(Ix),Px=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),nr=function(r){Px(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ArgumentException",e}(Xt),Mx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ue=function(r){Mx(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(Xt),U0=function(){function r(e){if(this.binarizer=e,e===null)throw new Ue("Binarizer must be non-null.")}return r.prototype.getWidth=function(){return this.binarizer.getWidth()},r.prototype.getHeight=function(){return this.binarizer.getHeight()},r.prototype.getBlackRow=function(e,t){return this.binarizer.getBlackRow(e,t)},r.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},r.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},r.prototype.crop=function(e,t,i,o){var s=this.binarizer.getLuminanceSource().crop(e,t,i,o);return new r(this.binarizer.createBinarizer(s))},r.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},r.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new r(this.binarizer.createBinarizer(e))},r.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new r(this.binarizer.createBinarizer(e))},r.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},r}(),Lx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Dt=function(r){Lx(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(Xt),kx=function(){function r(e){this.source=e}return r.prototype.getLuminanceSource=function(){return this.source},r.prototype.getWidth=function(){return this.source.getWidth()},r.prototype.getHeight=function(){return this.source.getHeight()},r}(),nt=function(){function r(){}return r.arraycopy=function(e,t,i,o,s){for(;s--;)i[o++]=e[t++]},r.currentTimeMillis=function(){return Date.now()},r}(),Nx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),kn=function(r){Nx(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(Xt),jx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Lo=function(r){jx(e,r);function e(t,i){t===void 0&&(t=void 0),i===void 0&&(i=void 0);var o=r.call(this,i)||this;return o.index=t,o.message=i,o}return e.kind="ArrayIndexOutOfBoundsException",e}(kn),Ux=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vt=function(){function r(){}return r.fill=function(e,t){for(var i=0,o=e.length;i<o;i++)e[i]=t},r.fillWithin=function(e,t,i,o){r.rangeCheck(e.length,t,i);for(var s=t;s<i;s++)e[s]=o},r.rangeCheck=function(e,t,i){if(t>i)throw new Ue("fromIndex("+t+") > toIndex("+i+")");if(t<0)throw new Lo(t);if(i>e)throw new Lo(i)},r.asList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},r.create=function(e,t,i){var o=Array.from({length:e});return o.map(function(s){return Array.from({length:t}).fill(i)})},r.createInt32Array=function(e,t,i){var o=Array.from({length:e});return o.map(function(s){return Int32Array.from({length:t}).fill(i)})},r.equals=function(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(var i=0,o=e.length;i<o;i++)if(e[i]!==t[i])return!1;return!0},r.hashCode=function(e){var t,i;if(e===null)return 0;var o=1;try{for(var s=Ux(e),u=s.next();!u.done;u=s.next()){var g=u.value;o=31*o+g}}catch(B){t={error:B}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return o},r.fillUint8Array=function(e,t){for(var i=0;i!==e.length;i++)e[i]=t},r.copyOf=function(e,t){return e.slice(0,t)},r.copyOfUint8Array=function(e,t){if(e.length<=t){var i=new Uint8Array(t);return i.set(e),i}return e.slice(0,t)},r.copyOfRange=function(e,t,i){var o=i-t,s=new Int32Array(o);return nt.arraycopy(e,t,s,0,o),s},r.binarySearch=function(e,t,i){i===void 0&&(i=r.numberComparator);for(var o=0,s=e.length-1;o<=s;){var u=s+o>>1,g=i(t,e[u]);if(g>0)o=u+1;else if(g<0)s=u-1;else return u}return-o-1},r.numberComparator=function(e,t){return e-t},r}(),ut=function(){function r(){}return r.numberOfTrailingZeros=function(e){var t;if(e===0)return 32;var i=31;return t=e<<16,t!==0&&(i-=16,e=t),t=e<<8,t!==0&&(i-=8,e=t),t=e<<4,t!==0&&(i-=4,e=t),t=e<<2,t!==0&&(i-=2,e=t),i-(e<<1>>>31)},r.numberOfLeadingZeros=function(e){if(e===0)return 32;var t=1;return e>>>16===0&&(t+=16,e<<=16),e>>>24===0&&(t+=8,e<<=8),e>>>28===0&&(t+=4,e<<=4),e>>>30===0&&(t+=2,e<<=2),t-=e>>>31,t},r.toHexString=function(e){return e.toString(16)},r.toBinaryString=function(e){return String(parseInt(String(e),2))},r.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},r.truncDivision=function(e,t){return Math.trunc(e/t)},r.parseInt=function(e,t){return t===void 0&&(t=void 0),parseInt(e,t)},r.MIN_VALUE_32_BITS=-2147483648,r.MAX_VALUE=Number.MAX_SAFE_INTEGER,r}(),Ht=function(){function r(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=r.makeArray(e):this.bits=t)}return r.prototype.getSize=function(){return this.size},r.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},r.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var t=r.makeArray(e);nt.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}},r.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},r.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},r.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},r.prototype.getNextSet=function(e){var t=this.size;if(e>=t)return t;var i=this.bits,o=Math.floor(e/32),s=i[o];s&=~((1<<(e&31))-1);for(var u=i.length;s===0;){if(++o===u)return t;s=i[o]}var g=o*32+ut.numberOfTrailingZeros(s);return g>t?t:g},r.prototype.getNextUnset=function(e){var t=this.size;if(e>=t)return t;var i=this.bits,o=Math.floor(e/32),s=~i[o];s&=~((1<<(e&31))-1);for(var u=i.length;s===0;){if(++o===u)return t;s=~i[o]}var g=o*32+ut.numberOfTrailingZeros(s);return g>t?t:g},r.prototype.setBulk=function(e,t){this.bits[Math.floor(e/32)]=t},r.prototype.setRange=function(e,t){if(t<e||e<0||t>this.size)throw new Ue;if(t!==e){t--;for(var i=Math.floor(e/32),o=Math.floor(t/32),s=this.bits,u=i;u<=o;u++){var g=u>i?0:e&31,B=u<o?31:t&31,_=(2<<B)-(1<<g);s[u]|=_}}},r.prototype.clear=function(){for(var e=this.bits.length,t=this.bits,i=0;i<e;i++)t[i]=0},r.prototype.isRange=function(e,t,i){if(t<e||e<0||t>this.size)throw new Ue;if(t===e)return!0;t--;for(var o=Math.floor(e/32),s=Math.floor(t/32),u=this.bits,g=o;g<=s;g++){var B=g>o?0:e&31,_=g<s?31:t&31,m=(2<<_)-(1<<B)&4294967295;if((u[g]&m)!==(i?m:0))return!1}return!0},r.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},r.prototype.appendBits=function(e,t){if(t<0||t>32)throw new Ue("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(var i=t;i>0;i--)this.appendBit((e>>i-1&1)===1)},r.prototype.appendBitArray=function(e){var t=e.size;this.ensureCapacity(this.size+t);for(var i=0;i<t;i++)this.appendBit(e.get(i))},r.prototype.xor=function(e){if(this.size!==e.size)throw new Ue("Sizes don't match");for(var t=this.bits,i=0,o=t.length;i<o;i++)t[i]^=e.bits[i]},r.prototype.toBytes=function(e,t,i,o){for(var s=0;s<o;s++){for(var u=0,g=0;g<8;g++)this.get(e)&&(u|=1<<7-g),e++;t[i+s]=u}},r.prototype.getBitArray=function(){return this.bits},r.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),i=t+1,o=this.bits,s=0;s<i;s++){var u=o[s];u=u>>1&1431655765|(u&1431655765)<<1,u=u>>2&858993459|(u&858993459)<<2,u=u>>4&252645135|(u&252645135)<<4,u=u>>8&16711935|(u&16711935)<<8,u=u>>16&65535|(u&65535)<<16,e[t-s]=u}if(this.size!==i*32){for(var g=i*32-this.size,B=e[0]>>>g,s=1;s<i;s++){var _=e[s];B|=_<<32-g,e[s-1]=B,B=_>>>g}e[i-1]=B}this.bits=e},r.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.size===t.size&&vt.equals(this.bits,t.bits)},r.prototype.hashCode=function(){return 31*this.size+vt.hashCode(this.bits)},r.prototype.toString=function(){for(var e="",t=0,i=this.size;t<i;t++)(t&7)===0&&(e+=" "),e+=this.get(t)?"X":".";return e},r.prototype.clone=function(){return new r(this.size,this.bits.slice())},r.prototype.toArray=function(){for(var e=[],t=0,i=this.size;t<i;t++)e.push(this.get(t));return e},r}(),En;(function(r){r[r.OTHER=0]="OTHER",r[r.PURE_BARCODE=1]="PURE_BARCODE",r[r.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",r[r.TRY_HARDER=3]="TRY_HARDER",r[r.CHARACTER_SET=4]="CHARACTER_SET",r[r.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",r[r.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",r[r.ASSUME_GS1=7]="ASSUME_GS1",r[r.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",r[r.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",r[r.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(En||(En={}));var xt=En,Vx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ie=function(r){Vx(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(Xt),Gx=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Qe;(function(r){r[r.Cp437=0]="Cp437",r[r.ISO8859_1=1]="ISO8859_1",r[r.ISO8859_2=2]="ISO8859_2",r[r.ISO8859_3=3]="ISO8859_3",r[r.ISO8859_4=4]="ISO8859_4",r[r.ISO8859_5=5]="ISO8859_5",r[r.ISO8859_6=6]="ISO8859_6",r[r.ISO8859_7=7]="ISO8859_7",r[r.ISO8859_8=8]="ISO8859_8",r[r.ISO8859_9=9]="ISO8859_9",r[r.ISO8859_10=10]="ISO8859_10",r[r.ISO8859_11=11]="ISO8859_11",r[r.ISO8859_13=12]="ISO8859_13",r[r.ISO8859_14=13]="ISO8859_14",r[r.ISO8859_15=14]="ISO8859_15",r[r.ISO8859_16=15]="ISO8859_16",r[r.SJIS=16]="SJIS",r[r.Cp1250=17]="Cp1250",r[r.Cp1251=18]="Cp1251",r[r.Cp1252=19]="Cp1252",r[r.Cp1256=20]="Cp1256",r[r.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",r[r.UTF8=22]="UTF8",r[r.ASCII=23]="ASCII",r[r.Big5=24]="Big5",r[r.GB18030=25]="GB18030",r[r.EUC_KR=26]="EUC_KR"})(Qe||(Qe={}));var Bt=function(){function r(e,t,i){for(var o,s,u=[],g=3;g<arguments.length;g++)u[g-3]=arguments[g];this.valueIdentifier=e,this.name=i,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=u,r.VALUE_IDENTIFIER_TO_ECI.set(e,this),r.NAME_TO_ECI.set(i,this);for(var B=this.values,_=0,m=B.length;_!==m;_++){var D=B[_];r.VALUES_TO_ECI.set(D,this)}try{for(var F=Gx(u),T=F.next();!T.done;T=F.next()){var I=T.value;r.NAME_TO_ECI.set(I,this)}}catch(k){o={error:k}}finally{try{T&&!T.done&&(s=F.return)&&s.call(F)}finally{if(o)throw o.error}}}return r.prototype.getValueIdentifier=function(){return this.valueIdentifier},r.prototype.getName=function(){return this.name},r.prototype.getValue=function(){return this.values[0]},r.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new Ie("incorect value");var t=r.VALUES_TO_ECI.get(e);if(t===void 0)throw new Ie("incorect value");return t},r.getCharacterSetECIByName=function(e){var t=r.NAME_TO_ECI.get(e);if(t===void 0)throw new Ie("incorect value");return t},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.getName()===t.getName()},r.VALUE_IDENTIFIER_TO_ECI=new Map,r.VALUES_TO_ECI=new Map,r.NAME_TO_ECI=new Map,r.Cp437=new r(Qe.Cp437,Int32Array.from([0,2]),"Cp437"),r.ISO8859_1=new r(Qe.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),r.ISO8859_2=new r(Qe.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),r.ISO8859_3=new r(Qe.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),r.ISO8859_4=new r(Qe.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),r.ISO8859_5=new r(Qe.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),r.ISO8859_6=new r(Qe.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),r.ISO8859_7=new r(Qe.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),r.ISO8859_8=new r(Qe.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),r.ISO8859_9=new r(Qe.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),r.ISO8859_10=new r(Qe.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),r.ISO8859_11=new r(Qe.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),r.ISO8859_13=new r(Qe.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),r.ISO8859_14=new r(Qe.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),r.ISO8859_15=new r(Qe.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),r.ISO8859_16=new r(Qe.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),r.SJIS=new r(Qe.SJIS,20,"SJIS","Shift_JIS"),r.Cp1250=new r(Qe.Cp1250,21,"Cp1250","windows-1250"),r.Cp1251=new r(Qe.Cp1251,22,"Cp1251","windows-1251"),r.Cp1252=new r(Qe.Cp1252,23,"Cp1252","windows-1252"),r.Cp1256=new r(Qe.Cp1256,24,"Cp1256","windows-1256"),r.UnicodeBigUnmarked=new r(Qe.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),r.UTF8=new r(Qe.UTF8,26,"UTF8","UTF-8"),r.ASCII=new r(Qe.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),r.Big5=new r(Qe.Big5,28,"Big5"),r.GB18030=new r(Qe.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),r.EUC_KR=new r(Qe.EUC_KR,30,"EUC_KR","EUC-KR"),r}(),Wx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),bi=function(r){Wx(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(Xt),tr=function(){function r(){}return r.decode=function(e,t){var i=this.encodingName(t);return this.customDecoder?this.customDecoder(e,i):typeof TextDecoder=="undefined"||this.shouldDecodeOnFallback(i)?this.decodeFallback(e,i):new TextDecoder(i).decode(e)},r.shouldDecodeOnFallback=function(e){return!r.isBrowser()&&e==="ISO-8859-1"},r.encode=function(e,t){var i=this.encodingName(t);return this.customEncoder?this.customEncoder(e,i):typeof TextEncoder=="undefined"?this.encodeFallback(e):new TextEncoder().encode(e)},r.isBrowser=function(){return typeof window!="undefined"&&{}.toString.call(window)==="[object Window]"},r.encodingName=function(e){return typeof e=="string"?e:e.getName()},r.encodingCharacterSet=function(e){return e instanceof Bt?e:Bt.getCharacterSetECIByName(e)},r.decodeFallback=function(e,t){var i=this.encodingCharacterSet(t);if(r.isDecodeFallbackSupported(i)){for(var o="",s=0,u=e.length;s<u;s++){var g=e[s].toString(16);g.length<2&&(g="0"+g),o+="%"+g}return decodeURIComponent(o)}if(i.equals(Bt.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new bi("Encoding "+this.encodingName(t)+" not supported by fallback.")},r.isDecodeFallbackSupported=function(e){return e.equals(Bt.UTF8)||e.equals(Bt.ISO8859_1)||e.equals(Bt.ASCII)},r.encodeFallback=function(e){for(var t=btoa(unescape(encodeURIComponent(e))),i=t.split(""),o=[],s=0;s<i.length;s++)o.push(i[s].charCodeAt(0));return new Uint8Array(o)},r}(),it=function(){function r(){}return r.castAsNonUtf8Char=function(e,t){t===void 0&&(t=null);var i=t?t.getName():this.ISO88591;return tr.decode(new Uint8Array([e]),i)},r.guessEncoding=function(e,t){if(t!=null&&t.get(xt.CHARACTER_SET)!==void 0)return t.get(xt.CHARACTER_SET).toString();for(var i=e.length,o=!0,s=!0,u=!0,g=0,B=0,_=0,m=0,D=0,F=0,T=0,I=0,k=0,U=0,K=0,X=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,te=0;te<i&&(o||s||u);te++){var ne=e[te]&255;u&&(g>0?(ne&128)===0?u=!1:g--:(ne&128)!==0&&((ne&64)===0?u=!1:(g++,(ne&32)===0?B++:(g++,(ne&16)===0?_++:(g++,(ne&8)===0?m++:u=!1))))),o&&(ne>127&&ne<160?o=!1:ne>159&&(ne<192||ne===215||ne===247)&&K++),s&&(D>0?ne<64||ne===127||ne>252?s=!1:D--:ne===128||ne===160||ne>239?s=!1:ne>160&&ne<224?(F++,I=0,T++,T>k&&(k=T)):ne>127?(D++,T=0,I++,I>U&&(U=I)):(T=0,I=0))}return u&&g>0&&(u=!1),s&&D>0&&(s=!1),u&&(X||B+_+m>0)?r.UTF8:s&&(r.ASSUME_SHIFT_JIS||k>=3||U>=3)?r.SHIFT_JIS:o&&s?k===2&&F===2||K*10>=i?r.SHIFT_JIS:r.ISO88591:o?r.ISO88591:s?r.SHIFT_JIS:u?r.UTF8:r.PLATFORM_DEFAULT_ENCODING},r.format=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=-1;function s(g,B,_,m,D,F){if(g==="%%")return"%";if(t[++o]!==void 0){g=m?parseInt(m.substr(1)):void 0;var T=D?parseInt(D.substr(1)):void 0,I;switch(F){case"s":I=t[o];break;case"c":I=t[o][0];break;case"f":I=parseFloat(t[o]).toFixed(g);break;case"p":I=parseFloat(t[o]).toPrecision(g);break;case"e":I=parseFloat(t[o]).toExponential(g);break;case"x":I=parseInt(t[o]).toString(T||16);break;case"d":I=parseFloat(parseInt(t[o],T||10).toPrecision(g)).toFixed(0);break}I=typeof I=="object"?JSON.stringify(I):(+I).toString(T);for(var k=parseInt(_),U=_&&_[0]+""=="0"?"0":" ";I.length<k;)I=B!==void 0?I+U:U+I;return I}}var u=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(u,s)},r.getBytes=function(e,t){return tr.encode(e,t)},r.getCharCode=function(e,t){return t===void 0&&(t=0),e.charCodeAt(t)},r.getCharAt=function(e){return String.fromCharCode(e)},r.SHIFT_JIS=Bt.SJIS.getName(),r.GB2312="GB2312",r.ISO88591=Bt.ISO8859_1.getName(),r.EUC_JP="EUC_JP",r.UTF8=Bt.UTF8.getName(),r.PLATFORM_DEFAULT_ENCODING=r.UTF8,r.ASSUME_SHIFT_JIS=!1,r}(),Ge=function(){function r(e){e===void 0&&(e=""),this.value=e}return r.prototype.enableDecoding=function(e){return this.encoding=e,this},r.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=it.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},r.prototype.appendChars=function(e,t,i){for(var o=t;t<t+i;o++)this.append(e[o]);return this},r.prototype.length=function(){return this.value.length},r.prototype.charAt=function(e){return this.value.charAt(e)},r.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},r.prototype.setCharAt=function(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)},r.prototype.substring=function(e,t){return this.value.substring(e,t)},r.prototype.setLengthToZero=function(){this.value=""},r.prototype.toString=function(){return this.value},r.prototype.insert=function(e,t){this.value=this.value.substring(0,e)+t+this.value.substring(e)},r}(),dr=function(){function r(e,t,i,o){if(this.width=e,this.height=t,this.rowSize=i,this.bits=o,t==null&&(t=e),this.height=t,e<1||t<1)throw new Ue("Both dimensions must be greater than 0");i==null&&(i=Math.floor((e+31)/32)),this.rowSize=i,o==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return r.parseFromBooleanArray=function(e){for(var t=e.length,i=e[0].length,o=new r(i,t),s=0;s<t;s++)for(var u=e[s],g=0;g<i;g++)u[g]&&o.set(g,s);return o},r.parseFromString=function(e,t,i){if(e===null)throw new Ue("stringRepresentation cannot be null");for(var o=new Array(e.length),s=0,u=0,g=-1,B=0,_=0;_<e.length;)if(e.charAt(_)===`
`||e.charAt(_)==="\r"){if(s>u){if(g===-1)g=s-u;else if(s-u!==g)throw new Ue("row lengths do not match");u=s,B++}_++}else if(e.substring(_,_+t.length)===t)_+=t.length,o[s]=!0,s++;else if(e.substring(_,_+i.length)===i)_+=i.length,o[s]=!1,s++;else throw new Ue("illegal character encountered: "+e.substring(_));if(s>u){if(g===-1)g=s-u;else if(s-u!==g)throw new Ue("row lengths do not match");B++}for(var m=new r(g,B),D=0;D<s;D++)o[D]&&m.set(Math.floor(D%g),Math.floor(D/g));return m},r.prototype.get=function(e,t){var i=t*this.rowSize+Math.floor(e/32);return(this.bits[i]>>>(e&31)&1)!==0},r.prototype.set=function(e,t){var i=t*this.rowSize+Math.floor(e/32);this.bits[i]|=1<<(e&31)&4294967295},r.prototype.unset=function(e,t){var i=t*this.rowSize+Math.floor(e/32);this.bits[i]&=~(1<<(e&31)&4294967295)},r.prototype.flip=function(e,t){var i=t*this.rowSize+Math.floor(e/32);this.bits[i]^=1<<(e&31)&4294967295},r.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new Ue("input matrix dimensions do not match");for(var t=new Ht(Math.floor(this.width/32)+1),i=this.rowSize,o=this.bits,s=0,u=this.height;s<u;s++)for(var g=s*i,B=e.getRow(s,t).getBitArray(),_=0;_<i;_++)o[g+_]^=B[_]},r.prototype.clear=function(){for(var e=this.bits,t=e.length,i=0;i<t;i++)e[i]=0},r.prototype.setRegion=function(e,t,i,o){if(t<0||e<0)throw new Ue("Left and top must be nonnegative");if(o<1||i<1)throw new Ue("Height and width must be at least 1");var s=e+i,u=t+o;if(u>this.height||s>this.width)throw new Ue("The region must fit inside the matrix");for(var g=this.rowSize,B=this.bits,_=t;_<u;_++)for(var m=_*g,D=e;D<s;D++)B[m+Math.floor(D/32)]|=1<<(D&31)&4294967295},r.prototype.getRow=function(e,t){t==null||t.getSize()<this.width?t=new Ht(this.width):t.clear();for(var i=this.rowSize,o=this.bits,s=e*i,u=0;u<i;u++)t.setBulk(u*32,o[s+u]);return t},r.prototype.setRow=function(e,t){nt.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},r.prototype.rotate180=function(){for(var e=this.getWidth(),t=this.getHeight(),i=new Ht(e),o=new Ht(e),s=0,u=Math.floor((t+1)/2);s<u;s++)i=this.getRow(s,i),o=this.getRow(t-1-s,o),i.reverse(),o.reverse(),this.setRow(s,o),this.setRow(t-1-s,i)},r.prototype.getEnclosingRectangle=function(){for(var e=this.width,t=this.height,i=this.rowSize,o=this.bits,s=e,u=t,g=-1,B=-1,_=0;_<t;_++)for(var m=0;m<i;m++){var D=o[_*i+m];if(D!==0){if(_<u&&(u=_),_>B&&(B=_),m*32<s){for(var F=0;(D<<31-F&4294967295)===0;)F++;m*32+F<s&&(s=m*32+F)}if(m*32+31>g){for(var F=31;D>>>F===0;)F--;m*32+F>g&&(g=m*32+F)}}}return g<s||B<u?null:Int32Array.from([s,u,g-s+1,B-u+1])},r.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,t=this.bits,i=0;i<t.length&&t[i]===0;)i++;if(i===t.length)return null;for(var o=i/e,s=i%e*32,u=t[i],g=0;(u<<31-g&4294967295)===0;)g++;return s+=g,Int32Array.from([s,o])},r.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,t=this.bits,i=t.length-1;i>=0&&t[i]===0;)i--;if(i<0)return null;for(var o=Math.floor(i/e),s=Math.floor(i%e)*32,u=t[i],g=31;u>>>g===0;)g--;return s+=g,Int32Array.from([s,o])},r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.getRowSize=function(){return this.rowSize},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&vt.equals(this.bits,t.bits)},r.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+vt.hashCode(this.bits),e},r.prototype.toString=function(e,t,i){return e===void 0&&(e="X "),t===void 0&&(t="  "),i===void 0&&(i=`
`),this.buildToString(e,t,i)},r.prototype.buildToString=function(e,t,i){for(var o=new Ge,s=0,u=this.height;s<u;s++){for(var g=0,B=this.width;g<B;g++)o.append(this.get(g,s)?e:t);o.append(i)}return o.toString()},r.prototype.clone=function(){return new r(this.width,this.height,this.rowSize,this.bits.slice())},r}(),Hx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ve=function(r){Hx(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(Xt),Xx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Yx=function(r){Xx(e,r);function e(t){var i=r.call(this,t)||this;return i.luminances=e.EMPTY,i.buckets=new Int32Array(e.LUMINANCE_BUCKETS),i}return e.prototype.getBlackRow=function(t,i){var o=this.getLuminanceSource(),s=o.getWidth();i==null||i.getSize()<s?i=new Ht(s):i.clear(),this.initArrays(s);for(var u=o.getRow(t,this.luminances),g=this.buckets,B=0;B<s;B++)g[(u[B]&255)>>e.LUMINANCE_SHIFT]++;var _=e.estimateBlackPoint(g);if(s<3)for(var B=0;B<s;B++)(u[B]&255)<_&&i.set(B);else for(var m=u[0]&255,D=u[1]&255,B=1;B<s-1;B++){var F=u[B+1]&255;(D*4-m-F)/2<_&&i.set(B),m=D,D=F}return i},e.prototype.getBlackMatrix=function(){var t=this.getLuminanceSource(),i=t.getWidth(),o=t.getHeight(),s=new dr(i,o);this.initArrays(i);for(var u=this.buckets,g=1;g<5;g++)for(var B=Math.floor(o*g/5),_=t.getRow(B,this.luminances),m=Math.floor(i*4/5),D=Math.floor(i/5);D<m;D++){var F=_[D]&255;u[F>>e.LUMINANCE_SHIFT]++}for(var T=e.estimateBlackPoint(u),I=t.getMatrix(),g=0;g<o;g++)for(var k=g*i,D=0;D<i;D++){var F=I[k+D]&255;F<T&&s.set(D,g)}return s},e.prototype.createBinarizer=function(t){return new e(t)},e.prototype.initArrays=function(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));for(var i=this.buckets,o=0;o<e.LUMINANCE_BUCKETS;o++)i[o]=0},e.estimateBlackPoint=function(t){for(var i=t.length,o=0,s=0,u=0,g=0;g<i;g++)t[g]>u&&(s=g,u=t[g]),t[g]>o&&(o=t[g]);for(var B=0,_=0,g=0;g<i;g++){var m=g-s,D=t[g]*m*m;D>_&&(B=g,_=D)}if(s>B){var F=s;s=B,B=F}if(B-s<=i/16)throw new ve;for(var T=B-1,I=-1,g=B-1;g>s;g--){var k=g-s,D=k*k*(B-g)*(o-t[g]);D>I&&(T=g,I=D)}return T<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(kx),zx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),V0=function(r){zx(e,r);function e(t){var i=r.call(this,t)||this;return i.matrix=null,i}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var t=this.getLuminanceSource(),i=t.getWidth(),o=t.getHeight();if(i>=e.MINIMUM_DIMENSION&&o>=e.MINIMUM_DIMENSION){var s=t.getMatrix(),u=i>>e.BLOCK_SIZE_POWER;(i&e.BLOCK_SIZE_MASK)!==0&&u++;var g=o>>e.BLOCK_SIZE_POWER;(o&e.BLOCK_SIZE_MASK)!==0&&g++;var B=e.calculateBlackPoints(s,u,g,i,o),_=new dr(i,o);e.calculateThresholdForBlock(s,u,g,i,o,B,_),this.matrix=_}else this.matrix=r.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(t){return new e(t)},e.calculateThresholdForBlock=function(t,i,o,s,u,g,B){for(var _=u-e.BLOCK_SIZE,m=s-e.BLOCK_SIZE,D=0;D<o;D++){var F=D<<e.BLOCK_SIZE_POWER;F>_&&(F=_);for(var T=e.cap(D,2,o-3),I=0;I<i;I++){var k=I<<e.BLOCK_SIZE_POWER;k>m&&(k=m);for(var U=e.cap(I,2,i-3),K=0,X=-2;X<=2;X++){var te=g[T+X];K+=te[U-2]+te[U-1]+te[U]+te[U+1]+te[U+2]}var ne=K/25;e.thresholdBlock(t,k,F,ne,s,B)}}},e.cap=function(t,i,o){return t<i?i:t>o?o:t},e.thresholdBlock=function(t,i,o,s,u,g){for(var B=0,_=o*u+i;B<e.BLOCK_SIZE;B++,_+=u)for(var m=0;m<e.BLOCK_SIZE;m++)(t[_+m]&255)<=s&&g.set(i+m,o+B)},e.calculateBlackPoints=function(t,i,o,s,u){for(var g=u-e.BLOCK_SIZE,B=s-e.BLOCK_SIZE,_=new Array(o),m=0;m<o;m++){_[m]=new Int32Array(i);var D=m<<e.BLOCK_SIZE_POWER;D>g&&(D=g);for(var F=0;F<i;F++){var T=F<<e.BLOCK_SIZE_POWER;T>B&&(T=B);for(var I=0,k=255,U=0,K=0,X=D*s+T;K<e.BLOCK_SIZE;K++,X+=s){for(var te=0;te<e.BLOCK_SIZE;te++){var ne=t[X+te]&255;I+=ne,ne<k&&(k=ne),ne>U&&(U=ne)}if(U-k>e.MIN_DYNAMIC_RANGE)for(K++,X+=s;K<e.BLOCK_SIZE;K++,X+=s)for(var te=0;te<e.BLOCK_SIZE;te++)I+=t[X+te]&255}var re=I>>e.BLOCK_SIZE_POWER*2;if(U-k<=e.MIN_DYNAMIC_RANGE&&(re=k/2,m>0&&F>0)){var ue=(_[m-1][F]+2*_[m][F-1]+_[m-1][F-1])/4;k<ue&&(re=ue)}_[m][F]=re}}return _},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(Yx),Ki=function(){function r(e,t){this.width=e,this.height=t}return r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.isCropSupported=function(){return!1},r.prototype.crop=function(e,t,i,o){throw new bi("This luminance source does not support cropping.")},r.prototype.isRotateSupported=function(){return!1},r.prototype.rotateCounterClockwise=function(){throw new bi("This luminance source does not support rotation by 90 degrees.")},r.prototype.rotateCounterClockwise45=function(){throw new bi("This luminance source does not support rotation by 45 degrees.")},r.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),t=new Ge,i=0;i<this.height;i++){for(var o=this.getRow(i,e),s=0;s<this.width;s++){var u=o[s]&255,g=void 0;u<64?g="#":u<128?g="+":u<192?g=".":g=" ",t.append(g)}t.append(`
`)}return t.toString()},r}(),Kx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Nn=function(r){Kx(e,r);function e(t){var i=r.call(this,t.getWidth(),t.getHeight())||this;return i.delegate=t,i}return e.prototype.getRow=function(t,i){for(var o=this.delegate.getRow(t,i),s=this.getWidth(),u=0;u<s;u++)o[u]=255-(o[u]&255);return o},e.prototype.getMatrix=function(){for(var t=this.delegate.getMatrix(),i=this.getWidth()*this.getHeight(),o=new Uint8ClampedArray(i),s=0;s<i;s++)o[s]=255-(t[s]&255);return o},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(t,i,o,s){return new e(this.delegate.crop(t,i,o,s))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(Ki),Jx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),G0=function(r){Jx(e,r);function e(t){var i=r.call(this,t.width,t.height)||this;return i.canvas=t,i.tempCanvasElement=null,i.buffer=e.makeBufferFromCanvasImageData(t),i}return e.makeBufferFromCanvasImageData=function(t){var i=t.getContext("2d").getImageData(0,0,t.width,t.height);return e.toGrayscaleBuffer(i.data,t.width,t.height)},e.toGrayscaleBuffer=function(t,i,o){var s=new Uint8ClampedArray(i*o);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX)for(var u=0,g=0,B=t.length;u<B;u+=4,g++){var _=void 0,m=t[u+3];if(m===0)_=255;else{var D=t[u],F=t[u+1],T=t[u+2];_=306*D+601*F+117*T+512>>10}s[g]=_}else for(var u=0,g=0,I=t.length;u<I;u+=4,g++){var _=void 0,m=t[u+3];if(m===0)_=255;else{var D=t[u],F=t[u+1],T=t[u+2];_=306*D+601*F+117*T+512>>10}s[g]=255-_}return s},e.prototype.getRow=function(t,i){if(t<0||t>=this.getHeight())throw new Ue("Requested row is outside the image: "+t);var o=this.getWidth(),s=t*o;return i===null?i=this.buffer.slice(s,s+o):(i.length<o&&(i=new Uint8ClampedArray(o)),i.set(this.buffer.slice(s,s+o))),i},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,i,o,s){return r.prototype.crop.call(this,t,i,o,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement},e.prototype.rotate=function(t){var i=this.getTempCanvasElement(),o=i.getContext("2d"),s=t*e.DEGREE_TO_RADIANS,u=this.canvas.width,g=this.canvas.height,B=Math.ceil(Math.abs(Math.cos(s))*u+Math.abs(Math.sin(s))*g),_=Math.ceil(Math.abs(Math.sin(s))*u+Math.abs(Math.cos(s))*g);return i.width=B,i.height=_,o.translate(B/2,_/2),o.rotate(s),o.drawImage(this.canvas,u/-2,g/-2),this.buffer=e.makeBufferFromCanvasImageData(i),this},e.prototype.invert=function(){return new Nn(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(Ki),qx=function(){function r(e,t,i){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=i||void 0}return r.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},r}(),kt=globalThis&&globalThis.__awaiter||function(r,e,t,i){function o(s){return s instanceof t?s:new t(function(u){u(s)})}return new(t||(t=Promise))(function(s,u){function g(m){try{_(i.next(m))}catch(D){u(D)}}function B(m){try{_(i.throw(m))}catch(D){u(D)}}function _(m){m.done?s(m.value):o(m.value).then(g,B)}_((i=i.apply(r,e||[])).next())})},Nt=globalThis&&globalThis.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,o,s,u;return u={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function g(_){return function(m){return B([_,m])}}function B(_){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(s=_[0]&2?o.return:_[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,_[1])).done)return s;switch(o=0,s&&(_=[_[0]&2,s.value]),_[0]){case 0:case 1:s=_;break;case 4:return t.label++,{value:_[1],done:!1};case 5:t.label++,o=_[1],_=[0];continue;case 7:_=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(_[0]===6||_[0]===2)){t=0;continue}if(_[0]===3&&(!s||_[1]>s[0]&&_[1]<s[3])){t.label=_[1];break}if(_[0]===6&&t.label<s[1]){t.label=s[1],s=_;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(_);break}s[2]&&t.ops.pop(),t.trys.pop();continue}_=e.call(r,t)}catch(m){_=[6,m],o=0}finally{i=s=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},Zx=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Yr=function(){function r(e,t,i){t===void 0&&(t=500),this.reader=e,this.timeBetweenScansMillis=t,this._hints=i,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(r.prototype,"hasNavigator",{get:function(){return typeof navigator!="undefined"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),r.prototype.listVideoInputDevices=function(){return kt(this,void 0,void 0,function(){var e,t,i,o,s,u,g,B,_,m,D,F;return Nt(this,function(T){switch(T.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=T.sent(),t=[];try{for(i=Zx(e),o=i.next();!o.done;o=i.next())s=o.value,u=s.kind==="video"?"videoinput":s.kind,u==="videoinput"&&(g=s.deviceId||s.id,B=s.label||"Video device "+(t.length+1),_=s.groupId,m={deviceId:g,label:B,kind:u,groupId:_},t.push(m))}catch(I){D={error:I}}finally{try{o&&!o.done&&(F=i.return)&&F.call(i)}finally{if(D)throw D.error}}return[2,t]}})})},r.prototype.getVideoInputDevices=function(){return kt(this,void 0,void 0,function(){var e;return Nt(this,function(t){switch(t.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=t.sent(),[2,e.map(function(i){return new qx(i.deviceId,i.label)})]}})})},r.prototype.findDeviceById=function(e){return kt(this,void 0,void 0,function(){var t;return Nt(this,function(i){switch(i.label){case 0:return[4,this.listVideoInputDevices()];case 1:return t=i.sent(),t?[2,t.find(function(o){return o.deviceId===e})]:[2,null]}})})},r.prototype.decodeFromInputVideoDevice=function(e,t){return kt(this,void 0,void 0,function(){return Nt(this,function(i){switch(i.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,t)];case 1:return[2,i.sent()]}})})},r.prototype.decodeOnceFromVideoDevice=function(e,t){return kt(this,void 0,void 0,function(){var i,o;return Nt(this,function(s){switch(s.label){case 0:return this.reset(),e?i={deviceId:{exact:e}}:i={facingMode:"environment"},o={video:i},[4,this.decodeOnceFromConstraints(o,t)];case 1:return[2,s.sent()]}})})},r.prototype.decodeOnceFromConstraints=function(e,t){return kt(this,void 0,void 0,function(){var i;return Nt(this,function(o){switch(o.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return i=o.sent(),[4,this.decodeOnceFromStream(i,t)];case 2:return[2,o.sent()]}})})},r.prototype.decodeOnceFromStream=function(e,t){return kt(this,void 0,void 0,function(){var i,o;return Nt(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return i=s.sent(),[4,this.decodeOnce(i)];case 2:return o=s.sent(),[2,o]}})})},r.prototype.decodeFromInputVideoDeviceContinuously=function(e,t,i){return kt(this,void 0,void 0,function(){return Nt(this,function(o){switch(o.label){case 0:return[4,this.decodeFromVideoDevice(e,t,i)];case 1:return[2,o.sent()]}})})},r.prototype.decodeFromVideoDevice=function(e,t,i){return kt(this,void 0,void 0,function(){var o,s;return Nt(this,function(u){switch(u.label){case 0:return e?o={deviceId:{exact:e}}:o={facingMode:"environment"},s={video:o},[4,this.decodeFromConstraints(s,t,i)];case 1:return[2,u.sent()]}})})},r.prototype.decodeFromConstraints=function(e,t,i){return kt(this,void 0,void 0,function(){var o;return Nt(this,function(s){switch(s.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return o=s.sent(),[4,this.decodeFromStream(o,t,i)];case 2:return[2,s.sent()]}})})},r.prototype.decodeFromStream=function(e,t,i){return kt(this,void 0,void 0,function(){var o;return Nt(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return o=s.sent(),[4,this.decodeContinuously(o,i)];case 2:return[2,s.sent()]}})})},r.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},r.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},r.prototype.attachStreamToVideo=function(e,t){return kt(this,void 0,void 0,function(){var i;return Nt(this,function(o){switch(o.label){case 0:return i=this.prepareVideoElement(t),this.addVideoSource(i,e),this.videoElement=i,this.stream=e,[4,this.playVideoOnLoadAsync(i)];case 1:return o.sent(),[2,i]}})})},r.prototype.playVideoOnLoadAsync=function(e){var t=this;return new Promise(function(i,o){return t.playVideoOnLoad(e,function(){return i()})})},r.prototype.playVideoOnLoad=function(e,t){var i=this;this.videoEndedListener=function(){return i.stopStreams()},this.videoCanPlayListener=function(){return i.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)},r.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},r.prototype.tryPlayVideo=function(e){return kt(this,void 0,void 0,function(){return Nt(this,function(t){switch(t.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.play()];case 2:return t.sent(),[3,4];case 3:return t.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},r.prototype.getMediaElement=function(e,t){var i=document.getElementById(e);if(!i)throw new nr("element with id '"+e+"' not found");if(i.nodeName.toLowerCase()!==t.toLowerCase())throw new nr("element with id '"+e+"' must be an "+t+" element");return i},r.prototype.decodeFromImage=function(e,t){if(!e&&!t)throw new nr("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)},r.prototype.decodeFromVideo=function(e,t){if(!e&&!t)throw new nr("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)},r.prototype.decodeFromVideoContinuously=function(e,t,i){if(e===void 0&&t===void 0)throw new nr("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,i):this.decodeFromVideoElementContinuously(e,i)},r.prototype.decodeFromImageElement=function(e){if(!e)throw new nr("An image element must be provided.");this.reset();var t=this.prepareImageElement(e);this.imageElement=t;var i;return this.isImageLoaded(t)?i=this.decodeOnce(t,!1,!0):i=this._decodeOnLoadImage(t),i},r.prototype.decodeFromVideoElement=function(e){var t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)},r.prototype.decodeFromVideoElementContinuously=function(e,t){var i=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(i,t)},r.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new nr("A video element must be provided.");this.reset();var t=this.prepareVideoElement(e);return this.videoElement=t,t},r.prototype.decodeFromImageUrl=function(e){if(!e)throw new nr("An URL must be provided.");this.reset();var t=this.prepareImageElement();this.imageElement=t;var i=this._decodeOnLoadImage(t);return t.src=e,i},r.prototype.decodeFromVideoUrl=function(e){if(!e)throw new nr("An URL must be provided.");this.reset();var t=this.prepareVideoElement(),i=this.decodeFromVideoElement(t);return t.src=e,i},r.prototype.decodeFromVideoUrlContinuously=function(e,t){if(!e)throw new nr("An URL must be provided.");this.reset();var i=this.prepareVideoElement(),o=this.decodeFromVideoElementContinuously(i,t);return i.src=e,o},r.prototype._decodeOnLoadImage=function(e){var t=this;return new Promise(function(i,o){t.imageLoadedListener=function(){return t.decodeOnce(e,!1,!0).then(i,o)},e.addEventListener("load",t.imageLoadedListener)})},r.prototype._decodeOnLoadVideo=function(e){return kt(this,void 0,void 0,function(){return Nt(this,function(t){switch(t.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return t.sent(),[4,this.decodeOnce(e)];case 2:return[2,t.sent()]}})})},r.prototype._decodeOnLoadVideoContinuously=function(e,t){return kt(this,void 0,void 0,function(){return Nt(this,function(i){switch(i.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return i.sent(),this.decodeContinuously(e,t),[2]}})})},r.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},r.prototype.prepareImageElement=function(e){var t;return typeof e=="undefined"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t},r.prototype.prepareVideoElement=function(e){var t;return!e&&typeof document!="undefined"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t},r.prototype.decodeOnce=function(e,t,i){var o=this;t===void 0&&(t=!0),i===void 0&&(i=!0),this._stopAsyncDecode=!1;var s=function(u,g){if(o._stopAsyncDecode){g(new ve("Video stream has ended before any code could be detected.")),o._stopAsyncDecode=void 0;return}try{var B=o.decode(e);u(B)}catch(F){var _=t&&F instanceof ve,m=F instanceof Dt||F instanceof Ie,D=m&&i;if(_||D)return setTimeout(s,o._timeBetweenDecodingAttempts,u,g);g(F)}};return new Promise(function(u,g){return s(u,g)})},r.prototype.decodeContinuously=function(e,t){var i=this;this._stopContinuousDecode=!1;var o=function(){if(i._stopContinuousDecode){i._stopContinuousDecode=void 0;return}try{var s=i.decode(e);t(s,null),setTimeout(o,i.timeBetweenScansMillis)}catch(B){t(null,B);var u=B instanceof Dt||B instanceof Ie,g=B instanceof ve;(u||g)&&setTimeout(o,i._timeBetweenDecodingAttempts)}};o()},r.prototype.decode=function(e){var t=this.createBinaryBitmap(e);return this.decodeBitmap(t)},r.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e),e instanceof HTMLVideoElement?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);var t=this.getCaptureCanvas(e),i=new G0(t),o=new V0(i);return new U0(o)},r.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var t=this.getCaptureCanvas(e),i=void 0;try{i=t.getContext("2d",{willReadFrequently:!0})}catch{i=t.getContext("2d")}this.captureCanvasContext=i}return this.captureCanvasContext},r.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas},r.prototype.drawFrameOnCanvas=function(e,t,i){t===void 0&&(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),i===void 0&&(i=this.captureCanvasContext),i.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},r.prototype.drawImageOnCanvas=function(e,t,i){t===void 0&&(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),i===void 0&&(i=this.captureCanvasContext),i.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},r.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},r.prototype.createCaptureCanvas=function(e){if(typeof document=="undefined")return this._destroyCaptureCanvas(),null;var t=document.createElement("canvas"),i,o;return typeof e!="undefined"&&(e instanceof HTMLVideoElement?(i=e.videoWidth,o=e.videoHeight):e instanceof HTMLImageElement&&(i=e.naturalWidth||e.width,o=e.naturalHeight||e.height)),t.style.width=i+"px",t.style.height=o+"px",t.width=i,t.height=o,t},r.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},r.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},r.prototype._destroyVideoElement=function(){!this.videoElement||(typeof this.videoEndedListener!="undefined"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener!="undefined"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener!="undefined"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},r.prototype._destroyImageElement=function(){!this.imageElement||(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},r.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},r.prototype.addVideoSource=function(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}},r.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},r}(),Mt=function(){function r(e,t,i,o,s,u){i===void 0&&(i=t==null?0:8*t.length),u===void 0&&(u=nt.currentTimeMillis()),this.text=e,this.rawBytes=t,this.numBits=i,this.resultPoints=o,this.format=s,this.timestamp=u,this.text=e,this.rawBytes=t,i==null?this.numBits=t==null?0:8*t.length:this.numBits=i,this.resultPoints=o,this.format=s,this.resultMetadata=null,u==null?this.timestamp=nt.currentTimeMillis():this.timestamp=u}return r.prototype.getText=function(){return this.text},r.prototype.getRawBytes=function(){return this.rawBytes},r.prototype.getNumBits=function(){return this.numBits},r.prototype.getResultPoints=function(){return this.resultPoints},r.prototype.getBarcodeFormat=function(){return this.format},r.prototype.getResultMetadata=function(){return this.resultMetadata},r.prototype.putMetadata=function(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)},r.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},r.prototype.addResultPoints=function(e){var t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){var i=new Array(t.length+e.length);nt.arraycopy(t,0,i,0,t.length),nt.arraycopy(e,0,i,t.length,e.length),this.resultPoints=i}},r.prototype.getTimestamp=function(){return this.timestamp},r.prototype.toString=function(){return this.text},r}(),dn;(function(r){r[r.AZTEC=0]="AZTEC",r[r.CODABAR=1]="CODABAR",r[r.CODE_39=2]="CODE_39",r[r.CODE_93=3]="CODE_93",r[r.CODE_128=4]="CODE_128",r[r.DATA_MATRIX=5]="DATA_MATRIX",r[r.EAN_8=6]="EAN_8",r[r.EAN_13=7]="EAN_13",r[r.ITF=8]="ITF",r[r.MAXICODE=9]="MAXICODE",r[r.PDF_417=10]="PDF_417",r[r.QR_CODE=11]="QR_CODE",r[r.RSS_14=12]="RSS_14",r[r.RSS_EXPANDED=13]="RSS_EXPANDED",r[r.UPC_A=14]="UPC_A",r[r.UPC_E=15]="UPC_E",r[r.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(dn||(dn={}));var ke=dn,gn;(function(r){r[r.OTHER=0]="OTHER",r[r.ORIENTATION=1]="ORIENTATION",r[r.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",r[r.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",r[r.ISSUE_NUMBER=4]="ISSUE_NUMBER",r[r.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",r[r.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",r[r.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",r[r.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",r[r.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",r[r.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(gn||(gn={}));var Ot=gn,Ji=function(){function r(e,t,i,o,s,u){s===void 0&&(s=-1),u===void 0&&(u=-1),this.rawBytes=e,this.text=t,this.byteSegments=i,this.ecLevel=o,this.structuredAppendSequenceNumber=s,this.structuredAppendParity=u,this.numBits=e==null?0:8*e.length}return r.prototype.getRawBytes=function(){return this.rawBytes},r.prototype.getNumBits=function(){return this.numBits},r.prototype.setNumBits=function(e){this.numBits=e},r.prototype.getText=function(){return this.text},r.prototype.getByteSegments=function(){return this.byteSegments},r.prototype.getECLevel=function(){return this.ecLevel},r.prototype.getErrorsCorrected=function(){return this.errorsCorrected},r.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},r.prototype.getErasures=function(){return this.erasures},r.prototype.setErasures=function(e){this.erasures=e},r.prototype.getOther=function(){return this.other},r.prototype.setOther=function(e){this.other=e},r.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},r.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},r.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},r}(),ei=function(){function r(){}return r.prototype.exp=function(e){return this.expTable[e]},r.prototype.log=function(e){if(e===0)throw new Ue;return this.logTable[e]},r.addOrSubtract=function(e,t){return e^t},r}(),Cr=function(){function r(e,t){if(t.length===0)throw new Ue;this.field=e;var i=t.length;if(i>1&&t[0]===0){for(var o=1;o<i&&t[o]===0;)o++;o===i?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(i-o),nt.arraycopy(t,o,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return r.prototype.getCoefficients=function(){return this.coefficients},r.prototype.getDegree=function(){return this.coefficients.length-1},r.prototype.isZero=function(){return this.coefficients[0]===0},r.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},r.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var t=this.coefficients,i;if(e===1){i=0;for(var o=0,s=t.length;o!==s;o++){var u=t[o];i=ei.addOrSubtract(i,u)}return i}i=t[0];for(var g=t.length,B=this.field,o=1;o<g;o++)i=ei.addOrSubtract(B.multiply(e,i),t[o]);return i},r.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new Ue("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var t=this.coefficients,i=e.coefficients;if(t.length>i.length){var o=t;t=i,i=o}var s=new Int32Array(i.length),u=i.length-t.length;nt.arraycopy(i,0,s,0,u);for(var g=u;g<i.length;g++)s[g]=ei.addOrSubtract(t[g-u],i[g]);return new r(this.field,s)},r.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new Ue("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var t=this.coefficients,i=t.length,o=e.coefficients,s=o.length,u=new Int32Array(i+s-1),g=this.field,B=0;B<i;B++)for(var _=t[B],m=0;m<s;m++)u[B+m]=ei.addOrSubtract(u[B+m],g.multiply(_,o[m]));return new r(g,u)},r.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var t=this.coefficients.length,i=this.field,o=new Int32Array(t),s=this.coefficients,u=0;u<t;u++)o[u]=i.multiply(s[u],e);return new r(i,o)},r.prototype.multiplyByMonomial=function(e,t){if(e<0)throw new Ue;if(t===0)return this.field.getZero();for(var i=this.coefficients,o=i.length,s=new Int32Array(o+e),u=this.field,g=0;g<o;g++)s[g]=u.multiply(i[g],t);return new r(u,s)},r.prototype.divide=function(e){if(!this.field.equals(e.field))throw new Ue("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new Ue("Divide by 0");for(var t=this.field,i=t.getZero(),o=this,s=e.getCoefficient(e.getDegree()),u=t.inverse(s);o.getDegree()>=e.getDegree()&&!o.isZero();){var g=o.getDegree()-e.getDegree(),B=t.multiply(o.getCoefficient(o.getDegree()),u),_=e.multiplyByMonomial(g,B),m=t.buildMonomial(g,B);i=i.addOrSubtract(m),o=o.addOrSubtract(_)}return[i,o]},r.prototype.toString=function(){for(var e="",t=this.getDegree();t>=0;t--){var i=this.getCoefficient(t);if(i!==0){if(i<0?(e+=" - ",i=-i):e.length>0&&(e+=" + "),t===0||i!==1){var o=this.field.log(i);o===0?e+="1":o===1?e+="a":(e+="a^",e+=o)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e},r}(),Qx=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),W0=function(r){Qx(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(Xt),$x=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Er=function(r){$x(e,r);function e(t,i,o){var s=r.call(this)||this;s.primitive=t,s.size=i,s.generatorBase=o;for(var u=new Int32Array(i),g=1,B=0;B<i;B++)u[B]=g,g*=2,g>=i&&(g^=t,g&=i-1);s.expTable=u;for(var _=new Int32Array(i),B=0;B<i-1;B++)_[u[B]]=B;return s.logTable=_,s.zero=new Cr(s,Int32Array.from([0])),s.one=new Cr(s,Int32Array.from([1])),s}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(t,i){if(t<0)throw new Ue;if(i===0)return this.zero;var o=new Int32Array(t+1);return o[0]=i,new Cr(this,o)},e.prototype.inverse=function(t){if(t===0)throw new W0;return this.expTable[this.size-this.logTable[t]-1]},e.prototype.multiply=function(t,i){return t===0||i===0?0:this.expTable[(this.logTable[t]+this.logTable[i])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+ut.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(t){return t===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(ei),el=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),mi=function(r){el(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(Xt),tl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ei=function(r){tl(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(Xt),qi=function(){function r(e){this.field=e}return r.prototype.decode=function(e,t){for(var i=this.field,o=new Cr(i,e),s=new Int32Array(t),u=!0,g=0;g<t;g++){var B=o.evaluateAt(i.exp(g+i.getGeneratorBase()));s[s.length-1-g]=B,B!==0&&(u=!1)}if(!u)for(var _=new Cr(i,s),m=this.runEuclideanAlgorithm(i.buildMonomial(t,1),_,t),D=m[0],F=m[1],T=this.findErrorLocations(D),I=this.findErrorMagnitudes(F,T),g=0;g<T.length;g++){var k=e.length-1-i.log(T[g]);if(k<0)throw new mi("Bad error location");e[k]=Er.addOrSubtract(e[k],I[g])}},r.prototype.runEuclideanAlgorithm=function(e,t,i){if(e.getDegree()<t.getDegree()){var o=e;e=t,t=o}for(var s=this.field,u=e,g=t,B=s.getZero(),_=s.getOne();g.getDegree()>=(i/2|0);){var m=u,D=B;if(u=g,B=_,u.isZero())throw new mi("r_{i-1} was zero");g=m;for(var F=s.getZero(),T=u.getCoefficient(u.getDegree()),I=s.inverse(T);g.getDegree()>=u.getDegree()&&!g.isZero();){var k=g.getDegree()-u.getDegree(),U=s.multiply(g.getCoefficient(g.getDegree()),I);F=F.addOrSubtract(s.buildMonomial(k,U)),g=g.addOrSubtract(u.multiplyByMonomial(k,U))}if(_=F.multiply(B).addOrSubtract(D),g.getDegree()>=u.getDegree())throw new Ei("Division algorithm failed to reduce polynomial?")}var K=_.getCoefficient(0);if(K===0)throw new mi("sigmaTilde(0) was zero");var X=s.inverse(K),te=_.multiplyScalar(X),ne=g.multiplyScalar(X);return[te,ne]},r.prototype.findErrorLocations=function(e){var t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);for(var i=new Int32Array(t),o=0,s=this.field,u=1;u<s.getSize()&&o<t;u++)e.evaluateAt(u)===0&&(i[o]=s.inverse(u),o++);if(o!==t)throw new mi("Error locator degree does not match number of roots");return i},r.prototype.findErrorMagnitudes=function(e,t){for(var i=t.length,o=new Int32Array(i),s=this.field,u=0;u<i;u++){for(var g=s.inverse(t[u]),B=1,_=0;_<i;_++)if(u!==_){var m=s.multiply(t[_],g),D=(m&1)===0?m|1:m&-2;B=s.multiply(B,D)}o[u]=s.multiply(e.evaluateAt(g),s.inverse(B)),s.getGeneratorBase()!==0&&(o[u]=s.multiply(o[u],g))}return o},r}(),bt;(function(r){r[r.UPPER=0]="UPPER",r[r.LOWER=1]="LOWER",r[r.MIXED=2]="MIXED",r[r.DIGIT=3]="DIGIT",r[r.PUNCT=4]="PUNCT",r[r.BINARY=5]="BINARY"})(bt||(bt={}));var ko=function(){function r(){}return r.prototype.decode=function(e){this.ddata=e;var t=e.getBits(),i=this.extractBits(t),o=this.correctBits(i),s=r.convertBoolArrayToByteArray(o),u=r.getEncodedData(o),g=new Ji(s,u,null,null);return g.setNumBits(o.length),g},r.highLevelDecode=function(e){return this.getEncodedData(e)},r.getEncodedData=function(e){for(var t=e.length,i=bt.UPPER,o=bt.UPPER,s="",u=0;u<t;)if(o===bt.BINARY){if(t-u<5)break;var g=r.readCode(e,u,5);if(u+=5,g===0){if(t-u<11)break;g=r.readCode(e,u,11)+31,u+=11}for(var B=0;B<g;B++){if(t-u<8){u=t;break}var _=r.readCode(e,u,8);s+=it.castAsNonUtf8Char(_),u+=8}o=i}else{var m=o===bt.DIGIT?4:5;if(t-u<m)break;var _=r.readCode(e,u,m);u+=m;var D=r.getCharacter(o,_);D.startsWith("CTRL_")?(i=o,o=r.getTable(D.charAt(5)),D.charAt(6)==="L"&&(i=o)):(s+=D,o=i)}return s},r.getTable=function(e){switch(e){case"L":return bt.LOWER;case"P":return bt.PUNCT;case"M":return bt.MIXED;case"D":return bt.DIGIT;case"B":return bt.BINARY;case"U":default:return bt.UPPER}},r.getCharacter=function(e,t){switch(e){case bt.UPPER:return r.UPPER_TABLE[t];case bt.LOWER:return r.LOWER_TABLE[t];case bt.MIXED:return r.MIXED_TABLE[t];case bt.PUNCT:return r.PUNCT_TABLE[t];case bt.DIGIT:return r.DIGIT_TABLE[t];default:throw new Ei("Bad table")}},r.prototype.correctBits=function(e){var t,i;this.ddata.getNbLayers()<=2?(i=6,t=Er.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(i=8,t=Er.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(i=10,t=Er.AZTEC_DATA_10):(i=12,t=Er.AZTEC_DATA_12);var o=this.ddata.getNbDatablocks(),s=e.length/i;if(s<o)throw new Ie;for(var u=e.length%i,g=new Int32Array(s),B=0;B<s;B++,u+=i)g[B]=r.readCode(e,u,i);try{var _=new qi(t);_.decode(g,s-o)}catch(U){throw new Ie(U)}for(var m=(1<<i)-1,D=0,B=0;B<o;B++){var F=g[B];if(F===0||F===m)throw new Ie;(F===1||F===m-1)&&D++}for(var T=new Array(o*i-D),I=0,B=0;B<o;B++){var F=g[B];if(F===1||F===m-1)T.fill(F>1,I,I+i-1),I+=i-1;else for(var k=i-1;k>=0;--k)T[I++]=(F&1<<k)!==0}return T},r.prototype.extractBits=function(e){var t=this.ddata.isCompact(),i=this.ddata.getNbLayers(),o=(t?11:14)+i*4,s=new Int32Array(o),u=new Array(this.totalBitsInLayer(i,t));if(t)for(var g=0;g<s.length;g++)s[g]=g;else for(var B=o+1+2*ut.truncDivision(ut.truncDivision(o,2)-1,15),_=o/2,m=ut.truncDivision(B,2),g=0;g<_;g++){var D=g+ut.truncDivision(g,15);s[_-g-1]=m-D-1,s[_+g]=m+D+1}for(var g=0,F=0;g<i;g++){for(var T=(i-g)*4+(t?9:12),I=g*2,k=o-1-I,U=0;U<T;U++)for(var K=U*2,X=0;X<2;X++)u[F+K+X]=e.get(s[I+X],s[I+U]),u[F+2*T+K+X]=e.get(s[I+U],s[k-X]),u[F+4*T+K+X]=e.get(s[k-X],s[k-U]),u[F+6*T+K+X]=e.get(s[k-U],s[I+X]);F+=T*8}return u},r.readCode=function(e,t,i){for(var o=0,s=t;s<t+i;s++)o<<=1,e[s]&&(o|=1);return o},r.readByte=function(e,t){var i=e.length-t;return i>=8?r.readCode(e,t,8):r.readCode(e,t,i)<<8-i},r.convertBoolArrayToByteArray=function(e){for(var t=new Uint8Array((e.length+7)/8),i=0;i<t.length;i++)t[i]=r.readByte(e,8*i);return t},r.prototype.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},r.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],r.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],r.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],r.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],r.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],r}(),Ye=function(){function r(){}return r.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},r.distance=function(e,t,i,o){var s=e-i,u=t-o;return Math.sqrt(s*s+u*u)},r.sum=function(e){for(var t=0,i=0,o=e.length;i!==o;i++){var s=e[i];t+=s}return t},r}(),An=function(){function r(){}return r.floatToIntBits=function(e){return e},r.MAX_VALUE=Number.MAX_SAFE_INTEGER,r}(),Pe=function(){function r(e,t){this.x=e,this.y=t}return r.prototype.getX=function(){return this.x},r.prototype.getY=function(){return this.y},r.prototype.equals=function(e){if(e instanceof r){var t=e;return this.x===t.x&&this.y===t.y}return!1},r.prototype.hashCode=function(){return 31*An.floatToIntBits(this.x)+An.floatToIntBits(this.y)},r.prototype.toString=function(){return"("+this.x+","+this.y+")"},r.orderBestPatterns=function(e){var t=this.distance(e[0],e[1]),i=this.distance(e[1],e[2]),o=this.distance(e[0],e[2]),s,u,g;if(i>=t&&i>=o?(u=e[0],s=e[1],g=e[2]):o>=i&&o>=t?(u=e[1],s=e[0],g=e[2]):(u=e[2],s=e[0],g=e[1]),this.crossProductZ(s,u,g)<0){var B=s;s=g,g=B}e[0]=s,e[1]=u,e[2]=g},r.distance=function(e,t){return Ye.distance(e.x,e.y,t.x,t.y)},r.crossProductZ=function(e,t,i){var o=t.x,s=t.y;return(i.x-o)*(e.y-s)-(i.y-s)*(e.x-o)},r}(),jn=function(){function r(e,t){this.bits=e,this.points=t}return r.prototype.getBits=function(){return this.bits},r.prototype.getPoints=function(){return this.points},r}(),rl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),il=function(r){rl(e,r);function e(t,i,o,s,u){var g=r.call(this,t,i)||this;return g.compact=o,g.nbDatablocks=s,g.nbLayers=u,g}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(jn),pn=function(){function r(e,t,i,o){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=r.INIT_SIZE),i==null&&(i=e.getWidth()/2|0),o==null&&(o=e.getHeight()/2|0);var s=t/2|0;if(this.leftInit=i-s,this.rightInit=i+s,this.upInit=o-s,this.downInit=o+s,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ve}return r.prototype.detect=function(){for(var e=this.leftInit,t=this.rightInit,i=this.upInit,o=this.downInit,s=!1,u=!0,g=!1,B=!1,_=!1,m=!1,D=!1,F=this.width,T=this.height;u;){u=!1;for(var I=!0;(I||!B)&&t<F;)I=this.containsBlackPoint(i,o,t,!1),I?(t++,u=!0,B=!0):B||t++;if(t>=F){s=!0;break}for(var k=!0;(k||!_)&&o<T;)k=this.containsBlackPoint(e,t,o,!0),k?(o++,u=!0,_=!0):_||o++;if(o>=T){s=!0;break}for(var U=!0;(U||!m)&&e>=0;)U=this.containsBlackPoint(i,o,e,!1),U?(e--,u=!0,m=!0):m||e--;if(e<0){s=!0;break}for(var K=!0;(K||!D)&&i>=0;)K=this.containsBlackPoint(e,t,i,!0),K?(i--,u=!0,D=!0):D||i--;if(i<0){s=!0;break}u&&(g=!0)}if(!s&&g){for(var X=t-e,te=null,ne=1;te===null&&ne<X;ne++)te=this.getBlackPointOnSegment(e,o-ne,e+ne,o);if(te==null)throw new ve;for(var re=null,ne=1;re===null&&ne<X;ne++)re=this.getBlackPointOnSegment(e,i+ne,e+ne,i);if(re==null)throw new ve;for(var ue=null,ne=1;ue===null&&ne<X;ne++)ue=this.getBlackPointOnSegment(t,i+ne,t-ne,i);if(ue==null)throw new ve;for(var Ae=null,ne=1;Ae===null&&ne<X;ne++)Ae=this.getBlackPointOnSegment(t,o-ne,t-ne,o);if(Ae==null)throw new ve;return this.centerEdges(Ae,te,ue,re)}else throw new ve},r.prototype.getBlackPointOnSegment=function(e,t,i,o){for(var s=Ye.round(Ye.distance(e,t,i,o)),u=(i-e)/s,g=(o-t)/s,B=this.image,_=0;_<s;_++){var m=Ye.round(e+_*u),D=Ye.round(t+_*g);if(B.get(m,D))return new Pe(m,D)}return null},r.prototype.centerEdges=function(e,t,i,o){var s=e.getX(),u=e.getY(),g=t.getX(),B=t.getY(),_=i.getX(),m=i.getY(),D=o.getX(),F=o.getY(),T=r.CORR;return s<this.width/2?[new Pe(D-T,F+T),new Pe(g+T,B+T),new Pe(_-T,m-T),new Pe(s+T,u-T)]:[new Pe(D+T,F+T),new Pe(g+T,B-T),new Pe(_-T,m+T),new Pe(s-T,u-T)]},r.prototype.containsBlackPoint=function(e,t,i,o){var s=this.image;if(o){for(var u=e;u<=t;u++)if(s.get(u,i))return!0}else for(var g=e;g<=t;g++)if(s.get(i,g))return!0;return!1},r.INIT_SIZE=10,r.CORR=1,r}(),No=function(){function r(){}return r.checkAndNudgePoints=function(e,t){for(var i=e.getWidth(),o=e.getHeight(),s=!0,u=0;u<t.length&&s;u+=2){var g=Math.floor(t[u]),B=Math.floor(t[u+1]);if(g<-1||g>i||B<-1||B>o)throw new ve;s=!1,g===-1?(t[u]=0,s=!0):g===i&&(t[u]=i-1,s=!0),B===-1?(t[u+1]=0,s=!0):B===o&&(t[u+1]=o-1,s=!0)}s=!0;for(var u=t.length-2;u>=0&&s;u-=2){var g=Math.floor(t[u]),B=Math.floor(t[u+1]);if(g<-1||g>i||B<-1||B>o)throw new ve;s=!1,g===-1?(t[u]=0,s=!0):g===i&&(t[u]=i-1,s=!0),B===-1?(t[u+1]=0,s=!0):B===o&&(t[u+1]=o-1,s=!0)}},r}(),H0=function(){function r(e,t,i,o,s,u,g,B,_){this.a11=e,this.a21=t,this.a31=i,this.a12=o,this.a22=s,this.a32=u,this.a13=g,this.a23=B,this.a33=_}return r.quadrilateralToQuadrilateral=function(e,t,i,o,s,u,g,B,_,m,D,F,T,I,k,U){var K=r.quadrilateralToSquare(e,t,i,o,s,u,g,B),X=r.squareToQuadrilateral(_,m,D,F,T,I,k,U);return X.times(K)},r.prototype.transformPoints=function(e){for(var t=e.length,i=this.a11,o=this.a12,s=this.a13,u=this.a21,g=this.a22,B=this.a23,_=this.a31,m=this.a32,D=this.a33,F=0;F<t;F+=2){var T=e[F],I=e[F+1],k=s*T+B*I+D;e[F]=(i*T+u*I+_)/k,e[F+1]=(o*T+g*I+m)/k}},r.prototype.transformPointsWithValues=function(e,t){for(var i=this.a11,o=this.a12,s=this.a13,u=this.a21,g=this.a22,B=this.a23,_=this.a31,m=this.a32,D=this.a33,F=e.length,T=0;T<F;T++){var I=e[T],k=t[T],U=s*I+B*k+D;e[T]=(i*I+u*k+_)/U,t[T]=(o*I+g*k+m)/U}},r.squareToQuadrilateral=function(e,t,i,o,s,u,g,B){var _=e-i+s-g,m=t-o+u-B;if(_===0&&m===0)return new r(i-e,s-i,e,o-t,u-o,t,0,0,1);var D=i-s,F=g-s,T=o-u,I=B-u,k=D*I-F*T,U=(_*I-F*m)/k,K=(D*m-_*T)/k;return new r(i-e+U*i,g-e+K*g,e,o-t+U*o,B-t+K*B,t,U,K,1)},r.quadrilateralToSquare=function(e,t,i,o,s,u,g,B){return r.squareToQuadrilateral(e,t,i,o,s,u,g,B).buildAdjoint()},r.prototype.buildAdjoint=function(){return new r(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},r.prototype.times=function(e){return new r(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},r}(),nl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ol=function(r){nl(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.sampleGrid=function(t,i,o,s,u,g,B,_,m,D,F,T,I,k,U,K,X,te,ne){var re=H0.quadrilateralToQuadrilateral(s,u,g,B,_,m,D,F,T,I,k,U,K,X,te,ne);return this.sampleGridWithTransform(t,i,o,re)},e.prototype.sampleGridWithTransform=function(t,i,o,s){if(i<=0||o<=0)throw new ve;for(var u=new dr(i,o),g=new Float32Array(2*i),B=0;B<o;B++){for(var _=g.length,m=B+.5,D=0;D<_;D+=2)g[D]=D/2+.5,g[D+1]=m;s.transformPoints(g),No.checkAndNudgePoints(t,g);try{for(var D=0;D<_;D+=2)t.get(Math.floor(g[D]),Math.floor(g[D+1]))&&u.set(D/2,B)}catch{throw new ve}}return u},e}(No),Un=function(){function r(){}return r.setGridSampler=function(e){r.gridSampler=e},r.getInstance=function(){return r.gridSampler},r.gridSampler=new ol,r}(),Wt=function(){function r(e,t){this.x=e,this.y=t}return r.prototype.toResultPoint=function(){return new Pe(this.getX(),this.getY())},r.prototype.getX=function(){return this.x},r.prototype.getY=function(){return this.y},r}(),al=function(){function r(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return r.prototype.detect=function(){return this.detectMirror(!1)},r.prototype.detectMirror=function(e){var t=this.getMatrixCenter(),i=this.getBullsEyeCorners(t);if(e){var o=i[0];i[0]=i[2],i[2]=o}this.extractParameters(i);var s=this.sampleGrid(this.image,i[this.shift%4],i[(this.shift+1)%4],i[(this.shift+2)%4],i[(this.shift+3)%4]),u=this.getMatrixCornerPoints(i);return new il(s,u,this.compact,this.nbDataBlocks,this.nbLayers)},r.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new ve;var t=2*this.nbCenterLayers,i=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(i,t);for(var o=0,s=0;s<4;s++){var u=i[(this.shift+s)%4];this.compact?(o<<=7,o+=u>>1&127):(o<<=10,o+=(u>>2&31<<5)+(u>>1&31))}var g=this.getCorrectedParameterData(o,this.compact);this.compact?(this.nbLayers=(g>>6)+1,this.nbDataBlocks=(g&63)+1):(this.nbLayers=(g>>11)+1,this.nbDataBlocks=(g&2047)+1)},r.prototype.getRotation=function(e,t){var i=0;e.forEach(function(s,u,g){var B=(s>>t-2<<1)+(s&1);i=(i<<3)+B}),i=((i&1)<<11)+(i>>1);for(var o=0;o<4;o++)if(ut.bitCount(i^this.EXPECTED_CORNER_BITS[o])<=2)return o;throw new ve},r.prototype.getCorrectedParameterData=function(e,t){var i,o;t?(i=7,o=2):(i=10,o=4);for(var s=i-o,u=new Int32Array(i),g=i-1;g>=0;--g)u[g]=e&15,e>>=4;try{var B=new qi(Er.AZTEC_PARAM);B.decode(u,s)}catch{throw new ve}for(var _=0,g=0;g<o;g++)_=(_<<4)+u[g];return _},r.prototype.getBullsEyeCorners=function(e){var t=e,i=e,o=e,s=e,u=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var g=this.getFirstDifferent(t,u,1,-1),B=this.getFirstDifferent(i,u,1,1),_=this.getFirstDifferent(o,u,-1,1),m=this.getFirstDifferent(s,u,-1,-1);if(this.nbCenterLayers>2){var D=this.distancePoint(m,g)*this.nbCenterLayers/(this.distancePoint(s,t)*(this.nbCenterLayers+2));if(D<.75||D>1.25||!this.isWhiteOrBlackRectangle(g,B,_,m))break}t=g,i=B,o=_,s=m,u=!u}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ve;this.compact=this.nbCenterLayers===5;var F=new Pe(t.getX()+.5,t.getY()-.5),T=new Pe(i.getX()+.5,i.getY()+.5),I=new Pe(o.getX()-.5,o.getY()+.5),k=new Pe(s.getX()-.5,s.getY()-.5);return this.expandSquare([F,T,I,k],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},r.prototype.getMatrixCenter=function(){var e,t,i,o;try{var s=new pn(this.image).detect();e=s[0],t=s[1],i=s[2],o=s[3]}catch{var u=this.image.getWidth()/2,g=this.image.getHeight()/2;e=this.getFirstDifferent(new Wt(u+7,g-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Wt(u+7,g+7),!1,1,1).toResultPoint(),i=this.getFirstDifferent(new Wt(u-7,g+7),!1,-1,1).toResultPoint(),o=this.getFirstDifferent(new Wt(u-7,g-7),!1,-1,-1).toResultPoint()}var B=Ye.round((e.getX()+o.getX()+t.getX()+i.getX())/4),_=Ye.round((e.getY()+o.getY()+t.getY()+i.getY())/4);try{var s=new pn(this.image,15,B,_).detect();e=s[0],t=s[1],i=s[2],o=s[3]}catch{e=this.getFirstDifferent(new Wt(B+7,_-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Wt(B+7,_+7),!1,1,1).toResultPoint(),i=this.getFirstDifferent(new Wt(B-7,_+7),!1,-1,1).toResultPoint(),o=this.getFirstDifferent(new Wt(B-7,_-7),!1,-1,-1).toResultPoint()}return B=Ye.round((e.getX()+o.getX()+t.getX()+i.getX())/4),_=Ye.round((e.getY()+o.getY()+t.getY()+i.getY())/4),new Wt(B,_)},r.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},r.prototype.sampleGrid=function(e,t,i,o,s){var u=Un.getInstance(),g=this.getDimension(),B=g/2-this.nbCenterLayers,_=g/2+this.nbCenterLayers;return u.sampleGrid(e,g,g,B,B,_,B,_,_,B,_,t.getX(),t.getY(),i.getX(),i.getY(),o.getX(),o.getY(),s.getX(),s.getY())},r.prototype.sampleLine=function(e,t,i){for(var o=0,s=this.distanceResultPoint(e,t),u=s/i,g=e.getX(),B=e.getY(),_=u*(t.getX()-e.getX())/s,m=u*(t.getY()-e.getY())/s,D=0;D<i;D++)this.image.get(Ye.round(g+D*_),Ye.round(B+D*m))&&(o|=1<<i-D-1);return o},r.prototype.isWhiteOrBlackRectangle=function(e,t,i,o){var s=3;e=new Wt(e.getX()-s,e.getY()+s),t=new Wt(t.getX()-s,t.getY()-s),i=new Wt(i.getX()+s,i.getY()-s),o=new Wt(o.getX()+s,o.getY()+s);var u=this.getColor(o,e);if(u===0)return!1;var g=this.getColor(e,t);return g!==u||(g=this.getColor(t,i),g!==u)?!1:(g=this.getColor(i,o),g===u)},r.prototype.getColor=function(e,t){for(var i=this.distancePoint(e,t),o=(t.getX()-e.getX())/i,s=(t.getY()-e.getY())/i,u=0,g=e.getX(),B=e.getY(),_=this.image.get(e.getX(),e.getY()),m=Math.ceil(i),D=0;D<m;D++)g+=o,B+=s,this.image.get(Ye.round(g),Ye.round(B))!==_&&u++;var F=u/i;return F>.1&&F<.9?0:F<=.1===_?1:-1},r.prototype.getFirstDifferent=function(e,t,i,o){for(var s=e.getX()+i,u=e.getY()+o;this.isValid(s,u)&&this.image.get(s,u)===t;)s+=i,u+=o;for(s-=i,u-=o;this.isValid(s,u)&&this.image.get(s,u)===t;)s+=i;for(s-=i;this.isValid(s,u)&&this.image.get(s,u)===t;)u+=o;return u-=o,new Wt(s,u)},r.prototype.expandSquare=function(e,t,i){var o=i/(2*t),s=e[0].getX()-e[2].getX(),u=e[0].getY()-e[2].getY(),g=(e[0].getX()+e[2].getX())/2,B=(e[0].getY()+e[2].getY())/2,_=new Pe(g+o*s,B+o*u),m=new Pe(g-o*s,B-o*u);s=e[1].getX()-e[3].getX(),u=e[1].getY()-e[3].getY(),g=(e[1].getX()+e[3].getX())/2,B=(e[1].getY()+e[3].getY())/2;var D=new Pe(g+o*s,B+o*u),F=new Pe(g-o*s,B-o*u),T=[_,D,m,F];return T},r.prototype.isValid=function(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()},r.prototype.isValidPoint=function(e){var t=Ye.round(e.getX()),i=Ye.round(e.getY());return this.isValid(t,i)},r.prototype.distancePoint=function(e,t){return Ye.distance(e.getX(),e.getY(),t.getX(),t.getY())},r.prototype.distanceResultPoint=function(e,t){return Ye.distance(e.getX(),e.getY(),t.getX(),t.getY())},r.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(ut.truncDivision(this.nbLayers-4,8)+1)+15},r}(),Bn=function(){function r(){}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var i=null,o=new al(e.getBlackMatrix()),s=null,u=null;try{var g=o.detectMirror(!1);s=g.getPoints(),this.reportFoundResultPoints(t,s),u=new ko().decode(g)}catch(D){i=D}if(u==null)try{var g=o.detectMirror(!0);s=g.getPoints(),this.reportFoundResultPoints(t,s),u=new ko().decode(g)}catch(D){throw i!=null?i:D}var B=new Mt(u.getText(),u.getRawBytes(),u.getNumBits(),s,ke.AZTEC,nt.currentTimeMillis()),_=u.getByteSegments();_!=null&&B.putMetadata(Ot.BYTE_SEGMENTS,_);var m=u.getECLevel();return m!=null&&B.putMetadata(Ot.ERROR_CORRECTION_LEVEL,m),B},r.prototype.reportFoundResultPoints=function(e,t){if(e!=null){var i=e.get(xt.NEED_RESULT_POINT_CALLBACK);i!=null&&t.forEach(function(o,s,u){i.foundPossibleResultPoint(o)})}},r.prototype.reset=function(){},r}(),sl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(r){sl(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new Bn,t)||this}return e})(Yr);var _t=function(){function r(){}return r.prototype.decode=function(e,t){try{return this.doDecode(e,t)}catch{var i=t&&t.get(xt.TRY_HARDER)===!0;if(i&&e.isRotateSupported()){var o=e.rotateCounterClockwise(),s=this.doDecode(o,t),u=s.getResultMetadata(),g=270;u!==null&&u.get(Ot.ORIENTATION)===!0&&(g=g+u.get(Ot.ORIENTATION)%360),s.putMetadata(Ot.ORIENTATION,g);var B=s.getResultPoints();if(B!==null)for(var _=o.getHeight(),m=0;m<B.length;m++)B[m]=new Pe(_-B[m].getY()-1,B[m].getX());return s}else throw new ve}},r.prototype.reset=function(){},r.prototype.doDecode=function(e,t){var i=e.getWidth(),o=e.getHeight(),s=new Ht(i),u=t&&t.get(xt.TRY_HARDER)===!0,g=Math.max(1,o>>(u?8:5)),B;u?B=o:B=15;for(var _=Math.trunc(o/2),m=0;m<B;m++){var D=Math.trunc((m+1)/2),F=(m&1)===0,T=_+g*(F?D:-D);if(T<0||T>=o)break;try{s=e.getBlackRow(T,s)}catch{continue}for(var I=function(X){if(X===1&&(s.reverse(),t&&t.get(xt.NEED_RESULT_POINT_CALLBACK)===!0)){var te=new Map;t.forEach(function(ue,Ae){return te.set(Ae,ue)}),te.delete(xt.NEED_RESULT_POINT_CALLBACK),t=te}try{var ne=k.decodeRow(T,s,t);if(X===1){ne.putMetadata(Ot.ORIENTATION,180);var re=ne.getResultPoints();re!==null&&(re[0]=new Pe(i-re[0].getX()-1,re[0].getY()),re[1]=new Pe(i-re[1].getX()-1,re[1].getY()))}return{value:ne}}catch{}},k=this,U=0;U<2;U++){var K=I(U);if(typeof K=="object")return K.value}}throw new ve},r.recordPattern=function(e,t,i){for(var o=i.length,s=0;s<o;s++)i[s]=0;var u=e.getSize();if(t>=u)throw new ve;for(var g=!e.get(t),B=0,_=t;_<u;){if(e.get(_)!==g)i[B]++;else{if(++B===o)break;i[B]=1,g=!g}_++}if(!(B===o||B===o-1&&_===u))throw new ve},r.recordPatternInReverse=function(e,t,i){for(var o=i.length,s=e.get(t);t>0&&o>=0;)e.get(--t)!==s&&(o--,s=!s);if(o>=0)throw new ve;r.recordPattern(e,t+1,i)},r.patternMatchVariance=function(e,t,i){for(var o=e.length,s=0,u=0,g=0;g<o;g++)s+=e[g],u+=t[g];if(s<u)return Number.POSITIVE_INFINITY;var B=s/u;i*=B;for(var _=0,m=0;m<o;m++){var D=e[m],F=t[m]*B,T=D>F?D-F:F-D;if(T>i)return Number.POSITIVE_INFINITY;_+=T}return _/s},r}(),xl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jo=function(r){xl(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.findStartPattern=function(t){for(var i=t.getSize(),o=t.getNextSet(0),s=0,u=Int32Array.from([0,0,0,0,0,0]),g=o,B=!1,_=6,m=o;m<i;m++)if(t.get(m)!==B)u[s]++;else{if(s===_-1){for(var D=e.MAX_AVG_VARIANCE,F=-1,T=e.CODE_START_A;T<=e.CODE_START_C;T++){var I=_t.patternMatchVariance(u,e.CODE_PATTERNS[T],e.MAX_INDIVIDUAL_VARIANCE);I<D&&(D=I,F=T)}if(F>=0&&t.isRange(Math.max(0,g-(m-g)/2),g,!1))return Int32Array.from([g,m,F]);g+=u[0]+u[1],u=u.slice(2,u.length-1),u[s-1]=0,u[s]=0,s--}else s++;u[s]=1,B=!B}throw new ve},e.decodeCode=function(t,i,o){_t.recordPattern(t,o,i);for(var s=e.MAX_AVG_VARIANCE,u=-1,g=0;g<e.CODE_PATTERNS.length;g++){var B=e.CODE_PATTERNS[g],_=this.patternMatchVariance(i,B,e.MAX_INDIVIDUAL_VARIANCE);_<s&&(s=_,u=g)}if(u>=0)return u;throw new ve},e.prototype.decodeRow=function(t,i,o){var s=o&&o.get(xt.ASSUME_GS1)===!0,u=e.findStartPattern(i),g=u[2],B=0,_=new Uint8Array(20);_[B++]=g;var m;switch(g){case e.CODE_START_A:m=e.CODE_CODE_A;break;case e.CODE_START_B:m=e.CODE_CODE_B;break;case e.CODE_START_C:m=e.CODE_CODE_C;break;default:throw new Ie}for(var D=!1,F=!1,T="",I=u[0],k=u[1],U=Int32Array.from([0,0,0,0,0,0]),K=0,X=0,te=g,ne=0,re=!0,ue=!1,Ae=!1;!D;){var v=F;switch(F=!1,K=X,X=e.decodeCode(i,U,k),_[B++]=X,X!==e.CODE_STOP&&(re=!0),X!==e.CODE_STOP&&(ne++,te+=ne*X),I=k,k+=U.reduce(function(a,c){return a+c},0),X){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new Ie}switch(m){case e.CODE_CODE_A:if(X<64)Ae===ue?T+=String.fromCharCode(" ".charCodeAt(0)+X):T+=String.fromCharCode(" ".charCodeAt(0)+X+128),Ae=!1;else if(X<96)Ae===ue?T+=String.fromCharCode(X-64):T+=String.fromCharCode(X+64),Ae=!1;else switch(X!==e.CODE_STOP&&(re=!1),X){case e.CODE_FNC_1:s&&(T.length===0?T+="]C1":T+=String.fromCharCode(29));break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!ue&&Ae?(ue=!0,Ae=!1):ue&&Ae?(ue=!1,Ae=!1):Ae=!0;break;case e.CODE_SHIFT:F=!0,m=e.CODE_CODE_B;break;case e.CODE_CODE_B:m=e.CODE_CODE_B;break;case e.CODE_CODE_C:m=e.CODE_CODE_C;break;case e.CODE_STOP:D=!0;break}break;case e.CODE_CODE_B:if(X<96)Ae===ue?T+=String.fromCharCode(" ".charCodeAt(0)+X):T+=String.fromCharCode(" ".charCodeAt(0)+X+128),Ae=!1;else switch(X!==e.CODE_STOP&&(re=!1),X){case e.CODE_FNC_1:s&&(T.length===0?T+="]C1":T+=String.fromCharCode(29));break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!ue&&Ae?(ue=!0,Ae=!1):ue&&Ae?(ue=!1,Ae=!1):Ae=!0;break;case e.CODE_SHIFT:F=!0,m=e.CODE_CODE_A;break;case e.CODE_CODE_A:m=e.CODE_CODE_A;break;case e.CODE_CODE_C:m=e.CODE_CODE_C;break;case e.CODE_STOP:D=!0;break}break;case e.CODE_CODE_C:if(X<100)X<10&&(T+="0"),T+=X;else switch(X!==e.CODE_STOP&&(re=!1),X){case e.CODE_FNC_1:s&&(T.length===0?T+="]C1":T+=String.fromCharCode(29));break;case e.CODE_CODE_A:m=e.CODE_CODE_A;break;case e.CODE_CODE_B:m=e.CODE_CODE_B;break;case e.CODE_STOP:D=!0;break}break}v&&(m=m===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var ye=k-I;if(k=i.getNextUnset(k),!i.isRange(k,Math.min(i.getSize(),k+(k-I)/2),!1))throw new ve;if(te-=ne*K,te%103!==K)throw new Dt;var be=T.length;if(be===0)throw new ve;be>0&&re&&(m===e.CODE_CODE_C?T=T.substring(0,be-2):T=T.substring(0,be-1));for(var je=(u[1]+u[0])/2,h=I+ye/2,x=_.length,l=new Uint8Array(x),f=0;f<x;f++)l[f]=_[f];var n=[new Pe(je,t),new Pe(h,t)];return new Mt(T,l,0,n,ke.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(_t),ll=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),rn=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Uo=function(r){ll(e,r);function e(t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var o=r.call(this)||this;return o.usingCheckDigit=t,o.extendedMode=i,o.decodeRowResult="",o.counters=new Int32Array(9),o}return e.prototype.decodeRow=function(t,i,o){var s,u,g,B,_=this.counters;_.fill(0),this.decodeRowResult="";var m=e.findAsteriskPattern(i,_),D=i.getNextSet(m[1]),F=i.getSize(),T,I;do{e.recordPattern(i,D,_);var k=e.toNarrowWidePattern(_);if(k<0)throw new ve;T=e.patternToChar(k),this.decodeRowResult+=T,I=D;try{for(var U=(s=void 0,rn(_)),K=U.next();!K.done;K=U.next()){var X=K.value;D+=X}}catch(x){s={error:x}}finally{try{K&&!K.done&&(u=U.return)&&u.call(U)}finally{if(s)throw s.error}}D=i.getNextSet(D)}while(T!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var te=0;try{for(var ne=rn(_),re=ne.next();!re.done;re=ne.next()){var X=re.value;te+=X}}catch(x){g={error:x}}finally{try{re&&!re.done&&(B=ne.return)&&B.call(ne)}finally{if(g)throw g.error}}var ue=D-I-te;if(D!==F&&ue*2<te)throw new ve;if(this.usingCheckDigit){for(var Ae=this.decodeRowResult.length-1,v=0,ye=0;ye<Ae;ye++)v+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ye));if(this.decodeRowResult.charAt(Ae)!==e.ALPHABET_STRING.charAt(v%43))throw new Dt;this.decodeRowResult=this.decodeRowResult.substring(0,Ae)}if(this.decodeRowResult.length===0)throw new ve;var be;this.extendedMode?be=e.decodeExtended(this.decodeRowResult):be=this.decodeRowResult;var je=(m[1]+m[0])/2,h=I+te/2;return new Mt(be,null,0,[new Pe(je,t),new Pe(h,t)],ke.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(t,i){for(var o=t.getSize(),s=t.getNextSet(0),u=0,g=s,B=!1,_=i.length,m=s;m<o;m++)if(t.get(m)!==B)i[u]++;else{if(u===_-1){if(this.toNarrowWidePattern(i)===e.ASTERISK_ENCODING&&t.isRange(Math.max(0,g-Math.floor((m-g)/2)),g,!1))return[g,m];g+=i[0]+i[1],i.copyWithin(0,2,2+u-1),i[u-1]=0,i[u]=0,u--}else u++;i[u]=1,B=!B}throw new ve},e.toNarrowWidePattern=function(t){var i,o,s=t.length,u=0,g;do{var B=2147483647;try{for(var _=(i=void 0,rn(t)),m=_.next();!m.done;m=_.next()){var D=m.value;D<B&&D>u&&(B=D)}}catch(k){i={error:k}}finally{try{m&&!m.done&&(o=_.return)&&o.call(_)}finally{if(i)throw i.error}}u=B,g=0;for(var F=0,T=0,I=0;I<s;I++){var D=t[I];D>u&&(T|=1<<s-1-I,g++,F+=D)}if(g===3){for(var I=0;I<s&&g>0;I++){var D=t[I];if(D>u&&(g--,D*2>=F))return-1}return T}}while(g>3);return-1},e.patternToChar=function(t){for(var i=0;i<e.CHARACTER_ENCODINGS.length;i++)if(e.CHARACTER_ENCODINGS[i]===t)return e.ALPHABET_STRING.charAt(i);if(t===e.ASTERISK_ENCODING)return"*";throw new ve},e.decodeExtended=function(t){for(var i=t.length,o="",s=0;s<i;s++){var u=t.charAt(s);if(u==="+"||u==="$"||u==="%"||u==="/"){var g=t.charAt(s+1),B="\0";switch(u){case"+":if(g>="A"&&g<="Z")B=String.fromCharCode(g.charCodeAt(0)+32);else throw new Ie;break;case"$":if(g>="A"&&g<="Z")B=String.fromCharCode(g.charCodeAt(0)-64);else throw new Ie;break;case"%":if(g>="A"&&g<="E")B=String.fromCharCode(g.charCodeAt(0)-38);else if(g>="F"&&g<="J")B=String.fromCharCode(g.charCodeAt(0)-11);else if(g>="K"&&g<="O")B=String.fromCharCode(g.charCodeAt(0)+16);else if(g>="P"&&g<="T")B=String.fromCharCode(g.charCodeAt(0)+43);else if(g==="U")B="\0";else if(g==="V")B="@";else if(g==="W")B="`";else if(g==="X"||g==="Y"||g==="Z")B="\x7F";else throw new Ie;break;case"/":if(g>="A"&&g<="O")B=String.fromCharCode(g.charCodeAt(0)-32);else if(g==="Z")B=":";else throw new Ie;break}o+=B,s++}else o+=u}return o},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(_t),hl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),nn=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Vo=function(r){hl(e,r);function e(){var t=r.call(this)||this;return t.decodeRowResult="",t.counters=new Int32Array(6),t}return e.prototype.decodeRow=function(t,i,o){var s,u,g,B,_=this.findAsteriskPattern(i),m=i.getNextSet(_[1]),D=i.getSize(),F=this.counters;F.fill(0),this.decodeRowResult="";var T,I;do{e.recordPattern(i,m,F);var k=this.toPattern(F);if(k<0)throw new ve;T=this.patternToChar(k),this.decodeRowResult+=T,I=m;try{for(var U=(s=void 0,nn(F)),K=U.next();!K.done;K=U.next()){var X=K.value;m+=X}}catch(ye){s={error:ye}}finally{try{K&&!K.done&&(u=U.return)&&u.call(U)}finally{if(s)throw s.error}}m=i.getNextSet(m)}while(T!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var te=0;try{for(var ne=nn(F),re=ne.next();!re.done;re=ne.next()){var X=re.value;te+=X}}catch(ye){g={error:ye}}finally{try{re&&!re.done&&(B=ne.return)&&B.call(ne)}finally{if(g)throw g.error}}if(m===D||!i.get(m))throw new ve;if(this.decodeRowResult.length<2)throw new ve;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var ue=this.decodeExtended(this.decodeRowResult),Ae=(_[1]+_[0])/2,v=I+te/2;return new Mt(ue,null,0,[new Pe(Ae,t),new Pe(v,t)],ke.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(t){var i=t.getSize(),o=t.getNextSet(0);this.counters.fill(0);for(var s=this.counters,u=o,g=!1,B=s.length,_=0,m=o;m<i;m++)if(t.get(m)!==g)s[_]++;else{if(_===B-1){if(this.toPattern(s)===e.ASTERISK_ENCODING)return new Int32Array([u,m]);u+=s[0]+s[1],s.copyWithin(0,2,2+_-1),s[_-1]=0,s[_]=0,_--}else _++;s[_]=1,g=!g}throw new ve},e.prototype.toPattern=function(t){var i,o,s=0;try{for(var u=nn(t),g=u.next();!g.done;g=u.next()){var B=g.value;s+=B}}catch(I){i={error:I}}finally{try{g&&!g.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}for(var _=0,m=t.length,D=0;D<m;D++){var F=Math.round(t[D]*9/s);if(F<1||F>4)return-1;if((D&1)===0)for(var T=0;T<F;T++)_=_<<1|1;else _<<=F}return _},e.prototype.patternToChar=function(t){for(var i=0;i<e.CHARACTER_ENCODINGS.length;i++)if(e.CHARACTER_ENCODINGS[i]===t)return e.ALPHABET_STRING.charAt(i);throw new ve},e.prototype.decodeExtended=function(t){for(var i=t.length,o="",s=0;s<i;s++){var u=t.charAt(s);if(u>="a"&&u<="d"){if(s>=i-1)throw new Ie;var g=t.charAt(s+1),B="\0";switch(u){case"d":if(g>="A"&&g<="Z")B=String.fromCharCode(g.charCodeAt(0)+32);else throw new Ie;break;case"a":if(g>="A"&&g<="Z")B=String.fromCharCode(g.charCodeAt(0)-64);else throw new Ie;break;case"b":if(g>="A"&&g<="E")B=String.fromCharCode(g.charCodeAt(0)-38);else if(g>="F"&&g<="J")B=String.fromCharCode(g.charCodeAt(0)-11);else if(g>="K"&&g<="O")B=String.fromCharCode(g.charCodeAt(0)+16);else if(g>="P"&&g<="T")B=String.fromCharCode(g.charCodeAt(0)+43);else if(g==="U")B="\0";else if(g==="V")B="@";else if(g==="W")B="`";else if(g>="X"&&g<="Z")B=String.fromCharCode(127);else throw new Ie;break;case"c":if(g>="A"&&g<="O")B=String.fromCharCode(g.charCodeAt(0)-32);else if(g==="Z")B=":";else throw new Ie;break}o+=B,s++}else o+=u}return o},e.prototype.checkChecksums=function(t){var i=t.length;this.checkOneChecksum(t,i-2,20),this.checkOneChecksum(t,i-1,15)},e.prototype.checkOneChecksum=function(t,i,o){for(var s=1,u=0,g=i-1;g>=0;g--)u+=s*e.ALPHABET_STRING.indexOf(t.charAt(g)),++s>o&&(s=1);if(t.charAt(i)!==e.ALPHABET_STRING[u%47])throw new Dt},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(_t),cl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ul=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Go=function(r){cl(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.narrowLineWidth=-1,t}return e.prototype.decodeRow=function(t,i,o){var s,u,g=this.decodeStart(i),B=this.decodeEnd(i),_=new Ge;e.decodeMiddle(i,g[1],B[0],_);var m=_.toString(),D=null;o!=null&&(D=o.get(xt.ALLOWED_LENGTHS)),D==null&&(D=e.DEFAULT_ALLOWED_LENGTHS);var F=m.length,T=!1,I=0;try{for(var k=ul(D),U=k.next();!U.done;U=k.next()){var K=U.value;if(F===K){T=!0;break}K>I&&(I=K)}}catch(ne){s={error:ne}}finally{try{U&&!U.done&&(u=k.return)&&u.call(k)}finally{if(s)throw s.error}}if(!T&&F>I&&(T=!0),!T)throw new Ie;var X=[new Pe(g[1],t),new Pe(B[0],t)],te=new Mt(m,null,0,X,ke.ITF,new Date().getTime());return te},e.decodeMiddle=function(t,i,o,s){var u=new Int32Array(10),g=new Int32Array(5),B=new Int32Array(5);for(u.fill(0),g.fill(0),B.fill(0);i<o;){_t.recordPattern(t,i,u);for(var _=0;_<5;_++){var m=2*_;g[_]=u[m],B[_]=u[m+1]}var D=e.decodeDigit(g);s.append(D.toString()),D=this.decodeDigit(B),s.append(D.toString()),u.forEach(function(F){i+=F})}},e.prototype.decodeStart=function(t){var i=e.skipWhiteSpace(t),o=e.findGuardPattern(t,i,e.START_PATTERN);return this.narrowLineWidth=(o[1]-o[0])/4,this.validateQuietZone(t,o[0]),o},e.prototype.validateQuietZone=function(t,i){var o=this.narrowLineWidth*10;o=o<i?o:i;for(var s=i-1;o>0&&s>=0&&!t.get(s);s--)o--;if(o!==0)throw new ve},e.skipWhiteSpace=function(t){var i=t.getSize(),o=t.getNextSet(0);if(o===i)throw new ve;return o},e.prototype.decodeEnd=function(t){t.reverse();try{var i=e.skipWhiteSpace(t),o=void 0;try{o=e.findGuardPattern(t,i,e.END_PATTERN_REVERSED[0])}catch(u){u instanceof ve&&(o=e.findGuardPattern(t,i,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(t,o[0]);var s=o[0];return o[0]=t.getSize()-o[1],o[1]=t.getSize()-s,o}finally{t.reverse()}},e.findGuardPattern=function(t,i,o){var s=o.length,u=new Int32Array(s),g=t.getSize(),B=!1,_=0,m=i;u.fill(0);for(var D=i;D<g;D++)if(t.get(D)!==B)u[_]++;else{if(_===s-1){if(_t.patternMatchVariance(u,o,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[m,D];m+=u[0]+u[1],nt.arraycopy(u,2,u,0,_-1),u[_-1]=0,u[_]=0,_--}else _++;u[_]=1,B=!B}throw new ve},e.decodeDigit=function(t){for(var i=e.MAX_AVG_VARIANCE,o=-1,s=e.PATTERNS.length,u=0;u<s;u++){var g=e.PATTERNS[u],B=_t.patternMatchVariance(t,g,e.MAX_INDIVIDUAL_VARIANCE);B<i?(i=B,o=u):B===i&&(o=-1)}if(o>=0)return o%10;throw new ve},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(_t),fl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Hr=function(r){fl(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.decodeRowStringBuffer="",t}return e.findStartGuardPattern=function(t){for(var i=!1,o,s=0,u=Int32Array.from([0,0,0]);!i;){u=Int32Array.from([0,0,0]),o=e.findGuardPattern(t,s,!1,this.START_END_PATTERN,u);var g=o[0];s=o[1];var B=g-(s-g);B>=0&&(i=t.isRange(B,g,!1))}return o},e.checkChecksum=function(t){return e.checkStandardUPCEANChecksum(t)},e.checkStandardUPCEANChecksum=function(t){var i=t.length;if(i===0)return!1;var o=parseInt(t.charAt(i-1),10);return e.getStandardUPCEANChecksum(t.substring(0,i-1))===o},e.getStandardUPCEANChecksum=function(t){for(var i=t.length,o=0,s=i-1;s>=0;s-=2){var u=t.charAt(s).charCodeAt(0)-"0".charCodeAt(0);if(u<0||u>9)throw new Ie;o+=u}o*=3;for(var s=i-2;s>=0;s-=2){var u=t.charAt(s).charCodeAt(0)-"0".charCodeAt(0);if(u<0||u>9)throw new Ie;o+=u}return(1e3-o)%10},e.decodeEnd=function(t,i){return e.findGuardPattern(t,i,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(t,i,o,s){return this.findGuardPattern(t,i,o,s,new Int32Array(s.length))},e.findGuardPattern=function(t,i,o,s,u){var g=t.getSize();i=o?t.getNextUnset(i):t.getNextSet(i);for(var B=0,_=i,m=s.length,D=o,F=i;F<g;F++)if(t.get(F)!==D)u[B]++;else{if(B===m-1){if(_t.patternMatchVariance(u,s,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([_,F]);_+=u[0]+u[1];for(var T=u.slice(2,u.length),I=0;I<B-1;I++)u[I]=T[I];u[B-1]=0,u[B]=0,B--}else B++;u[B]=1,D=!D}throw new ve},e.decodeDigit=function(t,i,o,s){this.recordPattern(t,o,i);for(var u=this.MAX_AVG_VARIANCE,g=-1,B=s.length,_=0;_<B;_++){var m=s[_],D=_t.patternMatchVariance(i,m,e.MAX_INDIVIDUAL_VARIANCE);D<u&&(u=D,g=_)}if(g>=0)return g;throw new ve},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(_t),El=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dl=function(){function r(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return r.prototype.decodeRow=function(e,t,i){var o=this.decodeRowStringBuffer,s=this.decodeMiddle(t,i,o),u=o.toString(),g=r.parseExtensionString(u),B=[new Pe((i[0]+i[1])/2,e),new Pe(s,e)],_=new Mt(u,null,0,B,ke.UPC_EAN_EXTENSION,new Date().getTime());return g!=null&&_.putAllMetadata(g),_},r.prototype.decodeMiddle=function(e,t,i){var o,s,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var g=e.getSize(),B=t[1],_=0,m=0;m<5&&B<g;m++){var D=Hr.decodeDigit(e,u,B,Hr.L_AND_G_PATTERNS);i+=String.fromCharCode("0".charCodeAt(0)+D%10);try{for(var F=(o=void 0,El(u)),T=F.next();!T.done;T=F.next()){var I=T.value;B+=I}}catch(U){o={error:U}}finally{try{T&&!T.done&&(s=F.return)&&s.call(F)}finally{if(o)throw o.error}}D>=10&&(_|=1<<4-m),m!==4&&(B=e.getNextSet(B),B=e.getNextUnset(B))}if(i.length!==5)throw new ve;var k=this.determineCheckDigit(_);if(r.extensionChecksum(i.toString())!==k)throw new ve;return B},r.extensionChecksum=function(e){for(var t=e.length,i=0,o=t-2;o>=0;o-=2)i+=e.charAt(o).charCodeAt(0)-"0".charCodeAt(0);i*=3;for(var o=t-1;o>=0;o-=2)i+=e.charAt(o).charCodeAt(0)-"0".charCodeAt(0);return i*=3,i%10},r.prototype.determineCheckDigit=function(e){for(var t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new ve},r.parseExtensionString=function(e){if(e.length!==5)return null;var t=r.parseExtension5String(e);return t==null?null:new Map([[Ot.SUGGESTED_PRICE,t]])},r.parseExtension5String=function(e){var t;switch(e.charAt(0)){case"0":t="\xA3";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}var i=parseInt(e.substring(1)),o=(i/100).toString(),s=i%100,u=s<10?"0"+s:s.toString();return t+o+"."+u},r}(),gl=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Al=function(){function r(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return r.prototype.decodeRow=function(e,t,i){var o=this.decodeRowStringBuffer,s=this.decodeMiddle(t,i,o),u=o.toString(),g=r.parseExtensionString(u),B=[new Pe((i[0]+i[1])/2,e),new Pe(s,e)],_=new Mt(u,null,0,B,ke.UPC_EAN_EXTENSION,new Date().getTime());return g!=null&&_.putAllMetadata(g),_},r.prototype.decodeMiddle=function(e,t,i){var o,s,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var g=e.getSize(),B=t[1],_=0,m=0;m<2&&B<g;m++){var D=Hr.decodeDigit(e,u,B,Hr.L_AND_G_PATTERNS);i+=String.fromCharCode("0".charCodeAt(0)+D%10);try{for(var F=(o=void 0,gl(u)),T=F.next();!T.done;T=F.next()){var I=T.value;B+=I}}catch(k){o={error:k}}finally{try{T&&!T.done&&(s=F.return)&&s.call(F)}finally{if(o)throw o.error}}D>=10&&(_|=1<<1-m),m!==1&&(B=e.getNextSet(B),B=e.getNextUnset(B))}if(i.length!==2)throw new ve;if(parseInt(i.toString())%4!==_)throw new ve;return B},r.parseExtensionString=function(e){return e.length!==2?null:new Map([[Ot.ISSUE_NUMBER,parseInt(e)]])},r}(),pl=function(){function r(){}return r.decodeRow=function(e,t,i){var o=Hr.findGuardPattern(t,i,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var s=new dl;return s.decodeRow(e,t,o)}catch{var u=new Al;return u.decodeRow(e,t,o)}},r.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),r}(),Bl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pt=function(r){Bl(e,r);function e(){var t=r.call(this)||this;t.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(g){return Int32Array.from(g)});for(var i=10;i<20;i++){for(var o=e.L_PATTERNS[i-10],s=new Int32Array(o.length),u=0;u<o.length;u++)s[u]=o[o.length-u-1];e.L_AND_G_PATTERNS[i]=s}return t}return e.prototype.decodeRow=function(t,i,o){var s=e.findStartGuardPattern(i),u=o==null?null:o.get(xt.NEED_RESULT_POINT_CALLBACK);if(u!=null){var g=new Pe((s[0]+s[1])/2,t);u.foundPossibleResultPoint(g)}var B=this.decodeMiddle(i,s,this.decodeRowStringBuffer),_=B.rowOffset,m=B.resultString;if(u!=null){var D=new Pe(_,t);u.foundPossibleResultPoint(D)}var F=e.decodeEnd(i,_);if(u!=null){var T=new Pe((F[0]+F[1])/2,t);u.foundPossibleResultPoint(T)}var I=F[1],k=I+(I-F[0]);if(k>=i.getSize()||!i.isRange(I,k,!1))throw new ve;var U=m.toString();if(U.length<8)throw new Ie;if(!e.checkChecksum(U))throw new Dt;var K=(s[1]+s[0])/2,X=(F[1]+F[0])/2,te=this.getBarcodeFormat(),ne=[new Pe(K,t),new Pe(X,t)],re=new Mt(U,null,0,ne,te,new Date().getTime()),ue=0;try{var Ae=pl.decodeRow(t,i,F[1]);re.putMetadata(Ot.UPC_EAN_EXTENSION,Ae.getText()),re.putAllMetadata(Ae.getResultMetadata()),re.addResultPoints(Ae.getResultPoints()),ue=Ae.getText().length}catch{}var v=o==null?null:o.get(xt.ALLOWED_EAN_EXTENSIONS);if(v!=null){var ye=!1;for(var be in v)if(ue.toString()===be){ye=!0;break}if(!ye)throw new ve}return te===ke.EAN_13||ke.UPC_A,re},e.checkChecksum=function(t){return e.checkStandardUPCEANChecksum(t)},e.checkStandardUPCEANChecksum=function(t){var i=t.length;if(i===0)return!1;var o=parseInt(t.charAt(i-1),10);return e.getStandardUPCEANChecksum(t.substring(0,i-1))===o},e.getStandardUPCEANChecksum=function(t){for(var i=t.length,o=0,s=i-1;s>=0;s-=2){var u=t.charAt(s).charCodeAt(0)-"0".charCodeAt(0);if(u<0||u>9)throw new Ie;o+=u}o*=3;for(var s=i-2;s>=0;s-=2){var u=t.charAt(s).charCodeAt(0)-"0".charCodeAt(0);if(u<0||u>9)throw new Ie;o+=u}return(1e3-o)%10},e.decodeEnd=function(t,i){return e.findGuardPattern(t,i,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(Hr),vl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Wo=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vn=function(r){vl(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return e.prototype.decodeMiddle=function(t,i,o){var s,u,g,B,_=this.decodeMiddleCounters;_[0]=0,_[1]=0,_[2]=0,_[3]=0;for(var m=t.getSize(),D=i[1],F=0,T=0;T<6&&D<m;T++){var I=pt.decodeDigit(t,_,D,pt.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+I%10);try{for(var k=(s=void 0,Wo(_)),U=k.next();!U.done;U=k.next()){var K=U.value;D+=K}}catch(re){s={error:re}}finally{try{U&&!U.done&&(u=k.return)&&u.call(k)}finally{if(s)throw s.error}}I>=10&&(F|=1<<5-T)}o=e.determineFirstDigit(o,F);var X=pt.findGuardPattern(t,D,!0,pt.MIDDLE_PATTERN,new Int32Array(pt.MIDDLE_PATTERN.length).fill(0));D=X[1];for(var T=0;T<6&&D<m;T++){var I=pt.decodeDigit(t,_,D,pt.L_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+I);try{for(var te=(g=void 0,Wo(_)),ne=te.next();!ne.done;ne=te.next()){var K=ne.value;D+=K}}catch(Ae){g={error:Ae}}finally{try{ne&&!ne.done&&(B=te.return)&&B.call(te)}finally{if(g)throw g.error}}}return{rowOffset:D,resultString:o}},e.prototype.getBarcodeFormat=function(){return ke.EAN_13},e.determineFirstDigit=function(t,i){for(var o=0;o<10;o++)if(i===this.FIRST_DIGIT_ENCODINGS[o])return t=String.fromCharCode("0".charCodeAt(0)+o)+t,t;throw new ve},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(pt),_l=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ho=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Xo=function(r){_l(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return e.prototype.decodeMiddle=function(t,i,o){var s,u,g,B,_=this.decodeMiddleCounters;_[0]=0,_[1]=0,_[2]=0,_[3]=0;for(var m=t.getSize(),D=i[1],F=0;F<4&&D<m;F++){var T=pt.decodeDigit(t,_,D,pt.L_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+T);try{for(var I=(s=void 0,Ho(_)),k=I.next();!k.done;k=I.next()){var U=k.value;D+=U}}catch(ne){s={error:ne}}finally{try{k&&!k.done&&(u=I.return)&&u.call(I)}finally{if(s)throw s.error}}}var K=pt.findGuardPattern(t,D,!0,pt.MIDDLE_PATTERN,new Int32Array(pt.MIDDLE_PATTERN.length).fill(0));D=K[1];for(var F=0;F<4&&D<m;F++){var T=pt.decodeDigit(t,_,D,pt.L_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+T);try{for(var X=(g=void 0,Ho(_)),te=X.next();!te.done;te=X.next()){var U=te.value;D+=U}}catch(ue){g={error:ue}}finally{try{te&&!te.done&&(B=X.return)&&B.call(X)}finally{if(g)throw g.error}}}return{rowOffset:D,resultString:o}},e.prototype.getBarcodeFormat=function(){return ke.EAN_8},e}(pt),Cl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Yo=function(r){Cl(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.ean13Reader=new vn,t}return e.prototype.getBarcodeFormat=function(){return ke.UPC_A},e.prototype.decode=function(t,i){return this.maybeReturnResult(this.ean13Reader.decode(t))},e.prototype.decodeRow=function(t,i,o){return this.maybeReturnResult(this.ean13Reader.decodeRow(t,i,o))},e.prototype.decodeMiddle=function(t,i,o){return this.ean13Reader.decodeMiddle(t,i,o)},e.prototype.maybeReturnResult=function(t){var i=t.getText();if(i.charAt(0)==="0"){var o=new Mt(i.substring(1),null,null,t.getResultPoints(),ke.UPC_A);return t.getResultMetadata()!=null&&o.putAllMetadata(t.getResultMetadata()),o}else throw new ve},e.prototype.reset=function(){this.ean13Reader.reset()},e}(pt),ml=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),yl=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},zo=function(r){ml(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=new Int32Array(4),t}return e.prototype.decodeMiddle=function(t,i,o){var s,u,g=this.decodeMiddleCounters.map(function(U){return U});g[0]=0,g[1]=0,g[2]=0,g[3]=0;for(var B=t.getSize(),_=i[1],m=0,D=0;D<6&&_<B;D++){var F=e.decodeDigit(t,g,_,e.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+F%10);try{for(var T=(s=void 0,yl(g)),I=T.next();!I.done;I=T.next()){var k=I.value;_+=k}}catch(U){s={error:U}}finally{try{I&&!I.done&&(u=T.return)&&u.call(T)}finally{if(s)throw s.error}}F>=10&&(m|=1<<5-D)}return e.determineNumSysAndCheckDigit(new Ge(o),m),_},e.prototype.decodeEnd=function(t,i){return e.findGuardPatternWithoutCounters(t,i,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(t){return pt.checkChecksum(e.convertUPCEtoUPCA(t))},e.determineNumSysAndCheckDigit=function(t,i){for(var o=0;o<=1;o++)for(var s=0;s<10;s++)if(i===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[o][s]){t.insert(0,"0"+o),t.append("0"+s);return}throw ve.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return ke.UPC_E},e.convertUPCEtoUPCA=function(t){var i=t.slice(1,7).split("").map(function(u){return u.charCodeAt(0)}),o=new Ge;o.append(t.charAt(0));var s=i[5];switch(s){case 0:case 1:case 2:o.appendChars(i,0,2),o.append(s),o.append("0000"),o.appendChars(i,2,3);break;case 3:o.appendChars(i,0,3),o.append("00000"),o.appendChars(i,3,2);break;case 4:o.appendChars(i,0,4),o.append("00000"),o.append(i[4]);break;default:o.appendChars(i,0,5),o.append("0000"),o.append(s);break}return t.length>=8&&o.append(t.charAt(7)),o.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(pt),Dl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ko=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},on=function(r){Dl(e,r);function e(t){var i=r.call(this)||this,o=t==null?null:t.get(xt.POSSIBLE_FORMATS),s=[];return o!=null&&(o.indexOf(ke.EAN_13)>-1&&s.push(new vn),o.indexOf(ke.UPC_A)>-1&&s.push(new Yo),o.indexOf(ke.EAN_8)>-1&&s.push(new Xo),o.indexOf(ke.UPC_E)>-1&&s.push(new zo)),s.length===0&&(s.push(new vn),s.push(new Yo),s.push(new Xo),s.push(new zo)),i.readers=s,i}return e.prototype.decodeRow=function(t,i,o){var s,u;try{for(var g=Ko(this.readers),B=g.next();!B.done;B=g.next()){var _=B.value;try{var m=_.decodeRow(t,i,o),D=m.getBarcodeFormat()===ke.EAN_13&&m.getText().charAt(0)==="0",F=o==null?null:o.get(xt.POSSIBLE_FORMATS),T=F==null||F.includes(ke.UPC_A);if(D&&T){var I=m.getRawBytes(),k=new Mt(m.getText().substring(1),I,I?I.length:null,m.getResultPoints(),ke.UPC_A);return k.putAllMetadata(m.getResultMetadata()),k}return m}catch{}}}catch(U){s={error:U}}finally{try{B&&!B.done&&(u=g.return)&&u.call(g)}finally{if(s)throw s.error}}throw new ve},e.prototype.reset=function(){var t,i;try{for(var o=Ko(this.readers),s=o.next();!s.done;s=o.next()){var u=s.value;u.reset()}}catch(g){t={error:g}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}},e}(_t),wl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Fl=function(r){wl(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},t}return e.prototype.decodeRow=function(t,i,o){var s=this.getValidRowData(i);if(!s)throw new ve;var u=this.codaBarDecodeRow(s.row);if(!u)throw new ve;return new Mt(u,null,0,[new Pe(s.left,t),new Pe(s.right,t)],ke.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(t){var i=t.toArray(),o=i.indexOf(!0);if(o===-1)return null;var s=i.lastIndexOf(!0);if(s<=o)return null;i=i.slice(o,s+1);for(var u=[],g=i[0],B=1,_=1;_<i.length;_++)i[_]===g?B++:(g=i[_],u.push(B),B=1);return u.push(B),u.length<23&&(u.length+1)%8!==0?null:{row:u,left:o,right:s}},e.prototype.codaBarDecodeRow=function(t){for(var i=[],o=Math.ceil(t.reduce(function(B,_){return(B+_)/2},0));t.length>0;){var s=t.splice(0,8).splice(0,7),u=s.map(function(B){return B<o?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[u]===void 0)return null;i.push(this.CODA_BAR_CHAR_SET[u])}var g=i.join("");return this.validCodaBarString(g)?g:null},e.prototype.validCodaBarString=function(t){var i=/^[A-D].{1,}[A-D]$/;return i.test(t)},e}(_t),Sl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),bl=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Fr=function(r){Sl(e,r);function e(){var t=r.call(this)||this;return t.decodeFinderCounters=new Int32Array(4),t.dataCharacterCounters=new Int32Array(8),t.oddRoundingErrors=new Array(4),t.evenRoundingErrors=new Array(4),t.oddCounts=new Array(t.dataCharacterCounters.length/2),t.evenCounts=new Array(t.dataCharacterCounters.length/2),t}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(t,i){for(var o=0;o<i.length;o++)if(_t.patternMatchVariance(t,i[o],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return o;throw new ve},e.count=function(t){return Ye.sum(new Int32Array(t))},e.increment=function(t,i){for(var o=0,s=i[0],u=1;u<t.length;u++)i[u]>s&&(s=i[u],o=u);t[o]++},e.decrement=function(t,i){for(var o=0,s=i[0],u=1;u<t.length;u++)i[u]<s&&(s=i[u],o=u);t[o]--},e.isFinderPattern=function(t){var i,o,s=t[0]+t[1],u=s+t[2]+t[3],g=s/u;if(g>=e.MIN_FINDER_PATTERN_RATIO&&g<=e.MAX_FINDER_PATTERN_RATIO){var B=Number.MAX_SAFE_INTEGER,_=Number.MIN_SAFE_INTEGER;try{for(var m=bl(t),D=m.next();!D.done;D=m.next()){var F=D.value;F>_&&(_=F),F<B&&(B=F)}}catch(T){i={error:T}}finally{try{D&&!D.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}return _<10*B}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(_t),Ni=function(){function r(e,t){this.value=e,this.checksumPortion=t}return r.prototype.getValue=function(){return this.value},r.prototype.getChecksumPortion=function(){return this.checksumPortion},r.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion},r.prototype.hashCode=function(){return this.value^this.checksumPortion},r}(),X0=function(){function r(e,t,i,o,s){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new Pe(i,s)),this.resultPoints.push(new Pe(o,s))}return r.prototype.getValue=function(){return this.value},r.prototype.getStartEnd=function(){return this.startEnd},r.prototype.getResultPoints=function(){return this.resultPoints},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.prototype.hashCode=function(){return this.value},r}(),Tl=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Vr=function(){function r(){}return r.getRSSvalue=function(e,t,i){var o,s,u=0;try{for(var g=Tl(e),B=g.next();!B.done;B=g.next()){var _=B.value;u+=_}}catch(X){o={error:X}}finally{try{B&&!B.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}for(var m=0,D=0,F=e.length,T=0;T<F-1;T++){var I=void 0;for(I=1,D|=1<<T;I<e[T];I++,D&=~(1<<T)){var k=r.combins(u-I-1,F-T-2);if(i&&D===0&&u-I-(F-T-1)>=F-T-1&&(k-=r.combins(u-I-(F-T),F-T-2)),F-T-1>1){for(var U=0,K=u-I-(F-T-2);K>t;K--)U+=r.combins(u-I-K-1,F-T-3);k-=U*(F-1-T)}else u-I>t&&k--;m+=k}u-=I}return m},r.combins=function(e,t){var i,o;e-t>t?(o=t,i=e-t):(o=e-t,i=t);for(var s=1,u=1,g=e;g>i;g--)s*=g,u<=o&&(s/=u,u++);for(;u<=o;)s/=u,u++;return s},r}(),Ol=function(){function r(){}return r.buildBitArray=function(e){var t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);for(var i=12*t,o=new Ht(i),s=0,u=e[0],g=u.getRightChar().getValue(),B=11;B>=0;--B)(g&1<<B)!==0&&o.set(s),s++;for(var B=1;B<e.length;++B){for(var _=e[B],m=_.getLeftChar().getValue(),D=11;D>=0;--D)(m&1<<D)!==0&&o.set(s),s++;if(_.getRightChar()!==null)for(var F=_.getRightChar().getValue(),D=11;D>=0;--D)(F&1<<D)!==0&&o.set(s),s++}return o},r}(),Dr=function(){function r(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}return r.prototype.getDecodedInformation=function(){return this.decodedInformation},r.prototype.isFinished=function(){return this.finished},r}(),Vn=function(){function r(e){this.newPosition=e}return r.prototype.getNewPosition=function(){return this.newPosition},r}(),Il=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ir=function(r){Il(e,r);function e(t,i){var o=r.call(this,t)||this;return o.value=i,o}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(Vn),Rl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),wr=function(r){Rl(e,r);function e(t,i,o){var s=r.call(this,t)||this;return o?(s.remaining=!0,s.remainingValue=s.remainingValue):(s.remaining=!1,s.remainingValue=0),s.newString=i,s}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(Vn),Pl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ur=function(r){Pl(e,r);function e(t,i,o){var s=r.call(this,t)||this;if(i<0||i>10||o<0||o>10)throw new Ie;return s.firstDigit=i,s.secondDigit=o,s}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(Vn),yi=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ml=function(){function r(){}return r.parseFieldsInGeneralPurpose=function(e){var t,i,o,s,u,g,B,_;if(!e)return null;if(e.length<2)throw new ve;var m=e.substring(0,2);try{for(var D=yi(r.TWO_DIGIT_DATA_LENGTH),F=D.next();!F.done;F=D.next()){var T=F.value;if(T[0]===m)return T[1]===r.VARIABLE_LENGTH?r.processVariableAI(2,T[2],e):r.processFixedAI(2,T[1],e)}}catch(ue){t={error:ue}}finally{try{F&&!F.done&&(i=D.return)&&i.call(D)}finally{if(t)throw t.error}}if(e.length<3)throw new ve;var I=e.substring(0,3);try{for(var k=yi(r.THREE_DIGIT_DATA_LENGTH),U=k.next();!U.done;U=k.next()){var T=U.value;if(T[0]===I)return T[1]===r.VARIABLE_LENGTH?r.processVariableAI(3,T[2],e):r.processFixedAI(3,T[1],e)}}catch(ue){o={error:ue}}finally{try{U&&!U.done&&(s=k.return)&&s.call(k)}finally{if(o)throw o.error}}try{for(var K=yi(r.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),X=K.next();!X.done;X=K.next()){var T=X.value;if(T[0]===I)return T[1]===r.VARIABLE_LENGTH?r.processVariableAI(4,T[2],e):r.processFixedAI(4,T[1],e)}}catch(ue){u={error:ue}}finally{try{X&&!X.done&&(g=K.return)&&g.call(K)}finally{if(u)throw u.error}}if(e.length<4)throw new ve;var te=e.substring(0,4);try{for(var ne=yi(r.FOUR_DIGIT_DATA_LENGTH),re=ne.next();!re.done;re=ne.next()){var T=re.value;if(T[0]===te)return T[1]===r.VARIABLE_LENGTH?r.processVariableAI(4,T[2],e):r.processFixedAI(4,T[1],e)}}catch(ue){B={error:ue}}finally{try{re&&!re.done&&(_=ne.return)&&_.call(ne)}finally{if(B)throw B.error}}throw new ve},r.processFixedAI=function(e,t,i){if(i.length<e)throw new ve;var o=i.substring(0,e);if(i.length<e+t)throw new ve;var s=i.substring(e,e+t),u=i.substring(e+t),g="("+o+")"+s,B=r.parseFieldsInGeneralPurpose(u);return B==null?g:g+B},r.processVariableAI=function(e,t,i){var o=i.substring(0,e),s;i.length<e+t?s=i.length:s=e+t;var u=i.substring(e,s),g=i.substring(s),B="("+o+")"+u,_=r.parseFieldsInGeneralPurpose(g);return _==null?B:B+_},r.VARIABLE_LENGTH=[],r.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",r.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",r.VARIABLE_LENGTH,20],["22",r.VARIABLE_LENGTH,29],["30",r.VARIABLE_LENGTH,8],["37",r.VARIABLE_LENGTH,8],["90",r.VARIABLE_LENGTH,30],["91",r.VARIABLE_LENGTH,30],["92",r.VARIABLE_LENGTH,30],["93",r.VARIABLE_LENGTH,30],["94",r.VARIABLE_LENGTH,30],["95",r.VARIABLE_LENGTH,30],["96",r.VARIABLE_LENGTH,30],["97",r.VARIABLE_LENGTH,3],["98",r.VARIABLE_LENGTH,30],["99",r.VARIABLE_LENGTH,30]],r.THREE_DIGIT_DATA_LENGTH=[["240",r.VARIABLE_LENGTH,30],["241",r.VARIABLE_LENGTH,30],["242",r.VARIABLE_LENGTH,6],["250",r.VARIABLE_LENGTH,30],["251",r.VARIABLE_LENGTH,30],["253",r.VARIABLE_LENGTH,17],["254",r.VARIABLE_LENGTH,20],["400",r.VARIABLE_LENGTH,30],["401",r.VARIABLE_LENGTH,30],["402",17],["403",r.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",r.VARIABLE_LENGTH,20],["421",r.VARIABLE_LENGTH,15],["422",3],["423",r.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],r.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",r.VARIABLE_LENGTH,15],["391",r.VARIABLE_LENGTH,18],["392",r.VARIABLE_LENGTH,15],["393",r.VARIABLE_LENGTH,18],["703",r.VARIABLE_LENGTH,30]],r.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",r.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",r.VARIABLE_LENGTH,20],["8003",r.VARIABLE_LENGTH,30],["8004",r.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",r.VARIABLE_LENGTH,30],["8008",r.VARIABLE_LENGTH,12],["8018",18],["8020",r.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",r.VARIABLE_LENGTH,70],["8200",r.VARIABLE_LENGTH,70]],r}(),Ti=function(){function r(e){this.buffer=new Ge,this.information=e}return r.prototype.decodeAllCodes=function(e,t){var i=t,o=null;do{var s=this.decodeGeneralPurposeField(i,o),u=Ml.parseFieldsInGeneralPurpose(s.getNewString());if(u!=null&&e.append(u),s.isRemaining()?o=""+s.getRemainingValue():o=null,i===s.getNewPosition())break;i=s.getNewPosition()}while(!0);return e.toString()},r.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)},r.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var t=this.extractNumericValueFromBitArray(e,4);return t===0?new Ur(this.information.getSize(),Ur.FNC1,Ur.FNC1):new Ur(this.information.getSize(),t-1,Ur.FNC1)}var i=this.extractNumericValueFromBitArray(e,7),o=(i-8)/11,s=(i-8)%11;return new Ur(e+7,o,s)},r.prototype.extractNumericValueFromBitArray=function(e,t){return r.extractNumericValueFromBitArray(this.information,e,t)},r.extractNumericValueFromBitArray=function(e,t,i){for(var o=0,s=0;s<i;++s)e.get(t+s)&&(o|=1<<i-s-1);return o},r.prototype.decodeGeneralPurposeField=function(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);var i=this.parseBlocks();return i!=null&&i.isRemaining()?new wr(this.current.getPosition(),this.buffer.toString(),i.getRemainingValue()):new wr(this.current.getPosition(),this.buffer.toString())},r.prototype.parseBlocks=function(){var e,t;do{var i=this.current.getPosition();this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished());var o=i!==this.current.getPosition();if(!o&&!e)break}while(!e);return t.getDecodedInformation()},r.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var t=void 0;return e.isSecondDigitFNC1()?t=new wr(this.current.getPosition(),this.buffer.toString()):t=new wr(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Dr(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var t=new wr(this.current.getPosition(),this.buffer.toString());return new Dr(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Dr(!1)},r.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new wr(this.current.getPosition(),this.buffer.toString());return new Dr(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Dr(!1)},r.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new wr(this.current.getPosition(),this.buffer.toString());return new Dr(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Dr(!1)},r.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;var i=this.extractNumericValueFromBitArray(e,7);if(i>=64&&i<116)return!0;if(e+8>this.information.getSize())return!1;var o=this.extractNumericValueFromBitArray(e,8);return o>=232&&o<253},r.prototype.decodeIsoIec646=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new ir(e+5,ir.FNC1);if(t>=5&&t<15)return new ir(e+5,"0"+(t-5));var i=this.extractNumericValueFromBitArray(e,7);if(i>=64&&i<90)return new ir(e+7,""+(i+1));if(i>=90&&i<116)return new ir(e+7,""+(i+7));var o=this.extractNumericValueFromBitArray(e,8),s;switch(o){case 232:s="!";break;case 233:s='"';break;case 234:s="%";break;case 235:s="&";break;case 236:s="'";break;case 237:s="(";break;case 238:s=")";break;case 239:s="*";break;case 240:s="+";break;case 241:s=",";break;case 242:s="-";break;case 243:s=".";break;case 244:s="/";break;case 245:s=":";break;case 246:s=";";break;case 247:s="<";break;case 248:s="=";break;case 249:s=">";break;case 250:s="?";break;case 251:s="_";break;case 252:s=" ";break;default:throw new Ie}return new ir(e+8,s)},r.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;var i=this.extractNumericValueFromBitArray(e,6);return i>=16&&i<63},r.prototype.decodeAlphanumeric=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new ir(e+5,ir.FNC1);if(t>=5&&t<15)return new ir(e+5,"0"+(t-5));var i=this.extractNumericValueFromBitArray(e,6);if(i>=32&&i<58)return new ir(e+6,""+(i+33));var o;switch(i){case 58:o="*";break;case 59:o=",";break;case 60:o="-";break;case 61:o=".";break;case 62:o="/";break;default:throw new Ei("Decoding invalid alphanumeric value: "+i)}return new ir(e+6,o)},r.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0},r.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0},r.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0},r}(),Y0=function(){function r(e){this.information=e,this.generalDecoder=new Ti(e)}return r.prototype.getInformation=function(){return this.information},r.prototype.getGeneralDecoder=function(){return this.generalDecoder},r}(),Ll=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),or=function(r){Ll(e,r);function e(t){return r.call(this,t)||this}return e.prototype.encodeCompressedGtin=function(t,i){t.append("(01)");var o=t.length();t.append("9"),this.encodeCompressedGtinWithoutAI(t,i,o)},e.prototype.encodeCompressedGtinWithoutAI=function(t,i,o){for(var s=0;s<4;++s){var u=this.getGeneralDecoder().extractNumericValueFromBitArray(i+10*s,10);u/100===0&&t.append("0"),u/10===0&&t.append("0"),t.append(u)}e.appendCheckDigit(t,o)},e.appendCheckDigit=function(t,i){for(var o=0,s=0;s<13;s++){var u=t.charAt(s+i).charCodeAt(0)-"0".charCodeAt(0);o+=(s&1)===0?3*u:u}o=10-o%10,o===10&&(o=0),t.append(o)},e.GTIN_SIZE=40,e}(Y0),kl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Nl=function(r){kl(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){var t=new Ge;t.append("(01)");var i=t.length(),o=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return t.append(o),this.encodeCompressedGtinWithoutAI(t,e.HEADER_SIZE+4,i),this.getGeneralDecoder().decodeAllCodes(t,e.HEADER_SIZE+44)},e.HEADER_SIZE=1+1+2,e}(or),jl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ul=function(r){jl(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){var t=new Ge;return this.getGeneralDecoder().decodeAllCodes(t,e.HEADER_SIZE)},e.HEADER_SIZE=2+1+2,e}(Y0),Vl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Oi=function(r){Vl(e,r);function e(t){return r.call(this,t)||this}return e.prototype.encodeCompressedWeight=function(t,i,o){var s=this.getGeneralDecoder().extractNumericValueFromBitArray(i,o);this.addWeightCode(t,s);for(var u=this.checkWeight(s),g=1e5,B=0;B<5;++B)u/g===0&&t.append("0"),g/=10;t.append(u)},e}(or),Gl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),z0=function(r){Gl(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+Oi.GTIN_SIZE+e.WEIGHT_SIZE)throw new ve;var t=new Ge;return this.encodeCompressedGtin(t,e.HEADER_SIZE),this.encodeCompressedWeight(t,e.HEADER_SIZE+Oi.GTIN_SIZE,e.WEIGHT_SIZE),t.toString()},e.HEADER_SIZE=4+1,e.WEIGHT_SIZE=15,e}(Oi),Wl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Hl=function(r){Wl(e,r);function e(t){return r.call(this,t)||this}return e.prototype.addWeightCode=function(t,i){t.append("(3103)")},e.prototype.checkWeight=function(t){return t},e}(z0),Xl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Yl=function(r){Xl(e,r);function e(t){return r.call(this,t)||this}return e.prototype.addWeightCode=function(t,i){i<1e4?t.append("(3202)"):t.append("(3203)")},e.prototype.checkWeight=function(t){return t<1e4?t:t-1e4},e}(z0),zl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Kl=function(r){zl(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+or.GTIN_SIZE)throw new ve;var t=new Ge;this.encodeCompressedGtin(t,e.HEADER_SIZE);var i=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+or.GTIN_SIZE,e.LAST_DIGIT_SIZE);t.append("(392"),t.append(i),t.append(")");var o=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+or.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return t.append(o.getNewString()),t.toString()},e.HEADER_SIZE=5+1+2,e.LAST_DIGIT_SIZE=2,e}(or),Jl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ql=function(r){Jl(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+or.GTIN_SIZE)throw new ve;var t=new Ge;this.encodeCompressedGtin(t,e.HEADER_SIZE);var i=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+or.GTIN_SIZE,e.LAST_DIGIT_SIZE);t.append("(393"),t.append(i),t.append(")");var o=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+or.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);o/100===0&&t.append("0"),o/10===0&&t.append("0"),t.append(o);var s=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+or.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return t.append(s.getNewString()),t.toString()},e.HEADER_SIZE=5+1+2,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(or),Zl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ar=function(r){Zl(e,r);function e(t,i,o){var s=r.call(this,t)||this;return s.dateCode=o,s.firstAIdigits=i,s}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new ve;var t=new Ge;return this.encodeCompressedGtin(t,e.HEADER_SIZE),this.encodeCompressedWeight(t,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(t,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),t.toString()},e.prototype.encodeCompressedDate=function(t,i){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(i,e.DATE_SIZE);if(o!==38400){t.append("("),t.append(this.dateCode),t.append(")");var s=o%32;o/=32;var u=o%12+1;o/=12;var g=o;g/10===0&&t.append("0"),t.append(g),u/10===0&&t.append("0"),t.append(u),s/10===0&&t.append("0"),t.append(s)}},e.prototype.addWeightCode=function(t,i){t.append("("),t.append(this.firstAIdigits),t.append(i/1e5),t.append(")")},e.prototype.checkWeight=function(t){return t%1e5},e.HEADER_SIZE=7+1,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(Oi);function Ql(r){try{if(r.get(1))return new Nl(r);if(!r.get(2))return new Ul(r);var e=Ti.extractNumericValueFromBitArray(r,1,4);switch(e){case 4:return new Hl(r);case 5:return new Yl(r)}var t=Ti.extractNumericValueFromBitArray(r,1,5);switch(t){case 12:return new Kl(r);case 13:return new ql(r)}var i=Ti.extractNumericValueFromBitArray(r,1,7);switch(i){case 56:return new Ar(r,"310","11");case 57:return new Ar(r,"320","11");case 58:return new Ar(r,"310","13");case 59:return new Ar(r,"320","13");case 60:return new Ar(r,"310","15");case 61:return new Ar(r,"320","15");case 62:return new Ar(r,"310","17");case 63:return new Ar(r,"320","17")}}catch(o){throw console.log(o),new Ei("unknown decoder: "+r)}}var Jo=function(){function r(e,t,i,o){this.leftchar=e,this.rightchar=t,this.finderpattern=i,this.maybeLast=o}return r.prototype.mayBeLast=function(){return this.maybeLast},r.prototype.getLeftChar=function(){return this.leftchar},r.prototype.getRightChar=function(){return this.rightchar},r.prototype.getFinderPattern=function(){return this.finderpattern},r.prototype.mustBeLast=function(){return this.rightchar==null},r.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},r.equals=function(e,t){return e instanceof r?r.equalsOrNull(e.leftchar,t.leftchar)&&r.equalsOrNull(e.rightchar,t.rightchar)&&r.equalsOrNull(e.finderpattern,t.finderpattern):!1},r.equalsOrNull=function(e,t){return e===null?t===null:r.equals(e,t)},r.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},r}(),$l=function(){function r(e,t,i){this.pairs=e,this.rowNumber=t,this.wasReversed=i}return r.prototype.getPairs=function(){return this.pairs},r.prototype.getRowNumber=function(){return this.rowNumber},r.prototype.isReversed=function(){return this.wasReversed},r.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},r.prototype.toString=function(){return"{ "+this.pairs+" }"},r.prototype.equals=function(e,t){return e instanceof r?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1},r.prototype.checkEqualitity=function(e,t){if(!(!e||!t)){var i;return e.forEach(function(o,s){t.forEach(function(u){o.getLeftChar().getValue()===u.getLeftChar().getValue()&&o.getRightChar().getValue()===u.getRightChar().getValue()&&o.getFinderPatter().getValue()===u.getFinderPatter().getValue()&&(i=!0)})}),i}},r}(),eh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pr=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},th=function(r){eh(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.pairs=new Array(e.MAX_PAIRS),t.rows=new Array,t.startEnd=[2],t}return e.prototype.decodeRow=function(t,i,o){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(t,i))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(t,i))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(t,i){for(var o=!1;!o;)try{this.pairs.push(this.retrieveNextPair(i,this.pairs,t))}catch(g){if(g instanceof ve){if(!this.pairs.length)throw new ve;o=!0}}if(this.checkChecksum())return this.pairs;var s;if(this.rows.length?s=!0:s=!1,this.storeRow(t,!1),s){var u=this.checkRowsBoolean(!1);if(u!=null||(u=this.checkRowsBoolean(!0),u!=null))return u}throw new ve},e.prototype.checkRowsBoolean=function(t){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());var i=null;try{i=this.checkRows(new Array,0)}catch(o){console.log(o)}return t&&(this.rows=this.rows.reverse()),i},e.prototype.checkRows=function(t,i){for(var o,s,u=i;u<this.rows.length;u++){var g=this.rows[u];this.pairs.length=0;try{for(var B=(o=void 0,pr(t)),_=B.next();!_.done;_=B.next()){var m=_.value;this.pairs.push(m.getPairs())}}catch(F){o={error:F}}finally{try{_&&!_.done&&(s=B.return)&&s.call(B)}finally{if(o)throw o.error}}if(this.pairs.push(g.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var D=new Array(t);D.push(g);try{return this.checkRows(D,u+1)}catch(F){console.log(F)}}}throw new ve},e.isValidSequence=function(t){var i,o;try{for(var s=pr(e.FINDER_PATTERN_SEQUENCES),u=s.next();!u.done;u=s.next()){var g=u.value;if(!(t.length>g.length)){for(var B=!0,_=0;_<t.length;_++)if(t[_].getFinderPattern().getValue()!==g[_]){B=!1;break}if(B)return!0}}}catch(m){i={error:m}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}return!1},e.prototype.storeRow=function(t,i){for(var o=0,s=!1,u=!1;o<this.rows.length;){var g=this.rows[o];if(g.getRowNumber()>t){u=g.isEquivalent(this.pairs);break}s=g.isEquivalent(this.pairs),o++}u||s||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(o,new $l(this.pairs,t,i)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(t,i){var o,s,u,g,B,_;try{for(var m=pr(i),D=m.next();!D.done;D=m.next()){var F=D.value;if(F.getPairs().length!==t.length){var T=!0;try{for(var I=(u=void 0,pr(F.getPairs())),k=I.next();!k.done;k=I.next()){var U=k.value,K=!1;try{for(var X=(B=void 0,pr(t)),te=X.next();!te.done;te=X.next()){var ne=te.value;if(Jo.equals(U,ne)){K=!0;break}}}catch(re){B={error:re}}finally{try{te&&!te.done&&(_=X.return)&&_.call(X)}finally{if(B)throw B.error}}K||(T=!1)}}catch(re){u={error:re}}finally{try{k&&!k.done&&(g=I.return)&&g.call(I)}finally{if(u)throw u.error}}}}}catch(re){o={error:re}}finally{try{D&&!D.done&&(s=m.return)&&s.call(m)}finally{if(o)throw o.error}}},e.isPartialRow=function(t,i){var o,s,u,g,B,_;try{for(var m=pr(i),D=m.next();!D.done;D=m.next()){var F=D.value,T=!0;try{for(var I=(u=void 0,pr(t)),k=I.next();!k.done;k=I.next()){var U=k.value,K=!1;try{for(var X=(B=void 0,pr(F.getPairs())),te=X.next();!te.done;te=X.next()){var ne=te.value;if(U.equals(ne)){K=!0;break}}}catch(re){B={error:re}}finally{try{te&&!te.done&&(_=X.return)&&_.call(X)}finally{if(B)throw B.error}}if(!K){T=!1;break}}}catch(re){u={error:re}}finally{try{k&&!k.done&&(g=I.return)&&g.call(I)}finally{if(u)throw u.error}}if(T)return!0}}catch(re){o={error:re}}finally{try{D&&!D.done&&(s=m.return)&&s.call(m)}finally{if(o)throw o.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(t){var i=Ol.buildBitArray(t),o=Ql(i),s=o.parseInformation(),u=t[0].getFinderPattern().getResultPoints(),g=t[t.length-1].getFinderPattern().getResultPoints(),B=[u[0],u[1],g[0],g[1]];return new Mt(s,null,null,B,ke.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var t=this.pairs.get(0),i=t.getLeftChar(),o=t.getRightChar();if(o===null)return!1;for(var s=o.getChecksumPortion(),u=2,g=1;g<this.pairs.size();++g){var B=this.pairs.get(g);s+=B.getLeftChar().getChecksumPortion(),u++;var _=B.getRightChar();_!=null&&(s+=_.getChecksumPortion(),u++)}s%=211;var m=211*(u-4)+s;return m===i.getValue()},e.getNextSecondBar=function(t,i){var o;return t.get(i)?(o=t.getNextUnset(i),o=t.getNextSet(o)):(o=t.getNextSet(i),o=t.getNextUnset(o)),o},e.prototype.retrieveNextPair=function(t,i,o){var s=i.length%2===0;this.startFromEven&&(s=!s);var u,g=!0,B=-1;do this.findNextPair(t,i,B),u=this.parseFoundFinderPattern(t,o,s),u===null?B=e.getNextSecondBar(t,this.startEnd[0]):g=!1;while(g);var _=this.decodeDataCharacter(t,u,s,!0);if(!this.isEmptyPair(i)&&i[i.length-1].mustBeLast())throw new ve;var m;try{m=this.decodeDataCharacter(t,u,s,!1)}catch(D){m=null,console.log(D)}return new Jo(_,m,u,!0)},e.prototype.isEmptyPair=function(t){return t.length===0},e.prototype.findNextPair=function(t,i,o){var s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;var u=t.getSize(),g;if(o>=0)g=o;else if(this.isEmptyPair(i))g=0;else{var B=i[i.length-1];g=B.getFinderPattern().getStartEnd()[1]}var _=i.length%2!==0;this.startFromEven&&(_=!_);for(var m=!1;g<u&&(m=!t.get(g),!!m);)g++;for(var D=0,F=g,T=g;T<u;T++)if(t.get(T)!==m)s[D]++;else{if(D===3){if(_&&e.reverseCounters(s),e.isFinderPattern(s)){this.startEnd[0]=F,this.startEnd[1]=T;return}_&&e.reverseCounters(s),F+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,D--}else D++;s[D]=1,m=!m}throw new ve},e.reverseCounters=function(t){for(var i=t.length,o=0;o<i/2;++o){var s=t[o];t[o]=t[i-o-1],t[i-o-1]=s}},e.prototype.parseFoundFinderPattern=function(t,i,o){var s,u,g;if(o){for(var B=this.startEnd[0]-1;B>=0&&!t.get(B);)B--;B++,s=this.startEnd[0]-B,u=B,g=this.startEnd[1]}else u=this.startEnd[0],g=t.getNextUnset(this.startEnd[1]+1),s=g-this.startEnd[1];var _=this.getDecodeFinderCounters();nt.arraycopy(_,0,_,1,_.length-1),_[0]=s;var m;try{m=this.parseFinderValue(_,e.FINDER_PATTERNS)}catch{return null}return new X0(m,[u,g],u,g,i)},e.prototype.decodeDataCharacter=function(t,i,o,s){for(var u=this.getDataCharacterCounters(),g=0;g<u.length;g++)u[g]=0;if(s)e.recordPatternInReverse(t,i.getStartEnd()[0],u);else{e.recordPattern(t,i.getStartEnd()[1],u);for(var B=0,_=u.length-1;B<_;B++,_--){var m=u[B];u[B]=u[_],u[_]=m}}var D=17,F=Ye.sum(new Int32Array(u))/D,T=(i.getStartEnd()[1]-i.getStartEnd()[0])/15;if(Math.abs(F-T)/T>.3)throw new ve;for(var I=this.getOddCounts(),k=this.getEvenCounts(),U=this.getOddRoundingErrors(),K=this.getEvenRoundingErrors(),B=0;B<u.length;B++){var X=1*u[B]/F,te=X+.5;if(te<1){if(X<.3)throw new ve;te=1}else if(te>8){if(X>8.7)throw new ve;te=8}var ne=B/2;(B&1)===0?(I[ne]=te,U[ne]=X-te):(k[ne]=te,K[ne]=X-te)}this.adjustOddEvenCounts(D);for(var re=4*i.getValue()+(o?0:2)+(s?0:1)-1,ue=0,Ae=0,B=I.length-1;B>=0;B--){if(e.isNotA1left(i,o,s)){var v=e.WEIGHTS[re][2*B];Ae+=I[B]*v}ue+=I[B]}for(var ye=0,B=k.length-1;B>=0;B--)if(e.isNotA1left(i,o,s)){var v=e.WEIGHTS[re][2*B+1];ye+=k[B]*v}var be=Ae+ye;if((ue&1)!==0||ue>13||ue<4)throw new ve;var je=(13-ue)/2,h=e.SYMBOL_WIDEST[je],x=9-h,l=Vr.getRSSvalue(I,h,!0),f=Vr.getRSSvalue(k,x,!1),n=e.EVEN_TOTAL_SUBSET[je],a=e.GSUM[je],c=l*n+f+a;return new Ni(c,be)},e.isNotA1left=function(t,i,o){return!(t.getValue()===0&&i&&o)},e.prototype.adjustOddEvenCounts=function(t){var i=Ye.sum(new Int32Array(this.getOddCounts())),o=Ye.sum(new Int32Array(this.getEvenCounts())),s=!1,u=!1;i>13?u=!0:i<4&&(s=!0);var g=!1,B=!1;o>13?B=!0:o<4&&(g=!0);var _=i+o-t,m=(i&1)===1,D=(o&1)===0;if(_===1)if(m){if(D)throw new ve;u=!0}else{if(!D)throw new ve;B=!0}else if(_===-1)if(m){if(D)throw new ve;s=!0}else{if(!D)throw new ve;g=!0}else if(_===0){if(m){if(!D)throw new ve;i<o?(s=!0,B=!0):(u=!0,g=!0)}else if(D)throw new ve}else throw new ve;if(s){if(u)throw new ve;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(u&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),g){if(B)throw new ve;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}B&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(Fr),rh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ih=function(r){rh(e,r);function e(t,i,o){var s=r.call(this,t,i)||this;return s.count=0,s.finderPattern=o,s}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(Ni),nh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),an=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},qo=function(r){nh(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.possibleLeftPairs=[],t.possibleRightPairs=[],t}return e.prototype.decodeRow=function(t,i,o){var s,u,g,B,_=this.decodePair(i,!1,t,o);e.addOrTally(this.possibleLeftPairs,_),i.reverse();var m=this.decodePair(i,!0,t,o);e.addOrTally(this.possibleRightPairs,m),i.reverse();try{for(var D=an(this.possibleLeftPairs),F=D.next();!F.done;F=D.next()){var T=F.value;if(T.getCount()>1)try{for(var I=(g=void 0,an(this.possibleRightPairs)),k=I.next();!k.done;k=I.next()){var U=k.value;if(U.getCount()>1&&e.checkChecksum(T,U))return e.constructResult(T,U)}}catch(K){g={error:K}}finally{try{k&&!k.done&&(B=I.return)&&B.call(I)}finally{if(g)throw g.error}}}}catch(K){s={error:K}}finally{try{F&&!F.done&&(u=D.return)&&u.call(D)}finally{if(s)throw s.error}}throw new ve},e.addOrTally=function(t,i){var o,s;if(i!=null){var u=!1;try{for(var g=an(t),B=g.next();!B.done;B=g.next()){var _=B.value;if(_.getValue()===i.getValue()){_.incrementCount(),u=!0;break}}}catch(m){o={error:m}}finally{try{B&&!B.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}u||t.push(i)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(t,i){for(var o=4537077*t.getValue()+i.getValue(),s=new String(o).toString(),u=new Ge,g=13-s.length;g>0;g--)u.append("0");u.append(s);for(var B=0,g=0;g<13;g++){var _=u.charAt(g).charCodeAt(0)-"0".charCodeAt(0);B+=(g&1)===0?3*_:_}B=10-B%10,B===10&&(B=0),u.append(B.toString());var m=t.getFinderPattern().getResultPoints(),D=i.getFinderPattern().getResultPoints();return new Mt(u.toString(),null,0,[m[0],m[1],D[0],D[1]],ke.RSS_14,new Date().getTime())},e.checkChecksum=function(t,i){var o=(t.getChecksumPortion()+16*i.getChecksumPortion())%79,s=9*t.getFinderPattern().getValue()+i.getFinderPattern().getValue();return s>72&&s--,s>8&&s--,o===s},e.prototype.decodePair=function(t,i,o,s){try{var u=this.findFinderPattern(t,i),g=this.parseFoundFinderPattern(t,o,i,u),B=s==null?null:s.get(xt.NEED_RESULT_POINT_CALLBACK);if(B!=null){var _=(u[0]+u[1])/2;i&&(_=t.getSize()-1-_),B.foundPossibleResultPoint(new Pe(_,o))}var m=this.decodeDataCharacter(t,g,!0),D=this.decodeDataCharacter(t,g,!1);return new ih(1597*m.getValue()+D.getValue(),m.getChecksumPortion()+4*D.getChecksumPortion(),g)}catch{return null}},e.prototype.decodeDataCharacter=function(t,i,o){for(var s=this.getDataCharacterCounters(),u=0;u<s.length;u++)s[u]=0;if(o)_t.recordPatternInReverse(t,i.getStartEnd()[0],s);else{_t.recordPattern(t,i.getStartEnd()[1]+1,s);for(var g=0,B=s.length-1;g<B;g++,B--){var _=s[g];s[g]=s[B],s[B]=_}}for(var m=o?16:15,D=Ye.sum(new Int32Array(s))/m,F=this.getOddCounts(),T=this.getEvenCounts(),I=this.getOddRoundingErrors(),k=this.getEvenRoundingErrors(),g=0;g<s.length;g++){var U=s[g]/D,K=Math.floor(U+.5);K<1?K=1:K>8&&(K=8);var X=Math.floor(g/2);(g&1)===0?(F[X]=K,I[X]=U-K):(T[X]=K,k[X]=U-K)}this.adjustOddEvenCounts(o,m);for(var te=0,ne=0,g=F.length-1;g>=0;g--)ne*=9,ne+=F[g],te+=F[g];for(var re=0,ue=0,g=T.length-1;g>=0;g--)re*=9,re+=T[g],ue+=T[g];var Ae=ne+3*re;if(o){if((te&1)!==0||te>12||te<4)throw new ve;var v=(12-te)/2,ye=e.OUTSIDE_ODD_WIDEST[v],be=9-ye,je=Vr.getRSSvalue(F,ye,!1),h=Vr.getRSSvalue(T,be,!0),x=e.OUTSIDE_EVEN_TOTAL_SUBSET[v],l=e.OUTSIDE_GSUM[v];return new Ni(je*x+h+l,Ae)}else{if((ue&1)!==0||ue>10||ue<4)throw new ve;var v=(10-ue)/2,ye=e.INSIDE_ODD_WIDEST[v],be=9-ye,je=Vr.getRSSvalue(F,ye,!0),h=Vr.getRSSvalue(T,be,!1),f=e.INSIDE_ODD_TOTAL_SUBSET[v],l=e.INSIDE_GSUM[v];return new Ni(h*f+je+l,Ae)}},e.prototype.findFinderPattern=function(t,i){var o=this.getDecodeFinderCounters();o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var s=t.getSize(),u=!1,g=0;g<s&&(u=!t.get(g),i!==u);)g++;for(var B=0,_=g,m=g;m<s;m++)if(t.get(m)!==u)o[B]++;else{if(B===3){if(Fr.isFinderPattern(o))return[_,m];_+=o[0]+o[1],o[0]=o[2],o[1]=o[3],o[2]=0,o[3]=0,B--}else B++;o[B]=1,u=!u}throw new ve},e.prototype.parseFoundFinderPattern=function(t,i,o,s){for(var u=t.get(s[0]),g=s[0]-1;g>=0&&u!==t.get(g);)g--;g++;var B=s[0]-g,_=this.getDecodeFinderCounters(),m=new Int32Array(_.length);nt.arraycopy(_,0,m,1,_.length-1),m[0]=B;var D=this.parseFinderValue(m,e.FINDER_PATTERNS),F=g,T=s[1];return o&&(F=t.getSize()-1-F,T=t.getSize()-1-T),new X0(D,[g,s[1]],F,T,i)},e.prototype.adjustOddEvenCounts=function(t,i){var o=Ye.sum(new Int32Array(this.getOddCounts())),s=Ye.sum(new Int32Array(this.getEvenCounts())),u=!1,g=!1,B=!1,_=!1;t?(o>12?g=!0:o<4&&(u=!0),s>12?_=!0:s<4&&(B=!0)):(o>11?g=!0:o<5&&(u=!0),s>10?_=!0:s<4&&(B=!0));var m=o+s-i,D=(o&1)===(t?1:0),F=(s&1)===1;if(m===1)if(D){if(F)throw new ve;g=!0}else{if(!F)throw new ve;_=!0}else if(m===-1)if(D){if(F)throw new ve;u=!0}else{if(!F)throw new ve;B=!0}else if(m===0){if(D){if(!F)throw new ve;o<s?(u=!0,_=!0):(g=!0,B=!0)}else if(F)throw new ve}else throw new ve;if(u){if(g)throw new ve;Fr.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(g&&Fr.decrement(this.getOddCounts(),this.getOddRoundingErrors()),B){if(_)throw new ve;Fr.increment(this.getEvenCounts(),this.getOddRoundingErrors())}_&&Fr.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(Fr),oh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ti=function(r){oh(e,r);function e(t){var i=r.call(this)||this;i.readers=[];var o=t?t.get(xt.POSSIBLE_FORMATS):null,s=t&&t.get(xt.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;return o&&((o.includes(ke.EAN_13)||o.includes(ke.UPC_A)||o.includes(ke.EAN_8)||o.includes(ke.UPC_E))&&i.readers.push(new on(t)),o.includes(ke.CODE_39)&&i.readers.push(new Uo(s)),o.includes(ke.CODE_93)&&i.readers.push(new Vo),o.includes(ke.CODE_128)&&i.readers.push(new jo),o.includes(ke.ITF)&&i.readers.push(new Go),o.includes(ke.CODABAR)&&i.readers.push(new Fl),o.includes(ke.RSS_14)&&i.readers.push(new qo),o.includes(ke.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),i.readers.push(new th))),i.readers.length===0&&(i.readers.push(new on(t)),i.readers.push(new Uo),i.readers.push(new Vo),i.readers.push(new on(t)),i.readers.push(new jo),i.readers.push(new Go),i.readers.push(new qo)),i}return e.prototype.decodeRow=function(t,i,o){for(var s=0;s<this.readers.length;s++)try{return this.readers[s].decodeRow(t,i,o)}catch{}throw new ve},e.prototype.reset=function(){this.readers.forEach(function(t){return t.reset()})},e}(_t),ah=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(r){ah(e,r);function e(t,i){return t===void 0&&(t=500),r.call(this,new ti(i),t,i)||this}return e})(Yr);var Zo=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},qe=function(){function r(e,t,i){this.ecCodewords=e,this.ecBlocks=[t],i&&this.ecBlocks.push(i)}return r.prototype.getECCodewords=function(){return this.ecCodewords},r.prototype.getECBlocks=function(){return this.ecBlocks},r}(),ze=function(){function r(e,t){this.count=e,this.dataCodewords=t}return r.prototype.getCount=function(){return this.count},r.prototype.getDataCodewords=function(){return this.dataCodewords},r}(),sh=function(){function r(e,t,i,o,s,u){var g,B;this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=i,this.dataRegionSizeRows=o,this.dataRegionSizeColumns=s,this.ecBlocks=u;var _=0,m=u.getECCodewords(),D=u.getECBlocks();try{for(var F=Zo(D),T=F.next();!T.done;T=F.next()){var I=T.value;_+=I.getCount()*(I.getDataCodewords()+m)}}catch(k){g={error:k}}finally{try{T&&!T.done&&(B=F.return)&&B.call(F)}finally{if(g)throw g.error}}this.totalCodewords=_}return r.prototype.getVersionNumber=function(){return this.versionNumber},r.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},r.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},r.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},r.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},r.prototype.getTotalCodewords=function(){return this.totalCodewords},r.prototype.getECBlocks=function(){return this.ecBlocks},r.getVersionForDimensions=function(e,t){var i,o;if((e&1)!==0||(t&1)!==0)throw new Ie;try{for(var s=Zo(r.VERSIONS),u=s.next();!u.done;u=s.next()){var g=u.value;if(g.symbolSizeRows===e&&g.symbolSizeColumns===t)return g}}catch(B){i={error:B}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}throw new Ie},r.prototype.toString=function(){return""+this.versionNumber},r.buildVersions=function(){return[new r(1,10,10,8,8,new qe(5,new ze(1,3))),new r(2,12,12,10,10,new qe(7,new ze(1,5))),new r(3,14,14,12,12,new qe(10,new ze(1,8))),new r(4,16,16,14,14,new qe(12,new ze(1,12))),new r(5,18,18,16,16,new qe(14,new ze(1,18))),new r(6,20,20,18,18,new qe(18,new ze(1,22))),new r(7,22,22,20,20,new qe(20,new ze(1,30))),new r(8,24,24,22,22,new qe(24,new ze(1,36))),new r(9,26,26,24,24,new qe(28,new ze(1,44))),new r(10,32,32,14,14,new qe(36,new ze(1,62))),new r(11,36,36,16,16,new qe(42,new ze(1,86))),new r(12,40,40,18,18,new qe(48,new ze(1,114))),new r(13,44,44,20,20,new qe(56,new ze(1,144))),new r(14,48,48,22,22,new qe(68,new ze(1,174))),new r(15,52,52,24,24,new qe(42,new ze(2,102))),new r(16,64,64,14,14,new qe(56,new ze(2,140))),new r(17,72,72,16,16,new qe(36,new ze(4,92))),new r(18,80,80,18,18,new qe(48,new ze(4,114))),new r(19,88,88,20,20,new qe(56,new ze(4,144))),new r(20,96,96,22,22,new qe(68,new ze(4,174))),new r(21,104,104,24,24,new qe(56,new ze(6,136))),new r(22,120,120,18,18,new qe(68,new ze(6,175))),new r(23,132,132,20,20,new qe(62,new ze(8,163))),new r(24,144,144,22,22,new qe(62,new ze(8,156),new ze(2,155))),new r(25,8,18,6,16,new qe(7,new ze(1,5))),new r(26,8,32,6,14,new qe(11,new ze(1,10))),new r(27,12,26,10,24,new qe(14,new ze(1,16))),new r(28,12,36,10,16,new qe(18,new ze(1,22))),new r(29,16,36,14,16,new qe(24,new ze(1,32))),new r(30,16,48,14,22,new qe(28,new ze(1,49)))]},r.VERSIONS=r.buildVersions(),r}(),xh=function(){function r(e){var t=e.getHeight();if(t<8||t>144||(t&1)!==0)throw new Ie;this.version=r.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new dr(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return r.prototype.getVersion=function(){return this.version},r.readVersion=function(e){var t=e.getHeight(),i=e.getWidth();return sh.getVersionForDimensions(t,i)},r.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),t=0,i=4,o=0,s=this.mappingBitMatrix.getHeight(),u=this.mappingBitMatrix.getWidth(),g=!1,B=!1,_=!1,m=!1;do if(i===s&&o===0&&!g)e[t++]=this.readCorner1(s,u)&255,i-=2,o+=2,g=!0;else if(i===s-2&&o===0&&(u&3)!==0&&!B)e[t++]=this.readCorner2(s,u)&255,i-=2,o+=2,B=!0;else if(i===s+4&&o===2&&(u&7)===0&&!_)e[t++]=this.readCorner3(s,u)&255,i-=2,o+=2,_=!0;else if(i===s-2&&o===0&&(u&7)===4&&!m)e[t++]=this.readCorner4(s,u)&255,i-=2,o+=2,m=!0;else{do i<s&&o>=0&&!this.readMappingMatrix.get(o,i)&&(e[t++]=this.readUtah(i,o,s,u)&255),i-=2,o+=2;while(i>=0&&o<u);i+=1,o+=3;do i>=0&&o<u&&!this.readMappingMatrix.get(o,i)&&(e[t++]=this.readUtah(i,o,s,u)&255),i+=2,o-=2;while(i<s&&o>=0);i+=3,o+=1}while(i<s||o<u);if(t!==this.version.getTotalCodewords())throw new Ie;return e},r.prototype.readModule=function(e,t,i,o){return e<0&&(e+=i,t+=4-(i+4&7)),t<0&&(t+=o,e+=4-(o+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)},r.prototype.readUtah=function(e,t,i,o){var s=0;return this.readModule(e-2,t-2,i,o)&&(s|=1),s<<=1,this.readModule(e-2,t-1,i,o)&&(s|=1),s<<=1,this.readModule(e-1,t-2,i,o)&&(s|=1),s<<=1,this.readModule(e-1,t-1,i,o)&&(s|=1),s<<=1,this.readModule(e-1,t,i,o)&&(s|=1),s<<=1,this.readModule(e,t-2,i,o)&&(s|=1),s<<=1,this.readModule(e,t-1,i,o)&&(s|=1),s<<=1,this.readModule(e,t,i,o)&&(s|=1),s},r.prototype.readCorner1=function(e,t){var i=0;return this.readModule(e-1,0,e,t)&&(i|=1),i<<=1,this.readModule(e-1,1,e,t)&&(i|=1),i<<=1,this.readModule(e-1,2,e,t)&&(i|=1),i<<=1,this.readModule(0,t-2,e,t)&&(i|=1),i<<=1,this.readModule(0,t-1,e,t)&&(i|=1),i<<=1,this.readModule(1,t-1,e,t)&&(i|=1),i<<=1,this.readModule(2,t-1,e,t)&&(i|=1),i<<=1,this.readModule(3,t-1,e,t)&&(i|=1),i},r.prototype.readCorner2=function(e,t){var i=0;return this.readModule(e-3,0,e,t)&&(i|=1),i<<=1,this.readModule(e-2,0,e,t)&&(i|=1),i<<=1,this.readModule(e-1,0,e,t)&&(i|=1),i<<=1,this.readModule(0,t-4,e,t)&&(i|=1),i<<=1,this.readModule(0,t-3,e,t)&&(i|=1),i<<=1,this.readModule(0,t-2,e,t)&&(i|=1),i<<=1,this.readModule(0,t-1,e,t)&&(i|=1),i<<=1,this.readModule(1,t-1,e,t)&&(i|=1),i},r.prototype.readCorner3=function(e,t){var i=0;return this.readModule(e-1,0,e,t)&&(i|=1),i<<=1,this.readModule(e-1,t-1,e,t)&&(i|=1),i<<=1,this.readModule(0,t-3,e,t)&&(i|=1),i<<=1,this.readModule(0,t-2,e,t)&&(i|=1),i<<=1,this.readModule(0,t-1,e,t)&&(i|=1),i<<=1,this.readModule(1,t-3,e,t)&&(i|=1),i<<=1,this.readModule(1,t-2,e,t)&&(i|=1),i<<=1,this.readModule(1,t-1,e,t)&&(i|=1),i},r.prototype.readCorner4=function(e,t){var i=0;return this.readModule(e-3,0,e,t)&&(i|=1),i<<=1,this.readModule(e-2,0,e,t)&&(i|=1),i<<=1,this.readModule(e-1,0,e,t)&&(i|=1),i<<=1,this.readModule(0,t-2,e,t)&&(i|=1),i<<=1,this.readModule(0,t-1,e,t)&&(i|=1),i<<=1,this.readModule(1,t-1,e,t)&&(i|=1),i<<=1,this.readModule(2,t-1,e,t)&&(i|=1),i<<=1,this.readModule(3,t-1,e,t)&&(i|=1),i},r.prototype.extractDataRegion=function(e){var t=this.version.getSymbolSizeRows(),i=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new Ue("Dimension of bitMatrix must match the version size");for(var o=this.version.getDataRegionSizeRows(),s=this.version.getDataRegionSizeColumns(),u=t/o|0,g=i/s|0,B=u*o,_=g*s,m=new dr(_,B),D=0;D<u;++D)for(var F=D*o,T=0;T<g;++T)for(var I=T*s,k=0;k<o;++k)for(var U=D*(o+2)+1+k,K=F+k,X=0;X<s;++X){var te=T*(s+2)+1+X;if(e.get(te,U)){var ne=I+X;m.set(ne,K)}}return m},r}(),Qo=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},lh=function(){function r(e,t){this.numDataCodewords=e,this.codewords=t}return r.getDataBlocks=function(e,t){var i,o,s,u,g=t.getECBlocks(),B=0,_=g.getECBlocks();try{for(var m=Qo(_),D=m.next();!D.done;D=m.next()){var F=D.value;B+=F.getCount()}}catch(l){i={error:l}}finally{try{D&&!D.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}var T=new Array(B),I=0;try{for(var k=Qo(_),U=k.next();!U.done;U=k.next())for(var F=U.value,K=0;K<F.getCount();K++){var X=F.getDataCodewords(),te=g.getECCodewords()+X;T[I++]=new r(X,new Uint8Array(te))}}catch(l){s={error:l}}finally{try{U&&!U.done&&(u=k.return)&&u.call(k)}finally{if(s)throw s.error}}for(var ne=T[0].codewords.length,re=ne-g.getECCodewords(),ue=re-1,Ae=0,K=0;K<ue;K++)for(var v=0;v<I;v++)T[v].codewords[K]=e[Ae++];for(var ye=t.getVersionNumber()===24,be=ye?8:I,v=0;v<be;v++)T[v].codewords[re-1]=e[Ae++];for(var je=T[0].codewords.length,K=re;K<je;K++)for(var v=0;v<I;v++){var h=ye?(v+8)%I:v,x=ye&&h>7?K-1:K;T[h].codewords[x]=e[Ae++]}if(Ae!==e.length)throw new Ue;return T},r.prototype.getNumDataCodewords=function(){return this.numDataCodewords},r.prototype.getCodewords=function(){return this.codewords},r}(),K0=function(){function r(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return r.prototype.getBitOffset=function(){return this.bitOffset},r.prototype.getByteOffset=function(){return this.byteOffset},r.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new Ue(""+e);var t=0,i=this.bitOffset,o=this.byteOffset,s=this.bytes;if(i>0){var u=8-i,g=e<u?e:u,B=u-g,_=255>>8-g<<B;t=(s[o]&_)>>B,e-=g,i+=g,i===8&&(i=0,o++)}if(e>0){for(;e>=8;)t=t<<8|s[o]&255,o++,e-=8;if(e>0){var B=8-e,_=255>>B<<B;t=t<<e|(s[o]&_)>>B,i+=e}}return this.bitOffset=i,this.byteOffset=o,t},r.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},r}(),dt;(function(r){r[r.PAD_ENCODE=0]="PAD_ENCODE",r[r.ASCII_ENCODE=1]="ASCII_ENCODE",r[r.C40_ENCODE=2]="C40_ENCODE",r[r.TEXT_ENCODE=3]="TEXT_ENCODE",r[r.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",r[r.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",r[r.BASE256_ENCODE=6]="BASE256_ENCODE"})(dt||(dt={}));var hh=function(){function r(){}return r.decode=function(e){var t=new K0(e),i=new Ge,o=new Ge,s=new Array,u=dt.ASCII_ENCODE;do if(u===dt.ASCII_ENCODE)u=this.decodeAsciiSegment(t,i,o);else{switch(u){case dt.C40_ENCODE:this.decodeC40Segment(t,i);break;case dt.TEXT_ENCODE:this.decodeTextSegment(t,i);break;case dt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,i);break;case dt.EDIFACT_ENCODE:this.decodeEdifactSegment(t,i);break;case dt.BASE256_ENCODE:this.decodeBase256Segment(t,i,s);break;default:throw new Ie}u=dt.ASCII_ENCODE}while(u!==dt.PAD_ENCODE&&t.available()>0);return o.length()>0&&i.append(o.toString()),new Ji(e,i.toString(),s.length===0?null:s,null)},r.decodeAsciiSegment=function(e,t,i){var o=!1;do{var s=e.readBits(8);if(s===0)throw new Ie;if(s<=128)return o&&(s+=128),t.append(String.fromCharCode(s-1)),dt.ASCII_ENCODE;if(s===129)return dt.PAD_ENCODE;if(s<=229){var u=s-130;u<10&&t.append("0"),t.append(""+u)}else switch(s){case 230:return dt.C40_ENCODE;case 231:return dt.BASE256_ENCODE;case 232:t.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:o=!0;break;case 236:t.append("[)>05"),i.insert(0,"");break;case 237:t.append("[)>06"),i.insert(0,"");break;case 238:return dt.ANSIX12_ENCODE;case 239:return dt.TEXT_ENCODE;case 240:return dt.EDIFACT_ENCODE;case 241:break;default:if(s!==254||e.available()!==0)throw new Ie;break}}while(e.available()>0);return dt.ASCII_ENCODE},r.decodeC40Segment=function(e,t){var i=!1,o=[],s=0;do{if(e.available()===8)return;var u=e.readBits(8);if(u===254)return;this.parseTwoBytes(u,e.readBits(8),o);for(var g=0;g<3;g++){var B=o[g];switch(s){case 0:if(B<3)s=B+1;else if(B<this.C40_BASIC_SET_CHARS.length){var _=this.C40_BASIC_SET_CHARS[B];i?(t.append(String.fromCharCode(_.charCodeAt(0)+128)),i=!1):t.append(_)}else throw new Ie;break;case 1:i?(t.append(String.fromCharCode(B+128)),i=!1):t.append(String.fromCharCode(B)),s=0;break;case 2:if(B<this.C40_SHIFT2_SET_CHARS.length){var _=this.C40_SHIFT2_SET_CHARS[B];i?(t.append(String.fromCharCode(_.charCodeAt(0)+128)),i=!1):t.append(_)}else switch(B){case 27:t.append(String.fromCharCode(29));break;case 30:i=!0;break;default:throw new Ie}s=0;break;case 3:i?(t.append(String.fromCharCode(B+224)),i=!1):t.append(String.fromCharCode(B+96)),s=0;break;default:throw new Ie}}}while(e.available()>0)},r.decodeTextSegment=function(e,t){var i=!1,o=[],s=0;do{if(e.available()===8)return;var u=e.readBits(8);if(u===254)return;this.parseTwoBytes(u,e.readBits(8),o);for(var g=0;g<3;g++){var B=o[g];switch(s){case 0:if(B<3)s=B+1;else if(B<this.TEXT_BASIC_SET_CHARS.length){var _=this.TEXT_BASIC_SET_CHARS[B];i?(t.append(String.fromCharCode(_.charCodeAt(0)+128)),i=!1):t.append(_)}else throw new Ie;break;case 1:i?(t.append(String.fromCharCode(B+128)),i=!1):t.append(String.fromCharCode(B)),s=0;break;case 2:if(B<this.TEXT_SHIFT2_SET_CHARS.length){var _=this.TEXT_SHIFT2_SET_CHARS[B];i?(t.append(String.fromCharCode(_.charCodeAt(0)+128)),i=!1):t.append(_)}else switch(B){case 27:t.append(String.fromCharCode(29));break;case 30:i=!0;break;default:throw new Ie}s=0;break;case 3:if(B<this.TEXT_SHIFT3_SET_CHARS.length){var _=this.TEXT_SHIFT3_SET_CHARS[B];i?(t.append(String.fromCharCode(_.charCodeAt(0)+128)),i=!1):t.append(_),s=0}else throw new Ie;break;default:throw new Ie}}}while(e.available()>0)},r.decodeAnsiX12Segment=function(e,t){var i=[];do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),i);for(var s=0;s<3;s++){var u=i[s];switch(u){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(u<14)t.append(String.fromCharCode(u+44));else if(u<40)t.append(String.fromCharCode(u+51));else throw new Ie;break}}}while(e.available()>0)},r.parseTwoBytes=function(e,t,i){var o=(e<<8)+t-1,s=Math.floor(o/1600);i[0]=s,o-=s*1600,s=Math.floor(o/40),i[1]=s,i[2]=o-s*40},r.decodeEdifactSegment=function(e,t){do{if(e.available()<=16)return;for(var i=0;i<4;i++){var o=e.readBits(6);if(o===31){var s=8-e.getBitOffset();s!==8&&e.readBits(s);return}(o&32)===0&&(o|=64),t.append(String.fromCharCode(o))}}while(e.available()>0)},r.decodeBase256Segment=function(e,t,i){var o=1+e.getByteOffset(),s=this.unrandomize255State(e.readBits(8),o++),u;if(s===0?u=e.available()/8|0:s<250?u=s:u=250*(s-249)+this.unrandomize255State(e.readBits(8),o++),u<0)throw new Ie;for(var g=new Uint8Array(u),B=0;B<u;B++){if(e.available()<8)throw new Ie;g[B]=this.unrandomize255State(e.readBits(8),o++)}i.push(g);try{t.append(tr.decode(g,it.ISO88591))}catch(_){throw new Ei("Platform does not support required encoding: "+_.message)}},r.unrandomize255State=function(e,t){var i=149*t%255+1,o=e-i;return o>=0?o:o+256},r.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],r.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],r.TEXT_SHIFT2_SET_CHARS=r.C40_SHIFT2_SET_CHARS,r.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)],r}(),ch=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},uh=function(){function r(){this.rsDecoder=new qi(Er.DATA_MATRIX_FIELD_256)}return r.prototype.decode=function(e){var t,i,o=new xh(e),s=o.getVersion(),u=o.readCodewords(),g=lh.getDataBlocks(u,s),B=0;try{for(var _=ch(g),m=_.next();!m.done;m=_.next()){var D=m.value;B+=D.getNumDataCodewords()}}catch(te){t={error:te}}finally{try{m&&!m.done&&(i=_.return)&&i.call(_)}finally{if(t)throw t.error}}for(var F=new Uint8Array(B),T=g.length,I=0;I<T;I++){var k=g[I],U=k.getCodewords(),K=k.getNumDataCodewords();this.correctErrors(U,K);for(var X=0;X<K;X++)F[X*T+I]=U[X]}return hh.decode(F)},r.prototype.correctErrors=function(e,t){var i=new Int32Array(e);try{this.rsDecoder.decode(i,e.length-t)}catch{throw new Dt}for(var o=0;o<t;o++)e[o]=i[o]},r}(),fh=function(){function r(e){this.image=e,this.rectangleDetector=new pn(this.image)}return r.prototype.detect=function(){var e=this.rectangleDetector.detect(),t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new ve;t=this.shiftToModuleCenter(t);var i=t[0],o=t[1],s=t[2],u=t[3],g=this.transitionsBetween(i,u)+1,B=this.transitionsBetween(s,u)+1;(g&1)===1&&(g+=1),(B&1)===1&&(B+=1),4*g<7*B&&4*B<7*g&&(g=B=Math.max(g,B));var _=r.sampleGrid(this.image,i,o,s,u,g,B);return new jn(_,[i,o,s,u])},r.shiftPoint=function(e,t,i){var o=(t.getX()-e.getX())/(i+1),s=(t.getY()-e.getY())/(i+1);return new Pe(e.getX()+o,e.getY()+s)},r.moveAway=function(e,t,i){var o=e.getX(),s=e.getY();return o<t?o-=1:o+=1,s<i?s-=1:s+=1,new Pe(o,s)},r.prototype.detectSolid1=function(e){var t=e[0],i=e[1],o=e[3],s=e[2],u=this.transitionsBetween(t,i),g=this.transitionsBetween(i,o),B=this.transitionsBetween(o,s),_=this.transitionsBetween(s,t),m=u,D=[s,t,i,o];return m>g&&(m=g,D[0]=t,D[1]=i,D[2]=o,D[3]=s),m>B&&(m=B,D[0]=i,D[1]=o,D[2]=s,D[3]=t),m>_&&(D[0]=o,D[1]=s,D[2]=t,D[3]=i),D},r.prototype.detectSolid2=function(e){var t=e[0],i=e[1],o=e[2],s=e[3],u=this.transitionsBetween(t,s),g=r.shiftPoint(i,o,(u+1)*4),B=r.shiftPoint(o,i,(u+1)*4),_=this.transitionsBetween(g,t),m=this.transitionsBetween(B,s);return _<m?(e[0]=t,e[1]=i,e[2]=o,e[3]=s):(e[0]=i,e[1]=o,e[2]=s,e[3]=t),e},r.prototype.correctTopRight=function(e){var t=e[0],i=e[1],o=e[2],s=e[3],u=this.transitionsBetween(t,s),g=this.transitionsBetween(i,s),B=r.shiftPoint(t,i,(g+1)*4),_=r.shiftPoint(o,i,(u+1)*4);u=this.transitionsBetween(B,s),g=this.transitionsBetween(_,s);var m=new Pe(s.getX()+(o.getX()-i.getX())/(u+1),s.getY()+(o.getY()-i.getY())/(u+1)),D=new Pe(s.getX()+(t.getX()-i.getX())/(g+1),s.getY()+(t.getY()-i.getY())/(g+1));if(!this.isValid(m))return this.isValid(D)?D:null;if(!this.isValid(D))return m;var F=this.transitionsBetween(B,m)+this.transitionsBetween(_,m),T=this.transitionsBetween(B,D)+this.transitionsBetween(_,D);return F>T?m:D},r.prototype.shiftToModuleCenter=function(e){var t=e[0],i=e[1],o=e[2],s=e[3],u=this.transitionsBetween(t,s)+1,g=this.transitionsBetween(o,s)+1,B=r.shiftPoint(t,i,g*4),_=r.shiftPoint(o,i,u*4);u=this.transitionsBetween(B,s)+1,g=this.transitionsBetween(_,s)+1,(u&1)===1&&(u+=1),(g&1)===1&&(g+=1);var m=(t.getX()+i.getX()+o.getX()+s.getX())/4,D=(t.getY()+i.getY()+o.getY()+s.getY())/4;t=r.moveAway(t,m,D),i=r.moveAway(i,m,D),o=r.moveAway(o,m,D),s=r.moveAway(s,m,D);var F,T;return B=r.shiftPoint(t,i,g*4),B=r.shiftPoint(B,s,u*4),F=r.shiftPoint(i,t,g*4),F=r.shiftPoint(F,o,u*4),_=r.shiftPoint(o,s,g*4),_=r.shiftPoint(_,i,u*4),T=r.shiftPoint(s,o,g*4),T=r.shiftPoint(T,t,u*4),[B,F,_,T]},r.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},r.sampleGrid=function(e,t,i,o,s,u,g){var B=Un.getInstance();return B.sampleGrid(e,u,g,.5,.5,u-.5,.5,u-.5,g-.5,.5,g-.5,t.getX(),t.getY(),s.getX(),s.getY(),o.getX(),o.getY(),i.getX(),i.getY())},r.prototype.transitionsBetween=function(e,t){var i=Math.trunc(e.getX()),o=Math.trunc(e.getY()),s=Math.trunc(t.getX()),u=Math.trunc(t.getY()),g=Math.abs(u-o)>Math.abs(s-i);if(g){var B=i;i=o,o=B,B=s,s=u,u=B}for(var _=Math.abs(s-i),m=Math.abs(u-o),D=-_/2,F=o<u?1:-1,T=i<s?1:-1,I=0,k=this.image.get(g?o:i,g?i:o),U=i,K=o;U!==s;U+=T){var X=this.image.get(g?K:U,g?U:K);if(X!==k&&(I++,k=X),D+=m,D>0){if(K===u)break;K+=F,D-=_}}return I},r}(),_n=function(){function r(){this.decoder=new uh}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var i,o;if(t!=null&&t.has(xt.PURE_BARCODE)){var s=r.extractPureBits(e.getBlackMatrix());i=this.decoder.decode(s),o=r.NO_POINTS}else{var u=new fh(e.getBlackMatrix()).detect();i=this.decoder.decode(u.getBits()),o=u.getPoints()}var g=i.getRawBytes(),B=new Mt(i.getText(),g,8*g.length,o,ke.DATA_MATRIX,nt.currentTimeMillis()),_=i.getByteSegments();_!=null&&B.putMetadata(Ot.BYTE_SEGMENTS,_);var m=i.getECLevel();return m!=null&&B.putMetadata(Ot.ERROR_CORRECTION_LEVEL,m),B},r.prototype.reset=function(){},r.extractPureBits=function(e){var t=e.getTopLeftOnBit(),i=e.getBottomRightOnBit();if(t==null||i==null)throw new ve;var o=this.moduleSize(t,e),s=t[1],u=i[1],g=t[0],B=i[0],_=(B-g+1)/o,m=(u-s+1)/o;if(_<=0||m<=0)throw new ve;var D=o/2;s+=D,g+=D;for(var F=new dr(_,m),T=0;T<m;T++)for(var I=s+T*o,k=0;k<_;k++)e.get(g+k*o,I)&&F.set(k,T);return F},r.moduleSize=function(e,t){for(var i=t.getWidth(),o=e[0],s=e[1];o<i&&t.get(o,s);)o++;if(o===i)throw new ve;var u=o-e[0];if(u===0)throw new ve;return u},r.NO_POINTS=[],r}(),Eh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(r){Eh(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new _n,t)||this}return e})(Yr);var Gr;(function(r){r[r.L=0]="L",r[r.M=1]="M",r[r.Q=2]="Q",r[r.H=3]="H"})(Gr||(Gr={}));var dh=function(){function r(e,t,i){this.value=e,this.stringValue=t,this.bits=i,r.FOR_BITS.set(i,this),r.FOR_VALUE.set(e,this)}return r.prototype.getValue=function(){return this.value},r.prototype.getBits=function(){return this.bits},r.fromString=function(e){switch(e){case"L":return r.L;case"M":return r.M;case"Q":return r.Q;case"H":return r.H;default:throw new nr(e+"not available")}},r.prototype.toString=function(){return this.stringValue},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.forBits=function(e){if(e<0||e>=r.FOR_BITS.size)throw new Ue;return r.FOR_BITS.get(e)},r.FOR_BITS=new Map,r.FOR_VALUE=new Map,r.L=new r(Gr.L,"L",1),r.M=new r(Gr.M,"M",0),r.Q=new r(Gr.Q,"Q",3),r.H=new r(Gr.H,"H",2),r}(),gh=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},J0=function(){function r(e){this.errorCorrectionLevel=dh.forBits(e>>3&3),this.dataMask=e&7}return r.numBitsDiffering=function(e,t){return ut.bitCount(e^t)},r.decodeFormatInformation=function(e,t){var i=r.doDecodeFormatInformation(e,t);return i!==null?i:r.doDecodeFormatInformation(e^r.FORMAT_INFO_MASK_QR,t^r.FORMAT_INFO_MASK_QR)},r.doDecodeFormatInformation=function(e,t){var i,o,s=Number.MAX_SAFE_INTEGER,u=0;try{for(var g=gh(r.FORMAT_INFO_DECODE_LOOKUP),B=g.next();!B.done;B=g.next()){var _=B.value,m=_[0];if(m===e||m===t)return new r(_[1]);var D=r.numBitsDiffering(e,m);D<s&&(u=_[1],s=D),e!==t&&(D=r.numBitsDiffering(t,m),D<s&&(u=_[1],s=D))}}catch(F){i={error:F}}finally{try{B&&!B.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}return s<=3?new r(u):null},r.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},r.prototype.getDataMask=function(){return this.dataMask},r.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask},r.FORMAT_INFO_MASK_QR=21522,r.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],r}(),Ah=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ge=function(){function r(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.ecCodewordsPerBlock=e,this.ecBlocks=t}return r.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},r.prototype.getNumBlocks=function(){var e,t,i=0,o=this.ecBlocks;try{for(var s=Ah(o),u=s.next();!u.done;u=s.next()){var g=u.value;i+=g.getCount()}}catch(B){e={error:B}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return i},r.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},r.prototype.getECBlocks=function(){return this.ecBlocks},r}(),Q=function(){function r(e,t){this.count=e,this.dataCodewords=t}return r.prototype.getCount=function(){return this.count},r.prototype.getDataCodewords=function(){return this.dataCodewords},r}(),ph=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Rr=function(){function r(e,t){for(var i,o,s=[],u=2;u<arguments.length;u++)s[u-2]=arguments[u];this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=s;var g=0,B=s[0].getECCodewordsPerBlock(),_=s[0].getECBlocks();try{for(var m=ph(_),D=m.next();!D.done;D=m.next()){var F=D.value;g+=F.getCount()*(F.getDataCodewords()+B)}}catch(T){i={error:T}}finally{try{D&&!D.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}this.totalCodewords=g}return r.prototype.getVersionNumber=function(){return this.versionNumber},r.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},r.prototype.getTotalCodewords=function(){return this.totalCodewords},r.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},r.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},r.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new Ie;try{return this.getVersionForNumber((e-17)/4)}catch{throw new Ie}},r.getVersionForNumber=function(e){if(e<1||e>40)throw new Ue;return r.VERSIONS[e-1]},r.decodeVersionInformation=function(e){for(var t=Number.MAX_SAFE_INTEGER,i=0,o=0;o<r.VERSION_DECODE_INFO.length;o++){var s=r.VERSION_DECODE_INFO[o];if(s===e)return r.getVersionForNumber(o+7);var u=J0.numBitsDiffering(e,s);u<t&&(i=o+7,t=u)}return t<=3?r.getVersionForNumber(i):null},r.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),t=new dr(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var i=this.alignmentPatternCenters.length,o=0;o<i;o++)for(var s=this.alignmentPatternCenters[o]-2,u=0;u<i;u++)o===0&&(u===0||u===i-1)||o===i-1&&u===0||t.setRegion(this.alignmentPatternCenters[u]-2,s,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},r.prototype.toString=function(){return""+this.versionNumber},r.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),r.VERSIONS=[new r(1,new Int32Array(0),new ge(7,new Q(1,19)),new ge(10,new Q(1,16)),new ge(13,new Q(1,13)),new ge(17,new Q(1,9))),new r(2,Int32Array.from([6,18]),new ge(10,new Q(1,34)),new ge(16,new Q(1,28)),new ge(22,new Q(1,22)),new ge(28,new Q(1,16))),new r(3,Int32Array.from([6,22]),new ge(15,new Q(1,55)),new ge(26,new Q(1,44)),new ge(18,new Q(2,17)),new ge(22,new Q(2,13))),new r(4,Int32Array.from([6,26]),new ge(20,new Q(1,80)),new ge(18,new Q(2,32)),new ge(26,new Q(2,24)),new ge(16,new Q(4,9))),new r(5,Int32Array.from([6,30]),new ge(26,new Q(1,108)),new ge(24,new Q(2,43)),new ge(18,new Q(2,15),new Q(2,16)),new ge(22,new Q(2,11),new Q(2,12))),new r(6,Int32Array.from([6,34]),new ge(18,new Q(2,68)),new ge(16,new Q(4,27)),new ge(24,new Q(4,19)),new ge(28,new Q(4,15))),new r(7,Int32Array.from([6,22,38]),new ge(20,new Q(2,78)),new ge(18,new Q(4,31)),new ge(18,new Q(2,14),new Q(4,15)),new ge(26,new Q(4,13),new Q(1,14))),new r(8,Int32Array.from([6,24,42]),new ge(24,new Q(2,97)),new ge(22,new Q(2,38),new Q(2,39)),new ge(22,new Q(4,18),new Q(2,19)),new ge(26,new Q(4,14),new Q(2,15))),new r(9,Int32Array.from([6,26,46]),new ge(30,new Q(2,116)),new ge(22,new Q(3,36),new Q(2,37)),new ge(20,new Q(4,16),new Q(4,17)),new ge(24,new Q(4,12),new Q(4,13))),new r(10,Int32Array.from([6,28,50]),new ge(18,new Q(2,68),new Q(2,69)),new ge(26,new Q(4,43),new Q(1,44)),new ge(24,new Q(6,19),new Q(2,20)),new ge(28,new Q(6,15),new Q(2,16))),new r(11,Int32Array.from([6,30,54]),new ge(20,new Q(4,81)),new ge(30,new Q(1,50),new Q(4,51)),new ge(28,new Q(4,22),new Q(4,23)),new ge(24,new Q(3,12),new Q(8,13))),new r(12,Int32Array.from([6,32,58]),new ge(24,new Q(2,92),new Q(2,93)),new ge(22,new Q(6,36),new Q(2,37)),new ge(26,new Q(4,20),new Q(6,21)),new ge(28,new Q(7,14),new Q(4,15))),new r(13,Int32Array.from([6,34,62]),new ge(26,new Q(4,107)),new ge(22,new Q(8,37),new Q(1,38)),new ge(24,new Q(8,20),new Q(4,21)),new ge(22,new Q(12,11),new Q(4,12))),new r(14,Int32Array.from([6,26,46,66]),new ge(30,new Q(3,115),new Q(1,116)),new ge(24,new Q(4,40),new Q(5,41)),new ge(20,new Q(11,16),new Q(5,17)),new ge(24,new Q(11,12),new Q(5,13))),new r(15,Int32Array.from([6,26,48,70]),new ge(22,new Q(5,87),new Q(1,88)),new ge(24,new Q(5,41),new Q(5,42)),new ge(30,new Q(5,24),new Q(7,25)),new ge(24,new Q(11,12),new Q(7,13))),new r(16,Int32Array.from([6,26,50,74]),new ge(24,new Q(5,98),new Q(1,99)),new ge(28,new Q(7,45),new Q(3,46)),new ge(24,new Q(15,19),new Q(2,20)),new ge(30,new Q(3,15),new Q(13,16))),new r(17,Int32Array.from([6,30,54,78]),new ge(28,new Q(1,107),new Q(5,108)),new ge(28,new Q(10,46),new Q(1,47)),new ge(28,new Q(1,22),new Q(15,23)),new ge(28,new Q(2,14),new Q(17,15))),new r(18,Int32Array.from([6,30,56,82]),new ge(30,new Q(5,120),new Q(1,121)),new ge(26,new Q(9,43),new Q(4,44)),new ge(28,new Q(17,22),new Q(1,23)),new ge(28,new Q(2,14),new Q(19,15))),new r(19,Int32Array.from([6,30,58,86]),new ge(28,new Q(3,113),new Q(4,114)),new ge(26,new Q(3,44),new Q(11,45)),new ge(26,new Q(17,21),new Q(4,22)),new ge(26,new Q(9,13),new Q(16,14))),new r(20,Int32Array.from([6,34,62,90]),new ge(28,new Q(3,107),new Q(5,108)),new ge(26,new Q(3,41),new Q(13,42)),new ge(30,new Q(15,24),new Q(5,25)),new ge(28,new Q(15,15),new Q(10,16))),new r(21,Int32Array.from([6,28,50,72,94]),new ge(28,new Q(4,116),new Q(4,117)),new ge(26,new Q(17,42)),new ge(28,new Q(17,22),new Q(6,23)),new ge(30,new Q(19,16),new Q(6,17))),new r(22,Int32Array.from([6,26,50,74,98]),new ge(28,new Q(2,111),new Q(7,112)),new ge(28,new Q(17,46)),new ge(30,new Q(7,24),new Q(16,25)),new ge(24,new Q(34,13))),new r(23,Int32Array.from([6,30,54,78,102]),new ge(30,new Q(4,121),new Q(5,122)),new ge(28,new Q(4,47),new Q(14,48)),new ge(30,new Q(11,24),new Q(14,25)),new ge(30,new Q(16,15),new Q(14,16))),new r(24,Int32Array.from([6,28,54,80,106]),new ge(30,new Q(6,117),new Q(4,118)),new ge(28,new Q(6,45),new Q(14,46)),new ge(30,new Q(11,24),new Q(16,25)),new ge(30,new Q(30,16),new Q(2,17))),new r(25,Int32Array.from([6,32,58,84,110]),new ge(26,new Q(8,106),new Q(4,107)),new ge(28,new Q(8,47),new Q(13,48)),new ge(30,new Q(7,24),new Q(22,25)),new ge(30,new Q(22,15),new Q(13,16))),new r(26,Int32Array.from([6,30,58,86,114]),new ge(28,new Q(10,114),new Q(2,115)),new ge(28,new Q(19,46),new Q(4,47)),new ge(28,new Q(28,22),new Q(6,23)),new ge(30,new Q(33,16),new Q(4,17))),new r(27,Int32Array.from([6,34,62,90,118]),new ge(30,new Q(8,122),new Q(4,123)),new ge(28,new Q(22,45),new Q(3,46)),new ge(30,new Q(8,23),new Q(26,24)),new ge(30,new Q(12,15),new Q(28,16))),new r(28,Int32Array.from([6,26,50,74,98,122]),new ge(30,new Q(3,117),new Q(10,118)),new ge(28,new Q(3,45),new Q(23,46)),new ge(30,new Q(4,24),new Q(31,25)),new ge(30,new Q(11,15),new Q(31,16))),new r(29,Int32Array.from([6,30,54,78,102,126]),new ge(30,new Q(7,116),new Q(7,117)),new ge(28,new Q(21,45),new Q(7,46)),new ge(30,new Q(1,23),new Q(37,24)),new ge(30,new Q(19,15),new Q(26,16))),new r(30,Int32Array.from([6,26,52,78,104,130]),new ge(30,new Q(5,115),new Q(10,116)),new ge(28,new Q(19,47),new Q(10,48)),new ge(30,new Q(15,24),new Q(25,25)),new ge(30,new Q(23,15),new Q(25,16))),new r(31,Int32Array.from([6,30,56,82,108,134]),new ge(30,new Q(13,115),new Q(3,116)),new ge(28,new Q(2,46),new Q(29,47)),new ge(30,new Q(42,24),new Q(1,25)),new ge(30,new Q(23,15),new Q(28,16))),new r(32,Int32Array.from([6,34,60,86,112,138]),new ge(30,new Q(17,115)),new ge(28,new Q(10,46),new Q(23,47)),new ge(30,new Q(10,24),new Q(35,25)),new ge(30,new Q(19,15),new Q(35,16))),new r(33,Int32Array.from([6,30,58,86,114,142]),new ge(30,new Q(17,115),new Q(1,116)),new ge(28,new Q(14,46),new Q(21,47)),new ge(30,new Q(29,24),new Q(19,25)),new ge(30,new Q(11,15),new Q(46,16))),new r(34,Int32Array.from([6,34,62,90,118,146]),new ge(30,new Q(13,115),new Q(6,116)),new ge(28,new Q(14,46),new Q(23,47)),new ge(30,new Q(44,24),new Q(7,25)),new ge(30,new Q(59,16),new Q(1,17))),new r(35,Int32Array.from([6,30,54,78,102,126,150]),new ge(30,new Q(12,121),new Q(7,122)),new ge(28,new Q(12,47),new Q(26,48)),new ge(30,new Q(39,24),new Q(14,25)),new ge(30,new Q(22,15),new Q(41,16))),new r(36,Int32Array.from([6,24,50,76,102,128,154]),new ge(30,new Q(6,121),new Q(14,122)),new ge(28,new Q(6,47),new Q(34,48)),new ge(30,new Q(46,24),new Q(10,25)),new ge(30,new Q(2,15),new Q(64,16))),new r(37,Int32Array.from([6,28,54,80,106,132,158]),new ge(30,new Q(17,122),new Q(4,123)),new ge(28,new Q(29,46),new Q(14,47)),new ge(30,new Q(49,24),new Q(10,25)),new ge(30,new Q(24,15),new Q(46,16))),new r(38,Int32Array.from([6,32,58,84,110,136,162]),new ge(30,new Q(4,122),new Q(18,123)),new ge(28,new Q(13,46),new Q(32,47)),new ge(30,new Q(48,24),new Q(14,25)),new ge(30,new Q(42,15),new Q(32,16))),new r(39,Int32Array.from([6,26,54,82,110,138,166]),new ge(30,new Q(20,117),new Q(4,118)),new ge(28,new Q(40,47),new Q(7,48)),new ge(30,new Q(43,24),new Q(22,25)),new ge(30,new Q(10,15),new Q(67,16))),new r(40,Int32Array.from([6,30,58,86,114,142,170]),new ge(30,new Q(19,118),new Q(6,119)),new ge(28,new Q(18,47),new Q(31,48)),new ge(30,new Q(34,24),new Q(34,25)),new ge(30,new Q(20,15),new Q(61,16)))],r}(),Ct;(function(r){r[r.DATA_MASK_000=0]="DATA_MASK_000",r[r.DATA_MASK_001=1]="DATA_MASK_001",r[r.DATA_MASK_010=2]="DATA_MASK_010",r[r.DATA_MASK_011=3]="DATA_MASK_011",r[r.DATA_MASK_100=4]="DATA_MASK_100",r[r.DATA_MASK_101=5]="DATA_MASK_101",r[r.DATA_MASK_110=6]="DATA_MASK_110",r[r.DATA_MASK_111=7]="DATA_MASK_111"})(Ct||(Ct={}));var $o=function(){function r(e,t){this.value=e,this.isMasked=t}return r.prototype.unmaskBitMatrix=function(e,t){for(var i=0;i<t;i++)for(var o=0;o<t;o++)this.isMasked(i,o)&&e.flip(o,i)},r.values=new Map([[Ct.DATA_MASK_000,new r(Ct.DATA_MASK_000,function(e,t){return(e+t&1)===0})],[Ct.DATA_MASK_001,new r(Ct.DATA_MASK_001,function(e,t){return(e&1)===0})],[Ct.DATA_MASK_010,new r(Ct.DATA_MASK_010,function(e,t){return t%3===0})],[Ct.DATA_MASK_011,new r(Ct.DATA_MASK_011,function(e,t){return(e+t)%3===0})],[Ct.DATA_MASK_100,new r(Ct.DATA_MASK_100,function(e,t){return(Math.floor(e/2)+Math.floor(t/3)&1)===0})],[Ct.DATA_MASK_101,new r(Ct.DATA_MASK_101,function(e,t){return e*t%6===0})],[Ct.DATA_MASK_110,new r(Ct.DATA_MASK_110,function(e,t){return e*t%6<3})],[Ct.DATA_MASK_111,new r(Ct.DATA_MASK_111,function(e,t){return(e+t+e*t%3&1)===0})]]),r}(),Bh=function(){function r(e){var t=e.getHeight();if(t<21||(t&3)!==1)throw new Ie;this.bitMatrix=e}return r.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var i=5;i>=0;i--)e=this.copyBit(8,i,e);for(var o=this.bitMatrix.getHeight(),s=0,u=o-7,i=o-1;i>=u;i--)s=this.copyBit(8,i,s);for(var t=o-8;t<o;t++)s=this.copyBit(t,8,s);if(this.parsedFormatInfo=J0.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Ie},r.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return Rr.getVersionForNumber(t);for(var i=0,o=e-11,s=5;s>=0;s--)for(var u=e-9;u>=o;u--)i=this.copyBit(u,s,i);var g=Rr.decodeVersionInformation(i);if(g!==null&&g.getDimensionForVersion()===e)return this.parsedVersion=g,g;i=0;for(var u=5;u>=0;u--)for(var s=e-9;s>=o;s--)i=this.copyBit(u,s,i);if(g=Rr.decodeVersionInformation(i),g!==null&&g.getDimensionForVersion()===e)return this.parsedVersion=g,g;throw new Ie},r.prototype.copyBit=function(e,t,i){var o=this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t);return o?i<<1|1:i<<1},r.prototype.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),i=$o.values.get(e.getDataMask()),o=this.bitMatrix.getHeight();i.unmaskBitMatrix(this.bitMatrix,o);for(var s=t.buildFunctionPattern(),u=!0,g=new Uint8Array(t.getTotalCodewords()),B=0,_=0,m=0,D=o-1;D>0;D-=2){D===6&&D--;for(var F=0;F<o;F++)for(var T=u?o-1-F:F,I=0;I<2;I++)s.get(D-I,T)||(m++,_<<=1,this.bitMatrix.get(D-I,T)&&(_|=1),m===8&&(g[B++]=_,m=0,_=0));u=!u}if(B!==t.getTotalCodewords())throw new Ie;return g},r.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=$o.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}},r.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},r.prototype.mirror=function(){for(var e=this.bitMatrix,t=0,i=e.getWidth();t<i;t++)for(var o=t+1,s=e.getHeight();o<s;o++)e.get(t,o)!==e.get(o,t)&&(e.flip(o,t),e.flip(t,o))},r}(),e0=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vh=function(){function r(e,t){this.numDataCodewords=e,this.codewords=t}return r.getDataBlocks=function(e,t,i){var o,s,u,g;if(e.length!==t.getTotalCodewords())throw new Ue;var B=t.getECBlocksForLevel(i),_=0,m=B.getECBlocks();try{for(var D=e0(m),F=D.next();!F.done;F=D.next()){var T=F.value;_+=T.getCount()}}catch(x){o={error:x}}finally{try{F&&!F.done&&(s=D.return)&&s.call(D)}finally{if(o)throw o.error}}var I=new Array(_),k=0;try{for(var U=e0(m),K=U.next();!K.done;K=U.next())for(var T=K.value,X=0;X<T.getCount();X++){var te=T.getDataCodewords(),ne=B.getECCodewordsPerBlock()+te;I[k++]=new r(te,new Uint8Array(ne))}}catch(x){u={error:x}}finally{try{K&&!K.done&&(g=U.return)&&g.call(U)}finally{if(u)throw u.error}}for(var re=I[0].codewords.length,ue=I.length-1;ue>=0;){var Ae=I[ue].codewords.length;if(Ae===re)break;ue--}ue++;for(var v=re-B.getECCodewordsPerBlock(),ye=0,X=0;X<v;X++)for(var be=0;be<k;be++)I[be].codewords[X]=e[ye++];for(var be=ue;be<k;be++)I[be].codewords[v]=e[ye++];for(var je=I[0].codewords.length,X=v;X<je;X++)for(var be=0;be<k;be++){var h=be<ue?X:X+1;I[be].codewords[h]=e[ye++]}return I},r.prototype.getNumDataCodewords=function(){return this.numDataCodewords},r.prototype.getCodewords=function(){return this.codewords},r}(),er;(function(r){r[r.TERMINATOR=0]="TERMINATOR",r[r.NUMERIC=1]="NUMERIC",r[r.ALPHANUMERIC=2]="ALPHANUMERIC",r[r.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",r[r.BYTE=4]="BYTE",r[r.ECI=5]="ECI",r[r.KANJI=6]="KANJI",r[r.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",r[r.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",r[r.HANZI=9]="HANZI"})(er||(er={}));var at=function(){function r(e,t,i,o){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=i,this.bits=o,r.FOR_BITS.set(o,this),r.FOR_VALUE.set(e,this)}return r.forBits=function(e){var t=r.FOR_BITS.get(e);if(t===void 0)throw new Ue;return t},r.prototype.getCharacterCountBits=function(e){var t=e.getVersionNumber(),i;return t<=9?i=0:t<=26?i=1:i=2,this.characterCountBitsForVersions[i]},r.prototype.getValue=function(){return this.value},r.prototype.getBits=function(){return this.bits},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.prototype.toString=function(){return this.stringValue},r.FOR_BITS=new Map,r.FOR_VALUE=new Map,r.TERMINATOR=new r(er.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),r.NUMERIC=new r(er.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),r.ALPHANUMERIC=new r(er.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),r.STRUCTURED_APPEND=new r(er.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),r.BYTE=new r(er.BYTE,"BYTE",Int32Array.from([8,16,16]),4),r.ECI=new r(er.ECI,"ECI",Int32Array.from([0,0,0]),7),r.KANJI=new r(er.KANJI,"KANJI",Int32Array.from([8,10,12]),8),r.FNC1_FIRST_POSITION=new r(er.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),r.FNC1_SECOND_POSITION=new r(er.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),r.HANZI=new r(er.HANZI,"HANZI",Int32Array.from([8,10,12]),13),r}(),_h=function(){function r(){}return r.decode=function(e,t,i,o){var s=new K0(e),u=new Ge,g=new Array,B=-1,_=-1;try{var m=null,D=!1,F=void 0;do{if(s.available()<4)F=at.TERMINATOR;else{var T=s.readBits(4);F=at.forBits(T)}switch(F){case at.TERMINATOR:break;case at.FNC1_FIRST_POSITION:case at.FNC1_SECOND_POSITION:D=!0;break;case at.STRUCTURED_APPEND:if(s.available()<16)throw new Ie;B=s.readBits(8),_=s.readBits(8);break;case at.ECI:var I=r.parseECIValue(s);if(m=Bt.getCharacterSetECIByValue(I),m===null)throw new Ie;break;case at.HANZI:var k=s.readBits(4),U=s.readBits(F.getCharacterCountBits(t));k===r.GB2312_SUBSET&&r.decodeHanziSegment(s,u,U);break;default:var K=s.readBits(F.getCharacterCountBits(t));switch(F){case at.NUMERIC:r.decodeNumericSegment(s,u,K);break;case at.ALPHANUMERIC:r.decodeAlphanumericSegment(s,u,K,D);break;case at.BYTE:r.decodeByteSegment(s,u,K,m,g,o);break;case at.KANJI:r.decodeKanjiSegment(s,u,K);break;default:throw new Ie}break}}while(F!==at.TERMINATOR)}catch{throw new Ie}return new Ji(e,u.toString(),g.length===0?null:g,i===null?null:i.toString(),B,_)},r.decodeHanziSegment=function(e,t,i){if(i*13>e.available())throw new Ie;for(var o=new Uint8Array(2*i),s=0;i>0;){var u=e.readBits(13),g=u/96<<8&4294967295|u%96;g<959?g+=41377:g+=42657,o[s]=g>>8&255,o[s+1]=g&255,s+=2,i--}try{t.append(tr.decode(o,it.GB2312))}catch(B){throw new Ie(B)}},r.decodeKanjiSegment=function(e,t,i){if(i*13>e.available())throw new Ie;for(var o=new Uint8Array(2*i),s=0;i>0;){var u=e.readBits(13),g=u/192<<8&4294967295|u%192;g<7936?g+=33088:g+=49472,o[s]=g>>8,o[s+1]=g,s+=2,i--}try{t.append(tr.decode(o,it.SHIFT_JIS))}catch(B){throw new Ie(B)}},r.decodeByteSegment=function(e,t,i,o,s,u){if(8*i>e.available())throw new Ie;for(var g=new Uint8Array(i),B=0;B<i;B++)g[B]=e.readBits(8);var _;o===null?_=it.guessEncoding(g,u):_=o.getName();try{t.append(tr.decode(g,_))}catch(m){throw new Ie(m)}s.push(g)},r.toAlphaNumericChar=function(e){if(e>=r.ALPHANUMERIC_CHARS.length)throw new Ie;return r.ALPHANUMERIC_CHARS[e]},r.decodeAlphanumericSegment=function(e,t,i,o){for(var s=t.length();i>1;){if(e.available()<11)throw new Ie;var u=e.readBits(11);t.append(r.toAlphaNumericChar(Math.floor(u/45))),t.append(r.toAlphaNumericChar(u%45)),i-=2}if(i===1){if(e.available()<6)throw new Ie;t.append(r.toAlphaNumericChar(e.readBits(6)))}if(o)for(var g=s;g<t.length();g++)t.charAt(g)==="%"&&(g<t.length()-1&&t.charAt(g+1)==="%"?t.deleteCharAt(g+1):t.setCharAt(g,String.fromCharCode(29)))},r.decodeNumericSegment=function(e,t,i){for(;i>=3;){if(e.available()<10)throw new Ie;var o=e.readBits(10);if(o>=1e3)throw new Ie;t.append(r.toAlphaNumericChar(Math.floor(o/100))),t.append(r.toAlphaNumericChar(Math.floor(o/10)%10)),t.append(r.toAlphaNumericChar(o%10)),i-=3}if(i===2){if(e.available()<7)throw new Ie;var s=e.readBits(7);if(s>=100)throw new Ie;t.append(r.toAlphaNumericChar(Math.floor(s/10))),t.append(r.toAlphaNumericChar(s%10))}else if(i===1){if(e.available()<4)throw new Ie;var u=e.readBits(4);if(u>=10)throw new Ie;t.append(r.toAlphaNumericChar(u))}},r.parseECIValue=function(e){var t=e.readBits(8);if((t&128)===0)return t&127;if((t&192)===128){var i=e.readBits(8);return(t&63)<<8&4294967295|i}if((t&224)===192){var o=e.readBits(16);return(t&31)<<16&4294967295|o}throw new Ie},r.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",r.GB2312_SUBSET=1,r}(),q0=function(){function r(e){this.mirrored=e}return r.prototype.isMirrored=function(){return this.mirrored},r.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var t=e[0];e[0]=e[2],e[2]=t}},r}(),t0=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ch=function(){function r(){this.rsDecoder=new qi(Er.QR_CODE_FIELD_256)}return r.prototype.decodeBooleanArray=function(e,t){return this.decodeBitMatrix(dr.parseFromBooleanArray(e),t)},r.prototype.decodeBitMatrix=function(e,t){var i=new Bh(e),o=null;try{return this.decodeBitMatrixParser(i,t)}catch(u){o=u}try{i.remask(),i.setMirror(!0),i.readVersion(),i.readFormatInformation(),i.mirror();var s=this.decodeBitMatrixParser(i,t);return s.setOther(new q0(!0)),s}catch(u){throw o!==null?o:u}},r.prototype.decodeBitMatrixParser=function(e,t){var i,o,s,u,g=e.readVersion(),B=e.readFormatInformation().getErrorCorrectionLevel(),_=e.readCodewords(),m=vh.getDataBlocks(_,g,B),D=0;try{for(var F=t0(m),T=F.next();!T.done;T=F.next()){var I=T.value;D+=I.getNumDataCodewords()}}catch(ue){i={error:ue}}finally{try{T&&!T.done&&(o=F.return)&&o.call(F)}finally{if(i)throw i.error}}var k=new Uint8Array(D),U=0;try{for(var K=t0(m),X=K.next();!X.done;X=K.next()){var I=X.value,te=I.getCodewords(),ne=I.getNumDataCodewords();this.correctErrors(te,ne);for(var re=0;re<ne;re++)k[U++]=te[re]}}catch(ue){s={error:ue}}finally{try{X&&!X.done&&(u=K.return)&&u.call(K)}finally{if(s)throw s.error}}return _h.decode(k,g,B,t)},r.prototype.correctErrors=function(e,t){var i=new Int32Array(e);try{this.rsDecoder.decode(i,e.length-t)}catch{throw new Dt}for(var o=0;o<t;o++)e[o]=i[o]},r}(),mh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),yh=function(r){mh(e,r);function e(t,i,o){var s=r.call(this,t,i)||this;return s.estimatedModuleSize=o,s}return e.prototype.aboutEquals=function(t,i,o){if(Math.abs(i-this.getY())<=t&&Math.abs(o-this.getX())<=t){var s=Math.abs(t-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,i,o){var s=(this.getX()+i)/2,u=(this.getY()+t)/2,g=(this.estimatedModuleSize+o)/2;return new e(s,u,g)},e}(Pe),Dh=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wh=function(){function r(e,t,i,o,s,u,g){this.image=e,this.startX=t,this.startY=i,this.width=o,this.height=s,this.moduleSize=u,this.resultPointCallback=g,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return r.prototype.find=function(){for(var e=this.startX,t=this.height,i=this.width,o=e+i,s=this.startY+t/2,u=new Int32Array(3),g=this.image,B=0;B<t;B++){var _=s+((B&1)===0?Math.floor((B+1)/2):-Math.floor((B+1)/2));u[0]=0,u[1]=0,u[2]=0;for(var m=e;m<o&&!g.get(m,_);)m++;for(var D=0;m<o;){if(g.get(m,_))if(D===1)u[1]++;else if(D===2){if(this.foundPatternCross(u)){var F=this.handlePossibleCenter(u,_,m);if(F!==null)return F}u[0]=u[2],u[1]=1,u[2]=0,D=1}else u[++D]++;else D===1&&D++,u[D]++;m++}if(this.foundPatternCross(u)){var F=this.handlePossibleCenter(u,_,o);if(F!==null)return F}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ve},r.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},r.prototype.foundPatternCross=function(e){for(var t=this.moduleSize,i=t/2,o=0;o<3;o++)if(Math.abs(t-e[o])>=i)return!1;return!0},r.prototype.crossCheckVertical=function(e,t,i,o){var s=this.image,u=s.getHeight(),g=this.crossCheckStateCount;g[0]=0,g[1]=0,g[2]=0;for(var B=e;B>=0&&s.get(t,B)&&g[1]<=i;)g[1]++,B--;if(B<0||g[1]>i)return NaN;for(;B>=0&&!s.get(t,B)&&g[0]<=i;)g[0]++,B--;if(g[0]>i)return NaN;for(B=e+1;B<u&&s.get(t,B)&&g[1]<=i;)g[1]++,B++;if(B===u||g[1]>i)return NaN;for(;B<u&&!s.get(t,B)&&g[2]<=i;)g[2]++,B++;if(g[2]>i)return NaN;var _=g[0]+g[1]+g[2];return 5*Math.abs(_-o)>=2*o?NaN:this.foundPatternCross(g)?r.centerFromEnd(g,B):NaN},r.prototype.handlePossibleCenter=function(e,t,i){var o,s,u=e[0]+e[1]+e[2],g=r.centerFromEnd(e,i),B=this.crossCheckVertical(t,g,2*e[1],u);if(!isNaN(B)){var _=(e[0]+e[1]+e[2])/3;try{for(var m=Dh(this.possibleCenters),D=m.next();!D.done;D=m.next()){var F=D.value;if(F.aboutEquals(_,B,g))return F.combineEstimate(B,g,_)}}catch(I){o={error:I}}finally{try{D&&!D.done&&(s=m.return)&&s.call(m)}finally{if(o)throw o.error}}var T=new yh(g,B,_);this.possibleCenters.push(T),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(T)}return null},r}(),Fh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Sh=function(r){Fh(e,r);function e(t,i,o,s){var u=r.call(this,t,i)||this;return u.estimatedModuleSize=o,u.count=s,s===void 0&&(u.count=1),u}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(t,i,o){if(Math.abs(i-this.getY())<=t&&Math.abs(o-this.getX())<=t){var s=Math.abs(t-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,i,o){var s=this.count+1,u=(this.count*this.getX()+i)/s,g=(this.count*this.getY()+t)/s,B=(this.count*this.estimatedModuleSize+o)/s;return new e(u,g,B,s)},e}(Pe),bh=function(){function r(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return r.prototype.getBottomLeft=function(){return this.bottomLeft},r.prototype.getTopLeft=function(){return this.topLeft},r.prototype.getTopRight=function(){return this.topRight},r}(),Qr=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Th=function(){function r(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}return r.prototype.getImage=function(){return this.image},r.prototype.getPossibleCenters=function(){return this.possibleCenters},r.prototype.find=function(e){var t=e!=null&&e.get(xt.TRY_HARDER)!==void 0,i=e!=null&&e.get(xt.PURE_BARCODE)!==void 0,o=this.image,s=o.getHeight(),u=o.getWidth(),g=Math.floor(3*s/(4*r.MAX_MODULES));(g<r.MIN_SKIP||t)&&(g=r.MIN_SKIP);for(var B=!1,_=new Int32Array(5),m=g-1;m<s&&!B;m+=g){_[0]=0,_[1]=0,_[2]=0,_[3]=0,_[4]=0;for(var D=0,F=0;F<u;F++)if(o.get(F,m))(D&1)===1&&D++,_[D]++;else if((D&1)===0)if(D===4)if(r.foundPatternCross(_)){var T=this.handlePossibleCenter(_,m,F,i);if(T===!0)if(g=2,this.hasSkipped===!0)B=this.haveMultiplyConfirmedCenters();else{var I=this.findRowSkip();I>_[2]&&(m+=I-_[2]-g,F=u-1)}else{_[0]=_[2],_[1]=_[3],_[2]=_[4],_[3]=1,_[4]=0,D=3;continue}D=0,_[0]=0,_[1]=0,_[2]=0,_[3]=0,_[4]=0}else _[0]=_[2],_[1]=_[3],_[2]=_[4],_[3]=1,_[4]=0,D=3;else _[++D]++;else _[D]++;if(r.foundPatternCross(_)){var T=this.handlePossibleCenter(_,m,u,i);T===!0&&(g=_[0],this.hasSkipped&&(B=this.haveMultiplyConfirmedCenters()))}}var k=this.selectBestPatterns();return Pe.orderBestPatterns(k),new bh(k)},r.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},r.foundPatternCross=function(e){for(var t=0,i=0;i<5;i++){var o=e[i];if(o===0)return!1;t+=o}if(t<7)return!1;var s=t/7,u=s/2;return Math.abs(s-e[0])<u&&Math.abs(s-e[1])<u&&Math.abs(3*s-e[2])<3*u&&Math.abs(s-e[3])<u&&Math.abs(s-e[4])<u},r.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},r.prototype.crossCheckDiagonal=function(e,t,i,o){for(var s=this.getCrossCheckStateCount(),u=0,g=this.image;e>=u&&t>=u&&g.get(t-u,e-u);)s[2]++,u++;if(e<u||t<u)return!1;for(;e>=u&&t>=u&&!g.get(t-u,e-u)&&s[1]<=i;)s[1]++,u++;if(e<u||t<u||s[1]>i)return!1;for(;e>=u&&t>=u&&g.get(t-u,e-u)&&s[0]<=i;)s[0]++,u++;if(s[0]>i)return!1;var B=g.getHeight(),_=g.getWidth();for(u=1;e+u<B&&t+u<_&&g.get(t+u,e+u);)s[2]++,u++;if(e+u>=B||t+u>=_)return!1;for(;e+u<B&&t+u<_&&!g.get(t+u,e+u)&&s[3]<i;)s[3]++,u++;if(e+u>=B||t+u>=_||s[3]>=i)return!1;for(;e+u<B&&t+u<_&&g.get(t+u,e+u)&&s[4]<i;)s[4]++,u++;if(s[4]>=i)return!1;var m=s[0]+s[1]+s[2]+s[3]+s[4];return Math.abs(m-o)<2*o&&r.foundPatternCross(s)},r.prototype.crossCheckVertical=function(e,t,i,o){for(var s=this.image,u=s.getHeight(),g=this.getCrossCheckStateCount(),B=e;B>=0&&s.get(t,B);)g[2]++,B--;if(B<0)return NaN;for(;B>=0&&!s.get(t,B)&&g[1]<=i;)g[1]++,B--;if(B<0||g[1]>i)return NaN;for(;B>=0&&s.get(t,B)&&g[0]<=i;)g[0]++,B--;if(g[0]>i)return NaN;for(B=e+1;B<u&&s.get(t,B);)g[2]++,B++;if(B===u)return NaN;for(;B<u&&!s.get(t,B)&&g[3]<i;)g[3]++,B++;if(B===u||g[3]>=i)return NaN;for(;B<u&&s.get(t,B)&&g[4]<i;)g[4]++,B++;if(g[4]>=i)return NaN;var _=g[0]+g[1]+g[2]+g[3]+g[4];return 5*Math.abs(_-o)>=2*o?NaN:r.foundPatternCross(g)?r.centerFromEnd(g,B):NaN},r.prototype.crossCheckHorizontal=function(e,t,i,o){for(var s=this.image,u=s.getWidth(),g=this.getCrossCheckStateCount(),B=e;B>=0&&s.get(B,t);)g[2]++,B--;if(B<0)return NaN;for(;B>=0&&!s.get(B,t)&&g[1]<=i;)g[1]++,B--;if(B<0||g[1]>i)return NaN;for(;B>=0&&s.get(B,t)&&g[0]<=i;)g[0]++,B--;if(g[0]>i)return NaN;for(B=e+1;B<u&&s.get(B,t);)g[2]++,B++;if(B===u)return NaN;for(;B<u&&!s.get(B,t)&&g[3]<i;)g[3]++,B++;if(B===u||g[3]>=i)return NaN;for(;B<u&&s.get(B,t)&&g[4]<i;)g[4]++,B++;if(g[4]>=i)return NaN;var _=g[0]+g[1]+g[2]+g[3]+g[4];return 5*Math.abs(_-o)>=o?NaN:r.foundPatternCross(g)?r.centerFromEnd(g,B):NaN},r.prototype.handlePossibleCenter=function(e,t,i,o){var s=e[0]+e[1]+e[2]+e[3]+e[4],u=r.centerFromEnd(e,i),g=this.crossCheckVertical(t,Math.floor(u),e[2],s);if(!isNaN(g)&&(u=this.crossCheckHorizontal(Math.floor(u),Math.floor(g),e[2],s),!isNaN(u)&&(!o||this.crossCheckDiagonal(Math.floor(g),Math.floor(u),e[2],s)))){for(var B=s/7,_=!1,m=this.possibleCenters,D=0,F=m.length;D<F;D++){var T=m[D];if(T.aboutEquals(B,g,u)){m[D]=T.combineEstimate(g,u,B),_=!0;break}}if(!_){var I=new Sh(u,g,B);m.push(I),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(I)}return!0}return!1},r.prototype.findRowSkip=function(){var e,t,i=this.possibleCenters.length;if(i<=1)return 0;var o=null;try{for(var s=Qr(this.possibleCenters),u=s.next();!u.done;u=s.next()){var g=u.value;if(g.getCount()>=r.CENTER_QUORUM)if(o==null)o=g;else return this.hasSkipped=!0,Math.floor((Math.abs(o.getX()-g.getX())-Math.abs(o.getY()-g.getY()))/2)}}catch(B){e={error:B}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return 0},r.prototype.haveMultiplyConfirmedCenters=function(){var e,t,i,o,s=0,u=0,g=this.possibleCenters.length;try{for(var B=Qr(this.possibleCenters),_=B.next();!_.done;_=B.next()){var m=_.value;m.getCount()>=r.CENTER_QUORUM&&(s++,u+=m.getEstimatedModuleSize())}}catch(k){e={error:k}}finally{try{_&&!_.done&&(t=B.return)&&t.call(B)}finally{if(e)throw e.error}}if(s<3)return!1;var D=u/g,F=0;try{for(var T=Qr(this.possibleCenters),I=T.next();!I.done;I=T.next()){var m=I.value;F+=Math.abs(m.getEstimatedModuleSize()-D)}}catch(k){i={error:k}}finally{try{I&&!I.done&&(o=T.return)&&o.call(T)}finally{if(i)throw i.error}}return F<=.05*u},r.prototype.selectBestPatterns=function(){var e,t,i,o,s=this.possibleCenters.length;if(s<3)throw new ve;var u=this.possibleCenters,g;if(s>3){var B=0,_=0;try{for(var m=Qr(this.possibleCenters),D=m.next();!D.done;D=m.next()){var F=D.value,T=F.getEstimatedModuleSize();B+=T,_+=T*T}}catch(re){e={error:re}}finally{try{D&&!D.done&&(t=m.return)&&t.call(m)}finally{if(e)throw e.error}}g=B/s;var I=Math.sqrt(_/s-g*g);u.sort(function(re,ue){var Ae=Math.abs(ue.getEstimatedModuleSize()-g),v=Math.abs(re.getEstimatedModuleSize()-g);return Ae<v?-1:Ae>v?1:0});for(var k=Math.max(.2*g,I),U=0;U<u.length&&u.length>3;U++){var K=u[U];Math.abs(K.getEstimatedModuleSize()-g)>k&&(u.splice(U,1),U--)}}if(u.length>3){var B=0;try{for(var X=Qr(u),te=X.next();!te.done;te=X.next()){var ne=te.value;B+=ne.getEstimatedModuleSize()}}catch(ue){i={error:ue}}finally{try{te&&!te.done&&(o=X.return)&&o.call(X)}finally{if(i)throw i.error}}g=B/u.length,u.sort(function(ue,Ae){if(Ae.getCount()===ue.getCount()){var v=Math.abs(Ae.getEstimatedModuleSize()-g),ye=Math.abs(ue.getEstimatedModuleSize()-g);return v<ye?1:v>ye?-1:0}else return Ae.getCount()-ue.getCount()}),u.splice(3)}return[u[0],u[1],u[2]]},r.CENTER_QUORUM=2,r.MIN_SKIP=3,r.MAX_MODULES=57,r}(),Oh=function(){function r(e){this.image=e}return r.prototype.getImage=function(){return this.image},r.prototype.getResultPointCallback=function(){return this.resultPointCallback},r.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(xt.NEED_RESULT_POINT_CALLBACK);var t=new Th(this.image,this.resultPointCallback),i=t.find(e);return this.processFinderPatternInfo(i)},r.prototype.processFinderPatternInfo=function(e){var t=e.getTopLeft(),i=e.getTopRight(),o=e.getBottomLeft(),s=this.calculateModuleSize(t,i,o);if(s<1)throw new ve("No pattern found in proccess finder.");var u=r.computeDimension(t,i,o,s),g=Rr.getProvisionalVersionForDimension(u),B=g.getDimensionForVersion()-7,_=null;if(g.getAlignmentPatternCenters().length>0)for(var m=i.getX()-t.getX()+o.getX(),D=i.getY()-t.getY()+o.getY(),F=1-3/B,T=Math.floor(t.getX()+F*(m-t.getX())),I=Math.floor(t.getY()+F*(D-t.getY())),k=4;k<=16;k<<=1)try{_=this.findAlignmentInRegion(s,T,I,k);break}catch(te){if(!(te instanceof ve))throw te}var U=r.createTransform(t,i,o,_,u),K=r.sampleGrid(this.image,U,u),X;return _===null?X=[o,t,i]:X=[o,t,i,_],new jn(K,X)},r.createTransform=function(e,t,i,o,s){var u=s-3.5,g,B,_,m;return o!==null?(g=o.getX(),B=o.getY(),_=u-3,m=_):(g=t.getX()-e.getX()+i.getX(),B=t.getY()-e.getY()+i.getY(),_=u,m=u),H0.quadrilateralToQuadrilateral(3.5,3.5,u,3.5,_,m,3.5,u,e.getX(),e.getY(),t.getX(),t.getY(),g,B,i.getX(),i.getY())},r.sampleGrid=function(e,t,i){var o=Un.getInstance();return o.sampleGridWithTransform(e,i,i,t)},r.computeDimension=function(e,t,i,o){var s=Ye.round(Pe.distance(e,t)/o),u=Ye.round(Pe.distance(e,i)/o),g=Math.floor((s+u)/2)+7;switch(g&3){case 0:g++;break;case 2:g--;break;case 3:throw new ve("Dimensions could be not found.")}return g},r.prototype.calculateModuleSize=function(e,t,i){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,i))/2},r.prototype.calculateModuleSizeOneWay=function(e,t){var i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),o=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(i)?o/7:isNaN(o)?i/7:(i+o)/14},r.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,t,i,o){var s=this.sizeOfBlackWhiteBlackRun(e,t,i,o),u=1,g=e-(i-e);g<0?(u=e/(e-g),g=0):g>=this.image.getWidth()&&(u=(this.image.getWidth()-1-e)/(g-e),g=this.image.getWidth()-1);var B=Math.floor(t-(o-t)*u);return u=1,B<0?(u=t/(t-B),B=0):B>=this.image.getHeight()&&(u=(this.image.getHeight()-1-t)/(B-t),B=this.image.getHeight()-1),g=Math.floor(e+(g-e)*u),s+=this.sizeOfBlackWhiteBlackRun(e,t,g,B),s-1},r.prototype.sizeOfBlackWhiteBlackRun=function(e,t,i,o){var s=Math.abs(o-t)>Math.abs(i-e);if(s){var u=e;e=t,t=u,u=i,i=o,o=u}for(var g=Math.abs(i-e),B=Math.abs(o-t),_=-g/2,m=e<i?1:-1,D=t<o?1:-1,F=0,T=i+m,I=e,k=t;I!==T;I+=m){var U=s?k:I,K=s?I:k;if(F===1===this.image.get(U,K)){if(F===2)return Ye.distance(I,k,e,t);F++}if(_+=B,_>0){if(k===o)break;k+=D,_-=g}}return F===2?Ye.distance(i+m,o,e,t):NaN},r.prototype.findAlignmentInRegion=function(e,t,i,o){var s=Math.floor(o*e),u=Math.max(0,t-s),g=Math.min(this.image.getWidth()-1,t+s);if(g-u<e*3)throw new ve("Alignment top exceeds estimated module size.");var B=Math.max(0,i-s),_=Math.min(this.image.getHeight()-1,i+s);if(_-B<e*3)throw new ve("Alignment bottom exceeds estimated module size.");var m=new wh(this.image,u,B,g-u,_-B,e,this.resultPointCallback);return m.find()},r}(),Cn=function(){function r(){this.decoder=new Ch}return r.prototype.getDecoder=function(){return this.decoder},r.prototype.decode=function(e,t){var i,o;if(t!=null&&t.get(xt.PURE_BARCODE)!==void 0){var s=r.extractPureBits(e.getBlackMatrix());i=this.decoder.decodeBitMatrix(s,t),o=r.NO_POINTS}else{var u=new Oh(e.getBlackMatrix()).detect(t);i=this.decoder.decodeBitMatrix(u.getBits(),t),o=u.getPoints()}i.getOther()instanceof q0&&i.getOther().applyMirroredCorrection(o);var g=new Mt(i.getText(),i.getRawBytes(),void 0,o,ke.QR_CODE,void 0),B=i.getByteSegments();B!==null&&g.putMetadata(Ot.BYTE_SEGMENTS,B);var _=i.getECLevel();return _!==null&&g.putMetadata(Ot.ERROR_CORRECTION_LEVEL,_),i.hasStructuredAppend()&&(g.putMetadata(Ot.STRUCTURED_APPEND_SEQUENCE,i.getStructuredAppendSequenceNumber()),g.putMetadata(Ot.STRUCTURED_APPEND_PARITY,i.getStructuredAppendParity())),g},r.prototype.reset=function(){},r.extractPureBits=function(e){var t=e.getTopLeftOnBit(),i=e.getBottomRightOnBit();if(t===null||i===null)throw new ve;var o=this.moduleSize(t,e),s=t[1],u=i[1],g=t[0],B=i[0];if(g>=B||s>=u)throw new ve;if(u-s!==B-g&&(B=g+(u-s),B>=e.getWidth()))throw new ve;var _=Math.round((B-g+1)/o),m=Math.round((u-s+1)/o);if(_<=0||m<=0)throw new ve;if(m!==_)throw new ve;var D=Math.floor(o/2);s+=D,g+=D;var F=g+Math.floor((_-1)*o)-B;if(F>0){if(F>D)throw new ve;g-=F}var T=s+Math.floor((m-1)*o)-u;if(T>0){if(T>D)throw new ve;s-=T}for(var I=new dr(_,m),k=0;k<m;k++)for(var U=s+Math.floor(k*o),K=0;K<_;K++)e.get(g+Math.floor(K*o),U)&&I.set(K,k);return I},r.moduleSize=function(e,t){for(var i=t.getHeight(),o=t.getWidth(),s=e[0],u=e[1],g=!0,B=0;s<o&&u<i;){if(g!==t.get(s,u)){if(++B===5)break;g=!g}s++,u++}if(s===o||u===i)throw new ve;return(s-e[0])/7},r.NO_POINTS=new Array,r}(),Ih=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Xe=function(){function r(){}return r.prototype.PDF417Common=function(){},r.getBitCountSum=function(e){return Ye.sum(e)},r.toIntArray=function(e){var t,i;if(e==null||!e.length)return r.EMPTY_INT_ARRAY;var o=new Int32Array(e.length),s=0;try{for(var u=Ih(e),g=u.next();!g.done;g=u.next()){var B=g.value;o[s++]=B}}catch(_){t={error:_}}finally{try{g&&!g.done&&(i=u.return)&&i.call(u)}finally{if(t)throw t.error}}return o},r.getCodeword=function(e){var t=vt.binarySearch(r.SYMBOL_TABLE,e&262143);return t<0?-1:(r.CODEWORD_TABLE[t]-1)%r.NUMBER_OF_CODEWORDS},r.NUMBER_OF_CODEWORDS=929,r.MAX_CODEWORDS_IN_BARCODE=r.NUMBER_OF_CODEWORDS-1,r.MIN_ROWS_IN_BARCODE=3,r.MAX_ROWS_IN_BARCODE=90,r.MODULES_IN_CODEWORD=17,r.MODULES_IN_STOP_PATTERN=18,r.BARS_IN_MODULE=8,r.EMPTY_INT_ARRAY=new Int32Array([]),r.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),r.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),r}(),Rh=function(){function r(e,t){this.bits=e,this.points=t}return r.prototype.getBits=function(){return this.bits},r.prototype.getPoints=function(){return this.points},r}(),Ph=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Mh=function(){function r(){}return r.detectMultiple=function(e,t,i){var o=e.getBlackMatrix(),s=r.detect(i,o);return s.length||(o=o.clone(),o.rotate180(),s=r.detect(i,o)),new Rh(o,s)},r.detect=function(e,t){for(var i,o,s=new Array,u=0,g=0,B=!1;u<t.getHeight();){var _=r.findVertices(t,u,g);if(_[0]==null&&_[3]==null){if(!B)break;B=!1,g=0;try{for(var m=(i=void 0,Ph(s)),D=m.next();!D.done;D=m.next()){var F=D.value;F[1]!=null&&(u=Math.trunc(Math.max(u,F[1].getY()))),F[3]!=null&&(u=Math.max(u,Math.trunc(F[3].getY())))}}catch(T){i={error:T}}finally{try{D&&!D.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}u+=r.ROW_STEP;continue}if(B=!0,s.push(_),!e)break;_[2]!=null?(g=Math.trunc(_[2].getX()),u=Math.trunc(_[2].getY())):(g=Math.trunc(_[4].getX()),u=Math.trunc(_[4].getY()))}return s},r.findVertices=function(e,t,i){var o=e.getHeight(),s=e.getWidth(),u=new Array(8);return r.copyToResult(u,r.findRowsWithPattern(e,o,s,t,i,r.START_PATTERN),r.INDEXES_START_PATTERN),u[4]!=null&&(i=Math.trunc(u[4].getX()),t=Math.trunc(u[4].getY())),r.copyToResult(u,r.findRowsWithPattern(e,o,s,t,i,r.STOP_PATTERN),r.INDEXES_STOP_PATTERN),u},r.copyToResult=function(e,t,i){for(var o=0;o<i.length;o++)e[i[o]]=t[o]},r.findRowsWithPattern=function(e,t,i,o,s,u){for(var g=new Array(4),B=!1,_=new Int32Array(u.length);o<t;o+=r.ROW_STEP){var m=r.findGuardPattern(e,s,o,i,!1,u,_);if(m!=null){for(;o>0;){var D=r.findGuardPattern(e,s,--o,i,!1,u,_);if(D!=null)m=D;else{o++;break}}g[0]=new Pe(m[0],o),g[1]=new Pe(m[1],o),B=!0;break}}var F=o+1;if(B){for(var T=0,D=Int32Array.from([Math.trunc(g[0].getX()),Math.trunc(g[1].getX())]);F<t;F++){var m=r.findGuardPattern(e,D[0],F,i,!1,u,_);if(m!=null&&Math.abs(D[0]-m[0])<r.MAX_PATTERN_DRIFT&&Math.abs(D[1]-m[1])<r.MAX_PATTERN_DRIFT)D=m,T=0;else{if(T>r.SKIPPED_ROW_COUNT_MAX)break;T++}}F-=T+1,g[2]=new Pe(D[0],F),g[3]=new Pe(D[1],F)}return F-o<r.BARCODE_MIN_HEIGHT&&vt.fill(g,null),g},r.findGuardPattern=function(e,t,i,o,s,u,g){vt.fillWithin(g,0,g.length,0);for(var B=t,_=0;e.get(B,i)&&B>0&&_++<r.MAX_PIXEL_DRIFT;)B--;for(var m=B,D=0,F=u.length,T=s;m<o;m++){var I=e.get(m,i);if(I!==T)g[D]++;else{if(D===F-1){if(r.patternMatchVariance(g,u,r.MAX_INDIVIDUAL_VARIANCE)<r.MAX_AVG_VARIANCE)return new Int32Array([B,m]);B+=g[0]+g[1],nt.arraycopy(g,2,g,0,D-1),g[D-1]=0,g[D]=0,D--}else D++;g[D]=1,T=!T}}return D===F-1&&r.patternMatchVariance(g,u,r.MAX_INDIVIDUAL_VARIANCE)<r.MAX_AVG_VARIANCE?new Int32Array([B,m-1]):null},r.patternMatchVariance=function(e,t,i){for(var o=e.length,s=0,u=0,g=0;g<o;g++)s+=e[g],u+=t[g];if(s<u)return 1/0;var B=s/u;i*=B;for(var _=0,m=0;m<o;m++){var D=e[m],F=t[m]*B,T=D>F?D-F:F-D;if(T>i)return 1/0;_+=T}return _/s},r.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),r.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),r.MAX_AVG_VARIANCE=.42,r.MAX_INDIVIDUAL_VARIANCE=.8,r.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),r.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),r.MAX_PIXEL_DRIFT=3,r.MAX_PATTERN_DRIFT=5,r.SKIPPED_ROW_COUNT_MAX=25,r.ROW_STEP=5,r.BARCODE_MIN_HEIGHT=10,r}(),Lh=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Or=function(){function r(e,t){if(t.length===0)throw new Ue;this.field=e;var i=t.length;if(i>1&&t[0]===0){for(var o=1;o<i&&t[o]===0;)o++;o===i?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(i-o),nt.arraycopy(t,o,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return r.prototype.getCoefficients=function(){return this.coefficients},r.prototype.getDegree=function(){return this.coefficients.length-1},r.prototype.isZero=function(){return this.coefficients[0]===0},r.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},r.prototype.evaluateAt=function(e){var t,i;if(e===0)return this.getCoefficient(0);if(e===1){var o=0;try{for(var s=Lh(this.coefficients),u=s.next();!u.done;u=s.next()){var g=u.value;o=this.field.add(o,g)}}catch(D){t={error:D}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return o}for(var B=this.coefficients[0],_=this.coefficients.length,m=1;m<_;m++)B=this.field.add(this.field.multiply(e,B),this.coefficients[m]);return B},r.prototype.add=function(e){if(!this.field.equals(e.field))throw new Ue("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var t=this.coefficients,i=e.coefficients;if(t.length>i.length){var o=t;t=i,i=o}var s=new Int32Array(i.length),u=i.length-t.length;nt.arraycopy(i,0,s,0,u);for(var g=u;g<i.length;g++)s[g]=this.field.add(t[g-u],i[g]);return new r(this.field,s)},r.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new Ue("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},r.prototype.multiply=function(e){return e instanceof r?this.multiplyOther(e):this.multiplyScalar(e)},r.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new Ue("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new r(this.field,new Int32Array([0]));for(var t=this.coefficients,i=t.length,o=e.coefficients,s=o.length,u=new Int32Array(i+s-1),g=0;g<i;g++)for(var B=t[g],_=0;_<s;_++)u[g+_]=this.field.add(u[g+_],this.field.multiply(B,o[_]));return new r(this.field,u)},r.prototype.negative=function(){for(var e=this.coefficients.length,t=new Int32Array(e),i=0;i<e;i++)t[i]=this.field.subtract(0,this.coefficients[i]);return new r(this.field,t)},r.prototype.multiplyScalar=function(e){if(e===0)return new r(this.field,new Int32Array([0]));if(e===1)return this;for(var t=this.coefficients.length,i=new Int32Array(t),o=0;o<t;o++)i[o]=this.field.multiply(this.coefficients[o],e);return new r(this.field,i)},r.prototype.multiplyByMonomial=function(e,t){if(e<0)throw new Ue;if(t===0)return new r(this.field,new Int32Array([0]));for(var i=this.coefficients.length,o=new Int32Array(i+e),s=0;s<i;s++)o[s]=this.field.multiply(this.coefficients[s],t);return new r(this.field,o)},r.prototype.toString=function(){for(var e=new Ge,t=this.getDegree();t>=0;t--){var i=this.getCoefficient(t);i!==0&&(i<0?(e.append(" - "),i=-i):e.length()>0&&e.append(" + "),(t===0||i!==1)&&e.append(i),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()},r}(),kh=function(){function r(){}return r.prototype.add=function(e,t){return(e+t)%this.modulus},r.prototype.subtract=function(e,t){return(this.modulus+e-t)%this.modulus},r.prototype.exp=function(e){return this.expTable[e]},r.prototype.log=function(e){if(e===0)throw new Ue;return this.logTable[e]},r.prototype.inverse=function(e){if(e===0)throw new W0;return this.expTable[this.modulus-this.logTable[e]-1]},r.prototype.multiply=function(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]},r.prototype.getSize=function(){return this.modulus},r.prototype.equals=function(e){return e===this},r}(),Nh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jh=function(r){Nh(e,r);function e(t,i){var o=r.call(this)||this;o.modulus=t,o.expTable=new Int32Array(t),o.logTable=new Int32Array(t);for(var s=1,u=0;u<t;u++)o.expTable[u]=s,s=s*i%t;for(var u=0;u<t-1;u++)o.logTable[o.expTable[u]]=u;return o.zero=new Or(o,new Int32Array([0])),o.one=new Or(o,new Int32Array([1])),o}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(t,i){if(t<0)throw new Ue;if(i===0)return this.zero;var o=new Int32Array(t+1);return o[0]=i,new Or(this,o)},e.PDF417_GF=new e(Xe.NUMBER_OF_CODEWORDS,3),e}(kh),Uh=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Vh=function(){function r(){this.field=jh.PDF417_GF}return r.prototype.decode=function(e,t,i){for(var o,s,u=new Or(this.field,e),g=new Int32Array(t),B=!1,_=t;_>0;_--){var m=u.evaluateAt(this.field.exp(_));g[t-_]=m,m!==0&&(B=!0)}if(!B)return 0;var D=this.field.getOne();if(i!=null)try{for(var F=Uh(i),T=F.next();!T.done;T=F.next()){var I=T.value,k=this.field.exp(e.length-1-I),U=new Or(this.field,new Int32Array([this.field.subtract(0,k),1]));D=D.multiply(U)}}catch(v){o={error:v}}finally{try{T&&!T.done&&(s=F.return)&&s.call(F)}finally{if(o)throw o.error}}for(var K=new Or(this.field,g),X=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),K,t),te=X[0],ne=X[1],re=this.findErrorLocations(te),ue=this.findErrorMagnitudes(ne,te,re),_=0;_<re.length;_++){var Ae=e.length-1-this.field.log(re[_]);if(Ae<0)throw Dt.getChecksumInstance();e[Ae]=this.field.subtract(e[Ae],ue[_])}return re.length},r.prototype.runEuclideanAlgorithm=function(e,t,i){if(e.getDegree()<t.getDegree()){var o=e;e=t,t=o}for(var s=e,u=t,g=this.field.getZero(),B=this.field.getOne();u.getDegree()>=Math.round(i/2);){var _=s,m=g;if(s=u,g=B,s.isZero())throw Dt.getChecksumInstance();u=_;for(var D=this.field.getZero(),F=s.getCoefficient(s.getDegree()),T=this.field.inverse(F);u.getDegree()>=s.getDegree()&&!u.isZero();){var I=u.getDegree()-s.getDegree(),k=this.field.multiply(u.getCoefficient(u.getDegree()),T);D=D.add(this.field.buildMonomial(I,k)),u=u.subtract(s.multiplyByMonomial(I,k))}B=D.multiply(g).subtract(m).negative()}var U=B.getCoefficient(0);if(U===0)throw Dt.getChecksumInstance();var K=this.field.inverse(U),X=B.multiply(K),te=u.multiply(K);return[X,te]},r.prototype.findErrorLocations=function(e){for(var t=e.getDegree(),i=new Int32Array(t),o=0,s=1;s<this.field.getSize()&&o<t;s++)e.evaluateAt(s)===0&&(i[o]=this.field.inverse(s),o++);if(o!==t)throw Dt.getChecksumInstance();return i},r.prototype.findErrorMagnitudes=function(e,t,i){for(var o=t.getDegree(),s=new Int32Array(o),u=1;u<=o;u++)s[o-u]=this.field.multiply(u,t.getCoefficient(u));for(var g=new Or(this.field,s),B=i.length,_=new Int32Array(B),u=0;u<B;u++){var m=this.field.inverse(i[u]),D=this.field.subtract(0,e.evaluateAt(m)),F=this.field.inverse(g.evaluateAt(m));_[u]=this.field.multiply(D,F)}return _},r}(),mn=function(){function r(e,t,i,o,s){e instanceof r?this.constructor_2(e):this.constructor_1(e,t,i,o,s)}return r.prototype.constructor_1=function(e,t,i,o,s){var u=t==null||i==null,g=o==null||s==null;if(u&&g)throw new ve;u?(t=new Pe(0,o.getY()),i=new Pe(0,s.getY())):g&&(o=new Pe(e.getWidth()-1,t.getY()),s=new Pe(e.getWidth()-1,i.getY())),this.image=e,this.topLeft=t,this.bottomLeft=i,this.topRight=o,this.bottomRight=s,this.minX=Math.trunc(Math.min(t.getX(),i.getX())),this.maxX=Math.trunc(Math.max(o.getX(),s.getX())),this.minY=Math.trunc(Math.min(t.getY(),o.getY())),this.maxY=Math.trunc(Math.max(i.getY(),s.getY()))},r.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},r.merge=function(e,t){return e==null?t:t==null?e:new r(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)},r.prototype.addMissingRows=function(e,t,i){var o=this.topLeft,s=this.bottomLeft,u=this.topRight,g=this.bottomRight;if(e>0){var B=i?this.topLeft:this.topRight,_=Math.trunc(B.getY()-e);_<0&&(_=0);var m=new Pe(B.getX(),_);i?o=m:u=m}if(t>0){var D=i?this.bottomLeft:this.bottomRight,F=Math.trunc(D.getY()+t);F>=this.image.getHeight()&&(F=this.image.getHeight()-1);var T=new Pe(D.getX(),F);i?s=T:g=T}return new r(this.image,o,s,u,g)},r.prototype.getMinX=function(){return this.minX},r.prototype.getMaxX=function(){return this.maxX},r.prototype.getMinY=function(){return this.minY},r.prototype.getMaxY=function(){return this.maxY},r.prototype.getTopLeft=function(){return this.topLeft},r.prototype.getTopRight=function(){return this.topRight},r.prototype.getBottomLeft=function(){return this.bottomLeft},r.prototype.getBottomRight=function(){return this.bottomRight},r}(),Gh=function(){function r(e,t,i,o){this.columnCount=e,this.errorCorrectionLevel=o,this.rowCountUpperPart=t,this.rowCountLowerPart=i,this.rowCount=t+i}return r.prototype.getColumnCount=function(){return this.columnCount},r.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},r.prototype.getRowCount=function(){return this.rowCount},r.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},r.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},r}(),Gn=function(){function r(){this.buffer=""}return r.form=function(e,t){var i=-1;function o(u,g,B,_,m,D){if(u==="%%")return"%";if(t[++i]!==void 0){u=_?parseInt(_.substr(1)):void 0;var F=m?parseInt(m.substr(1)):void 0,T;switch(D){case"s":T=t[i];break;case"c":T=t[i][0];break;case"f":T=parseFloat(t[i]).toFixed(u);break;case"p":T=parseFloat(t[i]).toPrecision(u);break;case"e":T=parseFloat(t[i]).toExponential(u);break;case"x":T=parseInt(t[i]).toString(F||16);break;case"d":T=parseFloat(parseInt(t[i],F||10).toPrecision(u)).toFixed(0);break}T=typeof T=="object"?JSON.stringify(T):(+T).toString(F);for(var I=parseInt(B),k=B&&B[0]+""=="0"?"0":" ";T.length<I;)T=g!==void 0?T+k:k+T;return T}}var s=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(s,o)},r.prototype.format=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.buffer+=r.form(e,t)},r.prototype.toString=function(){return this.buffer},r}(),Wh=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Z0=function(){function r(e){this.boundingBox=new mn(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return r.prototype.getCodewordNearby=function(e){var t=this.getCodeword(e);if(t!=null)return t;for(var i=1;i<r.MAX_NEARBY_DISTANCE;i++){var o=this.imageRowToCodewordIndex(e)-i;if(o>=0&&(t=this.codewords[o],t!=null)||(o=this.imageRowToCodewordIndex(e)+i,o<this.codewords.length&&(t=this.codewords[o],t!=null)))return t}return null},r.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},r.prototype.setCodeword=function(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t},r.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},r.prototype.getBoundingBox=function(){return this.boundingBox},r.prototype.getCodewords=function(){return this.codewords},r.prototype.toString=function(){var e,t,i=new Gn,o=0;try{for(var s=Wh(this.codewords),u=s.next();!u.done;u=s.next()){var g=u.value;if(g==null){i.format("%3d:    |   %n",o++);continue}i.format("%3d: %3d|%3d%n",o++,g.getRowNumber(),g.getValue())}}catch(B){e={error:B}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return i.toString()},r.MAX_NEARBY_DISTANCE=5,r}(),Hh=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Xh=globalThis&&globalThis.__read||function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),o,s=[],u;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(g){u={error:g}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(u)throw u.error}}return s},ri=function(){function r(){this.values=new Map}return r.prototype.setValue=function(e){e=Math.trunc(e);var t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)},r.prototype.getValue=function(){var e,t,i=-1,o=new Array,s=function(D,F){var T={getKey:function(){return D},getValue:function(){return F}};T.getValue()>i?(i=T.getValue(),o=[],o.push(T.getKey())):T.getValue()===i&&o.push(T.getKey())};try{for(var u=Hh(this.values.entries()),g=u.next();!g.done;g=u.next()){var B=Xh(g.value,2),_=B[0],m=B[1];s(_,m)}}catch(D){e={error:D}}finally{try{g&&!g.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}return Xe.toIntArray(o)},r.prototype.getConfidence=function(e){return this.values.get(e)},r}(),Yh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),sn=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r0=function(r){Yh(e,r);function e(t,i){var o=r.call(this,t)||this;return o._isLeft=i,o}return e.prototype.setRowNumbers=function(){var t,i;try{for(var o=sn(this.getCodewords()),s=o.next();!s.done;s=o.next()){var u=s.value;u!=null&&u.setRowNumberAsRowIndicatorColumn()}}catch(g){t={error:g}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(t){var i=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(i,t);for(var o=this.getBoundingBox(),s=this._isLeft?o.getTopLeft():o.getTopRight(),u=this._isLeft?o.getBottomLeft():o.getBottomRight(),g=this.imageRowToCodewordIndex(Math.trunc(s.getY())),B=this.imageRowToCodewordIndex(Math.trunc(u.getY())),_=-1,m=1,D=0,F=g;F<B;F++)if(i[F]!=null){var T=i[F],I=T.getRowNumber()-_;if(I===0)D++;else if(I===1)m=Math.max(m,D),D=1,_=T.getRowNumber();else if(I<0||T.getRowNumber()>=t.getRowCount()||I>F)i[F]=null;else{var k=void 0;m>2?k=(m-2)*I:k=I;for(var U=k>=F,K=1;K<=k&&!U;K++)U=i[F-K]!=null;U?i[F]=null:(_=T.getRowNumber(),D=1)}}},e.prototype.getRowHeights=function(){var t,i,o=this.getBarcodeMetadata();if(o==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(o);var s=new Int32Array(o.getRowCount());try{for(var u=sn(this.getCodewords()),g=u.next();!g.done;g=u.next()){var B=g.value;if(B!=null){var _=B.getRowNumber();if(_>=s.length)continue;s[_]++}}}catch(m){t={error:m}}finally{try{g&&!g.done&&(i=u.return)&&i.call(u)}finally{if(t)throw t.error}}return s},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(t){for(var i=this.getBoundingBox(),o=this._isLeft?i.getTopLeft():i.getTopRight(),s=this._isLeft?i.getBottomLeft():i.getBottomRight(),u=this.imageRowToCodewordIndex(Math.trunc(o.getY())),g=this.imageRowToCodewordIndex(Math.trunc(s.getY())),B=this.getCodewords(),_=-1,m=u;m<g;m++)if(B[m]!=null){var D=B[m];D.setRowNumberAsRowIndicatorColumn();var F=D.getRowNumber()-_;F===0||(F===1?_=D.getRowNumber():D.getRowNumber()>=t.getRowCount()?B[m]=null:_=D.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var t,i,o=this.getCodewords(),s=new ri,u=new ri,g=new ri,B=new ri;try{for(var _=sn(o),m=_.next();!m.done;m=_.next()){var D=m.value;if(D!=null){D.setRowNumberAsRowIndicatorColumn();var F=D.getValue()%30,T=D.getRowNumber();switch(this._isLeft||(T+=2),T%3){case 0:u.setValue(F*3+1);break;case 1:B.setValue(F/3),g.setValue(F%3);break;case 2:s.setValue(F+1);break}}}}catch(k){t={error:k}}finally{try{m&&!m.done&&(i=_.return)&&i.call(_)}finally{if(t)throw t.error}}if(s.getValue().length===0||u.getValue().length===0||g.getValue().length===0||B.getValue().length===0||s.getValue()[0]<1||u.getValue()[0]+g.getValue()[0]<Xe.MIN_ROWS_IN_BARCODE||u.getValue()[0]+g.getValue()[0]>Xe.MAX_ROWS_IN_BARCODE)return null;var I=new Gh(s.getValue()[0],u.getValue()[0],g.getValue()[0],B.getValue()[0]);return this.removeIncorrectCodewords(o,I),I},e.prototype.removeIncorrectCodewords=function(t,i){for(var o=0;o<t.length;o++){var s=t[o];if(t[o]!=null){var u=s.getValue()%30,g=s.getRowNumber();if(g>i.getRowCount()){t[o]=null;continue}switch(this._isLeft||(g+=2),g%3){case 0:u*3+1!==i.getRowCountUpperPart()&&(t[o]=null);break;case 1:(Math.trunc(u/3)!==i.getErrorCorrectionLevel()||u%3!==i.getRowCountLowerPart())&&(t[o]=null);break;case 2:u+1!==i.getColumnCount()&&(t[o]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+r.prototype.toString.call(this)},e}(Z0),zh=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Kh=function(){function r(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return r.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=Xe.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns},r.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},r.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var t=1;t<this.barcodeColumnCount+1;t++)for(var i=this.detectionResultColumns[t].getCodewords(),o=0;o<i.length;o++)i[o]!=null&&(i[o].hasValidRowNumber()||this.adjustRowNumbers(t,o,i));return e},r.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},r.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),i=0;i<e.length;i++)if(e[i]!=null&&t[i]!=null&&e[i].getRowNumber()===t[i].getRowNumber())for(var o=1;o<=this.barcodeColumnCount;o++){var s=this.detectionResultColumns[o].getCodewords()[i];s!=null&&(s.setRowNumber(e[i].getRowNumber()),s.hasValidRowNumber()||(this.detectionResultColumns[o].getCodewords()[i]=null))}}},r.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),i=0;i<t.length;i++)if(t[i]!=null)for(var o=t[i].getRowNumber(),s=0,u=this.barcodeColumnCount+1;u>0&&s<this.ADJUST_ROW_NUMBER_SKIP;u--){var g=this.detectionResultColumns[u].getCodewords()[i];g!=null&&(s=r.adjustRowNumberIfValid(o,s,g),g.hasValidRowNumber()||e++)}return e},r.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,t=this.detectionResultColumns[0].getCodewords(),i=0;i<t.length;i++)if(t[i]!=null)for(var o=t[i].getRowNumber(),s=0,u=1;u<this.barcodeColumnCount+1&&s<this.ADJUST_ROW_NUMBER_SKIP;u++){var g=this.detectionResultColumns[u].getCodewords()[i];g!=null&&(s=r.adjustRowNumberIfValid(o,s,g),g.hasValidRowNumber()||e++)}return e},r.adjustRowNumberIfValid=function(e,t,i){return i==null||i.hasValidRowNumber()||(i.isValidRowNumber(e)?(i.setRowNumber(e),t=0):++t),t},r.prototype.adjustRowNumbers=function(e,t,i){var o,s;if(this.detectionResultColumns[e-1]!=null){var u=i[t],g=this.detectionResultColumns[e-1].getCodewords(),B=g;this.detectionResultColumns[e+1]!=null&&(B=this.detectionResultColumns[e+1].getCodewords());var _=new Array(14);_[2]=g[t],_[3]=B[t],t>0&&(_[0]=i[t-1],_[4]=g[t-1],_[5]=B[t-1]),t>1&&(_[8]=i[t-2],_[10]=g[t-2],_[11]=B[t-2]),t<i.length-1&&(_[1]=i[t+1],_[6]=g[t+1],_[7]=B[t+1]),t<i.length-2&&(_[9]=i[t+2],_[12]=g[t+2],_[13]=B[t+2]);try{for(var m=zh(_),D=m.next();!D.done;D=m.next()){var F=D.value;if(r.adjustRowNumber(u,F))return}}catch(T){o={error:T}}finally{try{D&&!D.done&&(s=m.return)&&s.call(m)}finally{if(o)throw o.error}}}},r.adjustRowNumber=function(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1},r.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},r.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},r.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},r.prototype.setBoundingBox=function(e){this.boundingBox=e},r.prototype.getBoundingBox=function(){return this.boundingBox},r.prototype.setDetectionResultColumn=function(e,t){this.detectionResultColumns[e]=t},r.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},r.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var t=new Gn,i=0;i<e.getCodewords().length;i++){t.format("CW %3d:",i);for(var o=0;o<this.barcodeColumnCount+2;o++){if(this.detectionResultColumns[o]==null){t.format("    |   ");continue}var s=this.detectionResultColumns[o].getCodewords()[i];if(s==null){t.format("    |   ");continue}t.format(" %3d|%3d",s.getRowNumber(),s.getValue())}t.format("%n")}return t.toString()},r}(),Jh=function(){function r(e,t,i,o){this.rowNumber=r.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(i),this.value=Math.trunc(o)}return r.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},r.prototype.isValidRowNumber=function(e){return e!==r.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},r.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},r.prototype.getWidth=function(){return this.endX-this.startX},r.prototype.getStartX=function(){return this.startX},r.prototype.getEndX=function(){return this.endX},r.prototype.getBucket=function(){return this.bucket},r.prototype.getValue=function(){return this.value},r.prototype.getRowNumber=function(){return this.rowNumber},r.prototype.setRowNumber=function(e){this.rowNumber=e},r.prototype.toString=function(){return this.rowNumber+"|"+this.value},r.BARCODE_ROW_UNKNOWN=-1,r}(),qh=function(){function r(){}return r.initialize=function(){for(var e=0;e<Xe.SYMBOL_TABLE.length;e++)for(var t=Xe.SYMBOL_TABLE[e],i=t&1,o=0;o<Xe.BARS_IN_MODULE;o++){for(var s=0;(t&1)===i;)s+=1,t>>=1;i=t&1,r.RATIOS_TABLE[e]||(r.RATIOS_TABLE[e]=new Array(Xe.BARS_IN_MODULE)),r.RATIOS_TABLE[e][Xe.BARS_IN_MODULE-o-1]=Math.fround(s/Xe.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},r.getDecodedValue=function(e){var t=r.getDecodedCodewordValue(r.sampleBitCounts(e));return t!==-1?t:r.getClosestDecodedValue(e)},r.sampleBitCounts=function(e){for(var t=Ye.sum(e),i=new Int32Array(Xe.BARS_IN_MODULE),o=0,s=0,u=0;u<Xe.MODULES_IN_CODEWORD;u++){var g=t/(2*Xe.MODULES_IN_CODEWORD)+u*t/Xe.MODULES_IN_CODEWORD;s+e[o]<=g&&(s+=e[o],o++),i[o]++}return i},r.getDecodedCodewordValue=function(e){var t=r.getBitValue(e);return Xe.getCodeword(t)===-1?-1:t},r.getBitValue=function(e){for(var t=0,i=0;i<e.length;i++)for(var o=0;o<e[i];o++)t=t<<1|(i%2===0?1:0);return Math.trunc(t)},r.getClosestDecodedValue=function(e){var t=Ye.sum(e),i=new Array(Xe.BARS_IN_MODULE);if(t>1)for(var o=0;o<i.length;o++)i[o]=Math.fround(e[o]/t);var s=An.MAX_VALUE,u=-1;this.bSymbolTableReady||r.initialize();for(var g=0;g<r.RATIOS_TABLE.length;g++){for(var B=0,_=r.RATIOS_TABLE[g],m=0;m<Xe.BARS_IN_MODULE;m++){var D=Math.fround(_[m]-i[m]);if(B+=Math.fround(D*D),B>=s)break}B<s&&(s=B,u=Xe.SYMBOL_TABLE[g])}return u},r.bSymbolTableReady=!1,r.RATIOS_TABLE=new Array(Xe.SYMBOL_TABLE.length).map(function(e){return new Array(Xe.BARS_IN_MODULE)}),r}(),Zh=function(){function r(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return r.prototype.getSegmentIndex=function(){return this.segmentIndex},r.prototype.setSegmentIndex=function(e){this.segmentIndex=e},r.prototype.getFileId=function(){return this.fileId},r.prototype.setFileId=function(e){this.fileId=e},r.prototype.getOptionalData=function(){return this.optionalData},r.prototype.setOptionalData=function(e){this.optionalData=e},r.prototype.isLastSegment=function(){return this.lastSegment},r.prototype.setLastSegment=function(e){this.lastSegment=e},r.prototype.getSegmentCount=function(){return this.segmentCount},r.prototype.setSegmentCount=function(e){this.segmentCount=e},r.prototype.getSender=function(){return this.sender||null},r.prototype.setSender=function(e){this.sender=e},r.prototype.getAddressee=function(){return this.addressee||null},r.prototype.setAddressee=function(e){this.addressee=e},r.prototype.getFileName=function(){return this.fileName},r.prototype.setFileName=function(e){this.fileName=e},r.prototype.getFileSize=function(){return this.fileSize},r.prototype.setFileSize=function(e){this.fileSize=e},r.prototype.getChecksum=function(){return this.checksum},r.prototype.setChecksum=function(e){this.checksum=e},r.prototype.getTimestamp=function(){return this.timestamp},r.prototype.setTimestamp=function(e){this.timestamp=e},r}(),i0=function(){function r(){}return r.parseLong=function(e,t){return t===void 0&&(t=void 0),parseInt(e,t)},r}(),Qh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$h=function(r){Qh(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="NullPointerException",e}(Xt),ec=function(){function r(){}return r.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},r.prototype.writeBytesOffset=function(e,t,i){if(e==null)throw new $h;if(t<0||t>e.length||i<0||t+i>e.length||t+i<0)throw new kn;if(i===0)return;for(var o=0;o<i;o++)this.write(e[t+o])},r.prototype.flush=function(){},r.prototype.close=function(){},r}(),tc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),rc=function(r){tc(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(Xt),ic=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),nc=function(r){ic(e,r);function e(t){t===void 0&&(t=32);var i=r.call(this)||this;if(i.count=0,t<0)throw new Ue("Negative initial size: "+t);return i.buf=new Uint8Array(t),i}return e.prototype.ensureCapacity=function(t){t-this.buf.length>0&&this.grow(t)},e.prototype.grow=function(t){var i=this.buf.length,o=i<<1;if(o-t<0&&(o=t),o<0){if(t<0)throw new rc;o=ut.MAX_VALUE}this.buf=vt.copyOfUint8Array(this.buf,o)},e.prototype.write=function(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1},e.prototype.writeBytesOffset=function(t,i,o){if(i<0||i>t.length||o<0||i+o-t.length>0)throw new kn;this.ensureCapacity(this.count+o),nt.arraycopy(t,i,this.buf,this.count,o),this.count+=o},e.prototype.writeTo=function(t){t.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return vt.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(t){return t?typeof t=="string"?this.toString_string(t):this.toString_number(t):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(t){return new String(this.buf).toString()},e.prototype.toString_number=function(t){return new String(this.buf).toString()},e.prototype.close=function(){},e}(ec),et;(function(r){r[r.ALPHA=0]="ALPHA",r[r.LOWER=1]="LOWER",r[r.MIXED=2]="MIXED",r[r.PUNCT=3]="PUNCT",r[r.ALPHA_SHIFT=4]="ALPHA_SHIFT",r[r.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(et||(et={}));function Q0(){if(typeof window!="undefined")return window.BigInt||null;if(typeof global!="undefined")return global.BigInt||null;if(typeof self!="undefined")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var Di;function Br(r){if(typeof Di=="undefined"&&(Di=Q0()),Di===null)throw new Error("BigInt is not supported!");return Di(r)}function oc(){var r=[];r[0]=Br(1);var e=Br(900);r[1]=e;for(var t=2;t<16;t++)r[t]=r[t-1]*e;return r}var ac=function(){function r(){}return r.decode=function(e,t){var i=new Ge(""),o=Bt.ISO8859_1;i.enableDecoding(o);for(var s=1,u=e[s++],g=new Zh;s<e[0];){switch(u){case r.TEXT_COMPACTION_MODE_LATCH:s=r.textCompaction(e,s,i);break;case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:s=r.byteCompaction(u,e,o,s,i);break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(e[s++]);break;case r.NUMERIC_COMPACTION_MODE_LATCH:s=r.numericCompaction(e,s,i);break;case r.ECI_CHARSET:Bt.getCharacterSetECIByValue(e[s++]);break;case r.ECI_GENERAL_PURPOSE:s+=2;break;case r.ECI_USER_DEFINED:s++;break;case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:s=r.decodeMacroBlock(e,s,g);break;case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:throw new Ie;default:s--,s=r.textCompaction(e,s,i);break}if(s<e.length)u=e[s++];else throw Ie.getFormatInstance()}if(i.length()===0)throw Ie.getFormatInstance();var B=new Ji(null,i.toString(),null,t);return B.setOther(g),B},r.decodeMacroBlock=function(e,t,i){if(t+r.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw Ie.getFormatInstance();for(var o=new Int32Array(r.NUMBER_OF_SEQUENCE_CODEWORDS),s=0;s<r.NUMBER_OF_SEQUENCE_CODEWORDS;s++,t++)o[s]=e[t];i.setSegmentIndex(ut.parseInt(r.decodeBase900toBase10(o,r.NUMBER_OF_SEQUENCE_CODEWORDS)));var u=new Ge;t=r.textCompaction(e,t,u),i.setFileId(u.toString());var g=-1;for(e[t]===r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(g=t+1);t<e[0];)switch(e[t]){case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case r.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var B=new Ge;t=r.textCompaction(e,t+1,B),i.setFileName(B.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var _=new Ge;t=r.textCompaction(e,t+1,_),i.setSender(_.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var m=new Ge;t=r.textCompaction(e,t+1,m),i.setAddressee(m.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var D=new Ge;t=r.numericCompaction(e,t+1,D),i.setSegmentCount(ut.parseInt(D.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var F=new Ge;t=r.numericCompaction(e,t+1,F),i.setTimestamp(i0.parseLong(F.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var T=new Ge;t=r.numericCompaction(e,t+1,T),i.setChecksum(ut.parseInt(T.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var I=new Ge;t=r.numericCompaction(e,t+1,I),i.setFileSize(i0.parseLong(I.toString()));break;default:throw Ie.getFormatInstance()}break;case r.MACRO_PDF417_TERMINATOR:t++,i.setLastSegment(!0);break;default:throw Ie.getFormatInstance()}if(g!==-1){var k=t-g;i.isLastSegment()&&k--,i.setOptionalData(vt.copyOfRange(e,g,g+k))}return t},r.textCompaction=function(e,t,i){for(var o=new Int32Array((e[0]-t)*2),s=new Int32Array((e[0]-t)*2),u=0,g=!1;t<e[0]&&!g;){var B=e[t++];if(B<r.TEXT_COMPACTION_MODE_LATCH)o[u]=B/30,o[u+1]=B%30,u+=2;else switch(B){case r.TEXT_COMPACTION_MODE_LATCH:o[u++]=r.TEXT_COMPACTION_MODE_LATCH;break;case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:t--,g=!0;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o[u]=r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,B=e[t++],s[u]=B,u++;break}}return r.decodeTextCompaction(o,s,u,i),t},r.decodeTextCompaction=function(e,t,i,o){for(var s=et.ALPHA,u=et.ALPHA,g=0;g<i;){var B=e[g],_="";switch(s){case et.ALPHA:if(B<26)_=String.fromCharCode(65+B);else switch(B){case 26:_=" ";break;case r.LL:s=et.LOWER;break;case r.ML:s=et.MIXED;break;case r.PS:u=s,s=et.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(t[g]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=et.ALPHA;break}break;case et.LOWER:if(B<26)_=String.fromCharCode(97+B);else switch(B){case 26:_=" ";break;case r.AS:u=s,s=et.ALPHA_SHIFT;break;case r.ML:s=et.MIXED;break;case r.PS:u=s,s=et.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(t[g]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=et.ALPHA;break}break;case et.MIXED:if(B<r.PL)_=r.MIXED_CHARS[B];else switch(B){case r.PL:s=et.PUNCT;break;case 26:_=" ";break;case r.LL:s=et.LOWER;break;case r.AL:s=et.ALPHA;break;case r.PS:u=s,s=et.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(t[g]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=et.ALPHA;break}break;case et.PUNCT:if(B<r.PAL)_=r.PUNCT_CHARS[B];else switch(B){case r.PAL:s=et.ALPHA;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(t[g]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=et.ALPHA;break}break;case et.ALPHA_SHIFT:if(s=u,B<26)_=String.fromCharCode(65+B);else switch(B){case 26:_=" ";break;case r.TEXT_COMPACTION_MODE_LATCH:s=et.ALPHA;break}break;case et.PUNCT_SHIFT:if(s=u,B<r.PAL)_=r.PUNCT_CHARS[B];else switch(B){case r.PAL:s=et.ALPHA;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(t[g]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=et.ALPHA;break}break}_!==""&&o.append(_),g++}},r.byteCompaction=function(e,t,i,o,s){var u=new nc,g=0,B=0,_=!1;switch(e){case r.BYTE_COMPACTION_MODE_LATCH:for(var m=new Int32Array(6),D=t[o++];o<t[0]&&!_;)switch(m[g++]=D,B=900*B+D,D=t[o++],D){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:o--,_=!0;break;default:if(g%5===0&&g>0){for(var F=0;F<6;++F)u.write(Number(Br(B)>>Br(8*(5-F))));B=0,g=0}break}o===t[0]&&D<r.TEXT_COMPACTION_MODE_LATCH&&(m[g++]=D);for(var T=0;T<g;T++)u.write(m[T]);break;case r.BYTE_COMPACTION_MODE_LATCH_6:for(;o<t[0]&&!_;){var I=t[o++];if(I<r.TEXT_COMPACTION_MODE_LATCH)g++,B=900*B+I;else switch(I){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:o--,_=!0;break}if(g%5===0&&g>0){for(var F=0;F<6;++F)u.write(Number(Br(B)>>Br(8*(5-F))));B=0,g=0}}break}return s.append(tr.decode(u.toByteArray(),i)),o},r.numericCompaction=function(e,t,i){for(var o=0,s=!1,u=new Int32Array(r.MAX_NUMERIC_CODEWORDS);t<e[0]&&!s;){var g=e[t++];if(t===e[0]&&(s=!0),g<r.TEXT_COMPACTION_MODE_LATCH)u[o]=g,o++;else switch(g){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:t--,s=!0;break}(o%r.MAX_NUMERIC_CODEWORDS===0||g===r.NUMERIC_COMPACTION_MODE_LATCH||s)&&o>0&&(i.append(r.decodeBase900toBase10(u,o)),o=0)}return t},r.decodeBase900toBase10=function(e,t){for(var i=Br(0),o=0;o<t;o++)i+=r.EXP900[t-o-1]*Br(e[o]);var s=i.toString();if(s.charAt(0)!=="1")throw new Ie;return s.substring(1)},r.TEXT_COMPACTION_MODE_LATCH=900,r.BYTE_COMPACTION_MODE_LATCH=901,r.NUMERIC_COMPACTION_MODE_LATCH=902,r.BYTE_COMPACTION_MODE_LATCH_6=924,r.ECI_USER_DEFINED=925,r.ECI_GENERAL_PURPOSE=926,r.ECI_CHARSET=927,r.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,r.MACRO_PDF417_TERMINATOR=922,r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,r.MAX_NUMERIC_CODEWORDS=15,r.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,r.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,r.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,r.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,r.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,r.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,r.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,r.PL=25,r.LL=27,r.AS=27,r.ML=28,r.AL=28,r.PS=29,r.PAL=29,r.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,r.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",r.EXP900=Q0()?oc():[],r.NUMBER_OF_SEQUENCE_CODEWORDS=2,r}(),$r=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},sc=function(){function r(){}return r.decode=function(e,t,i,o,s,u,g){for(var B=new mn(e,t,i,o,s),_=null,m=null,D,F=!0;;F=!1){if(t!=null&&(_=r.getRowIndicatorColumn(e,B,t,!0,u,g)),o!=null&&(m=r.getRowIndicatorColumn(e,B,o,!1,u,g)),D=r.merge(_,m),D==null)throw ve.getNotFoundInstance();var T=D.getBoundingBox();if(F&&T!=null&&(T.getMinY()<B.getMinY()||T.getMaxY()>B.getMaxY()))B=T;else break}D.setBoundingBox(B);var I=D.getBarcodeColumnCount()+1;D.setDetectionResultColumn(0,_),D.setDetectionResultColumn(I,m);for(var k=_!=null,U=1;U<=I;U++){var K=k?U:I-U;if(D.getDetectionResultColumn(K)===void 0){var X=void 0;K===0||K===I?X=new r0(B,K===0):X=new Z0(B),D.setDetectionResultColumn(K,X);for(var te=-1,ne=te,re=B.getMinY();re<=B.getMaxY();re++){if(te=r.getStartColumn(D,K,re,k),te<0||te>B.getMaxX()){if(ne===-1)continue;te=ne}var ue=r.detectCodeword(e,B.getMinX(),B.getMaxX(),k,te,re,u,g);ue!=null&&(X.setCodeword(re,ue),ne=te,u=Math.min(u,ue.getWidth()),g=Math.max(g,ue.getWidth()))}}}return r.createDecoderResult(D)},r.merge=function(e,t){if(e==null&&t==null)return null;var i=r.getBarcodeMetadata(e,t);if(i==null)return null;var o=mn.merge(r.adjustBoundingBox(e),r.adjustBoundingBox(t));return new Kh(i,o)},r.adjustBoundingBox=function(e){var t,i;if(e==null)return null;var o=e.getRowHeights();if(o==null)return null;var s=r.getMax(o),u=0;try{for(var g=$r(o),B=g.next();!B.done;B=g.next()){var _=B.value;if(u+=s-_,_>0)break}}catch(T){t={error:T}}finally{try{B&&!B.done&&(i=g.return)&&i.call(g)}finally{if(t)throw t.error}}for(var m=e.getCodewords(),D=0;u>0&&m[D]==null;D++)u--;for(var F=0,D=o.length-1;D>=0&&(F+=s-o[D],!(o[D]>0));D--);for(var D=m.length-1;F>0&&m[D]==null;D--)F--;return e.getBoundingBox().addMissingRows(u,F,e.isLeft())},r.getMax=function(e){var t,i,o=-1;try{for(var s=$r(e),u=s.next();!u.done;u=s.next()){var g=u.value;o=Math.max(o,g)}}catch(B){t={error:B}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return o},r.getBarcodeMetadata=function(e,t){var i;if(e==null||(i=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();var o;return t==null||(o=t.getBarcodeMetadata())==null?i:i.getColumnCount()!==o.getColumnCount()&&i.getErrorCorrectionLevel()!==o.getErrorCorrectionLevel()&&i.getRowCount()!==o.getRowCount()?null:i},r.getRowIndicatorColumn=function(e,t,i,o,s,u){for(var g=new r0(t,o),B=0;B<2;B++)for(var _=B===0?1:-1,m=Math.trunc(Math.trunc(i.getX())),D=Math.trunc(Math.trunc(i.getY()));D<=t.getMaxY()&&D>=t.getMinY();D+=_){var F=r.detectCodeword(e,0,e.getWidth(),o,m,D,s,u);F!=null&&(g.setCodeword(D,F),o?m=F.getStartX():m=F.getEndX())}return g},r.adjustCodewordCount=function(e,t){var i=t[0][1],o=i.getValue(),s=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-r.getNumberOfECCodeWords(e.getBarcodeECLevel());if(o.length===0){if(s<1||s>Xe.MAX_CODEWORDS_IN_BARCODE)throw ve.getNotFoundInstance();i.setValue(s)}else o[0]!==s&&i.setValue(s)},r.createDecoderResult=function(e){var t=r.createBarcodeMatrix(e);r.adjustCodewordCount(e,t);for(var i=new Array,o=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),s=[],u=new Array,g=0;g<e.getBarcodeRowCount();g++)for(var B=0;B<e.getBarcodeColumnCount();B++){var _=t[g][B+1].getValue(),m=g*e.getBarcodeColumnCount()+B;_.length===0?i.push(m):_.length===1?o[m]=_[0]:(u.push(m),s.push(_))}for(var D=new Array(s.length),F=0;F<D.length;F++)D[F]=s[F];return r.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),o,Xe.toIntArray(i),Xe.toIntArray(u),D)},r.createDecoderResultFromAmbiguousValues=function(e,t,i,o,s){for(var u=new Int32Array(o.length),g=100;g-- >0;){for(var B=0;B<u.length;B++)t[o[B]]=s[B][u[B]];try{return r.decodeCodewords(t,e,i)}catch(m){var _=m instanceof Dt;if(!_)throw m}if(u.length===0)throw Dt.getChecksumInstance();for(var B=0;B<u.length;B++)if(u[B]<s[B].length-1){u[B]++;break}else if(u[B]=0,B===u.length-1)throw Dt.getChecksumInstance()}throw Dt.getChecksumInstance()},r.createBarcodeMatrix=function(e){for(var t,i,o,s,u=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),g=0;g<u.length;g++)for(var B=0;B<u[g].length;B++)u[g][B]=new ri;var _=0;try{for(var m=$r(e.getDetectionResultColumns()),D=m.next();!D.done;D=m.next()){var F=D.value;if(F!=null)try{for(var T=(o=void 0,$r(F.getCodewords())),I=T.next();!I.done;I=T.next()){var k=I.value;if(k!=null){var U=k.getRowNumber();if(U>=0){if(U>=u.length)continue;u[U][_].setValue(k.getValue())}}}}catch(K){o={error:K}}finally{try{I&&!I.done&&(s=T.return)&&s.call(T)}finally{if(o)throw o.error}}_++}}catch(K){t={error:K}}finally{try{D&&!D.done&&(i=m.return)&&i.call(m)}finally{if(t)throw t.error}}return u},r.isValidBarcodeColumn=function(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1},r.getStartColumn=function(e,t,i,o){var s,u,g=o?1:-1,B=null;if(r.isValidBarcodeColumn(e,t-g)&&(B=e.getDetectionResultColumn(t-g).getCodeword(i)),B!=null)return o?B.getEndX():B.getStartX();if(B=e.getDetectionResultColumn(t).getCodewordNearby(i),B!=null)return o?B.getStartX():B.getEndX();if(r.isValidBarcodeColumn(e,t-g)&&(B=e.getDetectionResultColumn(t-g).getCodewordNearby(i)),B!=null)return o?B.getEndX():B.getStartX();for(var _=0;r.isValidBarcodeColumn(e,t-g);){t-=g;try{for(var m=(s=void 0,$r(e.getDetectionResultColumn(t).getCodewords())),D=m.next();!D.done;D=m.next()){var F=D.value;if(F!=null)return(o?F.getEndX():F.getStartX())+g*_*(F.getEndX()-F.getStartX())}}catch(T){s={error:T}}finally{try{D&&!D.done&&(u=m.return)&&u.call(m)}finally{if(s)throw s.error}}_++}return o?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},r.detectCodeword=function(e,t,i,o,s,u,g,B){s=r.adjustCodewordStartColumn(e,t,i,o,s,u);var _=r.getModuleBitCount(e,t,i,o,s,u);if(_==null)return null;var m,D=Ye.sum(_);if(o)m=s+D;else{for(var F=0;F<_.length/2;F++){var T=_[F];_[F]=_[_.length-1-F],_[_.length-1-F]=T}m=s,s=m-D}if(!r.checkCodewordSkew(D,g,B))return null;var I=qh.getDecodedValue(_),k=Xe.getCodeword(I);return k===-1?null:new Jh(s,m,r.getCodewordBucketNumber(I),k)},r.getModuleBitCount=function(e,t,i,o,s,u){for(var g=s,B=new Int32Array(8),_=0,m=o?1:-1,D=o;(o?g<i:g>=t)&&_<B.length;)e.get(g,u)===D?(B[_]++,g+=m):(_++,D=!D);return _===B.length||g===(o?i:t)&&_===B.length-1?B:null},r.getNumberOfECCodeWords=function(e){return 2<<e},r.adjustCodewordStartColumn=function(e,t,i,o,s,u){for(var g=s,B=o?-1:1,_=0;_<2;_++){for(;(o?g>=t:g<i)&&o===e.get(g,u);){if(Math.abs(s-g)>r.CODEWORD_SKEW_SIZE)return s;g+=B}B=-B,o=!o}return g},r.checkCodewordSkew=function(e,t,i){return t-r.CODEWORD_SKEW_SIZE<=e&&e<=i+r.CODEWORD_SKEW_SIZE},r.decodeCodewords=function(e,t,i){if(e.length===0)throw Ie.getFormatInstance();var o=1<<t+1,s=r.correctErrors(e,i,o);r.verifyCodewordCount(e,o);var u=ac.decode(e,""+t);return u.setErrorsCorrected(s),u.setErasures(i.length),u},r.correctErrors=function(e,t,i){if(t!=null&&t.length>i/2+r.MAX_ERRORS||i<0||i>r.MAX_EC_CODEWORDS)throw Dt.getChecksumInstance();return r.errorCorrection.decode(e,i,t)},r.verifyCodewordCount=function(e,t){if(e.length<4)throw Ie.getFormatInstance();var i=e[0];if(i>e.length)throw Ie.getFormatInstance();if(i===0)if(t<e.length)e[0]=e.length-t;else throw Ie.getFormatInstance()},r.getBitCountForCodeword=function(e){for(var t=new Int32Array(8),i=0,o=t.length-1;!((e&1)!==i&&(i=e&1,o--,o<0));)t[o]++,e>>=1;return t},r.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},r.getCodewordBucketNumber_number=function(e){return r.getCodewordBucketNumber(r.getBitCountForCodeword(e))},r.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},r.toString=function(e){for(var t=new Gn,i=0;i<e.length;i++){t.format("Row %2d: ",i);for(var o=0;o<e[i].length;o++){var s=e[i][o];s.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",s.getValue()[0],s.getConfidence(s.getValue()[0]))}t.format("%n")}return t.toString()},r.CODEWORD_SKEW_SIZE=2,r.MAX_ERRORS=3,r.MAX_EC_CODEWORDS=512,r.errorCorrection=new Vh,r}(),xc=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},yn=function(){function r(){}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var i=r.decode(e,t,!1);if(i==null||i.length===0||i[0]==null)throw ve.getNotFoundInstance();return i[0]},r.prototype.decodeMultiple=function(e,t){t===void 0&&(t=null);try{return r.decode(e,t,!0)}catch(i){throw i instanceof Ie||i instanceof Dt?ve.getNotFoundInstance():i}},r.decode=function(e,t,i){var o,s,u=new Array,g=Mh.detectMultiple(e,t,i);try{for(var B=xc(g.getPoints()),_=B.next();!_.done;_=B.next()){var m=_.value,D=sc.decode(g.getBits(),m[4],m[5],m[6],m[7],r.getMinCodewordWidth(m),r.getMaxCodewordWidth(m)),F=new Mt(D.getText(),D.getRawBytes(),void 0,m,ke.PDF_417);F.putMetadata(Ot.ERROR_CORRECTION_LEVEL,D.getECLevel());var T=D.getOther();T!=null&&F.putMetadata(Ot.PDF417_EXTRA_METADATA,T),u.push(F)}}catch(I){o={error:I}}finally{try{_&&!_.done&&(s=B.return)&&s.call(B)}finally{if(o)throw o.error}}return u.map(function(I){return I})},r.getMaxWidth=function(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))},r.getMinWidth=function(e,t){return e==null||t==null?ut.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))},r.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(r.getMaxWidth(e[0],e[4]),r.getMaxWidth(e[6],e[2])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN),Math.max(r.getMaxWidth(e[1],e[5]),r.getMaxWidth(e[7],e[3])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN)))},r.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(r.getMinWidth(e[0],e[4]),r.getMinWidth(e[6],e[2])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN),Math.min(r.getMinWidth(e[1],e[5]),r.getMinWidth(e[7],e[3])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN)))},r.prototype.reset=function(){},r}(),lc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),n0=function(r){lc(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ReaderException",e}(Xt),o0=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$0=function(){function r(){}return r.prototype.decode=function(e,t){return this.setHints(t),this.decodeInternal(e)},r.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},r.prototype.setHints=function(e){this.hints=e;var t=e!=null&&e.get(xt.TRY_HARDER)!==void 0,i=e==null?null:e.get(xt.POSSIBLE_FORMATS),o=new Array;if(i!=null){var s=i.some(function(u){return u===ke.UPC_A||u===ke.UPC_E||u===ke.EAN_13||u===ke.EAN_8||u===ke.CODABAR||u===ke.CODE_39||u===ke.CODE_93||u===ke.CODE_128||u===ke.ITF||u===ke.RSS_14||u===ke.RSS_EXPANDED});s&&!t&&o.push(new ti(e)),i.includes(ke.QR_CODE)&&o.push(new Cn),i.includes(ke.DATA_MATRIX)&&o.push(new _n),i.includes(ke.AZTEC)&&o.push(new Bn),i.includes(ke.PDF_417)&&o.push(new yn),s&&t&&o.push(new ti(e))}o.length===0&&(t||o.push(new ti(e)),o.push(new Cn),o.push(new _n),o.push(new Bn),o.push(new yn),t&&o.push(new ti(e))),this.readers=o},r.prototype.reset=function(){var e,t;if(this.readers!==null)try{for(var i=o0(this.readers),o=i.next();!o.done;o=i.next()){var s=o.value;s.reset()}}catch(u){e={error:u}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},r.prototype.decodeInternal=function(e){var t,i;if(this.readers===null)throw new n0("No readers where selected, nothing can be read.");try{for(var o=o0(this.readers),s=o.next();!s.done;s=o.next()){var u=s.value;try{return u.decode(e,this.hints)}catch(g){if(g instanceof n0)continue}}}catch(g){t={error:g}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}throw new ve("No MultiFormat Readers were able to detect the code.")},r}(),hc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(r){hc(e,r);function e(t,i){t===void 0&&(t=null),i===void 0&&(i=500);var o=this,s=new $0;return s.setHints(t),o=r.call(this,s,i)||this,o}return e.prototype.decodeBitmap=function(t){return this.reader.decodeWithState(t)},e})(Yr);var cc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(r){cc(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new yn,t)||this}return e})(Yr);var uc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(r){uc(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new Cn,t)||this}return e})(Yr);var Dn;(function(r){r[r.ERROR_CORRECTION=0]="ERROR_CORRECTION",r[r.CHARACTER_SET=1]="CHARACTER_SET",r[r.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",r[r.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",r[r.MIN_SIZE=4]="MIN_SIZE",r[r.MAX_SIZE=5]="MAX_SIZE",r[r.MARGIN=6]="MARGIN",r[r.PDF417_COMPACT=7]="PDF417_COMPACT",r[r.PDF417_COMPACTION=8]="PDF417_COMPACTION",r[r.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",r[r.AZTEC_LAYERS=10]="AZTEC_LAYERS",r[r.QR_VERSION=11]="QR_VERSION",r[r.GS1_FORMAT=12]="GS1_FORMAT",r[r.FORCE_C40=13]="FORCE_C40"})(Dn||(Dn={}));var wi=Dn,fc=function(){function r(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new Cr(e,Int32Array.from([1])))}return r.prototype.buildGenerator=function(e){var t=this.cachedGenerators;if(e>=t.length)for(var i=t[t.length-1],o=this.field,s=t.length;s<=e;s++){var u=i.multiply(new Cr(o,Int32Array.from([1,o.exp(s-1+o.getGeneratorBase())])));t.push(u),i=u}return t[e]},r.prototype.encode=function(e,t){if(t===0)throw new Ue("No error correction bytes");var i=e.length-t;if(i<=0)throw new Ue("No data bytes provided");var o=this.buildGenerator(t),s=new Int32Array(i);nt.arraycopy(e,0,s,0,i);var u=new Cr(this.field,s);u=u.multiplyByMonomial(t,1);for(var g=u.divide(o)[1],B=g.getCoefficients(),_=t-B.length,m=0;m<_;m++)e[i+m]=0;nt.arraycopy(B,0,e,i+_,B.length)},r}(),ii=function(){function r(){}return r.applyMaskPenaltyRule1=function(e){return r.applyMaskPenaltyRule1Internal(e,!0)+r.applyMaskPenaltyRule1Internal(e,!1)},r.applyMaskPenaltyRule2=function(e){for(var t=0,i=e.getArray(),o=e.getWidth(),s=e.getHeight(),u=0;u<s-1;u++)for(var g=i[u],B=0;B<o-1;B++){var _=g[B];_===g[B+1]&&_===i[u+1][B]&&_===i[u+1][B+1]&&t++}return r.N2*t},r.applyMaskPenaltyRule3=function(e){for(var t=0,i=e.getArray(),o=e.getWidth(),s=e.getHeight(),u=0;u<s;u++)for(var g=0;g<o;g++){var B=i[u];g+6<o&&B[g]===1&&B[g+1]===0&&B[g+2]===1&&B[g+3]===1&&B[g+4]===1&&B[g+5]===0&&B[g+6]===1&&(r.isWhiteHorizontal(B,g-4,g)||r.isWhiteHorizontal(B,g+7,g+11))&&t++,u+6<s&&i[u][g]===1&&i[u+1][g]===0&&i[u+2][g]===1&&i[u+3][g]===1&&i[u+4][g]===1&&i[u+5][g]===0&&i[u+6][g]===1&&(r.isWhiteVertical(i,g,u-4,u)||r.isWhiteVertical(i,g,u+7,u+11))&&t++}return t*r.N3},r.isWhiteHorizontal=function(e,t,i){t=Math.max(t,0),i=Math.min(i,e.length);for(var o=t;o<i;o++)if(e[o]===1)return!1;return!0},r.isWhiteVertical=function(e,t,i,o){i=Math.max(i,0),o=Math.min(o,e.length);for(var s=i;s<o;s++)if(e[s][t]===1)return!1;return!0},r.applyMaskPenaltyRule4=function(e){for(var t=0,i=e.getArray(),o=e.getWidth(),s=e.getHeight(),u=0;u<s;u++)for(var g=i[u],B=0;B<o;B++)g[B]===1&&t++;var _=e.getHeight()*e.getWidth(),m=Math.floor(Math.abs(t*2-_)*10/_);return m*r.N4},r.getDataMaskBit=function(e,t,i){var o,s;switch(e){case 0:o=i+t&1;break;case 1:o=i&1;break;case 2:o=t%3;break;case 3:o=(i+t)%3;break;case 4:o=Math.floor(i/2)+Math.floor(t/3)&1;break;case 5:s=i*t,o=(s&1)+s%3;break;case 6:s=i*t,o=(s&1)+s%3&1;break;case 7:s=i*t,o=s%3+(i+t&1)&1;break;default:throw new Ue("Invalid mask pattern: "+e)}return o===0},r.applyMaskPenaltyRule1Internal=function(e,t){for(var i=0,o=t?e.getHeight():e.getWidth(),s=t?e.getWidth():e.getHeight(),u=e.getArray(),g=0;g<o;g++){for(var B=0,_=-1,m=0;m<s;m++){var D=t?u[g][m]:u[m][g];D===_?B++:(B>=5&&(i+=r.N1+(B-5)),B=1,_=D)}B>=5&&(i+=r.N1+(B-5))}return i},r.N1=3,r.N2=3,r.N3=40,r.N4=10,r}(),Ec=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dc=function(){function r(e,t){this.width=e,this.height=t;for(var i=new Array(t),o=0;o!==t;o++)i[o]=new Uint8Array(e);this.bytes=i}return r.prototype.getHeight=function(){return this.height},r.prototype.getWidth=function(){return this.width},r.prototype.get=function(e,t){return this.bytes[t][e]},r.prototype.getArray=function(){return this.bytes},r.prototype.setNumber=function(e,t,i){this.bytes[t][e]=i},r.prototype.setBoolean=function(e,t,i){this.bytes[t][e]=i?1:0},r.prototype.clear=function(e){var t,i;try{for(var o=Ec(this.bytes),s=o.next();!s.done;s=o.next()){var u=s.value;vt.fill(u,e)}}catch(g){t={error:g}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(var i=0,o=this.height;i<o;++i)for(var s=this.bytes[i],u=t.bytes[i],g=0,B=this.width;g<B;++g)if(s[g]!==u[g])return!1;return!0},r.prototype.toString=function(){for(var e=new Ge,t=0,i=this.height;t<i;++t){for(var o=this.bytes[t],s=0,u=this.width;s<u;++s)switch(o[s]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},r}(),wn=function(){function r(){this.maskPattern=-1}return r.prototype.getMode=function(){return this.mode},r.prototype.getECLevel=function(){return this.ecLevel},r.prototype.getVersion=function(){return this.version},r.prototype.getMaskPattern=function(){return this.maskPattern},r.prototype.getMatrix=function(){return this.matrix},r.prototype.toString=function(){var e=new Ge;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},r.prototype.setMode=function(e){this.mode=e},r.prototype.setECLevel=function(e){this.ecLevel=e},r.prototype.setVersion=function(e){this.version=e},r.prototype.setMaskPattern=function(e){this.maskPattern=e},r.prototype.setMatrix=function(e){this.matrix=e},r.isValidMaskPattern=function(e){return e>=0&&e<r.NUM_MASK_PATTERNS},r.NUM_MASK_PATTERNS=8,r}(),gc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ot=function(r){gc(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="WriterException",e}(Xt),a0=function(){function r(){}return r.clearMatrix=function(e){e.clear(255)},r.buildMatrix=function(e,t,i,o,s){r.clearMatrix(s),r.embedBasicPatterns(i,s),r.embedTypeInfo(t,o,s),r.maybeEmbedVersionInfo(i,s),r.embedDataBits(e,o,s)},r.embedBasicPatterns=function(e,t){r.embedPositionDetectionPatternsAndSeparators(t),r.embedDarkDotAtLeftBottomCorner(t),r.maybeEmbedPositionAdjustmentPatterns(e,t),r.embedTimingPatterns(t)},r.embedTypeInfo=function(e,t,i){var o=new Ht;r.makeTypeInfoBits(e,t,o);for(var s=0,u=o.getSize();s<u;++s){var g=o.get(o.getSize()-1-s),B=r.TYPE_INFO_COORDINATES[s],_=B[0],m=B[1];if(i.setBoolean(_,m,g),s<8){var D=i.getWidth()-s-1,F=8;i.setBoolean(D,F,g)}else{var D=8,F=i.getHeight()-7+(s-8);i.setBoolean(D,F,g)}}},r.maybeEmbedVersionInfo=function(e,t){if(!(e.getVersionNumber()<7)){var i=new Ht;r.makeVersionInfoBits(e,i);for(var o=6*3-1,s=0;s<6;++s)for(var u=0;u<3;++u){var g=i.get(o);o--,t.setBoolean(s,t.getHeight()-11+u,g),t.setBoolean(t.getHeight()-11+u,s,g)}}},r.embedDataBits=function(e,t,i){for(var o=0,s=-1,u=i.getWidth()-1,g=i.getHeight()-1;u>0;){for(u===6&&(u-=1);g>=0&&g<i.getHeight();){for(var B=0;B<2;++B){var _=u-B;if(!!r.isEmpty(i.get(_,g))){var m=void 0;o<e.getSize()?(m=e.get(o),++o):m=!1,t!==255&&ii.getDataMaskBit(t,_,g)&&(m=!m),i.setBoolean(_,g,m)}}g+=s}s=-s,g+=s,u-=2}if(o!==e.getSize())throw new ot("Not all bits consumed: "+o+"/"+e.getSize())},r.findMSBSet=function(e){return 32-ut.numberOfLeadingZeros(e)},r.calculateBCHCode=function(e,t){if(t===0)throw new Ue("0 polynomial");var i=r.findMSBSet(t);for(e<<=i-1;r.findMSBSet(e)>=i;)e^=t<<r.findMSBSet(e)-i;return e},r.makeTypeInfoBits=function(e,t,i){if(!wn.isValidMaskPattern(t))throw new ot("Invalid mask pattern");var o=e.getBits()<<3|t;i.appendBits(o,5);var s=r.calculateBCHCode(o,r.TYPE_INFO_POLY);i.appendBits(s,10);var u=new Ht;if(u.appendBits(r.TYPE_INFO_MASK_PATTERN,15),i.xor(u),i.getSize()!==15)throw new ot("should not happen but we got: "+i.getSize())},r.makeVersionInfoBits=function(e,t){t.appendBits(e.getVersionNumber(),6);var i=r.calculateBCHCode(e.getVersionNumber(),r.VERSION_INFO_POLY);if(t.appendBits(i,12),t.getSize()!==18)throw new ot("should not happen but we got: "+t.getSize())},r.isEmpty=function(e){return e===255},r.embedTimingPatterns=function(e){for(var t=8;t<e.getWidth()-8;++t){var i=(t+1)%2;r.isEmpty(e.get(t,6))&&e.setNumber(t,6,i),r.isEmpty(e.get(6,t))&&e.setNumber(6,t,i)}},r.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new ot;e.setNumber(8,e.getHeight()-8,1)},r.embedHorizontalSeparationPattern=function(e,t,i){for(var o=0;o<8;++o){if(!r.isEmpty(i.get(e+o,t)))throw new ot;i.setNumber(e+o,t,0)}},r.embedVerticalSeparationPattern=function(e,t,i){for(var o=0;o<7;++o){if(!r.isEmpty(i.get(e,t+o)))throw new ot;i.setNumber(e,t+o,0)}},r.embedPositionAdjustmentPattern=function(e,t,i){for(var o=0;o<5;++o)for(var s=r.POSITION_ADJUSTMENT_PATTERN[o],u=0;u<5;++u)i.setNumber(e+u,t+o,s[u])},r.embedPositionDetectionPattern=function(e,t,i){for(var o=0;o<7;++o)for(var s=r.POSITION_DETECTION_PATTERN[o],u=0;u<7;++u)i.setNumber(e+u,t+o,s[u])},r.embedPositionDetectionPatternsAndSeparators=function(e){var t=r.POSITION_DETECTION_PATTERN[0].length;r.embedPositionDetectionPattern(0,0,e),r.embedPositionDetectionPattern(e.getWidth()-t,0,e),r.embedPositionDetectionPattern(0,e.getWidth()-t,e);var i=8;r.embedHorizontalSeparationPattern(0,i-1,e),r.embedHorizontalSeparationPattern(e.getWidth()-i,i-1,e),r.embedHorizontalSeparationPattern(0,e.getWidth()-i,e);var o=7;r.embedVerticalSeparationPattern(o,0,e),r.embedVerticalSeparationPattern(e.getHeight()-o-1,0,e),r.embedVerticalSeparationPattern(o,e.getHeight()-o,e)},r.maybeEmbedPositionAdjustmentPatterns=function(e,t){if(!(e.getVersionNumber()<2))for(var i=e.getVersionNumber()-1,o=r.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[i],s=0,u=o.length;s!==u;s++){var g=o[s];if(g>=0)for(var B=0;B!==u;B++){var _=o[B];_>=0&&r.isEmpty(t.get(_,g))&&r.embedPositionAdjustmentPattern(_-2,g-2,t)}}},r.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),r.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),r.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),r.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),r.VERSION_INFO_POLY=7973,r.TYPE_INFO_POLY=1335,r.TYPE_INFO_MASK_PATTERN=21522,r}(),Ac=function(){function r(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}return r.prototype.getDataBytes=function(){return this.dataBytes},r.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},r}(),s0=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function r(){}return r.calculateMaskPenalty=function(e){return ii.applyMaskPenaltyRule1(e)+ii.applyMaskPenaltyRule2(e)+ii.applyMaskPenaltyRule3(e)+ii.applyMaskPenaltyRule4(e)},r.encode=function(e,t,i){i===void 0&&(i=null);var o=r.DEFAULT_BYTE_MODE_ENCODING,s=i!==null&&i.get(wi.CHARACTER_SET)!==void 0;s&&(o=i.get(wi.CHARACTER_SET).toString());var u=this.chooseMode(e,o),g=new Ht;if(u===at.BYTE&&(s||r.DEFAULT_BYTE_MODE_ENCODING!==o)){var B=Bt.getCharacterSetECIByName(o);B!==void 0&&this.appendECI(B,g)}this.appendModeInfo(u,g);var _=new Ht;this.appendBytes(e,u,_,o);var m;if(i!==null&&i.get(wi.QR_VERSION)!==void 0){var D=Number.parseInt(i.get(wi.QR_VERSION).toString(),10);m=Rr.getVersionForNumber(D);var F=this.calculateBitsNeeded(u,g,_,m);if(!this.willFit(F,m,t))throw new ot("Data too big for requested version")}else m=this.recommendVersion(t,u,g,_);var T=new Ht;T.appendBitArray(g);var I=u===at.BYTE?_.getSizeInBytes():e.length;this.appendLengthInfo(I,m,u,T),T.appendBitArray(_);var k=m.getECBlocksForLevel(t),U=m.getTotalCodewords()-k.getTotalECCodewords();this.terminateBits(U,T);var K=this.interleaveWithECBytes(T,m.getTotalCodewords(),U,k.getNumBlocks()),X=new wn;X.setECLevel(t),X.setMode(u),X.setVersion(m);var te=m.getDimensionForVersion(),ne=new dc(te,te),re=this.chooseMaskPattern(K,t,m,ne);return X.setMaskPattern(re),a0.buildMatrix(K,t,m,re,ne),X.setMatrix(ne),X},r.recommendVersion=function(e,t,i,o){var s=this.calculateBitsNeeded(t,i,o,Rr.getVersionForNumber(1)),u=this.chooseVersion(s,e),g=this.calculateBitsNeeded(t,i,o,u);return this.chooseVersion(g,e)},r.calculateBitsNeeded=function(e,t,i,o){return t.getSize()+e.getCharacterCountBits(o)+i.getSize()},r.getAlphanumericCode=function(e){return e<r.ALPHANUMERIC_TABLE.length?r.ALPHANUMERIC_TABLE[e]:-1},r.chooseMode=function(e,t){if(t===void 0&&(t=null),Bt.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return at.KANJI;for(var i=!1,o=!1,s=0,u=e.length;s<u;++s){var g=e.charAt(s);if(r.isDigit(g))i=!0;else if(this.getAlphanumericCode(g.charCodeAt(0))!==-1)o=!0;else return at.BYTE}return o?at.ALPHANUMERIC:i?at.NUMERIC:at.BYTE},r.isOnlyDoubleByteKanji=function(e){var t;try{t=tr.encode(e,Bt.SJIS)}catch{return!1}var i=t.length;if(i%2!==0)return!1;for(var o=0;o<i;o+=2){var s=t[o]&255;if((s<129||s>159)&&(s<224||s>235))return!1}return!0},r.chooseMaskPattern=function(e,t,i,o){for(var s=Number.MAX_SAFE_INTEGER,u=-1,g=0;g<wn.NUM_MASK_PATTERNS;g++){a0.buildMatrix(e,t,i,g,o);var B=this.calculateMaskPenalty(o);B<s&&(s=B,u=g)}return u},r.chooseVersion=function(e,t){for(var i=1;i<=40;i++){var o=Rr.getVersionForNumber(i);if(r.willFit(e,o,t))return o}throw new ot("Data too big")},r.willFit=function(e,t,i){var o=t.getTotalCodewords(),s=t.getECBlocksForLevel(i),u=s.getTotalECCodewords(),g=o-u,B=(e+7)/8;return g>=B},r.terminateBits=function(e,t){var i=e*8;if(t.getSize()>i)throw new ot("data bits cannot fit in the QR Code"+t.getSize()+" > "+i);for(var o=0;o<4&&t.getSize()<i;++o)t.appendBit(!1);var s=t.getSize()&7;if(s>0)for(var o=s;o<8;o++)t.appendBit(!1);for(var u=e-t.getSizeInBytes(),o=0;o<u;++o)t.appendBits((o&1)===0?236:17,8);if(t.getSize()!==i)throw new ot("Bits size does not equal capacity")},r.getNumDataBytesAndNumECBytesForBlockID=function(e,t,i,o,s,u){if(o>=i)throw new ot("Block ID too large");var g=e%i,B=i-g,_=Math.floor(e/i),m=_+1,D=Math.floor(t/i),F=D+1,T=_-D,I=m-F;if(T!==I)throw new ot("EC bytes mismatch");if(i!==B+g)throw new ot("RS blocks mismatch");if(e!==(D+T)*B+(F+I)*g)throw new ot("Total bytes mismatch");o<B?(s[0]=D,u[0]=T):(s[0]=F,u[0]=I)},r.interleaveWithECBytes=function(e,t,i,o){var s,u,g,B;if(e.getSizeInBytes()!==i)throw new ot("Number of bits and data bytes does not match");for(var _=0,m=0,D=0,F=new Array,T=0;T<o;++T){var I=new Int32Array(1),k=new Int32Array(1);r.getNumDataBytesAndNumECBytesForBlockID(t,i,o,T,I,k);var U=I[0],K=new Uint8Array(U);e.toBytes(8*_,K,0,U);var X=r.generateECBytes(K,k[0]);F.push(new Ac(K,X)),m=Math.max(m,U),D=Math.max(D,X.length),_+=I[0]}if(i!==_)throw new ot("Data bytes does not match offset");for(var te=new Ht,T=0;T<m;++T)try{for(var ne=(s=void 0,s0(F)),re=ne.next();!re.done;re=ne.next()){var ue=re.value,K=ue.getDataBytes();T<K.length&&te.appendBits(K[T],8)}}catch(be){s={error:be}}finally{try{re&&!re.done&&(u=ne.return)&&u.call(ne)}finally{if(s)throw s.error}}for(var T=0;T<D;++T)try{for(var Ae=(g=void 0,s0(F)),v=Ae.next();!v.done;v=Ae.next()){var ue=v.value,X=ue.getErrorCorrectionBytes();T<X.length&&te.appendBits(X[T],8)}}catch(be){g={error:be}}finally{try{v&&!v.done&&(B=Ae.return)&&B.call(Ae)}finally{if(g)throw g.error}}if(t!==te.getSizeInBytes())throw new ot("Interleaving error: "+t+" and "+te.getSizeInBytes()+" differ.");return te},r.generateECBytes=function(e,t){for(var i=e.length,o=new Int32Array(i+t),s=0;s<i;s++)o[s]=e[s]&255;new fc(Er.QR_CODE_FIELD_256).encode(o,t);for(var u=new Uint8Array(t),s=0;s<t;s++)u[s]=o[i+s];return u},r.appendModeInfo=function(e,t){t.appendBits(e.getBits(),4)},r.appendLengthInfo=function(e,t,i,o){var s=i.getCharacterCountBits(t);if(e>=1<<s)throw new ot(e+" is bigger than "+((1<<s)-1));o.appendBits(e,s)},r.appendBytes=function(e,t,i,o){switch(t){case at.NUMERIC:r.appendNumericBytes(e,i);break;case at.ALPHANUMERIC:r.appendAlphanumericBytes(e,i);break;case at.BYTE:r.append8BitBytes(e,i,o);break;case at.KANJI:r.appendKanjiBytes(e,i);break;default:throw new ot("Invalid mode: "+t)}},r.getDigit=function(e){return e.charCodeAt(0)-48},r.isDigit=function(e){var t=r.getDigit(e);return t>=0&&t<=9},r.appendNumericBytes=function(e,t){for(var i=e.length,o=0;o<i;){var s=r.getDigit(e.charAt(o));if(o+2<i){var u=r.getDigit(e.charAt(o+1)),g=r.getDigit(e.charAt(o+2));t.appendBits(s*100+u*10+g,10),o+=3}else if(o+1<i){var u=r.getDigit(e.charAt(o+1));t.appendBits(s*10+u,7),o+=2}else t.appendBits(s,4),o++}},r.appendAlphanumericBytes=function(e,t){for(var i=e.length,o=0;o<i;){var s=r.getAlphanumericCode(e.charCodeAt(o));if(s===-1)throw new ot;if(o+1<i){var u=r.getAlphanumericCode(e.charCodeAt(o+1));if(u===-1)throw new ot;t.appendBits(s*45+u,11),o+=2}else t.appendBits(s,6),o++}},r.append8BitBytes=function(e,t,i){var o;try{o=tr.encode(e,i)}catch(B){throw new ot(B)}for(var s=0,u=o.length;s!==u;s++){var g=o[s];t.appendBits(g,8)}},r.appendKanjiBytes=function(e,t){var i;try{i=tr.encode(e,Bt.SJIS)}catch(D){throw new ot(D)}for(var o=i.length,s=0;s<o;s+=2){var u=i[s]&255,g=i[s+1]&255,B=u<<8&4294967295|g,_=-1;if(B>=33088&&B<=40956?_=B-33088:B>=57408&&B<=60351&&(_=B-49472),_===-1)throw new ot("Invalid byte sequence");var m=(_>>8)*192+(_&255);t.appendBits(m,13)}},r.appendECI=function(e,t){t.appendBits(at.ECI.getBits(),4),t.appendBits(e.getValue(),8)},r.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),r.DEFAULT_BYTE_MODE_ENCODING=Bt.UTF8.getName(),r})();var pc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(r){pc(e,r);function e(t,i,o,s,u,g,B,_){var m=r.call(this,g,B)||this;if(m.yuvData=t,m.dataWidth=i,m.dataHeight=o,m.left=s,m.top=u,s+g>i||u+B>o)throw new Ue("Crop rectangle does not fit within image data.");return _&&m.reverseHorizontal(g,B),m}return e.prototype.getRow=function(t,i){if(t<0||t>=this.getHeight())throw new Ue("Requested row is outside the image: "+t);var o=this.getWidth();(i==null||i.length<o)&&(i=new Uint8ClampedArray(o));var s=(t+this.top)*this.dataWidth+this.left;return nt.arraycopy(this.yuvData,s,i,0,o),i},e.prototype.getMatrix=function(){var t=this.getWidth(),i=this.getHeight();if(t===this.dataWidth&&i===this.dataHeight)return this.yuvData;var o=t*i,s=new Uint8ClampedArray(o),u=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return nt.arraycopy(this.yuvData,u,s,0,o),s;for(var g=0;g<i;g++){var B=g*t;nt.arraycopy(this.yuvData,u,s,B,t),u+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,i,o,s){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+i,o,s,!1)},e.prototype.renderThumbnail=function(){for(var t=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,i=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,o=new Int32Array(t*i),s=this.yuvData,u=this.top*this.dataWidth+this.left,g=0;g<i;g++){for(var B=g*t,_=0;_<t;_++){var m=s[u+_*e.THUMBNAIL_SCALE_FACTOR]&255;o[B+_]=4278190080|m*65793}u+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return o},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(t,i){for(var o=this.yuvData,s=0,u=this.top*this.dataWidth+this.left;s<i;s++,u+=this.dataWidth)for(var g=u+t/2,B=u,_=u+t-1;B<g;B++,_--){var m=o[B];o[B]=o[_],o[_]=m}},e.prototype.invert=function(){return new Nn(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(Ki);var Bc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(r){Bc(e,r);function e(t,i,o,s,u,g,B){var _=r.call(this,i,o)||this;if(_.dataWidth=s,_.dataHeight=u,_.left=g,_.top=B,t.BYTES_PER_ELEMENT===4){for(var m=i*o,D=new Uint8ClampedArray(m),F=0;F<m;F++){var T=t[F],I=T>>16&255,k=T>>7&510,U=T&255;D[F]=(I+k+U)/4&255}_.luminances=D}else _.luminances=t;if(s===void 0&&(_.dataWidth=i),u===void 0&&(_.dataHeight=o),g===void 0&&(_.left=0),B===void 0&&(_.top=0),_.left+i>_.dataWidth||_.top+o>_.dataHeight)throw new Ue("Crop rectangle does not fit within image data.");return _}return e.prototype.getRow=function(t,i){if(t<0||t>=this.getHeight())throw new Ue("Requested row is outside the image: "+t);var o=this.getWidth();(i==null||i.length<o)&&(i=new Uint8ClampedArray(o));var s=(t+this.top)*this.dataWidth+this.left;return nt.arraycopy(this.luminances,s,i,0,o),i},e.prototype.getMatrix=function(){var t=this.getWidth(),i=this.getHeight();if(t===this.dataWidth&&i===this.dataHeight)return this.luminances;var o=t*i,s=new Uint8ClampedArray(o),u=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return nt.arraycopy(this.luminances,u,s,0,o),s;for(var g=0;g<i;g++){var B=g*t;nt.arraycopy(this.luminances,u,s,B,t),u+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,i,o,s){return new e(this.luminances,o,s,this.dataWidth,this.dataHeight,this.left+t,this.top+i)},e.prototype.invert=function(){return new Nn(this)},e})(Ki);var vc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),_c=function(r){vc(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.forName=function(t){return this.getCharacterSetECIByName(t)},e}(Bt),Cc=function(){function r(){}return r.ISO_8859_1=Bt.ISO8859_1,r}(),Fn,mc=301,yc=function(r,e){for(var t=1,i=0;i<255;i++)e[i]=t,r[t]=i,t*=2,t>=256&&(t^=mc);return{LOG:r,ALOG:e}};Fn=yc([],[]),Fn.LOG;Fn.ALOG;var x0;(function(r){r[r.FORCE_NONE=0]="FORCE_NONE",r[r.FORCE_SQUARE=1]="FORCE_SQUARE",r[r.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(x0||(x0={}));var l0=129,ea=230,Dc=231,wc=235,Fc=236,Sc=237,bc=238,Tc=239,Oc=240,xn=254,Ic=254,h0="[)>05",c0="[)>06",u0="",$e=0,Tt=1,jt=2,gt=3,mt=4,Pt=5,Rc=function(){function r(){}return r.prototype.getEncodingMode=function(){return $e},r.prototype.encode=function(e){var t=ar.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(t>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var i=e.getCurrentChar(),o=ar.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode())switch(o){case Pt:e.writeCodeword(Dc),e.signalEncoderChange(Pt);return;case Tt:e.writeCodeword(ea),e.signalEncoderChange(Tt);return;case gt:e.writeCodeword(bc),e.signalEncoderChange(gt);break;case jt:e.writeCodeword(Tc),e.signalEncoderChange(jt);break;case mt:e.writeCodeword(Oc),e.signalEncoderChange(mt);break;default:throw new Error("Illegal mode: "+o)}else ar.isExtendedASCII(i)?(e.writeCodeword(wc),e.writeCodeword(i-128+1),e.pos++):(e.writeCodeword(i+1),e.pos++)}},r.prototype.encodeASCIIDigits=function(e,t){if(ar.isDigit(e)&&ar.isDigit(t)){var i=(e-48)*10+(t-48);return i+130}throw new Error("not digits: "+e+t)},r}(),Pc=function(){function r(){}return r.prototype.getEncodingMode=function(){return Pt},r.prototype.encode=function(e){var t=new Ge;for(t.append(0);e.hasMoreCharacters();){var i=e.getCurrentChar();t.append(i),e.pos++;var o=ar.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange($e);break}}var s=t.length()-1,u=1,g=e.getCodewordCount()+s+u;e.updateSymbolInfo(g);var B=e.getSymbolInfo().getDataCapacity()-g>0;if(e.hasMoreCharacters()||B)if(s<=249)t.setCharAt(0,it.getCharAt(s));else if(s<=1555)t.setCharAt(0,it.getCharAt(Math.floor(s/250)+249)),t.insert(1,it.getCharAt(s%250));else throw new Error("Message length not in valid ranges: "+s);for(var _=0,i=t.length();_<i;_++)e.writeCodeword(this.randomize255State(t.charAt(_).charCodeAt(0),e.getCodewordCount()+1))},r.prototype.randomize255State=function(e,t){var i=149*t%255+1,o=e+i;return o<=255?o:o-256},r}(),Wn=function(){function r(){}return r.prototype.getEncodingMode=function(){return Tt},r.prototype.encodeMaximal=function(e){for(var t=new Ge,i=0,o=e.pos,s=0;e.hasMoreCharacters();){var u=e.getCurrentChar();e.pos++,i=this.encodeChar(u,t),t.length()%3===0&&(o=e.pos,s=t.length())}if(s!==t.length()){var g=Math.floor(t.length()/3*2),B=Math.floor(e.getCodewordCount()+g+1);e.updateSymbolInfo(B);var _=e.getSymbolInfo().getDataCapacity()-B,m=Math.floor(t.length()%3);(m===2&&_!==2||m===1&&(i>3||_!==1))&&(e.pos=o)}t.length()>0&&e.writeCodeword(ea),this.handleEOD(e,t)},r.prototype.encode=function(e){for(var t=new Ge;e.hasMoreCharacters();){var i=e.getCurrentChar();e.pos++;var o=this.encodeChar(i,t),s=Math.floor(t.length()/3)*2,u=e.getCodewordCount()+s;e.updateSymbolInfo(u);var g=e.getSymbolInfo().getDataCapacity()-u;if(!e.hasMoreCharacters()){var B=new Ge;for(t.length()%3===2&&g!==2&&(o=this.backtrackOneCharacter(e,t,B,o));t.length()%3===1&&(o>3||g!==1);)o=this.backtrackOneCharacter(e,t,B,o);break}var _=t.length();if(_%3===0){var m=ar.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(m!==this.getEncodingMode()){e.signalEncoderChange($e);break}}}this.handleEOD(e,t)},r.prototype.backtrackOneCharacter=function(e,t,i,o){var s=t.length(),u=t.toString().substring(0,s-o);t.setLengthToZero(),t.append(u),e.pos--;var g=e.getCurrentChar();return o=this.encodeChar(g,i),e.resetSymbolInfo(),o},r.prototype.writeNextTriplet=function(e,t){e.writeCodewords(this.encodeToCodewords(t.toString()));var i=t.toString().substring(3);t.setLengthToZero(),t.append(i)},r.prototype.handleEOD=function(e,t){var i=Math.floor(t.length()/3*2),o=t.length()%3,s=e.getCodewordCount()+i;e.updateSymbolInfo(s);var u=e.getSymbolInfo().getDataCapacity()-s;if(o===2){for(t.append("\0");t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(xn)}else if(u===1&&o===1){for(;t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(xn),e.pos--}else if(o===0){for(;t.length()>=3;)this.writeNextTriplet(e,t);(u>0||e.hasMoreCharacters())&&e.writeCodeword(xn)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange($e)},r.prototype.encodeChar=function(e,t){if(e===" ".charCodeAt(0))return t.append(3),1;if(e>="0".charCodeAt(0)&&e<="9".charCodeAt(0))return t.append(e-48+4),1;if(e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0))return t.append(e-65+14),1;if(e<" ".charCodeAt(0))return t.append(0),t.append(e),2;if(e<="/".charCodeAt(0))return t.append(1),t.append(e-33),2;if(e<="@".charCodeAt(0))return t.append(1),t.append(e-58+15),2;if(e<="_".charCodeAt(0))return t.append(1),t.append(e-91+22),2;if(e<=127)return t.append(2),t.append(e-96),2;t.append(1+"");var i=2;return i+=this.encodeChar(e-128,t),i},r.prototype.encodeToCodewords=function(e){var t=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,i=t/256,o=t%256,s=new Ge;return s.append(i),s.append(o),s.toString()},r}(),Mc=function(){function r(){}return r.prototype.getEncodingMode=function(){return mt},r.prototype.encode=function(e){for(var t=new Ge;e.hasMoreCharacters();){var i=e.getCurrentChar();this.encodeChar(i,t),e.pos++;var o=t.length();if(o>=4){e.writeCodewords(this.encodeToCodewords(t.toString()));var s=t.toString().substring(4);t.setLengthToZero(),t.append(s);var u=ar.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(u!==this.getEncodingMode()){e.signalEncoderChange($e);break}}}t.append(it.getCharAt(31)),this.handleEOD(e,t)},r.prototype.handleEOD=function(e,t){try{var i=t.length();if(i===0)return;if(i===1){e.updateSymbolInfo();var o=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),s=e.getRemainingCharacters();if(s>o&&(e.updateSymbolInfo(e.getCodewordCount()+1),o=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),s<=o&&o<=2)return}if(i>4)throw new Error("Count must not exceed 4");var u=i-1,g=this.encodeToCodewords(t.toString()),B=!e.hasMoreCharacters(),_=B&&u<=2;if(u<=2){e.updateSymbolInfo(e.getCodewordCount()+u);var o=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();o>=3&&(_=!1,e.updateSymbolInfo(e.getCodewordCount()+g.length))}_?(e.resetSymbolInfo(),e.pos-=u):e.writeCodewords(g)}finally{e.signalEncoderChange($e)}},r.prototype.encodeChar=function(e,t){e>=" ".charCodeAt(0)&&e<="?".charCodeAt(0)?t.append(e):e>="@".charCodeAt(0)&&e<="^".charCodeAt(0)?t.append(it.getCharAt(e-64)):ar.illegalCharacter(it.getCharAt(e))},r.prototype.encodeToCodewords=function(e){var t=e.length;if(t===0)throw new Error("StringBuilder must not be empty");var i=e.charAt(0).charCodeAt(0),o=t>=2?e.charAt(1).charCodeAt(0):0,s=t>=3?e.charAt(2).charCodeAt(0):0,u=t>=4?e.charAt(3).charCodeAt(0):0,g=(i<<18)+(o<<12)+(s<<6)+u,B=g>>16&255,_=g>>8&255,m=g&255,D=new Ge;return D.append(B),t>=2&&D.append(_),t>=3&&D.append(m),D.toString()},r}(),Lc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),kc=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ke=function(){function r(e,t,i,o,s,u,g,B){g===void 0&&(g=0),B===void 0&&(B=0),this.rectangular=e,this.dataCapacity=t,this.errorCodewords=i,this.matrixWidth=o,this.matrixHeight=s,this.dataRegions=u,this.rsBlockData=g,this.rsBlockError=B}return r.lookup=function(e,t,i,o,s){var u,g;t===void 0&&(t=0),i===void 0&&(i=null),o===void 0&&(o=null),s===void 0&&(s=!0);try{for(var B=kc(jc),_=B.next();!_.done;_=B.next()){var m=_.value;if(!(t===1&&m.rectangular)&&!(t===2&&!m.rectangular)&&!(i!=null&&(m.getSymbolWidth()<i.getWidth()||m.getSymbolHeight()<i.getHeight()))&&!(o!=null&&(m.getSymbolWidth()>o.getWidth()||m.getSymbolHeight()>o.getHeight()))&&e<=m.dataCapacity)return m}}catch(D){u={error:D}}finally{try{_&&!_.done&&(g=B.return)&&g.call(B)}finally{if(u)throw u.error}}if(s)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},r.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},r.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},r.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},r.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},r.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},r.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},r.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},r.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},r.prototype.getDataCapacity=function(){return this.dataCapacity},r.prototype.getErrorCodewords=function(){return this.errorCodewords},r.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},r.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},r}(),Nc=function(r){Lc(e,r);function e(){return r.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(t){return t<=8?156:155},e}(Ke),jc=[new Ke(!1,3,5,8,8,1),new Ke(!1,5,7,10,10,1),new Ke(!0,5,7,16,6,1),new Ke(!1,8,10,12,12,1),new Ke(!0,10,11,14,6,2),new Ke(!1,12,12,14,14,1),new Ke(!0,16,14,24,10,1),new Ke(!1,18,14,16,16,1),new Ke(!1,22,18,18,18,1),new Ke(!0,22,18,16,10,2),new Ke(!1,30,20,20,20,1),new Ke(!0,32,24,16,14,2),new Ke(!1,36,24,22,22,1),new Ke(!1,44,28,24,24,1),new Ke(!0,49,28,22,14,2),new Ke(!1,62,36,14,14,4),new Ke(!1,86,42,16,16,4),new Ke(!1,114,48,18,18,4),new Ke(!1,144,56,20,20,4),new Ke(!1,174,68,22,22,4),new Ke(!1,204,84,24,24,4,102,42),new Ke(!1,280,112,14,14,16,140,56),new Ke(!1,368,144,16,16,16,92,36),new Ke(!1,456,192,18,18,16,114,48),new Ke(!1,576,224,20,20,16,144,56),new Ke(!1,696,272,22,22,16,174,68),new Ke(!1,816,336,24,24,16,136,56),new Ke(!1,1050,408,18,18,36,175,68),new Ke(!1,1304,496,20,20,36,163,62),new Nc],Uc=function(){function r(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var t=e.split("").map(function(g){return g.charCodeAt(0)}),i=new Ge,o=0,s=t.length;o<s;o++){var u=String.fromCharCode(t[o]&255);if(u==="?"&&e.charAt(o)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");i.append(u)}this.msg=i.toString(),this.shape=0,this.codewords=new Ge,this.newEncoding=-1}return r.prototype.setSymbolShape=function(e){this.shape=e},r.prototype.setSizeConstraints=function(e,t){this.minSize=e,this.maxSize=t},r.prototype.getMessage=function(){return this.msg},r.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},r.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},r.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},r.prototype.getCodewords=function(){return this.codewords},r.prototype.writeCodewords=function(e){this.codewords.append(e)},r.prototype.writeCodeword=function(e){this.codewords.append(e)},r.prototype.getCodewordCount=function(){return this.codewords.length()},r.prototype.getNewEncoding=function(){return this.newEncoding},r.prototype.signalEncoderChange=function(e){this.newEncoding=e},r.prototype.resetEncoderSignal=function(){this.newEncoding=-1},r.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},r.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},r.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},r.prototype.getSymbolInfo=function(){return this.symbolInfo},r.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=Ke.lookup(e,this.shape,this.minSize,this.maxSize,!0))},r.prototype.resetSymbolInfo=function(){this.symbolInfo=null},r}(),Vc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Gc=function(r){Vc(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return gt},e.prototype.encode=function(t){for(var i=new Ge;t.hasMoreCharacters();){var o=t.getCurrentChar();t.pos++,this.encodeChar(o,i);var s=i.length();if(s%3===0){this.writeNextTriplet(t,i);var u=ar.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode());if(u!==this.getEncodingMode()){t.signalEncoderChange($e);break}}}this.handleEOD(t,i)},e.prototype.encodeChar=function(t,i){switch(t){case 13:i.append(0);break;case"*".charCodeAt(0):i.append(1);break;case">".charCodeAt(0):i.append(2);break;case" ".charCodeAt(0):i.append(3);break;default:t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)?i.append(t-48+4):t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)?i.append(t-65+14):ar.illegalCharacter(it.getCharAt(t));break}return 1},e.prototype.handleEOD=function(t,i){t.updateSymbolInfo();var o=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount(),s=i.length();t.pos-=s,(t.getRemainingCharacters()>1||o>1||t.getRemainingCharacters()!==o)&&t.writeCodeword(Ic),t.getNewEncoding()<0&&t.signalEncoderChange($e)},e}(Wn),Wc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Hc=function(r){Wc(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return jt},e.prototype.encodeChar=function(t,i){if(t===" ".charCodeAt(0))return i.append(3),1;if(t>="0".charCodeAt(0)&&t<="9".charCodeAt(0))return i.append(t-48+4),1;if(t>="a".charCodeAt(0)&&t<="z".charCodeAt(0))return i.append(t-97+14),1;if(t<" ".charCodeAt(0))return i.append(0),i.append(t),2;if(t<="/".charCodeAt(0))return i.append(1),i.append(t-33),2;if(t<="@".charCodeAt(0))return i.append(1),i.append(t-58+15),2;if(t>="[".charCodeAt(0)&&t<="_".charCodeAt(0))return i.append(1),i.append(t-91+22),2;if(t==="`".charCodeAt(0))return i.append(2),i.append(0),2;if(t<="Z".charCodeAt(0))return i.append(2),i.append(t-65+1),2;if(t<=127)return i.append(2),i.append(t-123+27),2;i.append(1+"");var o=2;return o+=this.encodeChar(t-128,i),o},e}(Wn),Xc=function(){function r(){}return r.randomize253State=function(e){var t=149*e%253+1,i=l0+t;return i<=254?i:i-254},r.encodeHighLevel=function(e,t,i,o,s){t===void 0&&(t=0),i===void 0&&(i=null),o===void 0&&(o=null),s===void 0&&(s=!1);var u=new Wn,g=[new Rc,u,new Hc,new Gc,new Mc,new Pc],B=new Uc(e);B.setSymbolShape(t),B.setSizeConstraints(i,o),e.startsWith(h0)&&e.endsWith(u0)?(B.writeCodeword(Fc),B.setSkipAtEnd(2),B.pos+=h0.length):e.startsWith(c0)&&e.endsWith(u0)&&(B.writeCodeword(Sc),B.setSkipAtEnd(2),B.pos+=c0.length);var _=$e;for(s&&(u.encodeMaximal(B),_=B.getNewEncoding(),B.resetEncoderSignal());B.hasMoreCharacters();)g[_].encode(B),B.getNewEncoding()>=0&&(_=B.getNewEncoding(),B.resetEncoderSignal());var m=B.getCodewordCount();B.updateSymbolInfo();var D=B.getSymbolInfo().getDataCapacity();m<D&&_!==$e&&_!==Pt&&_!==mt&&B.writeCodeword("\xFE");var F=B.getCodewords();for(F.length()<D&&F.append(l0);F.length()<D;)F.append(this.randomize253State(F.length()+1));return B.getCodewords().toString()},r.lookAheadTest=function(e,t,i){var o=this.lookAheadTestIntern(e,t,i);if(i===gt&&o===gt){for(var s=Math.min(t+3,e.length),u=t;u<s;u++)if(!this.isNativeX12(e.charCodeAt(u)))return $e}else if(i===mt&&o===mt){for(var s=Math.min(t+4,e.length),u=t;u<s;u++)if(!this.isNativeEDIFACT(e.charCodeAt(u)))return $e}return o},r.lookAheadTestIntern=function(e,t,i){if(t>=e.length)return i;var o;i===$e?o=[0,1,1,1,1,1.25]:(o=[1,2,2,2,2,2.25],o[i]=0);for(var s=0,u=new Uint8Array(6),g=[];;){if(t+s===e.length){vt.fill(u,0),vt.fill(g,0);var B=this.findMinimums(o,g,ut.MAX_VALUE,u),_=this.getMinimumCount(u);if(g[$e]===B)return $e;if(_===1){if(u[Pt]>0)return Pt;if(u[mt]>0)return mt;if(u[jt]>0)return jt;if(u[gt]>0)return gt}return Tt}var m=e.charCodeAt(t+s);if(s++,this.isDigit(m)?o[$e]+=.5:this.isExtendedASCII(m)?(o[$e]=Math.ceil(o[$e]),o[$e]+=2):(o[$e]=Math.ceil(o[$e]),o[$e]++),this.isNativeC40(m)?o[Tt]+=2/3:this.isExtendedASCII(m)?o[Tt]+=8/3:o[Tt]+=4/3,this.isNativeText(m)?o[jt]+=2/3:this.isExtendedASCII(m)?o[jt]+=8/3:o[jt]+=4/3,this.isNativeX12(m)?o[gt]+=2/3:this.isExtendedASCII(m)?o[gt]+=13/3:o[gt]+=10/3,this.isNativeEDIFACT(m)?o[mt]+=3/4:this.isExtendedASCII(m)?o[mt]+=17/4:o[mt]+=13/4,this.isSpecialB256(m)?o[Pt]+=4:o[Pt]++,s>=4){if(vt.fill(u,0),vt.fill(g,0),this.findMinimums(o,g,ut.MAX_VALUE,u),g[$e]<this.min(g[Pt],g[Tt],g[jt],g[gt],g[mt]))return $e;if(g[Pt]<g[$e]||g[Pt]+1<this.min(g[Tt],g[jt],g[gt],g[mt]))return Pt;if(g[mt]+1<this.min(g[Pt],g[Tt],g[jt],g[gt],g[$e]))return mt;if(g[jt]+1<this.min(g[Pt],g[Tt],g[mt],g[gt],g[$e]))return jt;if(g[gt]+1<this.min(g[Pt],g[Tt],g[mt],g[jt],g[$e]))return gt;if(g[Tt]+1<this.min(g[$e],g[Pt],g[mt],g[jt])){if(g[Tt]<g[gt])return Tt;if(g[Tt]===g[gt]){for(var D=t+s+1;D<e.length;){var F=e.charCodeAt(D);if(this.isX12TermSep(F))return gt;if(!this.isNativeX12(F))break;D++}return Tt}}}}},r.min=function(e,t,i,o,s){var u=Math.min(e,Math.min(t,Math.min(i,o)));return s===void 0?u:Math.min(u,s)},r.findMinimums=function(e,t,i,o){for(var s=0;s<6;s++){var u=t[s]=Math.ceil(e[s]);i>u&&(i=u,vt.fill(o,0)),i===u&&(o[s]=o[s]+1)}return i},r.getMinimumCount=function(e){for(var t=0,i=0;i<6;i++)t+=e[i];return t||0},r.isDigit=function(e){return e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)},r.isExtendedASCII=function(e){return e>=128&&e<=255},r.isNativeC40=function(e){return e===" ".charCodeAt(0)||e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)},r.isNativeText=function(e){return e===" ".charCodeAt(0)||e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)},r.isNativeX12=function(e){return this.isX12TermSep(e)||e===" ".charCodeAt(0)||e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)},r.isX12TermSep=function(e){return e===13||e==="*".charCodeAt(0)||e===">".charCodeAt(0)},r.isNativeEDIFACT=function(e){return e>=" ".charCodeAt(0)&&e<="^".charCodeAt(0)},r.isSpecialB256=function(e){return!1},r.determineConsecutiveDigitCount=function(e,t){t===void 0&&(t=0);for(var i=e.length,o=t;o<i&&this.isDigit(e.charCodeAt(o));)o++;return o-t},r.illegalCharacter=function(e){var t=ut.toHexString(e.charCodeAt(0));throw t="0000".substring(0,4-t.length)+t,new Error("Illegal character: "+e+" (0x"+t+")")},r}(),ar=Xc,ln=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f0=function(){function r(e){this.charset=e,this.name=e.name}return r.prototype.canEncode=function(e){try{return tr.encode(e,this.charset)!=null}catch{return!1}},r}(),Yc=function(){function r(e,t,i){var o,s,u,g,B,_;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(ye){return new f0(_c.forName(ye))}),this.encoders=[];var m=[];m.push(new f0(Cc.ISO_8859_1));for(var D=t!=null&&t.name.startsWith("UTF"),F=0;F<e.length;F++){var T=!1;try{for(var I=(o=void 0,ln(m)),k=I.next();!k.done;k=I.next()){var U=k.value,K=e.charAt(F),X=K.charCodeAt(0);if(X===i||U.canEncode(K)){T=!0;break}}}catch(ye){o={error:ye}}finally{try{k&&!k.done&&(s=I.return)&&s.call(I)}finally{if(o)throw o.error}}if(!T)try{for(var te=(u=void 0,ln(this.ENCODERS)),ne=te.next();!ne.done;ne=te.next()){var U=ne.value;if(U.canEncode(e.charAt(F))){m.push(U),T=!0;break}}}catch(ye){u={error:ye}}finally{try{ne&&!ne.done&&(g=te.return)&&g.call(te)}finally{if(u)throw u.error}}T||(D=!0)}if(m.length===1&&!D)this.encoders=[m[0]];else{this.encoders=[];var re=0;try{for(var ue=ln(m),Ae=ue.next();!Ae.done;Ae=ue.next()){var U=Ae.value;this.encoders[re++]=U}}catch(ye){B={error:ye}}finally{try{Ae&&!Ae.done&&(_=ue.return)&&_.call(ue)}finally{if(B)throw B.error}}}var v=-1;if(t!=null){for(var F=0;F<this.encoders.length;F++)if(this.encoders[F]!=null&&t.name===this.encoders[F].name){v=F;break}}this.priorityEncoderIndex=v}return r.prototype.length=function(){return this.encoders.length},r.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},r.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},r.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},r.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},r.prototype.canEncode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return!0},r.prototype.encode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return tr.encode(it.getCharAt(e),this.encoders[t].name)},r}(),zc=3,Kc=function(){function r(e,t,i){this.fnc1=i;var o=new Yc(e,t,i);if(o.length()===1)for(var s=0;s<this.bytes.length;s++){var u=e.charAt(s).charCodeAt(0);this.bytes[s]=u===i?1e3:u}else this.bytes=this.encodeMinimally(e,o,i)}return r.prototype.getFNC1Character=function(){return this.fnc1},r.prototype.length=function(){return this.bytes.length},r.prototype.haveNCharacters=function(e,t){if(e+t-1>=this.bytes.length)return!1;for(var i=0;i<t;i++)if(this.isECI(e+i))return!1;return!0},r.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},r.prototype.subSequence=function(e,t){if(e<0||e>t||t>this.length())throw new Error(""+e);for(var i=new Ge,o=e;o<t;o++){if(this.isECI(o))throw new Error("value at "+o+" is not a character but an ECI");i.append(this.charAt(o))}return i.toString()},r.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},r.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},r.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},r.prototype.addEdge=function(e,t,i){(e[t][i.encoderIndex]==null||e[t][i.encoderIndex].cachedTotalSize>i.cachedTotalSize)&&(e[t][i.encoderIndex]=i)},r.prototype.addEdges=function(e,t,i,o,s,u){var g=e.charAt(o).charCodeAt(0),B=0,_=t.length();t.getPriorityEncoderIndex()>=0&&(g===u||t.canEncode(g,t.getPriorityEncoderIndex()))&&(B=t.getPriorityEncoderIndex(),_=B+1);for(var m=B;m<_;m++)(g===u||t.canEncode(g,m))&&this.addEdge(i,o+1,new E0(g,t,m,s,u))},r.prototype.encodeMinimally=function(e,t,i){var o=e.length,s=new E0[o+1][t.length()];this.addEdges(e,t,s,0,null,i);for(var u=1;u<=o;u++){for(var g=0;g<t.length();g++)s[u][g]!=null&&u<o&&this.addEdges(e,t,s,u,s[u][g],i);for(var g=0;g<t.length();g++)s[u-1][g]=null}for(var B=-1,_=ut.MAX_VALUE,g=0;g<t.length();g++)if(s[o][g]!=null){var m=s[o][g];m.cachedTotalSize<_&&(_=m.cachedTotalSize,B=g)}if(B<0)throw new Error('Failed to encode "'+e+'"');for(var D=[],F=s[o][B];F!=null;){if(F.isFNC1())D.unshift(1e3);else for(var T=t.encode(F.c,F.encoderIndex),u=T.length-1;u>=0;u--)D.unshift(T[u]&255);var I=F.previous===null?0:F.previous.encoderIndex;I!==F.encoderIndex&&D.unshift(256+t.getECIValue(F.encoderIndex)),F=F.previous}for(var k=[],u=0;u<k.length;u++)k[u]=D[u];return k},r}(),E0=function(){function r(e,t,i,o,s){this.c=e,this.encoderSet=t,this.encoderIndex=i,this.previous=o,this.fnc1=s,this.c=e===s?1e3:e;var u=this.isFNC1()?1:t.encode(e,i).length,g=o===null?0:o.encoderIndex;g!==i&&(u+=zc),o!=null&&(u+=o.cachedTotalSize),this.cachedTotalSize=u}return r.prototype.isFNC1=function(){return this.c===1e3},r}(),Jc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();globalThis&&globalThis.__values;var qc=globalThis&&globalThis.__read||function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),o,s=[],u;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(g){u={error:g}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(u)throw u.error}}return s};globalThis&&globalThis.__spread;var d0;(function(r){r[r.ASCII=0]="ASCII",r[r.C40=1]="C40",r[r.TEXT=2]="TEXT",r[r.X12=3]="X12",r[r.EDF=4]="EDF",r[r.B256=5]="B256"})(d0||(d0={}));(function(r){Jc(e,r);function e(t,i,o,s,u){var g=r.call(this,t,i,o)||this;return g.shape=s,g.macroId=u,g}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(Kc);var Zc=function(){function r(e){this.previous=e}return r.prototype.getPrevious=function(){return this.previous},r}(),Qc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ta=function(r){Qc(e,r);function e(t,i,o){var s=r.call(this,t)||this;return s.value=i,s.bitCount=o,s}return e.prototype.appendTo=function(t,i){t.appendBits(this.value,this.bitCount)},e.prototype.add=function(t,i){return new e(this,t,i)},e.prototype.addBinaryShift=function(t,i){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,t,i)},e.prototype.toString=function(){var t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+ut.toBinaryString(t|1<<this.bitCount).substring(1)+">"},e}(Zc),$c=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(r){$c(e,r);function e(t,i,o){var s=r.call(this,t,0,0)||this;return s.binaryShiftStart=i,s.binaryShiftByteCount=o,s}return e.prototype.appendTo=function(t,i){for(var o=0;o<this.binaryShiftByteCount;o++)(o===0||o===31&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):o===0?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(i[this.binaryShiftStart+o],8)},e.prototype.addBinaryShift=function(t,i){return new e(this,t,i)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e})(ta);var oi=0,ji=1,Wr=2,ra=3,ni=4;new ta(null,0,0);var eu=globalThis&&globalThis.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function tu(r){var e,t;try{for(var i=eu(r),o=i.next();!o.done;o=i.next()){var s=o.value;vt.fill(s,-1)}}catch(u){e={error:u}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r[oi][ni]=0,r[ji][ni]=0,r[ji][oi]=28,r[ra][ni]=0,r[Wr][ni]=0,r[Wr][oi]=15,r}tu(vt.createInt32Array(6,6));globalThis&&globalThis.__values;function ru(r){var e=it.getCharCode(" "),t=it.getCharCode("."),i=it.getCharCode(",");r[oi][e]=1;for(var o=it.getCharCode("Z"),s=it.getCharCode("A"),u=s;u<=o;u++)r[oi][u]=u-s+2;r[ji][e]=1;for(var g=it.getCharCode("z"),B=it.getCharCode("a"),u=B;u<=g;u++)r[ji][u]=u-B+2;r[Wr][e]=1;for(var _=it.getCharCode("9"),m=it.getCharCode("0"),u=m;u<=_;u++)r[Wr][u]=u-m+2;r[Wr][i]=12,r[Wr][t]=13;for(var D=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","\x7F"],F=0;F<D.length;F++)r[ra][it.getCharCode(D[F])]=F;for(var T=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],F=0;F<T.length;F++)it.getCharCode(T[F])>0&&(r[ni][it.getCharCode(T[F])]=F);return r}ru(vt.createInt32Array(5,256));globalThis&&globalThis.__values;globalThis&&globalThis.__values;class iu{constructor(){sr(this,"reader");sr(this,"canvas");sr(this,"settings")}async init(){this.reader||(this.reader=new $0),this.canvas||(this.canvas=document.createElement("canvas"))}async detect(e){const t=Date.now();typeof e=="string"&&(e=await this.loadImageFromDataURL(e));let i;e instanceof HTMLCanvasElement?i=this.createBinaryBitmapFromCanvas(e):me.isDCEFrame(e)?i=this.createBinaryBitmapFromCanvas(e.toCanvas()):i=this.createBinaryBitmap(e);const o=[];let s,u=0;try{s=this.reader.decode(i),u=Date.now()-t}catch(B){console.log(B),u=Date.now()-t}return s&&o.push(this.wrapResult(s)),{elapsedTime:u,results:o}}loadImageFromDataURL(e){return new Promise(async function(t,i){try{const o=new Image;o.src=e,o.onload=function(){t(o)}}catch(o){i(o)}})}wrapResult(e){const t=this.getRectFromPoints(e.getResultPoints());let i="";e.getRawBytes()&&(i=this.getBinary(e.getRawBytes()));const o=ke[e.getBarcodeFormat()],s=t.top;let u=t.bottom;return u===s&&(u=s+2),{barcodeFormat:o,barcodeText:e.getText(),barcodeBytes:i,x1:t.left,x2:t.right,x3:t.right,x4:t.left,y1:s,y2:s,y3:u,y4:u}}getBinary(e){let t="";for(let i=0;i<e.length;i++){const o=e[i];t=t+On(o.toString())}return t}getRectFromPoints(e){return Ui(this.convertResultPointsToPoints(e))}convertResultPointsToPoints(e){const t=[];for(let i=0;i<e.length;i++){const o=e[i],s={x:o.getX(),y:o.getY()};t.push(s)}return t}createBinaryBitmap(e){const t=this.canvas.getContext("2d");let i,o;return e instanceof HTMLVideoElement?(i=e.videoWidth,o=e.videoHeight):(i=e.naturalWidth,o=e.naturalHeight),this.canvas.width=i,this.canvas.height=o,t.drawImage(e,0,0,i,o),this.createBinaryBitmapFromCanvas(this.canvas)}createBinaryBitmapFromCanvas(e){const t=new G0(e),i=new V0(t);return new U0(i)}getSupportedSettings(){return[]}async setSupportedSettings(e){this.settings=e}}class Hn{constructor(){sr(this,"engine","Dynamsoft");sr(this,"reader")}static async createInstance(e){const t=new Hn;return t.setEngine(e),await t.init(),t}setEngine(e){this.engine=e}getEngine(){return this.engine}async init(){this.engine==="Dynamsoft"?this.reader=new px:this.engine==="ZBar"?this.reader=new Sx:this.reader=new iu,await this.reader.init()}detect(e){return this.reader.detect(e)}static getEngines(){return["Dynamsoft","ZXing","ZBar"]}getSupportedSettings(){return this.reader.getSupportedSettings()}async setSupportedSettings(e){return this.reader.setSupportedSettings(e)}}const hn=[],g0=[];function nu(r,e){if(r===e)return 0;const t=r;r.length>e.length&&(r=e,e=t);let i=r.length,o=e.length;for(;i>0&&r.charCodeAt(~-i)===e.charCodeAt(~-o);)i--,o--;let s=0;for(;s<i&&r.charCodeAt(s)===e.charCodeAt(s);)s++;if(i-=s,o-=s,i===0)return o;let u,g,B,_,m=0,D=0;for(;m<i;)g0[m]=r.charCodeAt(s+m),hn[m]=++m;for(;D<o;)for(u=e.charCodeAt(s+D),B=D++,g=D,m=0;m<i;m++)_=u===g0[m]?B:B+1,B=hn[m],g=hn[m]=B>g?_>g?g+1:_:_>B?B+1:_;return g}const Sn=r=>r.lastIndexOf(".")!=-1?r.substring(0,r.lastIndexOf(".")):r,yu=async r=>new Promise(function(e,t){const i=new FileReader;i.onload=function(o){e(o.target.result)},i.onerror=function(){t("oops, something went wrong.")},i.readAsDataURL(r)}),Du=async r=>new Promise(function(e,t){const i=new FileReader;i.onload=function(o){e(o.target.result)},i.onerror=function(){t("oops, something went wrong.")},i.readAsText(r)}),wu=async(r,e)=>{const t=r.info.name,i=[];let o=0,s=0,u=0,g=0,B=0,_=0,m=0,D=0;for(let K=0;K<r.info.images.length;K++){const X=r.info.images[K];let te="",ne=[];const re=await vr.getItem(t+":groundTruth:"+Sn(X)+".txt");re&&(ne=JSON.parse(re),te=ou(ne));let ue="",Ae="",v="",ye="",be="";const je=await vr.getItem(t+":detectionResult:"+Sn(X)+"-"+e+".json");if(je){const x=JSON.parse(je);ue=au(x),v=su(x),Ae=x.elapsedTime.toString(),B=B+x.elapsedTime;const l=xu(x.results,ne);l.groundTruth!=0?l.correct===l.groundTruth?ye="true":ye="false":x.results.length>0?ye="true":ye="false",x.results.length>0&&(m=m+1),_=_+1,be=l.misdetected.toString(),o=o+ne.length,g=g+x.results.length,s=s+l.correct,u=u+l.misdetected}ye==="true"&&(D=D+1);const h={number:K+1,filename:X,groundTruth:te,detectedText:ue,time:Ae,barcodeFormat:v,correct:ye,misdetected:be};i.push(h)}const F=parseFloat((s/o*100).toFixed(2)),T=parseFloat(((g-u)/g*100).toFixed(2)),I=parseFloat((m/r.info.images.length*100).toFixed(2)),k={fileNumber:r.info.images.length,correctFilesNumber:D,barcodeNumber:o,accuracy:F,precision:T,detectedFilesRate:I,averageTime:parseFloat((B/_).toFixed(2))};return{name:e,metrics:k,rows:i}},ou=r=>{let e="";for(let t=0;t<r.length;t++){const i=r[t];e=e+i.text,t!=r.length-1&&(e=e+", ")}return e},au=r=>{let e="";for(let t=0;t<r.results.length;t++){const i=r.results[t];e=e+i.barcodeText,t!=r.results.length-1&&(e=e+", ")}return e},su=r=>{let e="";for(let t=0;t<r.results.length;t++){const i=r.results[t];e=e+i.barcodeFormat,t!=r.results.length-1&&(e=e+", ")}return e},xu=(r,e)=>{const t=e.length,i=r.length;let o=0,s=0;for(let u=0;u<r.length;u++){const g=r[u];for(let B=0;B<e.length;B++){const _=e[B];let m;if(_.hasLocation===!1)m=1;else{const D=uu(g),F=cu(_);m=fu(D,F)}if(m>0){_.text?lu(_,g)?s=s+1:o=o+1:s=s+1;continue}}}return{groundTruth:t,detected:i,misdetected:o,correct:s}};function lu(r,e){if(r.value_attrib.Mode==="binary"){const t=nu(r.text,e.barcodeBytes)/4;return 1-t/Math.max(r.text.length,e.barcodeBytes.length)>=.85}else{let t=r.text,i=e.barcodeText;return e.barcodeFormat.toLowerCase().indexOf("upc")!=-1&&r.attrib.Type.toLowerCase().indexOf("ean")!=-1&&i!=t&&(i="0"+i),e.barcodeFormat.toLowerCase().indexOf("ean")!=-1&&r.attrib.Type.toLowerCase().indexOf("upc")!=-1&&i!=t&&(i=i.substring(1,i.length)),i=hu(i),i=A0(i),t=A0(t),t===i}}function hu(r){return r=r.replaceAll("{GS}",""),r}function A0(r){return r=r.replaceAll("\r",""),r=r.replaceAll(`
`,""),r=r.replaceAll("	",""),r}function cu(r){const e={x:r.x1,y:r.y1},t={x:r.x2,y:r.y2},i={x:r.x3,y:r.y3},o={x:r.x4,y:r.y4};return[e,t,i,o]}function uu(r){const e={x:r.x1,y:r.y1},t={x:r.x2,y:r.y2},i={x:r.x3,y:r.y3},o={x:r.x4,y:r.y4};return[e,t,i,o]}function fu(r,e){const t=Ui(r),i=Ui(e);return Eu(t,i)}function Eu(r,e){const t=Math.max(r.left,e.left),i=Math.min(r.right,e.right),o=Math.max(r.top,e.top),s=Math.min(r.bottom,e.bottom);if(t>=i||s<=o)return 0;const u=r.width*r.height,g=e.width*e.height,B=(s-o)*(i-t);return B/(u+g-B)}function Ui(r){if(r[0]){let e,t,i,o;return e=r[0].x,t=r[0].y,i=0,o=0,r.forEach(u=>{e=Math.min(u.x,e),t=Math.min(u.y,t),i=Math.max(u.x,i),o=Math.max(u.y,o)}),{left:e,top:t,right:i,bottom:o,width:i-e,height:o-t}}else throw new Error("Invalid number of points")}const Fu=async r=>{for(let i=0;i<r.info.images.length;i++){const o=r.info.images[i];vr.removeItem(r.info.name+":image:"+o),vr.removeItem(r.info.name+":groundTruth:"+Sn(o)+".txt")}const e=await vr.getItem(r.info.name+":detectionResultFileNamesList");if(e)for(let i=0;i<e.length;i++){const o=e[i];vr.removeItem(r.info.name+":detectionResult:"+o)}const t=Hn.getEngines();for(let i=0;i<t.length;i++){const o=t[i];vr.removeItem(r.info.name+":settings:"+o)}r.info.images=[]};function Su(r){const e=r.split(",")[0].split(":")[1].split(";")[0],t=atob(r.split(",")[1]),i=[];for(let o=0;o<t.length;o++)i.push(t.charCodeAt(o));return new Blob([new Uint8Array(i)],{type:e})}function bu(r){return new Promise(function(e,t){const i=new FileReader;i.onload=function(o){o.target&&(typeof o.target.result=="string"?e(o.target.result):t(""))},i.readAsDataURL(r)})}const Tu=async(r,e,t)=>{const i=await vr.getItem(r+":settings:"+e),o=[];for(let s=0;s<t.length;s++){const u=t[s];let g="";if(i)for(let _=0;_<i.length;_++){const m=i[_];m.name===u&&(g=m.value)}const B={name:u,value:g};o.push(B)}return o};function Ou(r){return new Promise(function(e){setTimeout(e,r)})}function Iu(r){const e=[];for(let t=0;t<r.length;t++){const i=r[t];e.push(du(i))}return e}function du(r){return{text:r.barcodeText,attrib:{Type:r.barcodeFormat},value_attrib:{},x1:r.x1,x2:r.x2,x3:r.x3,x4:r.x4,y1:r.y1,y2:r.y2,y3:r.y3,y4:r.y4}}export{bu as B,Iu as C,mu as a,Hn as b,Bu as c,vu as d,gi as e,Ai as f,Sn as g,wu as h,Du as i,yu as j,Su as k,vr as l,Tu as m,Cu as n,uu as o,cu as p,fu as q,Fu as r,Ou as s,lu as t,_u as u,me as x};
